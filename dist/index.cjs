"use strict";var Q=Object.create;var K=Object.defineProperty;var ee=Object.getOwnPropertyDescriptor;var te=Object.getOwnPropertyNames;var oe=Object.getPrototypeOf,ne=Object.prototype.hasOwnProperty;var re=(r,a)=>{for(var l in a)K(r,l,{get:a[l],enumerable:!0})},Z=(r,a,l,f)=>{if(a&&typeof a=="object"||typeof a=="function")for(let u of te(a))!ne.call(r,u)&&u!==l&&K(r,u,{get:()=>a[u],enumerable:!(f=ee(a,u))||f.enumerable});return r};var se=(r,a,l)=>(l=r!=null?Q(oe(r)):{},Z(a||!r||!r.__esModule?K(l,"default",{value:r,enumerable:!0}):l,r)),ie=r=>Z(K({},"__esModule",{value:!0}),r);var de={};re(de,{ChatEnabled:()=>J,DefaultChatbot:()=>z,FloatingWindow:()=>Y});module.exports=ie(de);var k=se(require("react"),1);var P=require("react"),E=require("react/jsx-runtime"),Y=({children:r,title:a,onClose:l,position:f="bottom-right",width:u=360,height:M=480,minWidth:T=280,minHeight:W=240,offset:v=16,zIndex:_=1e3,className:g,style:F,headerClassName:w,bodyClassName:U,closeButtonAriaLabel:$="Close",closeOnEscape:L=!0,draggable:H=!0,anchorRect:d})=>{let[S,B]=(0,P.useState)(!1),m=(0,P.useRef)(null),[e,o]=(0,P.useState)(!1),t=(0,P.useRef)(null),[n,h]=(0,P.useState)(null);(0,P.useEffect)(()=>{if(!L)return;let s=R=>{R.key==="Escape"&&l?.()};return window.addEventListener("keydown",s),()=>window.removeEventListener("keydown",s)},[L,l]);let b=(()=>{let s=`${v}px`;switch(f){case"top-left":return{top:s,left:s};case"top-right":return{top:s,right:s};case"bottom-left":return{bottom:s,left:s};case"bottom-right":default:return{bottom:s,right:s}}})(),D=(()=>{if(f!=="auto"||!d)return null;let s=window.innerWidth,R=window.innerHeight,x=v,N=d.top<R/2,p=d.left>s/2,c=N?["bottom","top"]:["top","bottom"],j=p?["right","left"]:["left","right"],V=[`${c[0]}-${j[0]}`,`${c[0]}-${j[1]}`,`${c[1]}-${j[0]}`,`${c[1]}-${j[1]}`];for(let X of V){let O=0,A=0;if(X==="bottom-right"?(O=d.bottom+x,A=d.right-u):X==="bottom-left"?(O=d.bottom+x,A=d.left):X==="top-right"?(O=d.top-M-x,A=d.right-u):(O=d.top-M-x,A=d.left),O>=0&&A>=0&&O+M<=R&&A+u<=s)return{top:O,left:A}}let q=Math.min(Math.max(d.bottom+x,0),R-M),G=Math.min(Math.max(d.right-u,0),s-u);return{top:q,left:G}})(),C=s=>{if(!H)return;let R=m.current;if(!R)return;let x=R.getBoundingClientRect();t.current={x:s.clientX,y:s.clientY,top:x.top,left:x.left},h({top:x.top,left:x.left}),o(!0);let N=c=>{if(!t.current)return;let j=c.clientX-t.current.x,V=c.clientY-t.current.y;h({top:t.current.top+V,left:t.current.left+j})},p=()=>{o(!1),t.current=null,window.removeEventListener("pointermove",N),window.removeEventListener("pointerup",p)};window.addEventListener("pointermove",N),window.addEventListener("pointerup",p,{once:!0})};return(0,E.jsxs)("div",{ref:m,role:"dialog","aria-modal":"false",className:g,style:{position:"fixed",...n?{top:n.top,left:n.left}:D?{top:D.top,left:D.left}:b,width:u,height:M,minWidth:T,minHeight:W,zIndex:_,background:"#ffffff",border:"1px solid rgba(0,0,0,0.06)",borderRadius:12,boxShadow:"0 10px 30px rgba(0,0,0,0.15), 0 4px 12px rgba(0,0,0,0.08)",display:"flex",flexDirection:"column",overflow:"hidden",userSelect:e?"none":void 0,...F},children:[(0,E.jsxs)("div",{className:w,style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"10px 12px",borderBottom:"1px solid rgba(0,0,0,0.06)",background:"#f9fafb",cursor:H?"move":void 0},onPointerDown:C,children:[(0,E.jsx)("div",{style:{fontWeight:600,color:"#111827"},children:a}),(0,E.jsx)("button",{type:"button",onClick:l,"aria-label":$,onMouseEnter:()=>B(!0),onMouseLeave:()=>B(!1),style:{width:28,height:28,display:"inline-flex",alignItems:"center",justifyContent:"center",borderRadius:8,border:"1px solid rgba(0,0,0,0.08)",background:"white",cursor:"pointer",color:S?"#ef4444":void 0,transition:"color 120ms ease"},children:(0,E.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,E.jsx)("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),(0,E.jsx)("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),(0,E.jsx)("div",{className:U,style:{flex:1,overflow:"auto",background:"#ffffff"},children:r})]})};var y=require("react"),i=require("react/jsx-runtime"),ae="https://api.openai.com/v1/chat/completions";async function le(r){return new Promise((a,l)=>{let f=new FileReader;f.onload=()=>a(f.result),f.onerror=l,f.readAsDataURL(r)})}var z=({model:r="gpt-4o-mini",placeholderApiKey:a="REPLACE_WITH_YOUR_OPENAI_API_KEY",systemPrompt:l="You are a helpful assistant.",welcome:f="Hi! How can I help you today?",className:u,style:M})=>{let[T,W]=(0,y.useState)([{id:"welcome",role:"assistant",text:f}]),[v,_]=(0,y.useState)(""),[g,F]=(0,y.useState)([]),[w,U]=(0,y.useState)(!1),$=(0,y.useRef)(null),L=(0,y.useCallback)(()=>{$.current?.scrollIntoView({behavior:"smooth"})},[]),H=async e=>{let o=Array.from(e.target.files||[]);if(o.length===0)return;let t=await Promise.all(o.map(le));F(n=>[...n,...t]),e.target.value=""},d=e=>{F(o=>o.filter((t,n)=>n!==e))},S=(0,y.useCallback)((e,o)=>{let t=[];l&&t.push({role:"system",content:l});for(let n of e)if(n.role==="assistant")t.push({role:"assistant",content:n.text||""});else if((n.images?.length||0)>0){let h=[{type:"text",text:n.text||""},...n.images.map(b=>({type:"image_url",image_url:{url:b}}))];t.push({role:"user",content:h})}else t.push({role:"user",content:n.text||""});if(o)if(o.images.length>0){let n=[{type:"text",text:o.text},...o.images.map(h=>({type:"image_url",image_url:{url:h}}))];t.push({role:"user",content:n})}else t.push({role:"user",content:o.text});return t},[l]),B=(0,y.useCallback)(async()=>{let e=v.trim();if(!e&&g.length===0)return;let o={id:String(Date.now()),role:"user",text:e||void 0,images:g.length?g:void 0};W(t=>[...t,o]),_(""),F([]),U(!0);try{let t=S(T,{text:o.text||"",images:o.images||[]}),n=await fetch(ae,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`},body:JSON.stringify({model:r,messages:t,temperature:.7})});if(!n.ok)throw new Error(`OpenAI error: ${n.status}`);let b=(await n.json())?.choices?.[0]?.message?.content??"",D={id:String(Date.now()+1),role:"assistant",text:typeof b=="string"?b:String(b)};W(C=>[...C,D]),setTimeout(L,0)}catch(t){let n={id:String(Date.now()+1),role:"assistant",text:`Error: ${t?.message||"Failed to contact OpenAI"}`};W(h=>[...h,n])}finally{U(!1)}},[S,v,T,g,a,r,L]),m=(0,y.useMemo)(()=>(v.trim().length>0||g.length>0)&&!w,[v,g.length,w]);return(0,i.jsxs)("div",{className:u,style:{display:"flex",flexDirection:"column",height:"100%",...M},children:[(0,i.jsxs)("div",{style:{flex:1,overflow:"auto",padding:12,background:"#ffffff"},children:[T.map(e=>(0,i.jsx)("div",{style:{marginBottom:10,display:"flex",justifyContent:e.role==="user"?"flex-end":"flex-start"},children:(0,i.jsxs)("div",{style:{maxWidth:"80%",padding:"8px 10px",borderRadius:10,border:"1px solid rgba(0,0,0,0.06)",background:e.role==="user"?"#111827":"#f3f4f6",color:e.role==="user"?"#ffffff":"#111827",whiteSpace:"pre-wrap",wordBreak:"break-word"},children:[e.text,e.images&&e.images.length>0&&(0,i.jsx)("div",{style:{display:"flex",gap:8,marginTop:8,flexWrap:"wrap"},children:e.images.map((o,t)=>(0,i.jsx)("img",{src:o,alt:"upload",style:{width:96,height:72,objectFit:"cover",borderRadius:8,border:"1px solid rgba(0,0,0,0.06)"}},t))})]})},e.id)),(0,i.jsx)("div",{ref:$})]}),(0,i.jsxs)("div",{style:{padding:12,borderTop:"1px solid rgba(0,0,0,0.06)",background:"#fafafa"},children:[(0,i.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[(0,i.jsx)("input",{type:"file",accept:"image/*",multiple:!0,onChange:H,style:{display:"none"},id:"ai-hud-chatbot-file"}),(0,i.jsx)("label",{htmlFor:"ai-hud-chatbot-file",children:(0,i.jsx)("span",{style:{display:"inline-flex",alignItems:"center",justifyContent:"center",width:36,height:36,border:"1px solid rgba(0,0,0,0.08)",borderRadius:8,background:"white",cursor:"pointer"},children:(0,i.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,i.jsx)("path",{d:"M18.5 12.5l-5 5-3-3-5 5"}),(0,i.jsx)("path",{d:"M20 7a4 4 0 0 0-8 0v10a4 4 0 0 0 8 0Z"})]})})}),(0,i.jsx)("input",{value:v,onChange:e=>_(e.target.value),placeholder:"Type a message...",onKeyDown:e=>{e.key==="Enter"&&!e.shiftKey&&(e.preventDefault(),m&&B())},style:{flex:1,height:36,border:"1px solid rgba(0,0,0,0.15)",borderRadius:8,padding:"0 10px"}}),(0,i.jsx)("button",{type:"button",disabled:!m,onClick:()=>void B(),style:{height:36,padding:"0 12px",borderRadius:8,border:"1px solid rgba(0,0,0,0.08)",background:m?"#111827":"#e5e7eb",color:m?"#ffffff":"#9ca3af",cursor:m?"pointer":"not-allowed"},children:"Send"})]}),g.length>0&&(0,i.jsx)("div",{style:{display:"flex",gap:8,marginTop:8,flexWrap:"wrap"},children:g.map((e,o)=>(0,i.jsxs)("div",{style:{position:"relative"},children:[(0,i.jsx)("img",{src:e,alt:"selected",style:{width:64,height:48,objectFit:"cover",borderRadius:6,border:"1px solid rgba(0,0,0,0.06)"}}),(0,i.jsx)("button",{type:"button",onClick:()=>d(o),"aria-label":"Remove image",style:{position:"absolute",top:-6,right:-6,width:20,height:20,borderRadius:9999,border:"1px solid rgba(0,0,0,0.08)",background:"white",cursor:"pointer"},children:"\xD7"})]},o))})]})]})};var I=require("react/jsx-runtime"),J=k.default.forwardRef(({children:r,onClick:a,label:l="Open chat",position:f="top-right",offset:u=8,icon:M,className:T,containerStyle:W,buttonClassName:v,buttonStyle:_,buttonSize:g=36,zIndex:F=10,disabled:w=!1,trigger:U,open:$,onOpenChange:L,renderButton:H,openWindowOnClick:d=!1,windowProps:S,windowContent:B},m)=>{let[e,o]=(0,k.useState)(!1),[t,n]=(0,k.useState)(!1),h=(0,k.useRef)(null),b=U??"hover",D=(0,k.useMemo)(()=>{let p={position:"absolute"},c=`${u}px`;switch(f){case"top-left":return{...p,top:c,left:c};case"top-right":return{...p,top:c,right:c};case"bottom-left":return{...p,bottom:c,left:c};case"bottom-right":default:return{...p,bottom:c,right:c}}},[f,u]),C=b==="always"?!0:b==="manual"?!!$:e,s=p=>{L&&L(p)},R={onMouseEnter:b==="hover"?()=>{o(!0),s(!0)}:void 0,onMouseLeave:b==="hover"?()=>{o(!1),s(!1)}:void 0,onFocus:b==="focus"?()=>{o(!0),s(!0)}:void 0,onBlur:b==="focus"?()=>{o(!1),s(!1)}:void 0},x=p=>{h.current=p,typeof m=="function"?m(p):m&&typeof m=="object"&&(m.current=p)},N={type:"button","aria-label":l,onClick:p=>{a?.(p),!w&&d&&n(!0)},className:v,disabled:w,style:{...D,zIndex:F,width:g,height:g,borderRadius:9999,display:"flex",alignItems:"center",justifyContent:"center",border:"1px solid rgba(0,0,0,0.08)",background:w?"#f3f4f6":"white",color:w?"#9ca3af":void 0,boxShadow:"0 2px 6px rgba(0,0,0,0.1), 0 1px 2px rgba(0,0,0,0.06)",cursor:w?"not-allowed":"pointer",transition:"opacity 120ms ease, transform 120ms ease",opacity:C?1:0,transform:C?"scale(1)":"scale(0.95)",pointerEvents:C?"auto":"none",..._},tabIndex:C?0:-1,"aria-hidden":C?void 0:!0,ref:x,visible:C};return(0,I.jsxs)("div",{className:T,style:{position:"relative",display:"inline-block",...W},...R,children:[r,H?H(N):(0,I.jsx)("button",{...N,children:M??(0,I.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:Math.max(12,Math.floor(g*.5)),height:Math.max(12,Math.floor(g*.5)),viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,I.jsx)("path",{d:"M21 15a4 4 0 0 1-4 4H7l-4 4V7a4 4 0 0 1 4-4h10a4 4 0 0 1 4 4z"})})}),d&&t&&(0,I.jsx)(Y,{...S,onClose:()=>{S?.onClose?.(),n(!1)},anchorRect:S?.anchorRect??(h.current?h.current.getBoundingClientRect():null),children:B??(0,I.jsx)(z,{})})]})});J.displayName="ChatEnabled";0&&(module.exports={ChatEnabled,DefaultChatbot,FloatingWindow});
//# sourceMappingURL=index.cjs.map
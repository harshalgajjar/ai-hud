"use strict";var V=Object.create;var A=Object.defineProperty;var z=Object.getOwnPropertyDescriptor;var X=Object.getOwnPropertyNames;var J=Object.getPrototypeOf,Z=Object.prototype.hasOwnProperty;var q=(r,i)=>{for(var l in i)A(r,l,{get:i[l],enumerable:!0})},K=(r,i,l,p)=>{if(i&&typeof i=="object"||typeof i=="function")for(let g of X(i))!Z.call(r,g)&&g!==l&&A(r,g,{get:()=>i[g],enumerable:!(p=z(i,g))||p.enumerable});return r};var G=(r,i,l)=>(l=r!=null?V(J(r)):{},K(i||!r||!r.__esModule?A(l,"default",{value:r,enumerable:!0}):l,r)),Q=r=>K(A({},"__esModule",{value:!0}),r);var oe={};q(oe,{ChatEnabled:()=>j,DefaultChatbot:()=>U,FloatingWindow:()=>_});module.exports=Q(oe);var T=G(require("react"),1);var C=require("react"),y=require("react/jsx-runtime"),_=({children:r,title:i,onClose:l,position:p="bottom-right",width:g=360,height:B=480,minWidth:k=280,minHeight:M=240,offset:x=16,zIndex:F=1e3,className:d,style:S,headerClassName:b,bodyClassName:W,closeButtonAriaLabel:D="Close",closeOnEscape:R=!0,draggable:I=!0})=>{let[N,E]=(0,C.useState)(!1),L=(0,C.useRef)(null),[v,t]=(0,C.useState)(!1),e=(0,C.useRef)(null),[o,n]=(0,C.useState)(null);(0,C.useEffect)(()=>{if(!R)return;let s=f=>{f.key==="Escape"&&l?.()};return window.addEventListener("keydown",s),()=>window.removeEventListener("keydown",s)},[R,l]);let c=(()=>{let s=`${x}px`;switch(p){case"top-left":return{top:s,left:s};case"top-right":return{top:s,right:s};case"bottom-left":return{bottom:s,left:s};case"bottom-right":default:return{bottom:s,right:s}}})(),w=s=>{if(!I)return;let f=L.current;if(!f)return;let H=f.getBoundingClientRect();e.current={x:s.clientX,y:s.clientY,top:H.top,left:H.left},n({top:H.top,left:H.left}),t(!0);let O=m=>{if(!e.current)return;let Y=m.clientX-e.current.x,$=m.clientY-e.current.y;n({top:e.current.top+$,left:e.current.left+Y})},h=()=>{t(!1),e.current=null,window.removeEventListener("pointermove",O),window.removeEventListener("pointerup",h)};window.addEventListener("pointermove",O),window.addEventListener("pointerup",h,{once:!0})};return(0,y.jsxs)("div",{ref:L,role:"dialog","aria-modal":"false",className:d,style:{position:"fixed",...o?{top:o.top,left:o.left}:c,width:g,height:B,minWidth:k,minHeight:M,zIndex:F,background:"#ffffff",border:"1px solid rgba(0,0,0,0.06)",borderRadius:12,boxShadow:"0 10px 30px rgba(0,0,0,0.15), 0 4px 12px rgba(0,0,0,0.08)",display:"flex",flexDirection:"column",overflow:"hidden",userSelect:v?"none":void 0,...S},children:[(0,y.jsxs)("div",{className:b,style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"10px 12px",borderBottom:"1px solid rgba(0,0,0,0.06)",background:"#f9fafb",cursor:I?"move":void 0},onPointerDown:w,children:[(0,y.jsx)("div",{style:{fontWeight:600,color:"#111827"},children:i}),(0,y.jsx)("button",{type:"button",onClick:l,"aria-label":D,onMouseEnter:()=>E(!0),onMouseLeave:()=>E(!1),style:{width:28,height:28,display:"inline-flex",alignItems:"center",justifyContent:"center",borderRadius:8,border:"1px solid rgba(0,0,0,0.08)",background:"white",cursor:"pointer",color:N?"#ef4444":void 0,transition:"color 120ms ease"},children:(0,y.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,y.jsx)("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),(0,y.jsx)("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),(0,y.jsx)("div",{className:W,style:{flex:1,overflow:"auto",background:"#ffffff"},children:r})]})};var u=require("react"),a=require("react/jsx-runtime"),ee="https://api.openai.com/v1/chat/completions";async function te(r){return new Promise((i,l)=>{let p=new FileReader;p.onload=()=>i(p.result),p.onerror=l,p.readAsDataURL(r)})}var U=({model:r="gpt-4o-mini",placeholderApiKey:i="REPLACE_WITH_YOUR_OPENAI_API_KEY",systemPrompt:l="You are a helpful assistant.",welcome:p="Hi! How can I help you today?",className:g,style:B})=>{let[k,M]=(0,u.useState)([{id:"welcome",role:"assistant",text:p}]),[x,F]=(0,u.useState)(""),[d,S]=(0,u.useState)([]),[b,W]=(0,u.useState)(!1),D=(0,u.useRef)(null),R=(0,u.useCallback)(()=>{D.current?.scrollIntoView({behavior:"smooth"})},[]),I=async t=>{let e=Array.from(t.target.files||[]);if(e.length===0)return;let o=await Promise.all(e.map(te));S(n=>[...n,...o]),t.target.value=""},N=t=>{S(e=>e.filter((o,n)=>n!==t))},E=(0,u.useCallback)((t,e)=>{let o=[];l&&o.push({role:"system",content:l});for(let n of t)if(n.role==="assistant")o.push({role:"assistant",content:n.text||""});else if((n.images?.length||0)>0){let c=[{type:"text",text:n.text||""},...n.images.map(w=>({type:"image_url",image_url:{url:w}}))];o.push({role:"user",content:c})}else o.push({role:"user",content:n.text||""});if(e)if(e.images.length>0){let n=[{type:"text",text:e.text},...e.images.map(c=>({type:"image_url",image_url:{url:c}}))];o.push({role:"user",content:n})}else o.push({role:"user",content:e.text});return o},[l]),L=(0,u.useCallback)(async()=>{let t=x.trim();if(!t&&d.length===0)return;let e={id:String(Date.now()),role:"user",text:t||void 0,images:d.length?d:void 0};M(o=>[...o,e]),F(""),S([]),W(!0);try{let o=E(k,{text:e.text||"",images:e.images||[]}),n=await fetch(ee,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${i}`},body:JSON.stringify({model:r,messages:o,temperature:.7})});if(!n.ok)throw new Error(`OpenAI error: ${n.status}`);let w=(await n.json())?.choices?.[0]?.message?.content??"",s={id:String(Date.now()+1),role:"assistant",text:typeof w=="string"?w:String(w)};M(f=>[...f,s]),setTimeout(R,0)}catch(o){let n={id:String(Date.now()+1),role:"assistant",text:`Error: ${o?.message||"Failed to contact OpenAI"}`};M(c=>[...c,n])}finally{W(!1)}},[E,x,k,d,i,r,R]),v=(0,u.useMemo)(()=>(x.trim().length>0||d.length>0)&&!b,[x,d.length,b]);return(0,a.jsxs)("div",{className:g,style:{display:"flex",flexDirection:"column",height:"100%",...B},children:[(0,a.jsxs)("div",{style:{flex:1,overflow:"auto",padding:12,background:"#ffffff"},children:[k.map(t=>(0,a.jsx)("div",{style:{marginBottom:10,display:"flex",justifyContent:t.role==="user"?"flex-end":"flex-start"},children:(0,a.jsxs)("div",{style:{maxWidth:"80%",padding:"8px 10px",borderRadius:10,border:"1px solid rgba(0,0,0,0.06)",background:t.role==="user"?"#111827":"#f3f4f6",color:t.role==="user"?"#ffffff":"#111827",whiteSpace:"pre-wrap",wordBreak:"break-word"},children:[t.text,t.images&&t.images.length>0&&(0,a.jsx)("div",{style:{display:"flex",gap:8,marginTop:8,flexWrap:"wrap"},children:t.images.map((e,o)=>(0,a.jsx)("img",{src:e,alt:"upload",style:{width:96,height:72,objectFit:"cover",borderRadius:8,border:"1px solid rgba(0,0,0,0.06)"}},o))})]})},t.id)),(0,a.jsx)("div",{ref:D})]}),(0,a.jsxs)("div",{style:{padding:12,borderTop:"1px solid rgba(0,0,0,0.06)",background:"#fafafa"},children:[(0,a.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[(0,a.jsx)("input",{type:"file",accept:"image/*",multiple:!0,onChange:I,style:{display:"none"},id:"ai-hud-chatbot-file"}),(0,a.jsx)("label",{htmlFor:"ai-hud-chatbot-file",children:(0,a.jsx)("span",{style:{display:"inline-flex",alignItems:"center",justifyContent:"center",width:36,height:36,border:"1px solid rgba(0,0,0,0.08)",borderRadius:8,background:"white",cursor:"pointer"},children:(0,a.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,a.jsx)("path",{d:"M18.5 12.5l-5 5-3-3-5 5"}),(0,a.jsx)("path",{d:"M20 7a4 4 0 0 0-8 0v10a4 4 0 0 0 8 0Z"})]})})}),(0,a.jsx)("input",{value:x,onChange:t=>F(t.target.value),placeholder:"Type a message...",onKeyDown:t=>{t.key==="Enter"&&!t.shiftKey&&(t.preventDefault(),v&&L())},style:{flex:1,height:36,border:"1px solid rgba(0,0,0,0.15)",borderRadius:8,padding:"0 10px"}}),(0,a.jsx)("button",{type:"button",disabled:!v,onClick:()=>void L(),style:{height:36,padding:"0 12px",borderRadius:8,border:"1px solid rgba(0,0,0,0.08)",background:v?"#111827":"#e5e7eb",color:v?"#ffffff":"#9ca3af",cursor:v?"pointer":"not-allowed"},children:"Send"})]}),d.length>0&&(0,a.jsx)("div",{style:{display:"flex",gap:8,marginTop:8,flexWrap:"wrap"},children:d.map((t,e)=>(0,a.jsxs)("div",{style:{position:"relative"},children:[(0,a.jsx)("img",{src:t,alt:"selected",style:{width:64,height:48,objectFit:"cover",borderRadius:6,border:"1px solid rgba(0,0,0,0.06)"}}),(0,a.jsx)("button",{type:"button",onClick:()=>N(e),"aria-label":"Remove image",style:{position:"absolute",top:-6,right:-6,width:20,height:20,borderRadius:9999,border:"1px solid rgba(0,0,0,0.08)",background:"white",cursor:"pointer"},children:"\xD7"})]},e))})]})]})};var P=require("react/jsx-runtime"),j=T.default.forwardRef(({children:r,onClick:i,label:l="Open chat",position:p="top-right",offset:g=8,icon:B,className:k,containerStyle:M,buttonClassName:x,buttonStyle:F,buttonSize:d=36,zIndex:S=10,disabled:b=!1,trigger:W,open:D,onOpenChange:R,renderButton:I,openWindowOnClick:N=!1,windowProps:E,windowContent:L},v)=>{let[t,e]=(0,T.useState)(!1),[o,n]=(0,T.useState)(!1),c=W??"hover",w=(0,T.useMemo)(()=>{let h={position:"absolute"},m=`${g}px`;switch(p){case"top-left":return{...h,top:m,left:m};case"top-right":return{...h,top:m,right:m};case"bottom-left":return{...h,bottom:m,left:m};case"bottom-right":default:return{...h,bottom:m,right:m}}},[p,g]),s=c==="always"?!0:c==="manual"?!!D:t,f=h=>{R&&R(h)},H={onMouseEnter:c==="hover"?()=>{e(!0),f(!0)}:void 0,onMouseLeave:c==="hover"?()=>{e(!1),f(!1)}:void 0,onFocus:c==="focus"?()=>{e(!0),f(!0)}:void 0,onBlur:c==="focus"?()=>{e(!1),f(!1)}:void 0},O={type:"button","aria-label":l,onClick:h=>{i?.(h),!b&&N&&n(!0)},className:x,disabled:b,style:{...w,zIndex:S,width:d,height:d,borderRadius:9999,display:"flex",alignItems:"center",justifyContent:"center",border:"1px solid rgba(0,0,0,0.08)",background:b?"#f3f4f6":"white",color:b?"#9ca3af":void 0,boxShadow:"0 2px 6px rgba(0,0,0,0.1), 0 1px 2px rgba(0,0,0,0.06)",cursor:b?"not-allowed":"pointer",transition:"opacity 120ms ease, transform 120ms ease",opacity:s?1:0,transform:s?"scale(1)":"scale(0.95)",pointerEvents:s?"auto":"none",...F},tabIndex:s?0:-1,"aria-hidden":s?void 0:!0,ref:v,visible:s};return(0,P.jsxs)("div",{className:k,style:{position:"relative",display:"inline-block",...M},...H,children:[r,I?I(O):(0,P.jsx)("button",{...O,children:B??(0,P.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:Math.max(12,Math.floor(d*.5)),height:Math.max(12,Math.floor(d*.5)),viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,P.jsx)("path",{d:"M21 15a4 4 0 0 1-4 4H7l-4 4V7a4 4 0 0 1 4-4h10a4 4 0 0 1 4 4z"})})}),N&&o&&(0,P.jsx)(_,{...E,onClose:()=>{E?.onClose?.(),n(!1)},children:L??(0,P.jsx)(U,{})})]})});j.displayName="ChatEnabled";0&&(module.exports={ChatEnabled,DefaultChatbot,FloatingWindow});
//# sourceMappingURL=index.cjs.map
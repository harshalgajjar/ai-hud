"use strict";var $=Object.create;var D=Object.defineProperty;var V=Object.getOwnPropertyDescriptor;var Y=Object.getOwnPropertyNames;var z=Object.getPrototypeOf,J=Object.prototype.hasOwnProperty;var Z=(o,s)=>{for(var a in s)D(o,a,{get:s[a],enumerable:!0})},j=(o,s,a,p)=>{if(s&&typeof s=="object"||typeof s=="function")for(let u of Y(s))!J.call(o,u)&&u!==a&&D(o,u,{get:()=>s[u],enumerable:!(p=V(s,u))||p.enumerable});return o};var q=(o,s,a)=>(a=o!=null?$(z(o)):{},j(s||!o||!o.__esModule?D(a,"default",{value:o,enumerable:!0}):a,o)),G=o=>j(D({},"__esModule",{value:!0}),o);var ee={};Z(ee,{ChatEnabled:()=>_,DefaultChatbot:()=>B,FloatingWindow:()=>A});module.exports=G(ee);var I=q(require("react"),1);var O=require("react"),h=require("react/jsx-runtime"),A=({children:o,title:s,onClose:a,position:p="bottom-right",width:u=360,height:H=480,minWidth:R=280,minHeight:k=240,offset:b=16,zIndex:F=1e3,className:d,style:E,headerClassName:f,bodyClassName:W,closeButtonAriaLabel:L="Close",closeOnEscape:y=!0})=>{let[T,P]=(0,O.useState)(!1);(0,O.useEffect)(()=>{if(!y)return;let l=m=>{m.key==="Escape"&&a?.()};return window.addEventListener("keydown",l),()=>window.removeEventListener("keydown",l)},[y,a]);let M=(()=>{let l=`${b}px`;switch(p){case"top-left":return{top:l,left:l};case"top-right":return{top:l,right:l};case"bottom-left":return{bottom:l,left:l};case"bottom-right":default:return{bottom:l,right:l}}})();return(0,h.jsxs)("div",{role:"dialog","aria-modal":"false",className:d,style:{position:"fixed",...M,width:u,height:H,minWidth:R,minHeight:k,zIndex:F,background:"#ffffff",border:"1px solid rgba(0,0,0,0.06)",borderRadius:12,boxShadow:"0 10px 30px rgba(0,0,0,0.15), 0 4px 12px rgba(0,0,0,0.08)",display:"flex",flexDirection:"column",overflow:"hidden",...E},children:[(0,h.jsxs)("div",{className:f,style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"10px 12px",borderBottom:"1px solid rgba(0,0,0,0.06)",background:"#f9fafb"},children:[(0,h.jsx)("div",{style:{fontWeight:600,color:"#111827"},children:s}),(0,h.jsx)("button",{type:"button",onClick:a,"aria-label":L,onMouseEnter:()=>P(!0),onMouseLeave:()=>P(!1),style:{width:28,height:28,display:"inline-flex",alignItems:"center",justifyContent:"center",borderRadius:8,border:"1px solid rgba(0,0,0,0.08)",background:"white",cursor:"pointer",color:T?"#ef4444":void 0,transition:"color 120ms ease"},children:(0,h.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,h.jsx)("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),(0,h.jsx)("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),(0,h.jsx)("div",{className:W,style:{flex:1,overflow:"auto",background:"#ffffff"},children:o})]})};var g=require("react"),n=require("react/jsx-runtime"),Q="https://api.openai.com/v1/chat/completions";async function X(o){return new Promise((s,a)=>{let p=new FileReader;p.onload=()=>s(p.result),p.onerror=a,p.readAsDataURL(o)})}var B=({model:o="gpt-4o-mini",placeholderApiKey:s="REPLACE_WITH_YOUR_OPENAI_API_KEY",systemPrompt:a="You are a helpful assistant.",welcome:p="Hi! How can I help you today?",className:u,style:H})=>{let[R,k]=(0,g.useState)([{id:"welcome",role:"assistant",text:p}]),[b,F]=(0,g.useState)(""),[d,E]=(0,g.useState)([]),[f,W]=(0,g.useState)(!1),L=(0,g.useRef)(null),y=(0,g.useCallback)(()=>{L.current?.scrollIntoView({behavior:"smooth"})},[]),T=async e=>{let t=Array.from(e.target.files||[]);if(t.length===0)return;let i=await Promise.all(t.map(X));E(r=>[...r,...i]),e.target.value=""},P=e=>{E(t=>t.filter((i,r)=>r!==e))},M=(0,g.useCallback)((e,t)=>{let i=[];a&&i.push({role:"system",content:a});for(let r of e)if(r.role==="assistant")i.push({role:"assistant",content:r.text||""});else if((r.images?.length||0)>0){let c=[{type:"text",text:r.text||""},...r.images.map(S=>({type:"image_url",image_url:{url:S}}))];i.push({role:"user",content:c})}else i.push({role:"user",content:r.text||""});if(t)if(t.images.length>0){let r=[{type:"text",text:t.text},...t.images.map(c=>({type:"image_url",image_url:{url:c}}))];i.push({role:"user",content:r})}else i.push({role:"user",content:t.text});return i},[a]),l=(0,g.useCallback)(async()=>{let e=b.trim();if(!e&&d.length===0)return;let t={id:String(Date.now()),role:"user",text:e||void 0,images:d.length?d:void 0};k(i=>[...i,t]),F(""),E([]),W(!0);try{let i=M(R,{text:t.text||"",images:t.images||[]}),r=await fetch(Q,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify({model:o,messages:i,temperature:.7})});if(!r.ok)throw new Error(`OpenAI error: ${r.status}`);let S=(await r.json())?.choices?.[0]?.message?.content??"",x={id:String(Date.now()+1),role:"assistant",text:typeof S=="string"?S:String(S)};k(N=>[...N,x]),setTimeout(y,0)}catch(i){let r={id:String(Date.now()+1),role:"assistant",text:`Error: ${i?.message||"Failed to contact OpenAI"}`};k(c=>[...c,r])}finally{W(!1)}},[M,b,R,d,s,o,y]),m=(0,g.useMemo)(()=>(b.trim().length>0||d.length>0)&&!f,[b,d.length,f]);return(0,n.jsxs)("div",{className:u,style:{display:"flex",flexDirection:"column",height:"100%",...H},children:[(0,n.jsxs)("div",{style:{flex:1,overflow:"auto",padding:12,background:"#ffffff"},children:[R.map(e=>(0,n.jsx)("div",{style:{marginBottom:10,display:"flex",justifyContent:e.role==="user"?"flex-end":"flex-start"},children:(0,n.jsxs)("div",{style:{maxWidth:"80%",padding:"8px 10px",borderRadius:10,border:"1px solid rgba(0,0,0,0.06)",background:e.role==="user"?"#111827":"#f3f4f6",color:e.role==="user"?"#ffffff":"#111827",whiteSpace:"pre-wrap",wordBreak:"break-word"},children:[e.text,e.images&&e.images.length>0&&(0,n.jsx)("div",{style:{display:"flex",gap:8,marginTop:8,flexWrap:"wrap"},children:e.images.map((t,i)=>(0,n.jsx)("img",{src:t,alt:"upload",style:{width:96,height:72,objectFit:"cover",borderRadius:8,border:"1px solid rgba(0,0,0,0.06)"}},i))})]})},e.id)),(0,n.jsx)("div",{ref:L})]}),(0,n.jsxs)("div",{style:{padding:12,borderTop:"1px solid rgba(0,0,0,0.06)",background:"#fafafa"},children:[(0,n.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[(0,n.jsx)("input",{type:"file",accept:"image/*",multiple:!0,onChange:T,style:{display:"none"},id:"ai-hud-chatbot-file"}),(0,n.jsx)("label",{htmlFor:"ai-hud-chatbot-file",children:(0,n.jsx)("span",{style:{display:"inline-flex",alignItems:"center",justifyContent:"center",width:36,height:36,border:"1px solid rgba(0,0,0,0.08)",borderRadius:8,background:"white",cursor:"pointer"},children:(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,n.jsx)("path",{d:"M18.5 12.5l-5 5-3-3-5 5"}),(0,n.jsx)("path",{d:"M20 7a4 4 0 0 0-8 0v10a4 4 0 0 0 8 0Z"})]})})}),(0,n.jsx)("input",{value:b,onChange:e=>F(e.target.value),placeholder:"Type a message...",onKeyDown:e=>{e.key==="Enter"&&!e.shiftKey&&(e.preventDefault(),m&&l())},style:{flex:1,height:36,border:"1px solid rgba(0,0,0,0.15)",borderRadius:8,padding:"0 10px"}}),(0,n.jsx)("button",{type:"button",disabled:!m,onClick:()=>void l(),style:{height:36,padding:"0 12px",borderRadius:8,border:"1px solid rgba(0,0,0,0.08)",background:m?"#111827":"#e5e7eb",color:m?"#ffffff":"#9ca3af",cursor:m?"pointer":"not-allowed"},children:"Send"})]}),d.length>0&&(0,n.jsx)("div",{style:{display:"flex",gap:8,marginTop:8,flexWrap:"wrap"},children:d.map((e,t)=>(0,n.jsxs)("div",{style:{position:"relative"},children:[(0,n.jsx)("img",{src:e,alt:"selected",style:{width:64,height:48,objectFit:"cover",borderRadius:6,border:"1px solid rgba(0,0,0,0.06)"}}),(0,n.jsx)("button",{type:"button",onClick:()=>P(t),"aria-label":"Remove image",style:{position:"absolute",top:-6,right:-6,width:20,height:20,borderRadius:9999,border:"1px solid rgba(0,0,0,0.08)",background:"white",cursor:"pointer"},children:"\xD7"})]},t))})]})]})};var C=require("react/jsx-runtime"),_=I.default.forwardRef(({children:o,onClick:s,label:a="Open chat",position:p="top-right",offset:u=8,icon:H,className:R,containerStyle:k,buttonClassName:b,buttonStyle:F,buttonSize:d=36,zIndex:E=10,disabled:f=!1,trigger:W,open:L,onOpenChange:y,renderButton:T,openWindowOnClick:P=!1,windowProps:M,windowContent:l},m)=>{let[e,t]=(0,I.useState)(!1),[i,r]=(0,I.useState)(!1),c=W??"hover",S=(0,I.useMemo)(()=>{let w={position:"absolute"},v=`${u}px`;switch(p){case"top-left":return{...w,top:v,left:v};case"top-right":return{...w,top:v,right:v};case"bottom-left":return{...w,bottom:v,left:v};case"bottom-right":default:return{...w,bottom:v,right:v}}},[p,u]),x=c==="always"?!0:c==="manual"?!!L:e,N=w=>{y&&y(w)},K={onMouseEnter:c==="hover"?()=>{t(!0),N(!0)}:void 0,onMouseLeave:c==="hover"?()=>{t(!1),N(!1)}:void 0,onFocus:c==="focus"?()=>{t(!0),N(!0)}:void 0,onBlur:c==="focus"?()=>{t(!1),N(!1)}:void 0},U={type:"button","aria-label":a,onClick:w=>{s?.(w),!f&&P&&r(!0)},className:b,disabled:f,style:{...S,zIndex:E,width:d,height:d,borderRadius:9999,display:"flex",alignItems:"center",justifyContent:"center",border:"1px solid rgba(0,0,0,0.08)",background:f?"#f3f4f6":"white",color:f?"#9ca3af":void 0,boxShadow:"0 2px 6px rgba(0,0,0,0.1), 0 1px 2px rgba(0,0,0,0.06)",cursor:f?"not-allowed":"pointer",transition:"opacity 120ms ease, transform 120ms ease",opacity:x?1:0,transform:x?"scale(1)":"scale(0.95)",pointerEvents:x?"auto":"none",...F},tabIndex:x?0:-1,"aria-hidden":x?void 0:!0,ref:m,visible:x};return(0,C.jsxs)("div",{className:R,style:{position:"relative",display:"inline-block",...k},...K,children:[o,T?T(U):(0,C.jsx)("button",{...U,children:H??(0,C.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:Math.max(12,Math.floor(d*.5)),height:Math.max(12,Math.floor(d*.5)),viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,C.jsx)("path",{d:"M21 15a4 4 0 0 1-4 4H7l-4 4V7a4 4 0 0 1 4-4h10a4 4 0 0 1 4 4z"})})}),P&&i&&(0,C.jsx)(A,{...M,onClose:()=>{M?.onClose?.(),r(!1)},children:l??(0,C.jsx)(B,{})})]})});_.displayName="ChatEnabled";0&&(module.exports={ChatEnabled,DefaultChatbot,FloatingWindow});
//# sourceMappingURL=index.cjs.map
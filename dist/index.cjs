"use strict";var CF=Object.create;var go=Object.defineProperty;var EF=Object.getOwnPropertyDescriptor;var xF=Object.getOwnPropertyNames;var IF=Object.getPrototypeOf,UF=Object.prototype.hasOwnProperty;var FF=(r,e,t)=>e in r?go(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var oe=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports),hd=(r,e)=>{for(var t in e)go(r,t,{get:e[t],enumerable:!0})},aw=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let A of xF(e))!UF.call(r,A)&&A!==t&&go(r,A,{get:()=>e[A],enumerable:!(n=EF(e,A))||n.enumerable});return r};var Ur=(r,e,t)=>(t=r!=null?CF(IF(r)):{},aw(e||!r||!r.__esModule?go(t,"default",{value:r,enumerable:!0}):t,r)),QF=r=>aw(go({},"__esModule",{value:!0}),r);var rA=(r,e,t)=>FF(r,typeof e!="symbol"?e+"":e,t);var ow=oe((md,gd)=>{"use strict";(function(r,e){typeof md=="object"&&typeof gd<"u"?gd.exports=e():typeof define=="function"&&define.amd?define(e):(r=typeof globalThis<"u"?globalThis:r||self,r.html2canvas=e())})(md,(function(){"use strict";var r=function(u,o){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(l,c){l.__proto__=c}||function(l,c){for(var p in c)Object.prototype.hasOwnProperty.call(c,p)&&(l[p]=c[p])},r(u,o)};function e(u,o){if(typeof o!="function"&&o!==null)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");r(u,o);function l(){this.constructor=u}u.prototype=o===null?Object.create(o):(l.prototype=o.prototype,new l)}var t=function(){return t=Object.assign||function(o){for(var l,c=1,p=arguments.length;c<p;c++){l=arguments[c];for(var g in l)Object.prototype.hasOwnProperty.call(l,g)&&(o[g]=l[g])}return o},t.apply(this,arguments)};function n(u,o,l,c){function p(g){return g instanceof l?g:new l(function(_){_(g)})}return new(l||(l=Promise))(function(g,_){function v(x){try{E(c.next(x))}catch(U){_(U)}}function B(x){try{E(c.throw(x))}catch(U){_(U)}}function E(x){x.done?g(x.value):p(x.value).then(v,B)}E((c=c.apply(u,o||[])).next())})}function A(u,o){var l={label:0,sent:function(){if(g[0]&1)throw g[1];return g[1]},trys:[],ops:[]},c,p,g,_;return _={next:v(0),throw:v(1),return:v(2)},typeof Symbol=="function"&&(_[Symbol.iterator]=function(){return this}),_;function v(E){return function(x){return B([E,x])}}function B(E){if(c)throw new TypeError("Generator is already executing.");for(;l;)try{if(c=1,p&&(g=E[0]&2?p.return:E[0]?p.throw||((g=p.return)&&g.call(p),0):p.next)&&!(g=g.call(p,E[1])).done)return g;switch(p=0,g&&(E=[E[0]&2,g.value]),E[0]){case 0:case 1:g=E;break;case 4:return l.label++,{value:E[1],done:!1};case 5:l.label++,p=E[1],E=[0];continue;case 7:E=l.ops.pop(),l.trys.pop();continue;default:if(g=l.trys,!(g=g.length>0&&g[g.length-1])&&(E[0]===6||E[0]===2)){l=0;continue}if(E[0]===3&&(!g||E[1]>g[0]&&E[1]<g[3])){l.label=E[1];break}if(E[0]===6&&l.label<g[1]){l.label=g[1],g=E;break}if(g&&l.label<g[2]){l.label=g[2],l.ops.push(E);break}g[2]&&l.ops.pop(),l.trys.pop();continue}E=o.call(u,l)}catch(x){E=[6,x],p=0}finally{c=g=0}if(E[0]&5)throw E[1];return{value:E[0]?E[1]:void 0,done:!0}}}function s(u,o,l){if(l||arguments.length===2)for(var c=0,p=o.length,g;c<p;c++)(g||!(c in o))&&(g||(g=Array.prototype.slice.call(o,0,c)),g[c]=o[c]);return u.concat(g||o)}for(var i=(function(){function u(o,l,c,p){this.left=o,this.top=l,this.width=c,this.height=p}return u.prototype.add=function(o,l,c,p){return new u(this.left+o,this.top+l,this.width+c,this.height+p)},u.fromClientRect=function(o,l){return new u(l.left+o.windowBounds.left,l.top+o.windowBounds.top,l.width,l.height)},u.fromDOMRectList=function(o,l){var c=Array.from(l).find(function(p){return p.width!==0});return c?new u(c.left+o.windowBounds.left,c.top+o.windowBounds.top,c.width,c.height):u.EMPTY},u.EMPTY=new u(0,0,0,0),u})(),a=function(u,o){return i.fromClientRect(u,o.getBoundingClientRect())},f=function(u){var o=u.body,l=u.documentElement;if(!o||!l)throw new Error("Unable to get document size");var c=Math.max(Math.max(o.scrollWidth,l.scrollWidth),Math.max(o.offsetWidth,l.offsetWidth),Math.max(o.clientWidth,l.clientWidth)),p=Math.max(Math.max(o.scrollHeight,l.scrollHeight),Math.max(o.offsetHeight,l.offsetHeight),Math.max(o.clientHeight,l.clientHeight));return new i(0,0,c,p)},d=function(u){for(var o=[],l=0,c=u.length;l<c;){var p=u.charCodeAt(l++);if(p>=55296&&p<=56319&&l<c){var g=u.charCodeAt(l++);(g&64512)===56320?o.push(((p&1023)<<10)+(g&1023)+65536):(o.push(p),l--)}else o.push(p)}return o},h=function(){for(var u=[],o=0;o<arguments.length;o++)u[o]=arguments[o];if(String.fromCodePoint)return String.fromCodePoint.apply(String,u);var l=u.length;if(!l)return"";for(var c=[],p=-1,g="";++p<l;){var _=u[p];_<=65535?c.push(_):(_-=65536,c.push((_>>10)+55296,_%1024+56320)),(p+1===l||c.length>16384)&&(g+=String.fromCharCode.apply(String,c),c.length=0)}return g},m="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",y=typeof Uint8Array>"u"?[]:new Uint8Array(256),w=0;w<m.length;w++)y[m.charCodeAt(w)]=w;for(var b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",C=typeof Uint8Array>"u"?[]:new Uint8Array(256),I=0;I<b.length;I++)C[b.charCodeAt(I)]=I;for(var T=function(u){var o=u.length*.75,l=u.length,c,p=0,g,_,v,B;u[u.length-1]==="="&&(o--,u[u.length-2]==="="&&o--);var E=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(o):new Array(o),x=Array.isArray(E)?E:new Uint8Array(E);for(c=0;c<l;c+=4)g=C[u.charCodeAt(c)],_=C[u.charCodeAt(c+1)],v=C[u.charCodeAt(c+2)],B=C[u.charCodeAt(c+3)],x[p++]=g<<2|_>>4,x[p++]=(_&15)<<4|v>>2,x[p++]=(v&3)<<6|B&63;return E},Q=function(u){for(var o=u.length,l=[],c=0;c<o;c+=2)l.push(u[c+1]<<8|u[c]);return l},P=function(u){for(var o=u.length,l=[],c=0;c<o;c+=4)l.push(u[c+3]<<24|u[c+2]<<16|u[c+1]<<8|u[c]);return l},R=5,D=11,ee=2,Y=D-R,fe=65536>>R,ve=1<<R,Ie=ve-1,Te=1024>>R,_t=fe+Te,$e=_t,Ye=32,At=$e+Ye,Ut=65536>>D,Ft=1<<Y,Qt=Ft-1,st=function(u,o,l){return u.slice?u.slice(o,l):new Uint16Array(Array.prototype.slice.call(u,o,l))},de=function(u,o,l){return u.slice?u.slice(o,l):new Uint32Array(Array.prototype.slice.call(u,o,l))},we=function(u,o){var l=T(u),c=Array.isArray(l)?P(l):new Uint32Array(l),p=Array.isArray(l)?Q(l):new Uint16Array(l),g=24,_=st(p,g/2,c[4]/2),v=c[5]===2?st(p,(g+c[4])/2):de(c,Math.ceil((g+c[4])/4));return new ue(c[0],c[1],c[2],c[3],_,v)},ue=(function(){function u(o,l,c,p,g,_){this.initialValue=o,this.errorValue=l,this.highStart=c,this.highValueIndex=p,this.index=g,this.data=_}return u.prototype.get=function(o){var l;if(o>=0){if(o<55296||o>56319&&o<=65535)return l=this.index[o>>R],l=(l<<ee)+(o&Ie),this.data[l];if(o<=65535)return l=this.index[fe+(o-55296>>R)],l=(l<<ee)+(o&Ie),this.data[l];if(o<this.highStart)return l=At-Ut+(o>>D),l=this.index[l],l+=o>>R&Qt,l=this.index[l],l=(l<<ee)+(o&Ie),this.data[l];if(o<=1114111)return this.data[this.highValueIndex]}return this.errorValue},u})(),ye="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Ze=typeof Uint8Array>"u"?[]:new Uint8Array(256),Ge=0;Ge<ye.length;Ge++)Ze[ye.charCodeAt(Ge)]=Ge;var Tt="KwAAAAAAAAAACA4AUD0AADAgAAACAAAAAAAIABAAGABAAEgAUABYAGAAaABgAGgAYgBqAF8AZwBgAGgAcQB5AHUAfQCFAI0AlQCdAKIAqgCyALoAYABoAGAAaABgAGgAwgDKAGAAaADGAM4A0wDbAOEA6QDxAPkAAQEJAQ8BFwF1AH0AHAEkASwBNAE6AUIBQQFJAVEBWQFhAWgBcAF4ATAAgAGGAY4BlQGXAZ8BpwGvAbUBvQHFAc0B0wHbAeMB6wHxAfkBAQIJAvEBEQIZAiECKQIxAjgCQAJGAk4CVgJeAmQCbAJ0AnwCgQKJApECmQKgAqgCsAK4ArwCxAIwAMwC0wLbAjAA4wLrAvMC+AIAAwcDDwMwABcDHQMlAy0DNQN1AD0DQQNJA0kDSQNRA1EDVwNZA1kDdQB1AGEDdQBpA20DdQN1AHsDdQCBA4kDkQN1AHUAmQOhA3UAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AKYDrgN1AHUAtgO+A8YDzgPWAxcD3gPjA+sD8wN1AHUA+wMDBAkEdQANBBUEHQQlBCoEFwMyBDgEYABABBcDSARQBFgEYARoBDAAcAQzAXgEgASIBJAEdQCXBHUAnwSnBK4EtgS6BMIEyAR1AHUAdQB1AHUAdQCVANAEYABgAGAAYABgAGAAYABgANgEYADcBOQEYADsBPQE/AQEBQwFFAUcBSQFLAU0BWQEPAVEBUsFUwVbBWAAYgVgAGoFcgV6BYIFigWRBWAAmQWfBaYFYABgAGAAYABgAKoFYACxBbAFuQW6BcEFwQXHBcEFwQXPBdMF2wXjBeoF8gX6BQIGCgYSBhoGIgYqBjIGOgZgAD4GRgZMBmAAUwZaBmAAYABgAGAAYABgAGAAYABgAGAAYABgAGIGYABpBnAGYABgAGAAYABgAGAAYABgAGAAYAB4Bn8GhQZgAGAAYAB1AHcDFQSLBmAAYABgAJMGdQA9A3UAmwajBqsGqwaVALMGuwbDBjAAywbSBtIG1QbSBtIG0gbSBtIG0gbdBuMG6wbzBvsGAwcLBxMHAwcbByMHJwcsBywHMQcsB9IGOAdAB0gHTgfSBkgHVgfSBtIG0gbSBtIG0gbSBtIG0gbSBiwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdgAGAALAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdbB2MHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB2kH0gZwB64EdQB1AHUAdQB1AHUAdQB1AHUHfQdgAIUHjQd1AHUAlQedB2AAYAClB6sHYACzB7YHvgfGB3UAzgfWBzMB3gfmB1EB7gf1B/0HlQENAQUIDQh1ABUIHQglCBcDLQg1CD0IRQhNCEEDUwh1AHUAdQBbCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIcAh3CHoIMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIgggwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAALAcsBywHLAcsBywHLAcsBywHLAcsB4oILAcsB44I0gaWCJ4Ipgh1AHUAqgiyCHUAdQB1AHUAdQB1AHUAdQB1AHUAtwh8AXUAvwh1AMUIyQjRCNkI4AjoCHUAdQB1AO4I9gj+CAYJDgkTCS0HGwkjCYIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiAAIAAAAFAAYABgAGIAXwBgAHEAdQBFAJUAogCyAKAAYABgAEIA4ABGANMA4QDxAMEBDwE1AFwBLAE6AQEBUQF4QkhCmEKoQrhCgAHIQsAB0MLAAcABwAHAAeDC6ABoAHDCwMMAAcABwAHAAdDDGMMAAcAB6MM4wwjDWMNow3jDaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAEjDqABWw6bDqABpg6gAaABoAHcDvwOPA+gAaABfA/8DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DpcPAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcAB9cPKwkyCToJMAB1AHUAdQBCCUoJTQl1AFUJXAljCWcJawkwADAAMAAwAHMJdQB2CX4JdQCECYoJjgmWCXUAngkwAGAAYABxAHUApgn3A64JtAl1ALkJdQDACTAAMAAwADAAdQB1AHUAdQB1AHUAdQB1AHUAowYNBMUIMAAwADAAMADICcsJ0wnZCRUE4QkwAOkJ8An4CTAAMAB1AAAKvwh1AAgKDwoXCh8KdQAwACcKLgp1ADYKqAmICT4KRgowADAAdQB1AE4KMAB1AFYKdQBeCnUAZQowADAAMAAwADAAMAAwADAAMAAVBHUAbQowADAAdQC5CXUKMAAwAHwBxAijBogEMgF9CoQKiASMCpQKmgqIBKIKqgquCogEDQG2Cr4KxgrLCjAAMADTCtsKCgHjCusK8Qr5CgELMAAwADAAMAB1AIsECQsRC3UANAEZCzAAMAAwADAAMAB1ACELKQswAHUANAExCzkLdQBBC0kLMABRC1kLMAAwADAAMAAwADAAdQBhCzAAMAAwAGAAYABpC3ELdwt/CzAAMACHC4sLkwubC58Lpwt1AK4Ltgt1APsDMAAwADAAMAAwADAAMAAwAL4LwwvLC9IL1wvdCzAAMADlC+kL8Qv5C/8LSQswADAAMAAwADAAMAAwADAAMAAHDDAAMAAwADAAMAAODBYMHgx1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1ACYMMAAwADAAdQB1AHUALgx1AHUAdQB1AHUAdQA2DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AD4MdQBGDHUAdQB1AHUAdQB1AEkMdQB1AHUAdQB1AFAMMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQBYDHUAdQB1AF8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUA+wMVBGcMMAAwAHwBbwx1AHcMfwyHDI8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAYABgAJcMMAAwADAAdQB1AJ8MlQClDDAAMACtDCwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB7UMLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AA0EMAC9DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAsBywHLAcsBywHLAcsBywHLQcwAMEMyAwsBywHLAcsBywHLAcsBywHLAcsBywHzAwwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1ANQM2QzhDDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMABgAGAAYABgAGAAYABgAOkMYADxDGAA+AwADQYNYABhCWAAYAAODTAAMAAwADAAFg1gAGAAHg37AzAAMAAwADAAYABgACYNYAAsDTQNPA1gAEMNPg1LDWAAYABgAGAAYABgAGAAYABgAGAAUg1aDYsGVglhDV0NcQBnDW0NdQ15DWAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAlQCBDZUAiA2PDZcNMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAnw2nDTAAMAAwADAAMAAwAHUArw23DTAAMAAwADAAMAAwADAAMAAwADAAMAB1AL8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQDHDTAAYABgAM8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA1w11ANwNMAAwAD0B5A0wADAAMAAwADAAMADsDfQN/A0EDgwOFA4wABsOMAAwADAAMAAwADAAMAAwANIG0gbSBtIG0gbSBtIG0gYjDigOwQUuDsEFMw7SBjoO0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGQg5KDlIOVg7SBtIGXg5lDm0OdQ7SBtIGfQ6EDooOjQ6UDtIGmg6hDtIG0gaoDqwO0ga0DrwO0gZgAGAAYADEDmAAYAAkBtIGzA5gANIOYADaDokO0gbSBt8O5w7SBu8O0gb1DvwO0gZgAGAAxA7SBtIG0gbSBtIGYABgAGAAYAAED2AAsAUMD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHJA8sBywHLAcsBywHLAccDywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywPLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAc0D9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHPA/SBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gYUD0QPlQCVAJUAMAAwADAAMACVAJUAlQCVAJUAlQCVAEwPMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA//8EAAQABAAEAAQABAAEAAQABAANAAMAAQABAAIABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQACgATABcAHgAbABoAHgAXABYAEgAeABsAGAAPABgAHABLAEsASwBLAEsASwBLAEsASwBLABgAGAAeAB4AHgATAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABYAGwASAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWAA0AEQAeAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAFAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJABYAGgAbABsAGwAeAB0AHQAeAE8AFwAeAA0AHgAeABoAGwBPAE8ADgBQAB0AHQAdAE8ATwAXAE8ATwBPABYAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAFAATwBAAE8ATwBPAEAATwBQAFAATwBQAB4AHgAeAB4AHgAeAB0AHQAdAB0AHgAdAB4ADgBQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgBQAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAkACQAJAAkACQAJAAkABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAFAAHgAeAB4AKwArAFAAUABQAFAAGABQACsAKwArACsAHgAeAFAAHgBQAFAAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUAAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAYAA0AKwArAB4AHgAbACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAB4ABAAEAB4ABAAEABMABAArACsAKwArACsAKwArACsAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAKwArACsAKwBWAFYAVgBWAB4AHgArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AGgAaABoAGAAYAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQAEwAEACsAEwATAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABLAEsASwBLAEsASwBLAEsASwBLABoAGQAZAB4AUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABMAUAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABABQAFAABAAEAB4ABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUAAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAFAABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQAUABQAB4AHgAYABMAUAArACsABAAbABsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAFAABAAEAAQABAAEAFAABAAEAAQAUAAEAAQABAAEAAQAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArACsAHgArAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAUAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEAA0ADQBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUAArACsAKwBQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABABQACsAKwArACsAKwArACsAKwAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUAAaABoAUABQAFAAUABQAEwAHgAbAFAAHgAEACsAKwAEAAQABAArAFAAUABQAFAAUABQACsAKwArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQACsAUABQACsAKwAEACsABAAEAAQABAAEACsAKwArACsABAAEACsAKwAEAAQABAArACsAKwAEACsAKwArACsAKwArACsAUABQAFAAUAArAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLAAQABABQAFAAUAAEAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAArACsAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AGwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAKwArACsAKwArAAQABAAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAAQAUAArAFAAUABQAFAAUABQACsAKwArAFAAUABQACsAUABQAFAAUAArACsAKwBQAFAAKwBQACsAUABQACsAKwArAFAAUAArACsAKwBQAFAAUAArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArAAQABAAEAAQABAArACsAKwAEAAQABAArAAQABAAEAAQAKwArAFAAKwArACsAKwArACsABAArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAHgAeAB4AHgAeAB4AGwAeACsAKwArACsAKwAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAUABQAFAAKwArACsAKwArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwAOAFAAUABQAFAAUABQAFAAHgBQAAQABAAEAA4AUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAKwArAAQAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAKwArACsAKwArACsAUAArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAFAABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQABABQAB4AKwArACsAKwBQAFAAUAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQABoAUABQAFAAUABQAFAAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQACsAUAArACsAUABQAFAAUABQAFAAUAArACsAKwAEACsAKwArACsABAAEAAQABAAEAAQAKwAEACsABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArAAQABAAeACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAXAAqACoAKgAqACoAKgAqACsAKwArACsAGwBcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAeAEsASwBLAEsASwBLAEsASwBLAEsADQANACsAKwArACsAKwBcAFwAKwBcACsAXABcAFwAXABcACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAXAArAFwAXABcAFwAXABcAFwAXABcAFwAKgBcAFwAKgAqACoAKgAqACoAKgAqACoAXAArACsAXABcAFwAXABcACsAXAArACoAKgAqACoAKgAqACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwBcAFwAXABcAFAADgAOAA4ADgAeAA4ADgAJAA4ADgANAAkAEwATABMAEwATAAkAHgATAB4AHgAeAAQABAAeAB4AHgAeAB4AHgBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQAFAADQAEAB4ABAAeAAQAFgARABYAEQAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAAQABAAEAAQADQAEAAQAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAA0ADQAeAB4AHgAeAB4AHgAEAB4AHgAeAB4AHgAeACsAHgAeAA4ADgANAA4AHgAeAB4AHgAeAAkACQArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgBcAEsASwBLAEsASwBLAEsASwBLAEsADQANAB4AHgAeAB4AXABcAFwAXABcAFwAKgAqACoAKgBcAFwAXABcACoAKgAqAFwAKgAqACoAXABcACoAKgAqACoAKgAqACoAXABcAFwAKgAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqAFwAKgBLAEsASwBLAEsASwBLAEsASwBLACoAKgAqACoAKgAqAFAAUABQAFAAUABQACsAUAArACsAKwArACsAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAKwBQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsABAAEAAQAHgANAB4AHgAeAB4AHgAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUAArACsADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWABEAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQANAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAANAA0AKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUAArAAQABAArACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqAA0ADQAVAFwADQAeAA0AGwBcACoAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwAeAB4AEwATAA0ADQAOAB4AEwATAB4ABAAEAAQACQArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAHgArACsAKwATABMASwBLAEsASwBLAEsASwBLAEsASwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAXABcAFwAXABcACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAXAArACsAKwAqACoAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsAHgAeAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKwAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKwArAAQASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACoAKgAqACoAKgAqACoAXAAqACoAKgAqACoAKgArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABABQAFAAUABQAFAAUABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwANAA0AHgANAA0ADQANAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwAeAB4AHgAeAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArAA0ADQANAA0ADQBLAEsASwBLAEsASwBLAEsASwBLACsAKwArAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUAAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAAQAUABQAFAAUABQAFAABABQAFAABAAEAAQAUAArACsAKwArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQACsAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAFAAUABQACsAHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQACsAKwAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQACsAHgAeAB4AHgAeAB4AHgAOAB4AKwANAA0ADQANAA0ADQANAAkADQANAA0ACAAEAAsABAAEAA0ACQANAA0ADAAdAB0AHgAXABcAFgAXABcAFwAWABcAHQAdAB4AHgAUABQAFAANAAEAAQAEAAQABAAEAAQACQAaABoAGgAaABoAGgAaABoAHgAXABcAHQAVABUAHgAeAB4AHgAeAB4AGAAWABEAFQAVABUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ADQAeAA0ADQANAA0AHgANAA0ADQAHAB4AHgAeAB4AKwAEAAQABAAEAAQABAAEAAQABAAEAFAAUAArACsATwBQAFAAUABQAFAAHgAeAB4AFgARAE8AUABPAE8ATwBPAFAAUABQAFAAUAAeAB4AHgAWABEAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArABsAGwAbABsAGwAbABsAGgAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGgAbABsAGwAbABoAGwAbABoAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAHgAeAFAAGgAeAB0AHgBQAB4AGgAeAB4AHgAeAB4AHgAeAB4AHgBPAB4AUAAbAB4AHgBQAFAAUABQAFAAHgAeAB4AHQAdAB4AUAAeAFAAHgBQAB4AUABPAFAAUAAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgBQAFAAUABQAE8ATwBQAFAAUABQAFAATwBQAFAATwBQAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAUABQAFAATwBPAE8ATwBPAE8ATwBPAE8ATwBQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABPAB4AHgArACsAKwArAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHQAdAB4AHgAeAB0AHQAeAB4AHQAeAB4AHgAdAB4AHQAbABsAHgAdAB4AHgAeAB4AHQAeAB4AHQAdAB0AHQAeAB4AHQAeAB0AHgAdAB0AHQAdAB0AHQAeAB0AHgAeAB4AHgAeAB0AHQAdAB0AHgAeAB4AHgAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHgAeAB0AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAeAB0AHQAdAB0AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAdAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAWABEAHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAWABEAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AHQAdAB0AHgAeAB0AHgAeAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlAB4AHQAdAB4AHgAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AJQAlAB0AHQAlAB4AJQAlACUAIAAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAdAB0AHQAeAB0AJQAdAB0AHgAdAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAdAB0AHQAdACUAHgAlACUAJQAdACUAJQAdAB0AHQAlACUAHQAdACUAHQAdACUAJQAlAB4AHQAeAB4AHgAeAB0AHQAlAB0AHQAdAB0AHQAdACUAJQAlACUAJQAdACUAJQAgACUAHQAdACUAJQAlACUAJQAlACUAJQAeAB4AHgAlACUAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AFwAXABcAFwAXABcAHgATABMAJQAeAB4AHgAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARABYAEQAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAEAAQABAAeAB4AKwArACsAKwArABMADQANAA0AUAATAA0AUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUAANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAA0ADQANAA0ADQANAA0ADQAeAA0AFgANAB4AHgAXABcAHgAeABcAFwAWABEAFgARABYAEQAWABEADQANAA0ADQATAFAADQANAB4ADQANAB4AHgAeAB4AHgAMAAwADQANAA0AHgANAA0AFgANAA0ADQANAA0ADQANAA0AHgANAB4ADQANAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArAA0AEQARACUAJQBHAFcAVwAWABEAFgARABYAEQAWABEAFgARACUAJQAWABEAFgARABYAEQAWABEAFQAWABEAEQAlAFcAVwBXAFcAVwBXAFcAVwBXAAQABAAEAAQABAAEACUAVwBXAFcAVwA2ACUAJQBXAFcAVwBHAEcAJQAlACUAKwBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBRAFcAUQBXAFEAVwBXAFcAVwBXAFcAUQBXAFcAVwBXAFcAVwBRAFEAKwArAAQABAAVABUARwBHAFcAFQBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBRAFcAVwBXAFcAVwBXAFEAUQBXAFcAVwBXABUAUQBHAEcAVwArACsAKwArACsAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwAlACUAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACsAKwArACsAKwArACsAKwArACsAKwArAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBPAE8ATwBPAE8ATwBPAE8AJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADQATAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABLAEsASwBLAEsASwBLAEsASwBLAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAABAAEAAQABAAeAAQABAAEAAQABAAEAAQABAAEAAQAHgBQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAeAA0ADQANAA0ADQArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAAQAUABQAFAABABQAFAAUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAeAB4AHgAeAAQAKwArACsAUABQAFAAUABQAFAAHgAeABoAHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADgAOABMAEwArACsAKwArACsAKwArACsABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwANAA0ASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUAAeAB4AHgBQAA4AUABQAAQAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArAB4AWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYACsAKwArAAQAHgAeAB4AHgAeAB4ADQANAA0AHgAeAB4AHgArAFAASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArAB4AHgBcAFwAXABcAFwAKgBcAFwAXABcAFwAXABcAFwAXABcAEsASwBLAEsASwBLAEsASwBLAEsAXABcAFwAXABcACsAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAFAAUABQAAQAUABQAFAAUABQAFAAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAHgANAA0ADQBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAXAAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAKgAqACoAXABcACoAKgBcAFwAXABcAFwAKgAqAFwAKgBcACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcACoAKgBQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAA0ADQBQAFAAUAAEAAQAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQADQAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAVABVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBUAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVACsAKwArACsAKwArACsAKwArACsAKwArAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAKwArACsAKwBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAKwArACsAKwAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAKwArACsAKwArAFYABABWAFYAVgBWAFYAVgBWAFYAVgBWAB4AVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgArAFYAVgBWAFYAVgArAFYAKwBWAFYAKwBWAFYAKwBWAFYAVgBWAFYAVgBWAFYAVgBWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAEQAWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAaAB4AKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAGAARABEAGAAYABMAEwAWABEAFAArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACUAJQAlACUAJQAWABEAFgARABYAEQAWABEAFgARABYAEQAlACUAFgARACUAJQAlACUAJQAlACUAEQAlABEAKwAVABUAEwATACUAFgARABYAEQAWABEAJQAlACUAJQAlACUAJQAlACsAJQAbABoAJQArACsAKwArAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAcAKwATACUAJQAbABoAJQAlABYAEQAlACUAEQAlABEAJQBXAFcAVwBXAFcAVwBXAFcAVwBXABUAFQAlACUAJQATACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXABYAJQARACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAWACUAEQAlABYAEQARABYAEQARABUAVwBRAFEAUQBRAFEAUQBRAFEAUQBRAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcARwArACsAVwBXAFcAVwBXAFcAKwArAFcAVwBXAFcAVwBXACsAKwBXAFcAVwBXAFcAVwArACsAVwBXAFcAKwArACsAGgAbACUAJQAlABsAGwArAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAAQAB0AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsADQANAA0AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAA0AUABQAFAAUAArACsAKwArAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwArAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwBQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAUABQAFAAUABQAAQABAAEACsABAAEACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAKwBQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAA0ADQANAA0ADQANAA0ADQAeACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAArACsAKwArAFAAUABQAFAAUAANAA0ADQANAA0ADQAUACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsADQANAA0ADQANAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArAAQABAANACsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAB4AHgAeAB4AHgArACsAKwArACsAKwAEAAQABAAEAAQABAAEAA0ADQAeAB4AHgAeAB4AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsASwBLAEsASwBLAEsASwBLAEsASwANAA0ADQANAFAABAAEAFAAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAeAA4AUAArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAADQANAB4ADQAEAAQABAAEAB4ABAAEAEsASwBLAEsASwBLAEsASwBLAEsAUAAOAFAADQANAA0AKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAANAA0AHgANAA0AHgAEACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAA0AKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsABAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsABAAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAUAArACsAKwArACsAKwAEACsAKwArACsAKwBQAFAAUABQAFAABAAEACsAKwAEAAQABAAEAAQABAAEACsAKwArAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAQABABQAFAAUABQAA0ADQANAA0AHgBLAEsASwBLAEsASwBLAEsASwBLAA0ADQArAB4ABABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUAAeAFAAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABAAEAAQADgANAA0AEwATAB4AHgAeAA0ADQANAA0ADQANAA0ADQANAA0ADQANAA0ADQANAFAAUABQAFAABAAEACsAKwAEAA0ADQAeAFAAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKwArACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBcAFwADQANAA0AKgBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAKwArAFAAKwArAFAAUABQAFAAUABQAFAAUAArAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQAKwAEAAQAKwArAAQABAAEAAQAUAAEAFAABAAEAA0ADQANACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABABQAA4AUAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAFAABAAEAAQABAAOAB4ADQANAA0ADQAOAB4ABAArACsAKwArACsAKwArACsAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAA0ADQANAFAADgAOAA4ADQANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAAQABAAEAFAADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAOABMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAArACsAKwAEACsABAAEACsABAAEAAQABAAEAAQABABQAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAaABoAGgAaAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABIAEgAQwBDAEMAUABQAFAAUABDAFAAUABQAEgAQwBIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABDAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAJAAkACQAJAAkACQAJABYAEQArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwANAA0AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAANACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAA0ADQANAB4AHgAeAB4AHgAeAFAAUABQAFAADQAeACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAA0AHgAeACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAARwBHABUARwAJACsAKwArACsAKwArACsAKwArACsAKwAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUQBRAFEAKwArACsAKwArACsAKwArACsAKwArACsAKwBRAFEAUQBRACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAHgAEAAQADQAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQABAAEAAQABAAeAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQAHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAKwArAFAAKwArAFAAUAArACsAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUAArAFAAUABQAFAAUABQAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAHgAeAFAAUABQAFAAUAArAFAAKwArACsAUABQAFAAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeACsAKwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4ABAAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAHgAeAA0ADQANAA0AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArAAQABAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwBQAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArABsAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAB4AHgAeAB4ABAAEAAQABAAEAAQABABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArABYAFgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAGgBQAFAAUAAaAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUAArACsAKwArACsAKwBQACsAKwArACsAUAArAFAAKwBQACsAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUAArAFAAKwBQACsAUAArAFAAUAArAFAAKwArAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAKwBQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8AJQAlACUAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB4AHgAeACUAJQAlAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAlACUAJQAlACUAHgAlACUAJQAlACUAIAAgACAAJQAlACAAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACEAIQAhACEAIQAlACUAIAAgACUAJQAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAIAAlACUAJQAlACAAIAAgACUAIAAgACAAJQAlACUAJQAlACUAJQAgACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAlAB4AJQAeACUAJQAlACUAJQAgACUAJQAlACUAHgAlAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACAAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABcAFwAXABUAFQAVAB4AHgAeAB4AJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAgACUAJQAgACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAIAAgACUAJQAgACAAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACAAIAAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACAAIAAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAA==",Zn=50,Jn=1,Bi=2,at=3,er=4,xr=5,tr=7,Hr=8,fr=9,Kt=10,rr=11,Dr=12,qa=13,J=14,_n=15,he=16,ae=17,me=18,te=19,M=20,_e=21,pe=22,Ot=23,Wn=24,zt=25,Xa=26,Ya=27,vi=28,CC=29,ds=30,EC=31,Iu=32,Uu=33,Uf=34,Ff=35,Qf=36,eo=37,Tf=38,Fu=39,Qu=40,Of=41,wm=42,xC=43,IC=[9001,65288],ym="!",Le="\xD7",Tu="\xF7",Sf=we(Tt),qn=[ds,Qf],Pf=[Jn,Bi,at,xr],_m=[Kt,Hr],bm=[Ya,Xa],UC=Pf.concat(_m),Bm=[Tf,Fu,Qu,Uf,Ff],FC=[_n,qa],QC=function(u,o){o===void 0&&(o="strict");var l=[],c=[],p=[];return u.forEach(function(g,_){var v=Sf.get(g);if(v>Zn?(p.push(!0),v-=Zn):p.push(!1),["normal","auto","loose"].indexOf(o)!==-1&&[8208,8211,12316,12448].indexOf(g)!==-1)return c.push(_),l.push(he);if(v===er||v===rr){if(_===0)return c.push(_),l.push(ds);var B=l[_-1];return UC.indexOf(B)===-1?(c.push(c[_-1]),l.push(B)):(c.push(_),l.push(ds))}if(c.push(_),v===EC)return l.push(o==="strict"?_e:eo);if(v===wm||v===CC)return l.push(ds);if(v===xC)return g>=131072&&g<=196605||g>=196608&&g<=262141?l.push(eo):l.push(ds);l.push(v)}),[c,l,p]},Rf=function(u,o,l,c){var p=c[l];if(Array.isArray(u)?u.indexOf(p)!==-1:u===p)for(var g=l;g<=c.length;){g++;var _=c[g];if(_===o)return!0;if(_!==Kt)break}if(p===Kt)for(var g=l;g>0;){g--;var v=c[g];if(Array.isArray(u)?u.indexOf(v)!==-1:u===v)for(var B=l;B<=c.length;){B++;var _=c[B];if(_===o)return!0;if(_!==Kt)break}if(v!==Kt)break}return!1},vm=function(u,o){for(var l=u;l>=0;){var c=o[l];if(c===Kt)l--;else return c}return 0},TC=function(u,o,l,c,p){if(l[c]===0)return Le;var g=c-1;if(Array.isArray(p)&&p[g]===!0)return Le;var _=g-1,v=g+1,B=o[g],E=_>=0?o[_]:0,x=o[v];if(B===Bi&&x===at)return Le;if(Pf.indexOf(B)!==-1)return ym;if(Pf.indexOf(x)!==-1||_m.indexOf(x)!==-1)return Le;if(vm(g,o)===Hr)return Tu;if(Sf.get(u[g])===rr||(B===Iu||B===Uu)&&Sf.get(u[v])===rr||B===tr||x===tr||B===fr||[Kt,qa,_n].indexOf(B)===-1&&x===fr||[ae,me,te,Wn,vi].indexOf(x)!==-1||vm(g,o)===pe||Rf(Ot,pe,g,o)||Rf([ae,me],_e,g,o)||Rf(Dr,Dr,g,o))return Le;if(B===Kt)return Tu;if(B===Ot||x===Ot)return Le;if(x===he||B===he)return Tu;if([qa,_n,_e].indexOf(x)!==-1||B===J||E===Qf&&FC.indexOf(B)!==-1||B===vi&&x===Qf||x===M||qn.indexOf(x)!==-1&&B===zt||qn.indexOf(B)!==-1&&x===zt||B===Ya&&[eo,Iu,Uu].indexOf(x)!==-1||[eo,Iu,Uu].indexOf(B)!==-1&&x===Xa||qn.indexOf(B)!==-1&&bm.indexOf(x)!==-1||bm.indexOf(B)!==-1&&qn.indexOf(x)!==-1||[Ya,Xa].indexOf(B)!==-1&&(x===zt||[pe,_n].indexOf(x)!==-1&&o[v+1]===zt)||[pe,_n].indexOf(B)!==-1&&x===zt||B===zt&&[zt,vi,Wn].indexOf(x)!==-1)return Le;if([zt,vi,Wn,ae,me].indexOf(x)!==-1)for(var U=g;U>=0;){var S=o[U];if(S===zt)return Le;if([vi,Wn].indexOf(S)!==-1)U--;else break}if([Ya,Xa].indexOf(x)!==-1)for(var U=[ae,me].indexOf(B)!==-1?_:g;U>=0;){var S=o[U];if(S===zt)return Le;if([vi,Wn].indexOf(S)!==-1)U--;else break}if(Tf===B&&[Tf,Fu,Uf,Ff].indexOf(x)!==-1||[Fu,Uf].indexOf(B)!==-1&&[Fu,Qu].indexOf(x)!==-1||[Qu,Ff].indexOf(B)!==-1&&x===Qu||Bm.indexOf(B)!==-1&&[M,Xa].indexOf(x)!==-1||Bm.indexOf(x)!==-1&&B===Ya||qn.indexOf(B)!==-1&&qn.indexOf(x)!==-1||B===Wn&&qn.indexOf(x)!==-1||qn.concat(zt).indexOf(B)!==-1&&x===pe&&IC.indexOf(u[v])===-1||qn.concat(zt).indexOf(x)!==-1&&B===me)return Le;if(B===Of&&x===Of){for(var Z=l[g],H=1;Z>0&&(Z--,o[Z]===Of);)H++;if(H%2!==0)return Le}return B===Iu&&x===Uu?Le:Tu},OC=function(u,o){o||(o={lineBreak:"normal",wordBreak:"normal"});var l=QC(u,o.lineBreak),c=l[0],p=l[1],g=l[2];(o.wordBreak==="break-all"||o.wordBreak==="break-word")&&(p=p.map(function(v){return[zt,ds,wm].indexOf(v)!==-1?eo:v}));var _=o.wordBreak==="keep-all"?g.map(function(v,B){return v&&u[B]>=19968&&u[B]<=40959}):void 0;return[c,p,_]},SC=(function(){function u(o,l,c,p){this.codePoints=o,this.required=l===ym,this.start=c,this.end=p}return u.prototype.slice=function(){return h.apply(void 0,this.codePoints.slice(this.start,this.end))},u})(),PC=function(u,o){var l=d(u),c=OC(l,o),p=c[0],g=c[1],_=c[2],v=l.length,B=0,E=0;return{next:function(){if(E>=v)return{done:!0,value:null};for(var x=Le;E<v&&(x=TC(l,g,p,++E,_))===Le;);if(x!==Le||E===v){var U=new SC(l,x,B,E);return B=E,{value:U,done:!1}}return{done:!0,value:null}}}},RC=1,kC=2,to=4,Cm=8,Ou=10,Em=47,ro=92,NC=9,LC=32,Su=34,no=61,HC=35,DC=36,MC=37,Pu=39,Ru=40,Ao=41,$C=95,dr=45,jC=33,KC=60,zC=62,GC=64,VC=91,ZC=93,JC=61,WC=123,ku=63,qC=125,xm=124,XC=126,YC=128,Im=65533,kf=42,ps=43,eE=44,tE=58,rE=59,so=46,nE=0,AE=8,sE=11,iE=14,aE=31,oE=127,bn=-1,Um=48,Fm=97,Qm=101,uE=102,cE=117,lE=122,Tm=65,Om=69,Sm=70,fE=85,dE=90,Gt=function(u){return u>=Um&&u<=57},pE=function(u){return u>=55296&&u<=57343},Ci=function(u){return Gt(u)||u>=Tm&&u<=Sm||u>=Fm&&u<=uE},hE=function(u){return u>=Fm&&u<=lE},mE=function(u){return u>=Tm&&u<=dE},gE=function(u){return hE(u)||mE(u)},wE=function(u){return u>=YC},Nu=function(u){return u===Ou||u===NC||u===LC},Lu=function(u){return gE(u)||wE(u)||u===$C},Pm=function(u){return Lu(u)||Gt(u)||u===dr},yE=function(u){return u>=nE&&u<=AE||u===sE||u>=iE&&u<=aE||u===oE},EA=function(u,o){return u!==ro?!1:o!==Ou},Hu=function(u,o,l){return u===dr?Lu(o)||EA(o,l):Lu(u)?!0:!!(u===ro&&EA(u,o))},Nf=function(u,o,l){return u===ps||u===dr?Gt(o)?!0:o===so&&Gt(l):Gt(u===so?o:u)},_E=function(u){var o=0,l=1;(u[o]===ps||u[o]===dr)&&(u[o]===dr&&(l=-1),o++);for(var c=[];Gt(u[o]);)c.push(u[o++]);var p=c.length?parseInt(h.apply(void 0,c),10):0;u[o]===so&&o++;for(var g=[];Gt(u[o]);)g.push(u[o++]);var _=g.length,v=_?parseInt(h.apply(void 0,g),10):0;(u[o]===Om||u[o]===Qm)&&o++;var B=1;(u[o]===ps||u[o]===dr)&&(u[o]===dr&&(B=-1),o++);for(var E=[];Gt(u[o]);)E.push(u[o++]);var x=E.length?parseInt(h.apply(void 0,E),10):0;return l*(p+v*Math.pow(10,-_))*Math.pow(10,B*x)},bE={type:2},BE={type:3},vE={type:4},CE={type:13},EE={type:8},xE={type:21},IE={type:9},UE={type:10},FE={type:11},QE={type:12},TE={type:14},Du={type:23},OE={type:1},SE={type:25},PE={type:24},RE={type:26},kE={type:27},NE={type:28},LE={type:29},HE={type:31},Lf={type:32},Rm=(function(){function u(){this._value=[]}return u.prototype.write=function(o){this._value=this._value.concat(d(o))},u.prototype.read=function(){for(var o=[],l=this.consumeToken();l!==Lf;)o.push(l),l=this.consumeToken();return o},u.prototype.consumeToken=function(){var o=this.consumeCodePoint();switch(o){case Su:return this.consumeStringToken(Su);case HC:var l=this.peekCodePoint(0),c=this.peekCodePoint(1),p=this.peekCodePoint(2);if(Pm(l)||EA(c,p)){var g=Hu(l,c,p)?kC:RC,_=this.consumeName();return{type:5,value:_,flags:g}}break;case DC:if(this.peekCodePoint(0)===no)return this.consumeCodePoint(),CE;break;case Pu:return this.consumeStringToken(Pu);case Ru:return bE;case Ao:return BE;case kf:if(this.peekCodePoint(0)===no)return this.consumeCodePoint(),TE;break;case ps:if(Nf(o,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(o),this.consumeNumericToken();break;case eE:return vE;case dr:var v=o,B=this.peekCodePoint(0),E=this.peekCodePoint(1);if(Nf(v,B,E))return this.reconsumeCodePoint(o),this.consumeNumericToken();if(Hu(v,B,E))return this.reconsumeCodePoint(o),this.consumeIdentLikeToken();if(B===dr&&E===zC)return this.consumeCodePoint(),this.consumeCodePoint(),PE;break;case so:if(Nf(o,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(o),this.consumeNumericToken();break;case Em:if(this.peekCodePoint(0)===kf)for(this.consumeCodePoint();;){var x=this.consumeCodePoint();if(x===kf&&(x=this.consumeCodePoint(),x===Em))return this.consumeToken();if(x===bn)return this.consumeToken()}break;case tE:return RE;case rE:return kE;case KC:if(this.peekCodePoint(0)===jC&&this.peekCodePoint(1)===dr&&this.peekCodePoint(2)===dr)return this.consumeCodePoint(),this.consumeCodePoint(),SE;break;case GC:var U=this.peekCodePoint(0),S=this.peekCodePoint(1),Z=this.peekCodePoint(2);if(Hu(U,S,Z)){var _=this.consumeName();return{type:7,value:_}}break;case VC:return NE;case ro:if(EA(o,this.peekCodePoint(0)))return this.reconsumeCodePoint(o),this.consumeIdentLikeToken();break;case ZC:return LE;case JC:if(this.peekCodePoint(0)===no)return this.consumeCodePoint(),EE;break;case WC:return FE;case qC:return QE;case cE:case fE:var H=this.peekCodePoint(0),j=this.peekCodePoint(1);return H===ps&&(Ci(j)||j===ku)&&(this.consumeCodePoint(),this.consumeUnicodeRangeToken()),this.reconsumeCodePoint(o),this.consumeIdentLikeToken();case xm:if(this.peekCodePoint(0)===no)return this.consumeCodePoint(),IE;if(this.peekCodePoint(0)===xm)return this.consumeCodePoint(),xE;break;case XC:if(this.peekCodePoint(0)===no)return this.consumeCodePoint(),UE;break;case bn:return Lf}return Nu(o)?(this.consumeWhiteSpace(),HE):Gt(o)?(this.reconsumeCodePoint(o),this.consumeNumericToken()):Lu(o)?(this.reconsumeCodePoint(o),this.consumeIdentLikeToken()):{type:6,value:h(o)}},u.prototype.consumeCodePoint=function(){var o=this._value.shift();return typeof o>"u"?-1:o},u.prototype.reconsumeCodePoint=function(o){this._value.unshift(o)},u.prototype.peekCodePoint=function(o){return o>=this._value.length?-1:this._value[o]},u.prototype.consumeUnicodeRangeToken=function(){for(var o=[],l=this.consumeCodePoint();Ci(l)&&o.length<6;)o.push(l),l=this.consumeCodePoint();for(var c=!1;l===ku&&o.length<6;)o.push(l),l=this.consumeCodePoint(),c=!0;if(c){var p=parseInt(h.apply(void 0,o.map(function(B){return B===ku?Um:B})),16),g=parseInt(h.apply(void 0,o.map(function(B){return B===ku?Sm:B})),16);return{type:30,start:p,end:g}}var _=parseInt(h.apply(void 0,o),16);if(this.peekCodePoint(0)===dr&&Ci(this.peekCodePoint(1))){this.consumeCodePoint(),l=this.consumeCodePoint();for(var v=[];Ci(l)&&v.length<6;)v.push(l),l=this.consumeCodePoint();var g=parseInt(h.apply(void 0,v),16);return{type:30,start:_,end:g}}else return{type:30,start:_,end:_}},u.prototype.consumeIdentLikeToken=function(){var o=this.consumeName();return o.toLowerCase()==="url"&&this.peekCodePoint(0)===Ru?(this.consumeCodePoint(),this.consumeUrlToken()):this.peekCodePoint(0)===Ru?(this.consumeCodePoint(),{type:19,value:o}):{type:20,value:o}},u.prototype.consumeUrlToken=function(){var o=[];if(this.consumeWhiteSpace(),this.peekCodePoint(0)===bn)return{type:22,value:""};var l=this.peekCodePoint(0);if(l===Pu||l===Su){var c=this.consumeStringToken(this.consumeCodePoint());return c.type===0&&(this.consumeWhiteSpace(),this.peekCodePoint(0)===bn||this.peekCodePoint(0)===Ao)?(this.consumeCodePoint(),{type:22,value:c.value}):(this.consumeBadUrlRemnants(),Du)}for(;;){var p=this.consumeCodePoint();if(p===bn||p===Ao)return{type:22,value:h.apply(void 0,o)};if(Nu(p))return this.consumeWhiteSpace(),this.peekCodePoint(0)===bn||this.peekCodePoint(0)===Ao?(this.consumeCodePoint(),{type:22,value:h.apply(void 0,o)}):(this.consumeBadUrlRemnants(),Du);if(p===Su||p===Pu||p===Ru||yE(p))return this.consumeBadUrlRemnants(),Du;if(p===ro)if(EA(p,this.peekCodePoint(0)))o.push(this.consumeEscapedCodePoint());else return this.consumeBadUrlRemnants(),Du;else o.push(p)}},u.prototype.consumeWhiteSpace=function(){for(;Nu(this.peekCodePoint(0));)this.consumeCodePoint()},u.prototype.consumeBadUrlRemnants=function(){for(;;){var o=this.consumeCodePoint();if(o===Ao||o===bn)return;EA(o,this.peekCodePoint(0))&&this.consumeEscapedCodePoint()}},u.prototype.consumeStringSlice=function(o){for(var l=5e4,c="";o>0;){var p=Math.min(l,o);c+=h.apply(void 0,this._value.splice(0,p)),o-=p}return this._value.shift(),c},u.prototype.consumeStringToken=function(o){var l="",c=0;do{var p=this._value[c];if(p===bn||p===void 0||p===o)return l+=this.consumeStringSlice(c),{type:0,value:l};if(p===Ou)return this._value.splice(0,c),OE;if(p===ro){var g=this._value[c+1];g!==bn&&g!==void 0&&(g===Ou?(l+=this.consumeStringSlice(c),c=-1,this._value.shift()):EA(p,g)&&(l+=this.consumeStringSlice(c),l+=h(this.consumeEscapedCodePoint()),c=-1))}c++}while(!0)},u.prototype.consumeNumber=function(){var o=[],l=to,c=this.peekCodePoint(0);for((c===ps||c===dr)&&o.push(this.consumeCodePoint());Gt(this.peekCodePoint(0));)o.push(this.consumeCodePoint());c=this.peekCodePoint(0);var p=this.peekCodePoint(1);if(c===so&&Gt(p))for(o.push(this.consumeCodePoint(),this.consumeCodePoint()),l=Cm;Gt(this.peekCodePoint(0));)o.push(this.consumeCodePoint());c=this.peekCodePoint(0),p=this.peekCodePoint(1);var g=this.peekCodePoint(2);if((c===Om||c===Qm)&&((p===ps||p===dr)&&Gt(g)||Gt(p)))for(o.push(this.consumeCodePoint(),this.consumeCodePoint()),l=Cm;Gt(this.peekCodePoint(0));)o.push(this.consumeCodePoint());return[_E(o),l]},u.prototype.consumeNumericToken=function(){var o=this.consumeNumber(),l=o[0],c=o[1],p=this.peekCodePoint(0),g=this.peekCodePoint(1),_=this.peekCodePoint(2);if(Hu(p,g,_)){var v=this.consumeName();return{type:15,number:l,flags:c,unit:v}}return p===MC?(this.consumeCodePoint(),{type:16,number:l,flags:c}):{type:17,number:l,flags:c}},u.prototype.consumeEscapedCodePoint=function(){var o=this.consumeCodePoint();if(Ci(o)){for(var l=h(o);Ci(this.peekCodePoint(0))&&l.length<6;)l+=h(this.consumeCodePoint());Nu(this.peekCodePoint(0))&&this.consumeCodePoint();var c=parseInt(l,16);return c===0||pE(c)||c>1114111?Im:c}return o===bn?Im:o},u.prototype.consumeName=function(){for(var o="";;){var l=this.consumeCodePoint();if(Pm(l))o+=h(l);else if(EA(l,this.peekCodePoint(0)))o+=h(this.consumeEscapedCodePoint());else return this.reconsumeCodePoint(l),o}},u})(),km=(function(){function u(o){this._tokens=o}return u.create=function(o){var l=new Rm;return l.write(o),new u(l.read())},u.parseValue=function(o){return u.create(o).parseComponentValue()},u.parseValues=function(o){return u.create(o).parseComponentValues()},u.prototype.parseComponentValue=function(){for(var o=this.consumeToken();o.type===31;)o=this.consumeToken();if(o.type===32)throw new SyntaxError("Error parsing CSS component value, unexpected EOF");this.reconsumeToken(o);var l=this.consumeComponentValue();do o=this.consumeToken();while(o.type===31);if(o.type===32)return l;throw new SyntaxError("Error parsing CSS component value, multiple values found when expecting only one")},u.prototype.parseComponentValues=function(){for(var o=[];;){var l=this.consumeComponentValue();if(l.type===32)return o;o.push(l),o.push()}},u.prototype.consumeComponentValue=function(){var o=this.consumeToken();switch(o.type){case 11:case 28:case 2:return this.consumeSimpleBlock(o.type);case 19:return this.consumeFunction(o)}return o},u.prototype.consumeSimpleBlock=function(o){for(var l={type:o,values:[]},c=this.consumeToken();;){if(c.type===32||ME(c,o))return l;this.reconsumeToken(c),l.values.push(this.consumeComponentValue()),c=this.consumeToken()}},u.prototype.consumeFunction=function(o){for(var l={name:o.value,values:[],type:18};;){var c=this.consumeToken();if(c.type===32||c.type===3)return l;this.reconsumeToken(c),l.values.push(this.consumeComponentValue())}},u.prototype.consumeToken=function(){var o=this._tokens.shift();return typeof o>"u"?Lf:o},u.prototype.reconsumeToken=function(o){this._tokens.unshift(o)},u})(),io=function(u){return u.type===15},Ei=function(u){return u.type===17},Je=function(u){return u.type===20},DE=function(u){return u.type===0},Hf=function(u,o){return Je(u)&&u.value===o},Nm=function(u){return u.type!==31},xi=function(u){return u.type!==31&&u.type!==4},Bn=function(u){var o=[],l=[];return u.forEach(function(c){if(c.type===4){if(l.length===0)throw new Error("Error parsing function args, zero tokens for arg");o.push(l),l=[];return}c.type!==31&&l.push(c)}),l.length&&o.push(l),o},ME=function(u,o){return o===11&&u.type===12||o===28&&u.type===29?!0:o===2&&u.type===3},xA=function(u){return u.type===17||u.type===15},gt=function(u){return u.type===16||xA(u)},Lm=function(u){return u.length>1?[u[0],u[1]]:[u[0]]},Nt={type:17,number:0,flags:to},Df={type:16,number:50,flags:to},IA={type:16,number:100,flags:to},ao=function(u,o,l){var c=u[0],p=u[1];return[Xe(c,o),Xe(typeof p<"u"?p:c,l)]},Xe=function(u,o){if(u.type===16)return u.number/100*o;if(io(u))switch(u.unit){case"rem":case"em":return 16*u.number;case"px":default:return u.number}return u.number},Hm="deg",Dm="grad",Mm="rad",$m="turn",Mu={name:"angle",parse:function(u,o){if(o.type===15)switch(o.unit){case Hm:return Math.PI*o.number/180;case Dm:return Math.PI/200*o.number;case Mm:return o.number;case $m:return Math.PI*2*o.number}throw new Error("Unsupported angle type")}},jm=function(u){return u.type===15&&(u.unit===Hm||u.unit===Dm||u.unit===Mm||u.unit===$m)},Km=function(u){var o=u.filter(Je).map(function(l){return l.value}).join(" ");switch(o){case"to bottom right":case"to right bottom":case"left top":case"top left":return[Nt,Nt];case"to top":case"bottom":return Mr(0);case"to bottom left":case"to left bottom":case"right top":case"top right":return[Nt,IA];case"to right":case"left":return Mr(90);case"to top left":case"to left top":case"right bottom":case"bottom right":return[IA,IA];case"to bottom":case"top":return Mr(180);case"to top right":case"to right top":case"left bottom":case"bottom left":return[IA,Nt];case"to left":case"right":return Mr(270)}return 0},Mr=function(u){return Math.PI*u/180},UA={name:"color",parse:function(u,o){if(o.type===18){var l=$E[o.name];if(typeof l>"u")throw new Error('Attempting to parse an unsupported color function "'+o.name+'"');return l(u,o.values)}if(o.type===5){if(o.value.length===3){var c=o.value.substring(0,1),p=o.value.substring(1,2),g=o.value.substring(2,3);return QA(parseInt(c+c,16),parseInt(p+p,16),parseInt(g+g,16),1)}if(o.value.length===4){var c=o.value.substring(0,1),p=o.value.substring(1,2),g=o.value.substring(2,3),_=o.value.substring(3,4);return QA(parseInt(c+c,16),parseInt(p+p,16),parseInt(g+g,16),parseInt(_+_,16)/255)}if(o.value.length===6){var c=o.value.substring(0,2),p=o.value.substring(2,4),g=o.value.substring(4,6);return QA(parseInt(c,16),parseInt(p,16),parseInt(g,16),1)}if(o.value.length===8){var c=o.value.substring(0,2),p=o.value.substring(2,4),g=o.value.substring(4,6),_=o.value.substring(6,8);return QA(parseInt(c,16),parseInt(p,16),parseInt(g,16),parseInt(_,16)/255)}}if(o.type===20){var v=Xn[o.value.toUpperCase()];if(typeof v<"u")return v}return Xn.TRANSPARENT}},FA=function(u){return(255&u)===0},St=function(u){var o=255&u,l=255&u>>8,c=255&u>>16,p=255&u>>24;return o<255?"rgba("+p+","+c+","+l+","+o/255+")":"rgb("+p+","+c+","+l+")"},QA=function(u,o,l,c){return(u<<24|o<<16|l<<8|Math.round(c*255)<<0)>>>0},zm=function(u,o){if(u.type===17)return u.number;if(u.type===16){var l=o===3?1:255;return o===3?u.number/100*l:Math.round(u.number/100*l)}return 0},Gm=function(u,o){var l=o.filter(xi);if(l.length===3){var c=l.map(zm),p=c[0],g=c[1],_=c[2];return QA(p,g,_,1)}if(l.length===4){var v=l.map(zm),p=v[0],g=v[1],_=v[2],B=v[3];return QA(p,g,_,B)}return 0};function Mf(u,o,l){return l<0&&(l+=1),l>=1&&(l-=1),l<1/6?(o-u)*l*6+u:l<1/2?o:l<2/3?(o-u)*6*(2/3-l)+u:u}var Vm=function(u,o){var l=o.filter(xi),c=l[0],p=l[1],g=l[2],_=l[3],v=(c.type===17?Mr(c.number):Mu.parse(u,c))/(Math.PI*2),B=gt(p)?p.number/100:0,E=gt(g)?g.number/100:0,x=typeof _<"u"&&gt(_)?Xe(_,1):1;if(B===0)return QA(E*255,E*255,E*255,1);var U=E<=.5?E*(B+1):E+B-E*B,S=E*2-U,Z=Mf(S,U,v+1/3),H=Mf(S,U,v),j=Mf(S,U,v-1/3);return QA(Z*255,H*255,j*255,x)},$E={hsl:Vm,hsla:Vm,rgb:Gm,rgba:Gm},oo=function(u,o){return UA.parse(u,km.create(o).parseComponentValue())},Xn={ALICEBLUE:4042850303,ANTIQUEWHITE:4209760255,AQUA:16777215,AQUAMARINE:2147472639,AZURE:4043309055,BEIGE:4126530815,BISQUE:4293182719,BLACK:255,BLANCHEDALMOND:4293643775,BLUE:65535,BLUEVIOLET:2318131967,BROWN:2771004159,BURLYWOOD:3736635391,CADETBLUE:1604231423,CHARTREUSE:2147418367,CHOCOLATE:3530104575,CORAL:4286533887,CORNFLOWERBLUE:1687547391,CORNSILK:4294499583,CRIMSON:3692313855,CYAN:16777215,DARKBLUE:35839,DARKCYAN:9145343,DARKGOLDENROD:3095837695,DARKGRAY:2846468607,DARKGREEN:6553855,DARKGREY:2846468607,DARKKHAKI:3182914559,DARKMAGENTA:2332068863,DARKOLIVEGREEN:1433087999,DARKORANGE:4287365375,DARKORCHID:2570243327,DARKRED:2332033279,DARKSALMON:3918953215,DARKSEAGREEN:2411499519,DARKSLATEBLUE:1211993087,DARKSLATEGRAY:793726975,DARKSLATEGREY:793726975,DARKTURQUOISE:13554175,DARKVIOLET:2483082239,DEEPPINK:4279538687,DEEPSKYBLUE:12582911,DIMGRAY:1768516095,DIMGREY:1768516095,DODGERBLUE:512819199,FIREBRICK:2988581631,FLORALWHITE:4294635775,FORESTGREEN:579543807,FUCHSIA:4278255615,GAINSBORO:3705462015,GHOSTWHITE:4177068031,GOLD:4292280575,GOLDENROD:3668254975,GRAY:2155905279,GREEN:8388863,GREENYELLOW:2919182335,GREY:2155905279,HONEYDEW:4043305215,HOTPINK:4285117695,INDIANRED:3445382399,INDIGO:1258324735,IVORY:4294963455,KHAKI:4041641215,LAVENDER:3873897215,LAVENDERBLUSH:4293981695,LAWNGREEN:2096890111,LEMONCHIFFON:4294626815,LIGHTBLUE:2916673279,LIGHTCORAL:4034953471,LIGHTCYAN:3774873599,LIGHTGOLDENRODYELLOW:4210742015,LIGHTGRAY:3553874943,LIGHTGREEN:2431553791,LIGHTGREY:3553874943,LIGHTPINK:4290167295,LIGHTSALMON:4288707327,LIGHTSEAGREEN:548580095,LIGHTSKYBLUE:2278488831,LIGHTSLATEGRAY:2005441023,LIGHTSLATEGREY:2005441023,LIGHTSTEELBLUE:2965692159,LIGHTYELLOW:4294959359,LIME:16711935,LIMEGREEN:852308735,LINEN:4210091775,MAGENTA:4278255615,MAROON:2147483903,MEDIUMAQUAMARINE:1724754687,MEDIUMBLUE:52735,MEDIUMORCHID:3126187007,MEDIUMPURPLE:2473647103,MEDIUMSEAGREEN:1018393087,MEDIUMSLATEBLUE:2070474495,MEDIUMSPRINGGREEN:16423679,MEDIUMTURQUOISE:1221709055,MEDIUMVIOLETRED:3340076543,MIDNIGHTBLUE:421097727,MINTCREAM:4127193855,MISTYROSE:4293190143,MOCCASIN:4293178879,NAVAJOWHITE:4292783615,NAVY:33023,OLDLACE:4260751103,OLIVE:2155872511,OLIVEDRAB:1804477439,ORANGE:4289003775,ORANGERED:4282712319,ORCHID:3664828159,PALEGOLDENROD:4008225535,PALEGREEN:2566625535,PALETURQUOISE:2951671551,PALEVIOLETRED:3681588223,PAPAYAWHIP:4293907967,PEACHPUFF:4292524543,PERU:3448061951,PINK:4290825215,PLUM:3718307327,POWDERBLUE:2967529215,PURPLE:2147516671,REBECCAPURPLE:1714657791,RED:4278190335,ROSYBROWN:3163525119,ROYALBLUE:1097458175,SADDLEBROWN:2336560127,SALMON:4202722047,SANDYBROWN:4104413439,SEAGREEN:780883967,SEASHELL:4294307583,SIENNA:2689740287,SILVER:3233857791,SKYBLUE:2278484991,SLATEBLUE:1784335871,SLATEGRAY:1887473919,SLATEGREY:1887473919,SNOW:4294638335,SPRINGGREEN:16744447,STEELBLUE:1182971135,TAN:3535047935,TEAL:8421631,THISTLE:3636451583,TOMATO:4284696575,TRANSPARENT:0,TURQUOISE:1088475391,VIOLET:4001558271,WHEAT:4125012991,WHITE:4294967295,WHITESMOKE:4126537215,YELLOW:4294902015,YELLOWGREEN:2597139199},jE={name:"background-clip",initialValue:"border-box",prefix:!1,type:1,parse:function(u,o){return o.map(function(l){if(Je(l))switch(l.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},KE={name:"background-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},$u=function(u,o){var l=UA.parse(u,o[0]),c=o[1];return c&&gt(c)?{color:l,stop:c}:{color:l,stop:null}},Zm=function(u,o){var l=u[0],c=u[u.length-1];l.stop===null&&(l.stop=Nt),c.stop===null&&(c.stop=IA);for(var p=[],g=0,_=0;_<u.length;_++){var v=u[_].stop;if(v!==null){var B=Xe(v,o);B>g?p.push(B):p.push(g),g=B}else p.push(null)}for(var E=null,_=0;_<p.length;_++){var x=p[_];if(x===null)E===null&&(E=_);else if(E!==null){for(var U=_-E,S=p[E-1],Z=(x-S)/(U+1),H=1;H<=U;H++)p[E+H-1]=Z*H;E=null}}return u.map(function(j,Oe){var se=j.color;return{color:se,stop:Math.max(Math.min(1,p[Oe]/o),0)}})},zE=function(u,o,l){var c=o/2,p=l/2,g=Xe(u[0],o)-c,_=p-Xe(u[1],l);return(Math.atan2(_,g)+Math.PI*2)%(Math.PI*2)},GE=function(u,o,l){var c=typeof u=="number"?u:zE(u,o,l),p=Math.abs(o*Math.sin(c))+Math.abs(l*Math.cos(c)),g=o/2,_=l/2,v=p/2,B=Math.sin(c-Math.PI/2)*v,E=Math.cos(c-Math.PI/2)*v;return[p,g-E,g+E,_-B,_+B]},nn=function(u,o){return Math.sqrt(u*u+o*o)},Jm=function(u,o,l,c,p){var g=[[0,0],[0,o],[u,0],[u,o]];return g.reduce(function(_,v){var B=v[0],E=v[1],x=nn(l-B,c-E);return(p?x<_.optimumDistance:x>_.optimumDistance)?{optimumCorner:v,optimumDistance:x}:_},{optimumDistance:p?1/0:-1/0,optimumCorner:null}).optimumCorner},VE=function(u,o,l,c,p){var g=0,_=0;switch(u.size){case 0:u.shape===0?g=_=Math.min(Math.abs(o),Math.abs(o-c),Math.abs(l),Math.abs(l-p)):u.shape===1&&(g=Math.min(Math.abs(o),Math.abs(o-c)),_=Math.min(Math.abs(l),Math.abs(l-p)));break;case 2:if(u.shape===0)g=_=Math.min(nn(o,l),nn(o,l-p),nn(o-c,l),nn(o-c,l-p));else if(u.shape===1){var v=Math.min(Math.abs(l),Math.abs(l-p))/Math.min(Math.abs(o),Math.abs(o-c)),B=Jm(c,p,o,l,!0),E=B[0],x=B[1];g=nn(E-o,(x-l)/v),_=v*g}break;case 1:u.shape===0?g=_=Math.max(Math.abs(o),Math.abs(o-c),Math.abs(l),Math.abs(l-p)):u.shape===1&&(g=Math.max(Math.abs(o),Math.abs(o-c)),_=Math.max(Math.abs(l),Math.abs(l-p)));break;case 3:if(u.shape===0)g=_=Math.max(nn(o,l),nn(o,l-p),nn(o-c,l),nn(o-c,l-p));else if(u.shape===1){var v=Math.max(Math.abs(l),Math.abs(l-p))/Math.max(Math.abs(o),Math.abs(o-c)),U=Jm(c,p,o,l,!1),E=U[0],x=U[1];g=nn(E-o,(x-l)/v),_=v*g}break}return Array.isArray(u.size)&&(g=Xe(u.size[0],c),_=u.size.length===2?Xe(u.size[1],p):g),[g,_]},ZE=function(u,o){var l=Mr(180),c=[];return Bn(o).forEach(function(p,g){if(g===0){var _=p[0];if(_.type===20&&_.value==="to"){l=Km(p);return}else if(jm(_)){l=Mu.parse(u,_);return}}var v=$u(u,p);c.push(v)}),{angle:l,stops:c,type:1}},ju=function(u,o){var l=Mr(180),c=[];return Bn(o).forEach(function(p,g){if(g===0){var _=p[0];if(_.type===20&&["top","left","right","bottom"].indexOf(_.value)!==-1){l=Km(p);return}else if(jm(_)){l=(Mu.parse(u,_)+Mr(270))%Mr(360);return}}var v=$u(u,p);c.push(v)}),{angle:l,stops:c,type:1}},JE=function(u,o){var l=Mr(180),c=[],p=1,g=0,_=3,v=[];return Bn(o).forEach(function(B,E){var x=B[0];if(E===0){if(Je(x)&&x.value==="linear"){p=1;return}else if(Je(x)&&x.value==="radial"){p=2;return}}if(x.type===18){if(x.name==="from"){var U=UA.parse(u,x.values[0]);c.push({stop:Nt,color:U})}else if(x.name==="to"){var U=UA.parse(u,x.values[0]);c.push({stop:IA,color:U})}else if(x.name==="color-stop"){var S=x.values.filter(xi);if(S.length===2){var U=UA.parse(u,S[1]),Z=S[0];Ei(Z)&&c.push({stop:{type:16,number:Z.number*100,flags:Z.flags},color:U})}}}}),p===1?{angle:(l+Mr(180))%Mr(360),stops:c,type:p}:{size:_,shape:g,stops:c,position:v,type:p}},Wm="closest-side",qm="farthest-side",Xm="closest-corner",Ym="farthest-corner",eg="circle",tg="ellipse",rg="cover",ng="contain",WE=function(u,o){var l=0,c=3,p=[],g=[];return Bn(o).forEach(function(_,v){var B=!0;if(v===0){var E=!1;B=_.reduce(function(U,S){if(E)if(Je(S))switch(S.value){case"center":return g.push(Df),U;case"top":case"left":return g.push(Nt),U;case"right":case"bottom":return g.push(IA),U}else(gt(S)||xA(S))&&g.push(S);else if(Je(S))switch(S.value){case eg:return l=0,!1;case tg:return l=1,!1;case"at":return E=!0,!1;case Wm:return c=0,!1;case rg:case qm:return c=1,!1;case ng:case Xm:return c=2,!1;case Ym:return c=3,!1}else if(xA(S)||gt(S))return Array.isArray(c)||(c=[]),c.push(S),!1;return U},B)}if(B){var x=$u(u,_);p.push(x)}}),{size:c,shape:l,stops:p,position:g,type:2}},Ku=function(u,o){var l=0,c=3,p=[],g=[];return Bn(o).forEach(function(_,v){var B=!0;if(v===0?B=_.reduce(function(x,U){if(Je(U))switch(U.value){case"center":return g.push(Df),!1;case"top":case"left":return g.push(Nt),!1;case"right":case"bottom":return g.push(IA),!1}else if(gt(U)||xA(U))return g.push(U),!1;return x},B):v===1&&(B=_.reduce(function(x,U){if(Je(U))switch(U.value){case eg:return l=0,!1;case tg:return l=1,!1;case ng:case Wm:return c=0,!1;case qm:return c=1,!1;case Xm:return c=2,!1;case rg:case Ym:return c=3,!1}else if(xA(U)||gt(U))return Array.isArray(c)||(c=[]),c.push(U),!1;return x},B)),B){var E=$u(u,_);p.push(E)}}),{size:c,shape:l,stops:p,position:g,type:2}},qE=function(u){return u.type===1},XE=function(u){return u.type===2},$f={name:"image",parse:function(u,o){if(o.type===22){var l={url:o.value,type:0};return u.cache.addImage(o.value),l}if(o.type===18){var c=Ag[o.name];if(typeof c>"u")throw new Error('Attempting to parse an unsupported image function "'+o.name+'"');return c(u,o.values)}throw new Error("Unsupported image type "+o.type)}};function YE(u){return!(u.type===20&&u.value==="none")&&(u.type!==18||!!Ag[u.name])}var Ag={"linear-gradient":ZE,"-moz-linear-gradient":ju,"-ms-linear-gradient":ju,"-o-linear-gradient":ju,"-webkit-linear-gradient":ju,"radial-gradient":WE,"-moz-radial-gradient":Ku,"-ms-radial-gradient":Ku,"-o-radial-gradient":Ku,"-webkit-radial-gradient":Ku,"-webkit-gradient":JE},ex={name:"background-image",initialValue:"none",type:1,prefix:!1,parse:function(u,o){if(o.length===0)return[];var l=o[0];return l.type===20&&l.value==="none"?[]:o.filter(function(c){return xi(c)&&YE(c)}).map(function(c){return $f.parse(u,c)})}},tx={name:"background-origin",initialValue:"border-box",prefix:!1,type:1,parse:function(u,o){return o.map(function(l){if(Je(l))switch(l.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},rx={name:"background-position",initialValue:"0% 0%",type:1,prefix:!1,parse:function(u,o){return Bn(o).map(function(l){return l.filter(gt)}).map(Lm)}},nx={name:"background-repeat",initialValue:"repeat",prefix:!1,type:1,parse:function(u,o){return Bn(o).map(function(l){return l.filter(Je).map(function(c){return c.value}).join(" ")}).map(Ax)}},Ax=function(u){switch(u){case"no-repeat":return 1;case"repeat-x":case"repeat no-repeat":return 2;case"repeat-y":case"no-repeat repeat":return 3;case"repeat":default:return 0}},Ii;(function(u){u.AUTO="auto",u.CONTAIN="contain",u.COVER="cover"})(Ii||(Ii={}));var sx={name:"background-size",initialValue:"0",prefix:!1,type:1,parse:function(u,o){return Bn(o).map(function(l){return l.filter(ix)})}},ix=function(u){return Je(u)||gt(u)},zu=function(u){return{name:"border-"+u+"-color",initialValue:"transparent",prefix:!1,type:3,format:"color"}},ax=zu("top"),ox=zu("right"),ux=zu("bottom"),cx=zu("left"),Gu=function(u){return{name:"border-radius-"+u,initialValue:"0 0",prefix:!1,type:1,parse:function(o,l){return Lm(l.filter(gt))}}},lx=Gu("top-left"),fx=Gu("top-right"),dx=Gu("bottom-right"),px=Gu("bottom-left"),Vu=function(u){return{name:"border-"+u+"-style",initialValue:"solid",prefix:!1,type:2,parse:function(o,l){switch(l){case"none":return 0;case"dashed":return 2;case"dotted":return 3;case"double":return 4}return 1}}},hx=Vu("top"),mx=Vu("right"),gx=Vu("bottom"),wx=Vu("left"),Zu=function(u){return{name:"border-"+u+"-width",initialValue:"0",type:0,prefix:!1,parse:function(o,l){return io(l)?l.number:0}}},yx=Zu("top"),_x=Zu("right"),bx=Zu("bottom"),Bx=Zu("left"),vx={name:"color",initialValue:"transparent",prefix:!1,type:3,format:"color"},Cx={name:"direction",initialValue:"ltr",prefix:!1,type:2,parse:function(u,o){switch(o){case"rtl":return 1;case"ltr":default:return 0}}},Ex={name:"display",initialValue:"inline-block",prefix:!1,type:1,parse:function(u,o){return o.filter(Je).reduce(function(l,c){return l|xx(c.value)},0)}},xx=function(u){switch(u){case"block":case"-webkit-box":return 2;case"inline":return 4;case"run-in":return 8;case"flow":return 16;case"flow-root":return 32;case"table":return 64;case"flex":case"-webkit-flex":return 128;case"grid":case"-ms-grid":return 256;case"ruby":return 512;case"subgrid":return 1024;case"list-item":return 2048;case"table-row-group":return 4096;case"table-header-group":return 8192;case"table-footer-group":return 16384;case"table-row":return 32768;case"table-cell":return 65536;case"table-column-group":return 131072;case"table-column":return 262144;case"table-caption":return 524288;case"ruby-base":return 1048576;case"ruby-text":return 2097152;case"ruby-base-container":return 4194304;case"ruby-text-container":return 8388608;case"contents":return 16777216;case"inline-block":return 33554432;case"inline-list-item":return 67108864;case"inline-table":return 134217728;case"inline-flex":return 268435456;case"inline-grid":return 536870912}return 0},Ix={name:"float",initialValue:"none",prefix:!1,type:2,parse:function(u,o){switch(o){case"left":return 1;case"right":return 2;case"inline-start":return 3;case"inline-end":return 4}return 0}},Ux={name:"letter-spacing",initialValue:"0",prefix:!1,type:0,parse:function(u,o){return o.type===20&&o.value==="normal"?0:o.type===17||o.type===15?o.number:0}},Ju;(function(u){u.NORMAL="normal",u.STRICT="strict"})(Ju||(Ju={}));var Fx={name:"line-break",initialValue:"normal",prefix:!1,type:2,parse:function(u,o){switch(o){case"strict":return Ju.STRICT;case"normal":default:return Ju.NORMAL}}},Qx={name:"line-height",initialValue:"normal",prefix:!1,type:4},sg=function(u,o){return Je(u)&&u.value==="normal"?1.2*o:u.type===17?o*u.number:gt(u)?Xe(u,o):o},Tx={name:"list-style-image",initialValue:"none",type:0,prefix:!1,parse:function(u,o){return o.type===20&&o.value==="none"?null:$f.parse(u,o)}},Ox={name:"list-style-position",initialValue:"outside",prefix:!1,type:2,parse:function(u,o){switch(o){case"inside":return 0;case"outside":default:return 1}}},jf={name:"list-style-type",initialValue:"none",prefix:!1,type:2,parse:function(u,o){switch(o){case"disc":return 0;case"circle":return 1;case"square":return 2;case"decimal":return 3;case"cjk-decimal":return 4;case"decimal-leading-zero":return 5;case"lower-roman":return 6;case"upper-roman":return 7;case"lower-greek":return 8;case"lower-alpha":return 9;case"upper-alpha":return 10;case"arabic-indic":return 11;case"armenian":return 12;case"bengali":return 13;case"cambodian":return 14;case"cjk-earthly-branch":return 15;case"cjk-heavenly-stem":return 16;case"cjk-ideographic":return 17;case"devanagari":return 18;case"ethiopic-numeric":return 19;case"georgian":return 20;case"gujarati":return 21;case"gurmukhi":return 22;case"hebrew":return 22;case"hiragana":return 23;case"hiragana-iroha":return 24;case"japanese-formal":return 25;case"japanese-informal":return 26;case"kannada":return 27;case"katakana":return 28;case"katakana-iroha":return 29;case"khmer":return 30;case"korean-hangul-formal":return 31;case"korean-hanja-formal":return 32;case"korean-hanja-informal":return 33;case"lao":return 34;case"lower-armenian":return 35;case"malayalam":return 36;case"mongolian":return 37;case"myanmar":return 38;case"oriya":return 39;case"persian":return 40;case"simp-chinese-formal":return 41;case"simp-chinese-informal":return 42;case"tamil":return 43;case"telugu":return 44;case"thai":return 45;case"tibetan":return 46;case"trad-chinese-formal":return 47;case"trad-chinese-informal":return 48;case"upper-armenian":return 49;case"disclosure-open":return 50;case"disclosure-closed":return 51;case"none":default:return-1}}},Wu=function(u){return{name:"margin-"+u,initialValue:"0",prefix:!1,type:4}},Sx=Wu("top"),Px=Wu("right"),Rx=Wu("bottom"),kx=Wu("left"),Nx={name:"overflow",initialValue:"visible",prefix:!1,type:1,parse:function(u,o){return o.filter(Je).map(function(l){switch(l.value){case"hidden":return 1;case"scroll":return 2;case"clip":return 3;case"auto":return 4;case"visible":default:return 0}})}},Lx={name:"overflow-wrap",initialValue:"normal",prefix:!1,type:2,parse:function(u,o){switch(o){case"break-word":return"break-word";case"normal":default:return"normal"}}},qu=function(u){return{name:"padding-"+u,initialValue:"0",prefix:!1,type:3,format:"length-percentage"}},Hx=qu("top"),Dx=qu("right"),Mx=qu("bottom"),$x=qu("left"),jx={name:"text-align",initialValue:"left",prefix:!1,type:2,parse:function(u,o){switch(o){case"right":return 2;case"center":case"justify":return 1;case"left":default:return 0}}},Kx={name:"position",initialValue:"static",prefix:!1,type:2,parse:function(u,o){switch(o){case"relative":return 1;case"absolute":return 2;case"fixed":return 3;case"sticky":return 4}return 0}},zx={name:"text-shadow",initialValue:"none",type:1,prefix:!1,parse:function(u,o){return o.length===1&&Hf(o[0],"none")?[]:Bn(o).map(function(l){for(var c={color:Xn.TRANSPARENT,offsetX:Nt,offsetY:Nt,blur:Nt},p=0,g=0;g<l.length;g++){var _=l[g];xA(_)?(p===0?c.offsetX=_:p===1?c.offsetY=_:c.blur=_,p++):c.color=UA.parse(u,_)}return c})}},Gx={name:"text-transform",initialValue:"none",prefix:!1,type:2,parse:function(u,o){switch(o){case"uppercase":return 2;case"lowercase":return 1;case"capitalize":return 3}return 0}},Vx={name:"transform",initialValue:"none",prefix:!0,type:0,parse:function(u,o){if(o.type===20&&o.value==="none")return null;if(o.type===18){var l=Wx[o.name];if(typeof l>"u")throw new Error('Attempting to parse an unsupported transform function "'+o.name+'"');return l(o.values)}return null}},Zx=function(u){var o=u.filter(function(l){return l.type===17}).map(function(l){return l.number});return o.length===6?o:null},Jx=function(u){var o=u.filter(function(B){return B.type===17}).map(function(B){return B.number}),l=o[0],c=o[1];o[2],o[3];var p=o[4],g=o[5];o[6],o[7],o[8],o[9],o[10],o[11];var _=o[12],v=o[13];return o[14],o[15],o.length===16?[l,c,p,g,_,v]:null},Wx={matrix:Zx,matrix3d:Jx},ig={type:16,number:50,flags:to},qx=[ig,ig],Xx={name:"transform-origin",initialValue:"50% 50%",prefix:!0,type:1,parse:function(u,o){var l=o.filter(gt);return l.length!==2?qx:[l[0],l[1]]}},Yx={name:"visible",initialValue:"none",prefix:!1,type:2,parse:function(u,o){switch(o){case"hidden":return 1;case"collapse":return 2;case"visible":default:return 0}}},uo;(function(u){u.NORMAL="normal",u.BREAK_ALL="break-all",u.KEEP_ALL="keep-all"})(uo||(uo={}));for(var eI={name:"word-break",initialValue:"normal",prefix:!1,type:2,parse:function(u,o){switch(o){case"break-all":return uo.BREAK_ALL;case"keep-all":return uo.KEEP_ALL;case"normal":default:return uo.NORMAL}}},tI={name:"z-index",initialValue:"auto",prefix:!1,type:0,parse:function(u,o){if(o.type===20)return{auto:!0,order:0};if(Ei(o))return{auto:!1,order:o.number};throw new Error("Invalid z-index number parsed")}},ag={name:"time",parse:function(u,o){if(o.type===15)switch(o.unit.toLowerCase()){case"s":return 1e3*o.number;case"ms":return o.number}throw new Error("Unsupported time type")}},rI={name:"opacity",initialValue:"1",type:0,prefix:!1,parse:function(u,o){return Ei(o)?o.number:1}},nI={name:"text-decoration-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},AI={name:"text-decoration-line",initialValue:"none",prefix:!1,type:1,parse:function(u,o){return o.filter(Je).map(function(l){switch(l.value){case"underline":return 1;case"overline":return 2;case"line-through":return 3;case"none":return 4}return 0}).filter(function(l){return l!==0})}},sI={name:"font-family",initialValue:"",prefix:!1,type:1,parse:function(u,o){var l=[],c=[];return o.forEach(function(p){switch(p.type){case 20:case 0:l.push(p.value);break;case 17:l.push(p.number.toString());break;case 4:c.push(l.join(" ")),l.length=0;break}}),l.length&&c.push(l.join(" ")),c.map(function(p){return p.indexOf(" ")===-1?p:"'"+p+"'"})}},iI={name:"font-size",initialValue:"0",prefix:!1,type:3,format:"length"},aI={name:"font-weight",initialValue:"normal",type:0,prefix:!1,parse:function(u,o){if(Ei(o))return o.number;if(Je(o))switch(o.value){case"bold":return 700;case"normal":default:return 400}return 400}},oI={name:"font-variant",initialValue:"none",type:1,prefix:!1,parse:function(u,o){return o.filter(Je).map(function(l){return l.value})}},uI={name:"font-style",initialValue:"normal",prefix:!1,type:2,parse:function(u,o){switch(o){case"oblique":return"oblique";case"italic":return"italic";case"normal":default:return"normal"}}},bt=function(u,o){return(u&o)!==0},cI={name:"content",initialValue:"none",type:1,prefix:!1,parse:function(u,o){if(o.length===0)return[];var l=o[0];return l.type===20&&l.value==="none"?[]:o}},lI={name:"counter-increment",initialValue:"none",prefix:!0,type:1,parse:function(u,o){if(o.length===0)return null;var l=o[0];if(l.type===20&&l.value==="none")return null;for(var c=[],p=o.filter(Nm),g=0;g<p.length;g++){var _=p[g],v=p[g+1];if(_.type===20){var B=v&&Ei(v)?v.number:1;c.push({counter:_.value,increment:B})}}return c}},fI={name:"counter-reset",initialValue:"none",prefix:!0,type:1,parse:function(u,o){if(o.length===0)return[];for(var l=[],c=o.filter(Nm),p=0;p<c.length;p++){var g=c[p],_=c[p+1];if(Je(g)&&g.value!=="none"){var v=_&&Ei(_)?_.number:0;l.push({counter:g.value,reset:v})}}return l}},dI={name:"duration",initialValue:"0s",prefix:!1,type:1,parse:function(u,o){return o.filter(io).map(function(l){return ag.parse(u,l)})}},pI={name:"quotes",initialValue:"none",prefix:!0,type:1,parse:function(u,o){if(o.length===0)return null;var l=o[0];if(l.type===20&&l.value==="none")return null;var c=[],p=o.filter(DE);if(p.length%2!==0)return null;for(var g=0;g<p.length;g+=2){var _=p[g].value,v=p[g+1].value;c.push({open:_,close:v})}return c}},og=function(u,o,l){if(!u)return"";var c=u[Math.min(o,u.length-1)];return c?l?c.open:c.close:""},hI={name:"box-shadow",initialValue:"none",type:1,prefix:!1,parse:function(u,o){return o.length===1&&Hf(o[0],"none")?[]:Bn(o).map(function(l){for(var c={color:255,offsetX:Nt,offsetY:Nt,blur:Nt,spread:Nt,inset:!1},p=0,g=0;g<l.length;g++){var _=l[g];Hf(_,"inset")?c.inset=!0:xA(_)?(p===0?c.offsetX=_:p===1?c.offsetY=_:p===2?c.blur=_:c.spread=_,p++):c.color=UA.parse(u,_)}return c})}},mI={name:"paint-order",initialValue:"normal",prefix:!1,type:1,parse:function(u,o){var l=[0,1,2],c=[];return o.filter(Je).forEach(function(p){switch(p.value){case"stroke":c.push(1);break;case"fill":c.push(0);break;case"markers":c.push(2);break}}),l.forEach(function(p){c.indexOf(p)===-1&&c.push(p)}),c}},gI={name:"-webkit-text-stroke-color",initialValue:"currentcolor",prefix:!1,type:3,format:"color"},wI={name:"-webkit-text-stroke-width",initialValue:"0",type:0,prefix:!1,parse:function(u,o){return io(o)?o.number:0}},yI=(function(){function u(o,l){var c,p;this.animationDuration=W(o,dI,l.animationDuration),this.backgroundClip=W(o,jE,l.backgroundClip),this.backgroundColor=W(o,KE,l.backgroundColor),this.backgroundImage=W(o,ex,l.backgroundImage),this.backgroundOrigin=W(o,tx,l.backgroundOrigin),this.backgroundPosition=W(o,rx,l.backgroundPosition),this.backgroundRepeat=W(o,nx,l.backgroundRepeat),this.backgroundSize=W(o,sx,l.backgroundSize),this.borderTopColor=W(o,ax,l.borderTopColor),this.borderRightColor=W(o,ox,l.borderRightColor),this.borderBottomColor=W(o,ux,l.borderBottomColor),this.borderLeftColor=W(o,cx,l.borderLeftColor),this.borderTopLeftRadius=W(o,lx,l.borderTopLeftRadius),this.borderTopRightRadius=W(o,fx,l.borderTopRightRadius),this.borderBottomRightRadius=W(o,dx,l.borderBottomRightRadius),this.borderBottomLeftRadius=W(o,px,l.borderBottomLeftRadius),this.borderTopStyle=W(o,hx,l.borderTopStyle),this.borderRightStyle=W(o,mx,l.borderRightStyle),this.borderBottomStyle=W(o,gx,l.borderBottomStyle),this.borderLeftStyle=W(o,wx,l.borderLeftStyle),this.borderTopWidth=W(o,yx,l.borderTopWidth),this.borderRightWidth=W(o,_x,l.borderRightWidth),this.borderBottomWidth=W(o,bx,l.borderBottomWidth),this.borderLeftWidth=W(o,Bx,l.borderLeftWidth),this.boxShadow=W(o,hI,l.boxShadow),this.color=W(o,vx,l.color),this.direction=W(o,Cx,l.direction),this.display=W(o,Ex,l.display),this.float=W(o,Ix,l.cssFloat),this.fontFamily=W(o,sI,l.fontFamily),this.fontSize=W(o,iI,l.fontSize),this.fontStyle=W(o,uI,l.fontStyle),this.fontVariant=W(o,oI,l.fontVariant),this.fontWeight=W(o,aI,l.fontWeight),this.letterSpacing=W(o,Ux,l.letterSpacing),this.lineBreak=W(o,Fx,l.lineBreak),this.lineHeight=W(o,Qx,l.lineHeight),this.listStyleImage=W(o,Tx,l.listStyleImage),this.listStylePosition=W(o,Ox,l.listStylePosition),this.listStyleType=W(o,jf,l.listStyleType),this.marginTop=W(o,Sx,l.marginTop),this.marginRight=W(o,Px,l.marginRight),this.marginBottom=W(o,Rx,l.marginBottom),this.marginLeft=W(o,kx,l.marginLeft),this.opacity=W(o,rI,l.opacity);var g=W(o,Nx,l.overflow);this.overflowX=g[0],this.overflowY=g[g.length>1?1:0],this.overflowWrap=W(o,Lx,l.overflowWrap),this.paddingTop=W(o,Hx,l.paddingTop),this.paddingRight=W(o,Dx,l.paddingRight),this.paddingBottom=W(o,Mx,l.paddingBottom),this.paddingLeft=W(o,$x,l.paddingLeft),this.paintOrder=W(o,mI,l.paintOrder),this.position=W(o,Kx,l.position),this.textAlign=W(o,jx,l.textAlign),this.textDecorationColor=W(o,nI,(c=l.textDecorationColor)!==null&&c!==void 0?c:l.color),this.textDecorationLine=W(o,AI,(p=l.textDecorationLine)!==null&&p!==void 0?p:l.textDecoration),this.textShadow=W(o,zx,l.textShadow),this.textTransform=W(o,Gx,l.textTransform),this.transform=W(o,Vx,l.transform),this.transformOrigin=W(o,Xx,l.transformOrigin),this.visibility=W(o,Yx,l.visibility),this.webkitTextStrokeColor=W(o,gI,l.webkitTextStrokeColor),this.webkitTextStrokeWidth=W(o,wI,l.webkitTextStrokeWidth),this.wordBreak=W(o,eI,l.wordBreak),this.zIndex=W(o,tI,l.zIndex)}return u.prototype.isVisible=function(){return this.display>0&&this.opacity>0&&this.visibility===0},u.prototype.isTransparent=function(){return FA(this.backgroundColor)},u.prototype.isTransformed=function(){return this.transform!==null},u.prototype.isPositioned=function(){return this.position!==0},u.prototype.isPositionedWithZIndex=function(){return this.isPositioned()&&!this.zIndex.auto},u.prototype.isFloating=function(){return this.float!==0},u.prototype.isInlineLevel=function(){return bt(this.display,4)||bt(this.display,33554432)||bt(this.display,268435456)||bt(this.display,536870912)||bt(this.display,67108864)||bt(this.display,134217728)},u})(),_I=(function(){function u(o,l){this.content=W(o,cI,l.content),this.quotes=W(o,pI,l.quotes)}return u})(),ug=(function(){function u(o,l){this.counterIncrement=W(o,lI,l.counterIncrement),this.counterReset=W(o,fI,l.counterReset)}return u})(),W=function(u,o,l){var c=new Rm,p=l!==null&&typeof l<"u"?l.toString():o.initialValue;c.write(p);var g=new km(c.read());switch(o.type){case 2:var _=g.parseComponentValue();return o.parse(u,Je(_)?_.value:o.initialValue);case 0:return o.parse(u,g.parseComponentValue());case 1:return o.parse(u,g.parseComponentValues());case 4:return g.parseComponentValue();case 3:switch(o.format){case"angle":return Mu.parse(u,g.parseComponentValue());case"color":return UA.parse(u,g.parseComponentValue());case"image":return $f.parse(u,g.parseComponentValue());case"length":var v=g.parseComponentValue();return xA(v)?v:Nt;case"length-percentage":var B=g.parseComponentValue();return gt(B)?B:Nt;case"time":return ag.parse(u,g.parseComponentValue())}break}},bI="data-html2canvas-debug",BI=function(u){var o=u.getAttribute(bI);switch(o){case"all":return 1;case"clone":return 2;case"parse":return 3;case"render":return 4;default:return 0}},Kf=function(u,o){var l=BI(u);return l===1||o===l},vn=(function(){function u(o,l){if(this.context=o,this.textNodes=[],this.elements=[],this.flags=0,Kf(l,3))debugger;this.styles=new yI(o,window.getComputedStyle(l,null)),Ad(l)&&(this.styles.animationDuration.some(function(c){return c>0})&&(l.style.animationDuration="0s"),this.styles.transform!==null&&(l.style.transform="none")),this.bounds=a(this.context,l),Kf(l,4)&&(this.flags|=16)}return u})(),vI="AAAAAAAAAAAAEA4AGBkAAFAaAAACAAAAAAAIABAAGAAwADgACAAQAAgAEAAIABAACAAQAAgAEAAIABAACAAQAAgAEAAIABAAQABIAEQATAAIABAACAAQAAgAEAAIABAAVABcAAgAEAAIABAACAAQAGAAaABwAHgAgACIAI4AlgAIABAAmwCjAKgAsAC2AL4AvQDFAMoA0gBPAVYBWgEIAAgACACMANoAYgFkAWwBdAF8AX0BhQGNAZUBlgGeAaMBlQGWAasBswF8AbsBwwF0AcsBYwHTAQgA2wG/AOMBdAF8AekB8QF0AfkB+wHiAHQBfAEIAAMC5gQIAAsCEgIIAAgAFgIeAggAIgIpAggAMQI5AkACygEIAAgASAJQAlgCYAIIAAgACAAKBQoFCgUTBRMFGQUrBSsFCAAIAAgACAAIAAgACAAIAAgACABdAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABoAmgCrwGvAQgAbgJ2AggAHgEIAAgACADnAXsCCAAIAAgAgwIIAAgACAAIAAgACACKAggAkQKZAggAPADJAAgAoQKkAqwCsgK6AsICCADJAggA0AIIAAgACAAIANYC3gIIAAgACAAIAAgACABAAOYCCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAkASoB+QIEAAgACAA8AEMCCABCBQgACABJBVAFCAAIAAgACAAIAAgACAAIAAgACABTBVoFCAAIAFoFCABfBWUFCAAIAAgACAAIAAgAbQUIAAgACAAIAAgACABzBXsFfQWFBYoFigWKBZEFigWKBYoFmAWfBaYFrgWxBbkFCAAIAAgACAAIAAgACAAIAAgACAAIAMEFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAMgFCADQBQgACAAIAAgACAAIAAgACAAIAAgACAAIAO4CCAAIAAgAiQAIAAgACABAAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAD0AggACAD8AggACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIANYFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAMDvwAIAAgAJAIIAAgACAAIAAgACAAIAAgACwMTAwgACAB9BOsEGwMjAwgAKwMyAwsFYgE3A/MEPwMIAEUDTQNRAwgAWQOsAGEDCAAIAAgACAAIAAgACABpAzQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFIQUoBSwFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABtAwgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABMAEwACAAIAAgACAAIABgACAAIAAgACAC/AAgACAAyAQgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACAAIAAwAAgACAAIAAgACAAIAAgACAAIAAAARABIAAgACAAIABQASAAIAAgAIABwAEAAjgCIABsAqAC2AL0AigDQAtwC+IJIQqVAZUBWQqVAZUBlQGVAZUBlQGrC5UBlQGVAZUBlQGVAZUBlQGVAXsKlQGVAbAK6wsrDGUMpQzlDJUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAfAKAAuZA64AtwCJALoC6ADwAAgAuACgA/oEpgO6AqsD+AAIAAgAswMIAAgACAAIAIkAuwP5AfsBwwPLAwgACAAIAAgACADRA9kDCAAIAOED6QMIAAgACAAIAAgACADuA/YDCAAIAP4DyQAIAAgABgQIAAgAXQAOBAgACAAIAAgACAAIABMECAAIAAgACAAIAAgACAD8AAQBCAAIAAgAGgQiBCoECAExBAgAEAEIAAgACAAIAAgACAAIAAgACAAIAAgACAA4BAgACABABEYECAAIAAgATAQYAQgAVAQIAAgACAAIAAgACAAIAAgACAAIAFoECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAOQEIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAB+BAcACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAEABhgSMBAgACAAIAAgAlAQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAwAEAAQABAADAAMAAwADAAQABAAEAAQABAAEAAQABHATAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAdQMIAAgACAAIAAgACAAIAMkACAAIAAgAfQMIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACFA4kDCAAIAAgACAAIAOcBCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAIcDCAAIAAgACAAIAAgACAAIAAgACAAIAJEDCAAIAAgACADFAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABgBAgAZgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAbAQCBXIECAAIAHkECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABAAJwEQACjBKoEsgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAC6BMIECAAIAAgACAAIAAgACABmBAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAxwQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAGYECAAIAAgAzgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBd0FXwUIAOIF6gXxBYoF3gT5BQAGCAaKBYoFigWKBYoFigWKBYoFigWKBYoFigXWBIoFigWKBYoFigWKBYoFigWKBYsFEAaKBYoFigWKBYoFigWKBRQGCACKBYoFigWKBQgACAAIANEECAAIABgGigUgBggAJgYIAC4GMwaKBYoF0wQ3Bj4GigWKBYoFigWKBYoFigWKBYoFigWKBYoFigUIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWLBf///////wQABAAEAAQABAAEAAQABAAEAAQAAwAEAAQAAgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAQADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUAAAAFAAUAAAAFAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAQAAAAUABQAFAAUABQAFAAAAAAAFAAUAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAFAAUAAQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAAABwAHAAcAAAAHAAcABwAFAAEAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAcABwAFAAUAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAQABAAAAAAAAAAAAAAAFAAUABQAFAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAHAAcAAAAHAAcAAAAAAAUABQAHAAUAAQAHAAEABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwABAAUABQAFAAUAAAAAAAAAAAAAAAEAAQABAAEAAQABAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABQANAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAABQAHAAUABQAFAAAAAAAAAAcABQAFAAUABQAFAAQABAAEAAQABAAEAAQABAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUAAAAFAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAUAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAcABwAFAAcABwAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUABwAHAAUABQAFAAUAAAAAAAcABwAAAAAABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAAAAAAAAAAABQAFAAAAAAAFAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAFAAUABQAFAAUAAAAFAAUABwAAAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABwAFAAUABQAFAAAAAAAHAAcAAAAAAAcABwAFAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAAAAAAAAAHAAcABwAAAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAUABQAFAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAHAAcABQAHAAcAAAAFAAcABwAAAAcABwAFAAUAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAFAAcABwAFAAUABQAAAAUAAAAHAAcABwAHAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAHAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUAAAAFAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAUAAAAFAAUAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABwAFAAUABQAFAAUABQAAAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABQAFAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAFAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAHAAUABQAFAAUABQAFAAUABwAHAAcABwAHAAcABwAHAAUABwAHAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABwAHAAcABwAFAAUABwAHAAcAAAAAAAAAAAAHAAcABQAHAAcABwAHAAcABwAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAUABQAFAAUABQAFAAUAAAAFAAAABQAAAAAABQAFAAUABQAFAAUABQAFAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAUABQAFAAUABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABwAFAAcABwAHAAcABwAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAUABQAFAAUABwAHAAUABQAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABQAFAAcABwAHAAUABwAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAcABQAFAAUABQAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAAAAAABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAAAAAAAAAFAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAUABQAHAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAFAAUABQAFAAcABwAFAAUABwAHAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAcABwAFAAUABwAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABQAAAAAABQAFAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAcABwAAAAAAAAAAAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAcABwAFAAcABwAAAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAFAAUABQAAAAUABQAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABwAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAHAAcABQAHAAUABQAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAAABwAHAAAAAAAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAFAAUABwAFAAcABwAFAAcABQAFAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAAAAAABwAHAAcABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAFAAcABwAFAAUABQAFAAUABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAUABQAFAAcABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABQAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAAAAAAFAAUABwAHAAcABwAFAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAHAAUABQAFAAUABQAFAAUABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAABQAAAAUABQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAHAAcAAAAFAAUAAAAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABQAFAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAABQAFAAUABQAFAAUABQAAAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAFAAUABQAFAAUADgAOAA4ADgAOAA4ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAMAAwADAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkAAAAAAAAAAAAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAAAAAAAAAAAAsADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwACwAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAADgAOAA4AAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAAAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4AAAAOAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAAAAAAAAAAAA4AAAAOAAAAAAAAAAAADgAOAA4AAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAA=",cg="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",co=typeof Uint8Array>"u"?[]:new Uint8Array(256),Xu=0;Xu<cg.length;Xu++)co[cg.charCodeAt(Xu)]=Xu;for(var CI=function(u){var o=u.length*.75,l=u.length,c,p=0,g,_,v,B;u[u.length-1]==="="&&(o--,u[u.length-2]==="="&&o--);var E=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(o):new Array(o),x=Array.isArray(E)?E:new Uint8Array(E);for(c=0;c<l;c+=4)g=co[u.charCodeAt(c)],_=co[u.charCodeAt(c+1)],v=co[u.charCodeAt(c+2)],B=co[u.charCodeAt(c+3)],x[p++]=g<<2|_>>4,x[p++]=(_&15)<<4|v>>2,x[p++]=(v&3)<<6|B&63;return E},EI=function(u){for(var o=u.length,l=[],c=0;c<o;c+=2)l.push(u[c+1]<<8|u[c]);return l},xI=function(u){for(var o=u.length,l=[],c=0;c<o;c+=4)l.push(u[c+3]<<24|u[c+2]<<16|u[c+1]<<8|u[c]);return l},hs=5,zf=11,Gf=2,II=zf-hs,lg=65536>>hs,UI=1<<hs,Vf=UI-1,FI=1024>>hs,QI=lg+FI,TI=QI,OI=32,SI=TI+OI,PI=65536>>zf,RI=1<<II,kI=RI-1,fg=function(u,o,l){return u.slice?u.slice(o,l):new Uint16Array(Array.prototype.slice.call(u,o,l))},NI=function(u,o,l){return u.slice?u.slice(o,l):new Uint32Array(Array.prototype.slice.call(u,o,l))},LI=function(u,o){var l=CI(u),c=Array.isArray(l)?xI(l):new Uint32Array(l),p=Array.isArray(l)?EI(l):new Uint16Array(l),g=24,_=fg(p,g/2,c[4]/2),v=c[5]===2?fg(p,(g+c[4])/2):NI(c,Math.ceil((g+c[4])/4));return new HI(c[0],c[1],c[2],c[3],_,v)},HI=(function(){function u(o,l,c,p,g,_){this.initialValue=o,this.errorValue=l,this.highStart=c,this.highValueIndex=p,this.index=g,this.data=_}return u.prototype.get=function(o){var l;if(o>=0){if(o<55296||o>56319&&o<=65535)return l=this.index[o>>hs],l=(l<<Gf)+(o&Vf),this.data[l];if(o<=65535)return l=this.index[lg+(o-55296>>hs)],l=(l<<Gf)+(o&Vf),this.data[l];if(o<this.highStart)return l=SI-PI+(o>>zf),l=this.index[l],l+=o>>hs&kI,l=this.index[l],l=(l<<Gf)+(o&Vf),this.data[l];if(o<=1114111)return this.data[this.highValueIndex]}return this.errorValue},u})(),dg="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",DI=typeof Uint8Array>"u"?[]:new Uint8Array(256),Yu=0;Yu<dg.length;Yu++)DI[dg.charCodeAt(Yu)]=Yu;var MI=1,Zf=2,Jf=3,pg=4,hg=5,$I=7,mg=8,Wf=9,qf=10,gg=11,wg=12,yg=13,_g=14,Xf=15,jI=function(u){for(var o=[],l=0,c=u.length;l<c;){var p=u.charCodeAt(l++);if(p>=55296&&p<=56319&&l<c){var g=u.charCodeAt(l++);(g&64512)===56320?o.push(((p&1023)<<10)+(g&1023)+65536):(o.push(p),l--)}else o.push(p)}return o},KI=function(){for(var u=[],o=0;o<arguments.length;o++)u[o]=arguments[o];if(String.fromCodePoint)return String.fromCodePoint.apply(String,u);var l=u.length;if(!l)return"";for(var c=[],p=-1,g="";++p<l;){var _=u[p];_<=65535?c.push(_):(_-=65536,c.push((_>>10)+55296,_%1024+56320)),(p+1===l||c.length>16384)&&(g+=String.fromCharCode.apply(String,c),c.length=0)}return g},zI=LI(vI),$r="\xD7",Yf="\xF7",GI=function(u){return zI.get(u)},VI=function(u,o,l){var c=l-2,p=o[c],g=o[l-1],_=o[l];if(g===Zf&&_===Jf)return $r;if(g===Zf||g===Jf||g===pg||_===Zf||_===Jf||_===pg)return Yf;if(g===mg&&[mg,Wf,gg,wg].indexOf(_)!==-1||(g===gg||g===Wf)&&(_===Wf||_===qf)||(g===wg||g===qf)&&_===qf||_===yg||_===hg||_===$I||g===MI)return $r;if(g===yg&&_===_g){for(;p===hg;)p=o[--c];if(p===_g)return $r}if(g===Xf&&_===Xf){for(var v=0;p===Xf;)v++,p=o[--c];if(v%2===0)return $r}return Yf},ZI=function(u){var o=jI(u),l=o.length,c=0,p=0,g=o.map(GI);return{next:function(){if(c>=l)return{done:!0,value:null};for(var _=$r;c<l&&(_=VI(o,g,++c))===$r;);if(_!==$r||c===l){var v=KI.apply(null,o.slice(p,c));return p=c,{value:v,done:!1}}return{done:!0,value:null}}}},JI=function(u){for(var o=ZI(u),l=[],c;!(c=o.next()).done;)c.value&&l.push(c.value.slice());return l},WI=function(u){var o=123;if(u.createRange){var l=u.createRange();if(l.getBoundingClientRect){var c=u.createElement("boundtest");c.style.height=o+"px",c.style.display="block",u.body.appendChild(c),l.selectNode(c);var p=l.getBoundingClientRect(),g=Math.round(p.height);if(u.body.removeChild(c),g===o)return!0}}return!1},qI=function(u){var o=u.createElement("boundtest");o.style.width="50px",o.style.display="block",o.style.fontSize="12px",o.style.letterSpacing="0px",o.style.wordSpacing="0px",u.body.appendChild(o);var l=u.createRange();o.innerHTML=typeof"".repeat=="function"?"&#128104;".repeat(10):"";var c=o.firstChild,p=d(c.data).map(function(B){return h(B)}),g=0,_={},v=p.every(function(B,E){l.setStart(c,g),l.setEnd(c,g+B.length);var x=l.getBoundingClientRect();g+=B.length;var U=x.x>_.x||x.y>_.y;return _=x,E===0?!0:U});return u.body.removeChild(o),v},XI=function(){return typeof new Image().crossOrigin<"u"},YI=function(){return typeof new XMLHttpRequest().responseType=="string"},eU=function(u){var o=new Image,l=u.createElement("canvas"),c=l.getContext("2d");if(!c)return!1;o.src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>";try{c.drawImage(o,0,0),l.toDataURL()}catch{return!1}return!0},bg=function(u){return u[0]===0&&u[1]===255&&u[2]===0&&u[3]===255},tU=function(u){var o=u.createElement("canvas"),l=100;o.width=l,o.height=l;var c=o.getContext("2d");if(!c)return Promise.reject(!1);c.fillStyle="rgb(0, 255, 0)",c.fillRect(0,0,l,l);var p=new Image,g=o.toDataURL();p.src=g;var _=ed(l,l,0,0,p);return c.fillStyle="red",c.fillRect(0,0,l,l),Bg(_).then(function(v){c.drawImage(v,0,0);var B=c.getImageData(0,0,l,l).data;c.fillStyle="red",c.fillRect(0,0,l,l);var E=u.createElement("div");return E.style.backgroundImage="url("+g+")",E.style.height=l+"px",bg(B)?Bg(ed(l,l,0,0,E)):Promise.reject(!1)}).then(function(v){return c.drawImage(v,0,0),bg(c.getImageData(0,0,l,l).data)}).catch(function(){return!1})},ed=function(u,o,l,c,p){var g="http://www.w3.org/2000/svg",_=document.createElementNS(g,"svg"),v=document.createElementNS(g,"foreignObject");return _.setAttributeNS(null,"width",u.toString()),_.setAttributeNS(null,"height",o.toString()),v.setAttributeNS(null,"width","100%"),v.setAttributeNS(null,"height","100%"),v.setAttributeNS(null,"x",l.toString()),v.setAttributeNS(null,"y",c.toString()),v.setAttributeNS(null,"externalResourcesRequired","true"),_.appendChild(v),v.appendChild(p),_},Bg=function(u){return new Promise(function(o,l){var c=new Image;c.onload=function(){return o(c)},c.onerror=l,c.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(u))})},Lt={get SUPPORT_RANGE_BOUNDS(){var u=WI(document);return Object.defineProperty(Lt,"SUPPORT_RANGE_BOUNDS",{value:u}),u},get SUPPORT_WORD_BREAKING(){var u=Lt.SUPPORT_RANGE_BOUNDS&&qI(document);return Object.defineProperty(Lt,"SUPPORT_WORD_BREAKING",{value:u}),u},get SUPPORT_SVG_DRAWING(){var u=eU(document);return Object.defineProperty(Lt,"SUPPORT_SVG_DRAWING",{value:u}),u},get SUPPORT_FOREIGNOBJECT_DRAWING(){var u=typeof Array.from=="function"&&typeof window.fetch=="function"?tU(document):Promise.resolve(!1);return Object.defineProperty(Lt,"SUPPORT_FOREIGNOBJECT_DRAWING",{value:u}),u},get SUPPORT_CORS_IMAGES(){var u=XI();return Object.defineProperty(Lt,"SUPPORT_CORS_IMAGES",{value:u}),u},get SUPPORT_RESPONSE_TYPE(){var u=YI();return Object.defineProperty(Lt,"SUPPORT_RESPONSE_TYPE",{value:u}),u},get SUPPORT_CORS_XHR(){var u="withCredentials"in new XMLHttpRequest;return Object.defineProperty(Lt,"SUPPORT_CORS_XHR",{value:u}),u},get SUPPORT_NATIVE_TEXT_SEGMENTATION(){var u=!!(typeof Intl<"u"&&Intl.Segmenter);return Object.defineProperty(Lt,"SUPPORT_NATIVE_TEXT_SEGMENTATION",{value:u}),u}},lo=(function(){function u(o,l){this.text=o,this.bounds=l}return u})(),rU=function(u,o,l,c){var p=sU(o,l),g=[],_=0;return p.forEach(function(v){if(l.textDecorationLine.length||v.trim().length>0)if(Lt.SUPPORT_RANGE_BOUNDS){var B=vg(c,_,v.length).getClientRects();if(B.length>1){var E=td(v),x=0;E.forEach(function(S){g.push(new lo(S,i.fromDOMRectList(u,vg(c,x+_,S.length).getClientRects()))),x+=S.length})}else g.push(new lo(v,i.fromDOMRectList(u,B)))}else{var U=c.splitText(v.length);g.push(new lo(v,nU(u,c))),c=U}else Lt.SUPPORT_RANGE_BOUNDS||(c=c.splitText(v.length));_+=v.length}),g},nU=function(u,o){var l=o.ownerDocument;if(l){var c=l.createElement("html2canvaswrapper");c.appendChild(o.cloneNode(!0));var p=o.parentNode;if(p){p.replaceChild(c,o);var g=a(u,c);return c.firstChild&&p.replaceChild(c.firstChild,c),g}}return i.EMPTY},vg=function(u,o,l){var c=u.ownerDocument;if(!c)throw new Error("Node has no owner document");var p=c.createRange();return p.setStart(u,o),p.setEnd(u,o+l),p},td=function(u){if(Lt.SUPPORT_NATIVE_TEXT_SEGMENTATION){var o=new Intl.Segmenter(void 0,{granularity:"grapheme"});return Array.from(o.segment(u)).map(function(l){return l.segment})}return JI(u)},AU=function(u,o){if(Lt.SUPPORT_NATIVE_TEXT_SEGMENTATION){var l=new Intl.Segmenter(void 0,{granularity:"word"});return Array.from(l.segment(u)).map(function(c){return c.segment})}return aU(u,o)},sU=function(u,o){return o.letterSpacing!==0?td(u):AU(u,o)},iU=[32,160,4961,65792,65793,4153,4241],aU=function(u,o){for(var l=PC(u,{lineBreak:o.lineBreak,wordBreak:o.overflowWrap==="break-word"?"break-word":o.wordBreak}),c=[],p,g=function(){if(p.value){var _=p.value.slice(),v=d(_),B="";v.forEach(function(E){iU.indexOf(E)===-1?B+=h(E):(B.length&&c.push(B),c.push(h(E)),B="")}),B.length&&c.push(B)}};!(p=l.next()).done;)g();return c},oU=(function(){function u(o,l,c){this.text=uU(l.data,c.textTransform),this.textBounds=rU(o,this.text,c,l)}return u})(),uU=function(u,o){switch(o){case 1:return u.toLowerCase();case 3:return u.replace(cU,lU);case 2:return u.toUpperCase();default:return u}},cU=/(^|\s|:|-|\(|\))([a-z])/g,lU=function(u,o,l){return u.length>0?o+l.toUpperCase():u},Cg=(function(u){e(o,u);function o(l,c){var p=u.call(this,l,c)||this;return p.src=c.currentSrc||c.src,p.intrinsicWidth=c.naturalWidth,p.intrinsicHeight=c.naturalHeight,p.context.cache.addImage(p.src),p}return o})(vn),Eg=(function(u){e(o,u);function o(l,c){var p=u.call(this,l,c)||this;return p.canvas=c,p.intrinsicWidth=c.width,p.intrinsicHeight=c.height,p}return o})(vn),xg=(function(u){e(o,u);function o(l,c){var p=u.call(this,l,c)||this,g=new XMLSerializer,_=a(l,c);return c.setAttribute("width",_.width+"px"),c.setAttribute("height",_.height+"px"),p.svg="data:image/svg+xml,"+encodeURIComponent(g.serializeToString(c)),p.intrinsicWidth=c.width.baseVal.value,p.intrinsicHeight=c.height.baseVal.value,p.context.cache.addImage(p.svg),p}return o})(vn),Ig=(function(u){e(o,u);function o(l,c){var p=u.call(this,l,c)||this;return p.value=c.value,p}return o})(vn),rd=(function(u){e(o,u);function o(l,c){var p=u.call(this,l,c)||this;return p.start=c.start,p.reversed=typeof c.reversed=="boolean"&&c.reversed===!0,p}return o})(vn),fU=[{type:15,flags:0,unit:"px",number:3}],dU=[{type:16,flags:0,number:50}],pU=function(u){return u.width>u.height?new i(u.left+(u.width-u.height)/2,u.top,u.height,u.height):u.width<u.height?new i(u.left,u.top+(u.height-u.width)/2,u.width,u.width):u},hU=function(u){var o=u.type===mU?new Array(u.value.length+1).join("\u2022"):u.value;return o.length===0?u.placeholder||"":o},ec="checkbox",tc="radio",mU="password",Ug=707406591,nd=(function(u){e(o,u);function o(l,c){var p=u.call(this,l,c)||this;switch(p.type=c.type.toLowerCase(),p.checked=c.checked,p.value=hU(c),(p.type===ec||p.type===tc)&&(p.styles.backgroundColor=3739148031,p.styles.borderTopColor=p.styles.borderRightColor=p.styles.borderBottomColor=p.styles.borderLeftColor=2779096575,p.styles.borderTopWidth=p.styles.borderRightWidth=p.styles.borderBottomWidth=p.styles.borderLeftWidth=1,p.styles.borderTopStyle=p.styles.borderRightStyle=p.styles.borderBottomStyle=p.styles.borderLeftStyle=1,p.styles.backgroundClip=[0],p.styles.backgroundOrigin=[0],p.bounds=pU(p.bounds)),p.type){case ec:p.styles.borderTopRightRadius=p.styles.borderTopLeftRadius=p.styles.borderBottomRightRadius=p.styles.borderBottomLeftRadius=fU;break;case tc:p.styles.borderTopRightRadius=p.styles.borderTopLeftRadius=p.styles.borderBottomRightRadius=p.styles.borderBottomLeftRadius=dU;break}return p}return o})(vn),Fg=(function(u){e(o,u);function o(l,c){var p=u.call(this,l,c)||this,g=c.options[c.selectedIndex||0];return p.value=g&&g.text||"",p}return o})(vn),Qg=(function(u){e(o,u);function o(l,c){var p=u.call(this,l,c)||this;return p.value=c.value,p}return o})(vn),Tg=(function(u){e(o,u);function o(l,c){var p=u.call(this,l,c)||this;p.src=c.src,p.width=parseInt(c.width,10)||0,p.height=parseInt(c.height,10)||0,p.backgroundColor=p.styles.backgroundColor;try{if(c.contentWindow&&c.contentWindow.document&&c.contentWindow.document.documentElement){p.tree=Sg(l,c.contentWindow.document.documentElement);var g=c.contentWindow.document.documentElement?oo(l,getComputedStyle(c.contentWindow.document.documentElement).backgroundColor):Xn.TRANSPARENT,_=c.contentWindow.document.body?oo(l,getComputedStyle(c.contentWindow.document.body).backgroundColor):Xn.TRANSPARENT;p.backgroundColor=FA(g)?FA(_)?p.styles.backgroundColor:_:g}}catch{}return p}return o})(vn),gU=["OL","UL","MENU"],rc=function(u,o,l,c){for(var p=o.firstChild,g=void 0;p;p=g)if(g=p.nextSibling,Pg(p)&&p.data.trim().length>0)l.textNodes.push(new oU(u,p,l.styles));else if(Ui(p))if(Dg(p)&&p.assignedNodes)p.assignedNodes().forEach(function(v){return rc(u,v,l,c)});else{var _=Og(u,p);_.styles.isVisible()&&(wU(p,_,c)?_.flags|=4:yU(_.styles)&&(_.flags|=2),gU.indexOf(p.tagName)!==-1&&(_.flags|=8),l.elements.push(_),p.slot,p.shadowRoot?rc(u,p.shadowRoot,_,c):!Ac(p)&&!Rg(p)&&!sc(p)&&rc(u,p,_,c))}},Og=function(u,o){return id(o)?new Cg(u,o):kg(o)?new Eg(u,o):Rg(o)?new xg(u,o):_U(o)?new Ig(u,o):bU(o)?new rd(u,o):BU(o)?new nd(u,o):sc(o)?new Fg(u,o):Ac(o)?new Qg(u,o):Lg(o)?new Tg(u,o):new vn(u,o)},Sg=function(u,o){var l=Og(u,o);return l.flags|=4,rc(u,o,l,l),l},wU=function(u,o,l){return o.styles.isPositionedWithZIndex()||o.styles.opacity<1||o.styles.isTransformed()||sd(u)&&l.styles.isTransparent()},yU=function(u){return u.isPositioned()||u.isFloating()},Pg=function(u){return u.nodeType===Node.TEXT_NODE},Ui=function(u){return u.nodeType===Node.ELEMENT_NODE},Ad=function(u){return Ui(u)&&typeof u.style<"u"&&!nc(u)},nc=function(u){return typeof u.className=="object"},_U=function(u){return u.tagName==="LI"},bU=function(u){return u.tagName==="OL"},BU=function(u){return u.tagName==="INPUT"},vU=function(u){return u.tagName==="HTML"},Rg=function(u){return u.tagName==="svg"},sd=function(u){return u.tagName==="BODY"},kg=function(u){return u.tagName==="CANVAS"},Ng=function(u){return u.tagName==="VIDEO"},id=function(u){return u.tagName==="IMG"},Lg=function(u){return u.tagName==="IFRAME"},Hg=function(u){return u.tagName==="STYLE"},CU=function(u){return u.tagName==="SCRIPT"},Ac=function(u){return u.tagName==="TEXTAREA"},sc=function(u){return u.tagName==="SELECT"},Dg=function(u){return u.tagName==="SLOT"},Mg=function(u){return u.tagName.indexOf("-")>0},EU=(function(){function u(){this.counters={}}return u.prototype.getCounterValue=function(o){var l=this.counters[o];return l&&l.length?l[l.length-1]:1},u.prototype.getCounterValues=function(o){var l=this.counters[o];return l||[]},u.prototype.pop=function(o){var l=this;o.forEach(function(c){return l.counters[c].pop()})},u.prototype.parse=function(o){var l=this,c=o.counterIncrement,p=o.counterReset,g=!0;c!==null&&c.forEach(function(v){var B=l.counters[v.counter];B&&v.increment!==0&&(g=!1,B.length||B.push(1),B[Math.max(0,B.length-1)]+=v.increment)});var _=[];return g&&p.forEach(function(v){var B=l.counters[v.counter];_.push(v.counter),B||(B=l.counters[v.counter]=[]),B.push(v.reset)}),_},u})(),$g={integers:[1e3,900,500,400,100,90,50,40,10,9,5,4,1],values:["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"]},jg={integers:[9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["\u0554","\u0553","\u0552","\u0551","\u0550","\u054F","\u054E","\u054D","\u054C","\u054B","\u054A","\u0549","\u0548","\u0547","\u0546","\u0545","\u0544","\u0543","\u0542","\u0541","\u0540","\u053F","\u053E","\u053D","\u053C","\u053B","\u053A","\u0539","\u0538","\u0537","\u0536","\u0535","\u0534","\u0533","\u0532","\u0531"]},xU={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,400,300,200,100,90,80,70,60,50,40,30,20,19,18,17,16,15,10,9,8,7,6,5,4,3,2,1],values:["\u05D9\u05F3","\u05D8\u05F3","\u05D7\u05F3","\u05D6\u05F3","\u05D5\u05F3","\u05D4\u05F3","\u05D3\u05F3","\u05D2\u05F3","\u05D1\u05F3","\u05D0\u05F3","\u05EA","\u05E9","\u05E8","\u05E7","\u05E6","\u05E4","\u05E2","\u05E1","\u05E0","\u05DE","\u05DC","\u05DB","\u05D9\u05D8","\u05D9\u05D7","\u05D9\u05D6","\u05D8\u05D6","\u05D8\u05D5","\u05D9","\u05D8","\u05D7","\u05D6","\u05D5","\u05D4","\u05D3","\u05D2","\u05D1","\u05D0"]},IU={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["\u10F5","\u10F0","\u10EF","\u10F4","\u10EE","\u10ED","\u10EC","\u10EB","\u10EA","\u10E9","\u10E8","\u10E7","\u10E6","\u10E5","\u10E4","\u10F3","\u10E2","\u10E1","\u10E0","\u10DF","\u10DE","\u10DD","\u10F2","\u10DC","\u10DB","\u10DA","\u10D9","\u10D8","\u10D7","\u10F1","\u10D6","\u10D5","\u10D4","\u10D3","\u10D2","\u10D1","\u10D0"]},Fi=function(u,o,l,c,p,g){return u<o||u>l?po(u,p,g.length>0):c.integers.reduce(function(_,v,B){for(;u>=v;)u-=v,_+=c.values[B];return _},"")+g},Kg=function(u,o,l,c){var p="";do l||u--,p=c(u)+p,u/=o;while(u*o>=o);return p},lt=function(u,o,l,c,p){var g=l-o+1;return(u<0?"-":"")+(Kg(Math.abs(u),g,c,function(_){return h(Math.floor(_%g)+o)})+p)},ms=function(u,o,l){l===void 0&&(l=". ");var c=o.length;return Kg(Math.abs(u),c,!1,function(p){return o[Math.floor(p%c)]})+l},Qi=1,TA=2,OA=4,fo=8,Yn=function(u,o,l,c,p,g){if(u<-9999||u>9999)return po(u,4,p.length>0);var _=Math.abs(u),v=p;if(_===0)return o[0]+v;for(var B=0;_>0&&B<=4;B++){var E=_%10;E===0&&bt(g,Qi)&&v!==""?v=o[E]+v:E>1||E===1&&B===0||E===1&&B===1&&bt(g,TA)||E===1&&B===1&&bt(g,OA)&&u>100||E===1&&B>1&&bt(g,fo)?v=o[E]+(B>0?l[B-1]:"")+v:E===1&&B>0&&(v=l[B-1]+v),_=Math.floor(_/10)}return(u<0?c:"")+v},zg="\u5341\u767E\u5343\u842C",Gg="\u62FE\u4F70\u4EDF\u842C",Vg="\u30DE\u30A4\u30CA\u30B9",ad="\uB9C8\uC774\uB108\uC2A4",po=function(u,o,l){var c=l?". ":"",p=l?"\u3001":"",g=l?", ":"",_=l?" ":"";switch(o){case 0:return"\u2022"+_;case 1:return"\u25E6"+_;case 2:return"\u25FE"+_;case 5:var v=lt(u,48,57,!0,c);return v.length<4?"0"+v:v;case 4:return ms(u,"\u3007\u4E00\u4E8C\u4E09\u56DB\u4E94\u516D\u4E03\u516B\u4E5D",p);case 6:return Fi(u,1,3999,$g,3,c).toLowerCase();case 7:return Fi(u,1,3999,$g,3,c);case 8:return lt(u,945,969,!1,c);case 9:return lt(u,97,122,!1,c);case 10:return lt(u,65,90,!1,c);case 11:return lt(u,1632,1641,!0,c);case 12:case 49:return Fi(u,1,9999,jg,3,c);case 35:return Fi(u,1,9999,jg,3,c).toLowerCase();case 13:return lt(u,2534,2543,!0,c);case 14:case 30:return lt(u,6112,6121,!0,c);case 15:return ms(u,"\u5B50\u4E11\u5BC5\u536F\u8FB0\u5DF3\u5348\u672A\u7533\u9149\u620C\u4EA5",p);case 16:return ms(u,"\u7532\u4E59\u4E19\u4E01\u620A\u5DF1\u5E9A\u8F9B\u58EC\u7678",p);case 17:case 48:return Yn(u,"\u96F6\u4E00\u4E8C\u4E09\u56DB\u4E94\u516D\u4E03\u516B\u4E5D",zg,"\u8CA0",p,TA|OA|fo);case 47:return Yn(u,"\u96F6\u58F9\u8CB3\u53C3\u8086\u4F0D\u9678\u67D2\u634C\u7396",Gg,"\u8CA0",p,Qi|TA|OA|fo);case 42:return Yn(u,"\u96F6\u4E00\u4E8C\u4E09\u56DB\u4E94\u516D\u4E03\u516B\u4E5D",zg,"\u8D1F",p,TA|OA|fo);case 41:return Yn(u,"\u96F6\u58F9\u8D30\u53C1\u8086\u4F0D\u9646\u67D2\u634C\u7396",Gg,"\u8D1F",p,Qi|TA|OA|fo);case 26:return Yn(u,"\u3007\u4E00\u4E8C\u4E09\u56DB\u4E94\u516D\u4E03\u516B\u4E5D","\u5341\u767E\u5343\u4E07",Vg,p,0);case 25:return Yn(u,"\u96F6\u58F1\u5F10\u53C2\u56DB\u4F0D\u516D\u4E03\u516B\u4E5D","\u62FE\u767E\u5343\u4E07",Vg,p,Qi|TA|OA);case 31:return Yn(u,"\uC601\uC77C\uC774\uC0BC\uC0AC\uC624\uC721\uCE60\uD314\uAD6C","\uC2ED\uBC31\uCC9C\uB9CC",ad,g,Qi|TA|OA);case 33:return Yn(u,"\u96F6\u4E00\u4E8C\u4E09\u56DB\u4E94\u516D\u4E03\u516B\u4E5D","\u5341\u767E\u5343\u842C",ad,g,0);case 32:return Yn(u,"\u96F6\u58F9\u8CB3\u53C3\u56DB\u4E94\u516D\u4E03\u516B\u4E5D","\u62FE\u767E\u5343",ad,g,Qi|TA|OA);case 18:return lt(u,2406,2415,!0,c);case 20:return Fi(u,1,19999,IU,3,c);case 21:return lt(u,2790,2799,!0,c);case 22:return lt(u,2662,2671,!0,c);case 22:return Fi(u,1,10999,xU,3,c);case 23:return ms(u,"\u3042\u3044\u3046\u3048\u304A\u304B\u304D\u304F\u3051\u3053\u3055\u3057\u3059\u305B\u305D\u305F\u3061\u3064\u3066\u3068\u306A\u306B\u306C\u306D\u306E\u306F\u3072\u3075\u3078\u307B\u307E\u307F\u3080\u3081\u3082\u3084\u3086\u3088\u3089\u308A\u308B\u308C\u308D\u308F\u3090\u3091\u3092\u3093");case 24:return ms(u,"\u3044\u308D\u306F\u306B\u307B\u3078\u3068\u3061\u308A\u306C\u308B\u3092\u308F\u304B\u3088\u305F\u308C\u305D\u3064\u306D\u306A\u3089\u3080\u3046\u3090\u306E\u304A\u304F\u3084\u307E\u3051\u3075\u3053\u3048\u3066\u3042\u3055\u304D\u3086\u3081\u307F\u3057\u3091\u3072\u3082\u305B\u3059");case 27:return lt(u,3302,3311,!0,c);case 28:return ms(u,"\u30A2\u30A4\u30A6\u30A8\u30AA\u30AB\u30AD\u30AF\u30B1\u30B3\u30B5\u30B7\u30B9\u30BB\u30BD\u30BF\u30C1\u30C4\u30C6\u30C8\u30CA\u30CB\u30CC\u30CD\u30CE\u30CF\u30D2\u30D5\u30D8\u30DB\u30DE\u30DF\u30E0\u30E1\u30E2\u30E4\u30E6\u30E8\u30E9\u30EA\u30EB\u30EC\u30ED\u30EF\u30F0\u30F1\u30F2\u30F3",p);case 29:return ms(u,"\u30A4\u30ED\u30CF\u30CB\u30DB\u30D8\u30C8\u30C1\u30EA\u30CC\u30EB\u30F2\u30EF\u30AB\u30E8\u30BF\u30EC\u30BD\u30C4\u30CD\u30CA\u30E9\u30E0\u30A6\u30F0\u30CE\u30AA\u30AF\u30E4\u30DE\u30B1\u30D5\u30B3\u30A8\u30C6\u30A2\u30B5\u30AD\u30E6\u30E1\u30DF\u30B7\u30F1\u30D2\u30E2\u30BB\u30B9",p);case 34:return lt(u,3792,3801,!0,c);case 37:return lt(u,6160,6169,!0,c);case 38:return lt(u,4160,4169,!0,c);case 39:return lt(u,2918,2927,!0,c);case 40:return lt(u,1776,1785,!0,c);case 43:return lt(u,3046,3055,!0,c);case 44:return lt(u,3174,3183,!0,c);case 45:return lt(u,3664,3673,!0,c);case 46:return lt(u,3872,3881,!0,c);case 3:default:return lt(u,48,57,!0,c)}},Zg="data-html2canvas-ignore",Jg=(function(){function u(o,l,c){if(this.context=o,this.options=c,this.scrolledElements=[],this.referenceElement=l,this.counters=new EU,this.quoteDepth=0,!l.ownerDocument)throw new Error("Cloned element does not have an owner document");this.documentElement=this.cloneNode(l.ownerDocument.documentElement,!1)}return u.prototype.toIFrame=function(o,l){var c=this,p=UU(o,l);if(!p.contentWindow)return Promise.reject("Unable to find iframe window");var g=o.defaultView.pageXOffset,_=o.defaultView.pageYOffset,v=p.contentWindow,B=v.document,E=TU(p).then(function(){return n(c,void 0,void 0,function(){var x,U;return A(this,function(S){switch(S.label){case 0:return this.scrolledElements.forEach(RU),v&&(v.scrollTo(l.left,l.top),/(iPad|iPhone|iPod)/g.test(navigator.userAgent)&&(v.scrollY!==l.top||v.scrollX!==l.left)&&(this.context.logger.warn("Unable to restore scroll position for cloned document"),this.context.windowBounds=this.context.windowBounds.add(v.scrollX-l.left,v.scrollY-l.top,0,0))),x=this.options.onclone,U=this.clonedReferenceElement,typeof U>"u"?[2,Promise.reject("Error finding the "+this.referenceElement.nodeName+" in the cloned document")]:B.fonts&&B.fonts.ready?[4,B.fonts.ready]:[3,2];case 1:S.sent(),S.label=2;case 2:return/(AppleWebKit)/g.test(navigator.userAgent)?[4,QU(B)]:[3,4];case 3:S.sent(),S.label=4;case 4:return typeof x=="function"?[2,Promise.resolve().then(function(){return x(B,U)}).then(function(){return p})]:[2,p]}})})});return B.open(),B.write(SU(document.doctype)+"<html></html>"),PU(this.referenceElement.ownerDocument,g,_),B.replaceChild(B.adoptNode(this.documentElement),B.documentElement),B.close(),E},u.prototype.createElementClone=function(o){if(Kf(o,2))debugger;if(kg(o))return this.createCanvasClone(o);if(Ng(o))return this.createVideoClone(o);if(Hg(o))return this.createStyleClone(o);var l=o.cloneNode(!1);return id(l)&&(id(o)&&o.currentSrc&&o.currentSrc!==o.src&&(l.src=o.currentSrc,l.srcset=""),l.loading==="lazy"&&(l.loading="eager")),Mg(l)?this.createCustomElementClone(l):l},u.prototype.createCustomElementClone=function(o){var l=document.createElement("html2canvascustomelement");return od(o.style,l),l},u.prototype.createStyleClone=function(o){try{var l=o.sheet;if(l&&l.cssRules){var c=[].slice.call(l.cssRules,0).reduce(function(g,_){return _&&typeof _.cssText=="string"?g+_.cssText:g},""),p=o.cloneNode(!1);return p.textContent=c,p}}catch(g){if(this.context.logger.error("Unable to access cssRules property",g),g.name!=="SecurityError")throw g}return o.cloneNode(!1)},u.prototype.createCanvasClone=function(o){var l;if(this.options.inlineImages&&o.ownerDocument){var c=o.ownerDocument.createElement("img");try{return c.src=o.toDataURL(),c}catch{this.context.logger.info("Unable to inline canvas contents, canvas is tainted",o)}}var p=o.cloneNode(!1);try{p.width=o.width,p.height=o.height;var g=o.getContext("2d"),_=p.getContext("2d");if(_)if(!this.options.allowTaint&&g)_.putImageData(g.getImageData(0,0,o.width,o.height),0,0);else{var v=(l=o.getContext("webgl2"))!==null&&l!==void 0?l:o.getContext("webgl");if(v){var B=v.getContextAttributes();B?.preserveDrawingBuffer===!1&&this.context.logger.warn("Unable to clone WebGL context as it has preserveDrawingBuffer=false",o)}_.drawImage(o,0,0)}return p}catch{this.context.logger.info("Unable to clone canvas as it is tainted",o)}return p},u.prototype.createVideoClone=function(o){var l=o.ownerDocument.createElement("canvas");l.width=o.offsetWidth,l.height=o.offsetHeight;var c=l.getContext("2d");try{return c&&(c.drawImage(o,0,0,l.width,l.height),this.options.allowTaint||c.getImageData(0,0,l.width,l.height)),l}catch{this.context.logger.info("Unable to clone video as it is tainted",o)}var p=o.ownerDocument.createElement("canvas");return p.width=o.offsetWidth,p.height=o.offsetHeight,p},u.prototype.appendChildNode=function(o,l,c){(!Ui(l)||!CU(l)&&!l.hasAttribute(Zg)&&(typeof this.options.ignoreElements!="function"||!this.options.ignoreElements(l)))&&(!this.options.copyStyles||!Ui(l)||!Hg(l))&&o.appendChild(this.cloneNode(l,c))},u.prototype.cloneChildNodes=function(o,l,c){for(var p=this,g=o.shadowRoot?o.shadowRoot.firstChild:o.firstChild;g;g=g.nextSibling)if(Ui(g)&&Dg(g)&&typeof g.assignedNodes=="function"){var _=g.assignedNodes();_.length&&_.forEach(function(v){return p.appendChildNode(l,v,c)})}else this.appendChildNode(l,g,c)},u.prototype.cloneNode=function(o,l){if(Pg(o))return document.createTextNode(o.data);if(!o.ownerDocument)return o.cloneNode(!1);var c=o.ownerDocument.defaultView;if(c&&Ui(o)&&(Ad(o)||nc(o))){var p=this.createElementClone(o);p.style.transitionProperty="none";var g=c.getComputedStyle(o),_=c.getComputedStyle(o,":before"),v=c.getComputedStyle(o,":after");this.referenceElement===o&&Ad(p)&&(this.clonedReferenceElement=p),sd(p)&&LU(p);var B=this.counters.parse(new ug(this.context,g)),E=this.resolvePseudoContent(o,p,_,ho.BEFORE);Mg(o)&&(l=!0),Ng(o)||this.cloneChildNodes(o,p,l),E&&p.insertBefore(E,p.firstChild);var x=this.resolvePseudoContent(o,p,v,ho.AFTER);return x&&p.appendChild(x),this.counters.pop(B),(g&&(this.options.copyStyles||nc(o))&&!Lg(o)||l)&&od(g,p),(o.scrollTop!==0||o.scrollLeft!==0)&&this.scrolledElements.push([p,o.scrollLeft,o.scrollTop]),(Ac(o)||sc(o))&&(Ac(p)||sc(p))&&(p.value=o.value),p}return o.cloneNode(!1)},u.prototype.resolvePseudoContent=function(o,l,c,p){var g=this;if(c){var _=c.content,v=l.ownerDocument;if(!(!v||!_||_==="none"||_==="-moz-alt-content"||c.display==="none")){this.counters.parse(new ug(this.context,c));var B=new _I(this.context,c),E=v.createElement("html2canvaspseudoelement");od(c,E),B.content.forEach(function(U){if(U.type===0)E.appendChild(v.createTextNode(U.value));else if(U.type===22){var S=v.createElement("img");S.src=U.value,S.style.opacity="1",E.appendChild(S)}else if(U.type===18){if(U.name==="attr"){var Z=U.values.filter(Je);Z.length&&E.appendChild(v.createTextNode(o.getAttribute(Z[0].value)||""))}else if(U.name==="counter"){var H=U.values.filter(xi),j=H[0],Oe=H[1];if(j&&Je(j)){var se=g.counters.getCounterValue(j.value),ne=Oe&&Je(Oe)?jf.parse(g.context,Oe.value):3;E.appendChild(v.createTextNode(po(se,ne,!1)))}}else if(U.name==="counters"){var ze=U.values.filter(xi),j=ze[0],Pe=ze[1],Oe=ze[2];if(j&&Je(j)){var Ee=g.counters.getCounterValues(j.value),G=Oe&&Je(Oe)?jf.parse(g.context,Oe.value):3,je=Pe&&Pe.type===0?Pe.value:"",Ke=Ee.map(function(pr){return po(pr,G,!1)}).join(je);E.appendChild(v.createTextNode(Ke))}}}else if(U.type===20)switch(U.value){case"open-quote":E.appendChild(v.createTextNode(og(B.quotes,g.quoteDepth++,!0)));break;case"close-quote":E.appendChild(v.createTextNode(og(B.quotes,--g.quoteDepth,!1)));break;default:E.appendChild(v.createTextNode(U.value))}}),E.className=ud+" "+cd;var x=p===ho.BEFORE?" "+ud:" "+cd;return nc(l)?l.className.baseValue+=x:l.className+=x,E}}},u.destroy=function(o){return o.parentNode?(o.parentNode.removeChild(o),!0):!1},u})(),ho;(function(u){u[u.BEFORE=0]="BEFORE",u[u.AFTER=1]="AFTER"})(ho||(ho={}));var UU=function(u,o){var l=u.createElement("iframe");return l.className="html2canvas-container",l.style.visibility="hidden",l.style.position="fixed",l.style.left="-10000px",l.style.top="0px",l.style.border="0",l.width=o.width.toString(),l.height=o.height.toString(),l.scrolling="no",l.setAttribute(Zg,"true"),u.body.appendChild(l),l},FU=function(u){return new Promise(function(o){if(u.complete){o();return}if(!u.src){o();return}u.onload=o,u.onerror=o})},QU=function(u){return Promise.all([].slice.call(u.images,0).map(FU))},TU=function(u){return new Promise(function(o,l){var c=u.contentWindow;if(!c)return l("No window assigned for iframe");var p=c.document;c.onload=u.onload=function(){c.onload=u.onload=null;var g=setInterval(function(){p.body.childNodes.length>0&&p.readyState==="complete"&&(clearInterval(g),o(u))},50)}})},OU=["all","d","content"],od=function(u,o){for(var l=u.length-1;l>=0;l--){var c=u.item(l);OU.indexOf(c)===-1&&o.style.setProperty(c,u.getPropertyValue(c))}return o},SU=function(u){var o="";return u&&(o+="<!DOCTYPE ",u.name&&(o+=u.name),u.internalSubset&&(o+=u.internalSubset),u.publicId&&(o+='"'+u.publicId+'"'),u.systemId&&(o+='"'+u.systemId+'"'),o+=">"),o},PU=function(u,o,l){u&&u.defaultView&&(o!==u.defaultView.pageXOffset||l!==u.defaultView.pageYOffset)&&u.defaultView.scrollTo(o,l)},RU=function(u){var o=u[0],l=u[1],c=u[2];o.scrollLeft=l,o.scrollTop=c},kU=":before",NU=":after",ud="___html2canvas___pseudoelement_before",cd="___html2canvas___pseudoelement_after",Wg=`{
    content: "" !important;
    display: none !important;
}`,LU=function(u){HU(u,"."+ud+kU+Wg+`
         .`+cd+NU+Wg)},HU=function(u,o){var l=u.ownerDocument;if(l){var c=l.createElement("style");c.textContent=o,u.appendChild(c)}},qg=(function(){function u(){}return u.getOrigin=function(o){var l=u._link;return l?(l.href=o,l.href=l.href,l.protocol+l.hostname+l.port):"about:blank"},u.isSameOrigin=function(o){return u.getOrigin(o)===u._origin},u.setContext=function(o){u._link=o.document.createElement("a"),u._origin=u.getOrigin(o.location.href)},u._origin="about:blank",u})(),DU=(function(){function u(o,l){this.context=o,this._options=l,this._cache={}}return u.prototype.addImage=function(o){var l=Promise.resolve();return this.has(o)||(fd(o)||KU(o))&&(this._cache[o]=this.loadImage(o)).catch(function(){}),l},u.prototype.match=function(o){return this._cache[o]},u.prototype.loadImage=function(o){return n(this,void 0,void 0,function(){var l,c,p,g,_=this;return A(this,function(v){switch(v.label){case 0:return l=qg.isSameOrigin(o),c=!ld(o)&&this._options.useCORS===!0&&Lt.SUPPORT_CORS_IMAGES&&!l,p=!ld(o)&&!l&&!fd(o)&&typeof this._options.proxy=="string"&&Lt.SUPPORT_CORS_XHR&&!c,!l&&this._options.allowTaint===!1&&!ld(o)&&!fd(o)&&!p&&!c?[2]:(g=o,p?[4,this.proxy(g)]:[3,2]);case 1:g=v.sent(),v.label=2;case 2:return this.context.logger.debug("Added image "+o.substring(0,256)),[4,new Promise(function(B,E){var x=new Image;x.onload=function(){return B(x)},x.onerror=E,(zU(g)||c)&&(x.crossOrigin="anonymous"),x.src=g,x.complete===!0&&setTimeout(function(){return B(x)},500),_._options.imageTimeout>0&&setTimeout(function(){return E("Timed out ("+_._options.imageTimeout+"ms) loading image")},_._options.imageTimeout)})];case 3:return[2,v.sent()]}})})},u.prototype.has=function(o){return typeof this._cache[o]<"u"},u.prototype.keys=function(){return Promise.resolve(Object.keys(this._cache))},u.prototype.proxy=function(o){var l=this,c=this._options.proxy;if(!c)throw new Error("No proxy defined");var p=o.substring(0,256);return new Promise(function(g,_){var v=Lt.SUPPORT_RESPONSE_TYPE?"blob":"text",B=new XMLHttpRequest;B.onload=function(){if(B.status===200)if(v==="text")g(B.response);else{var U=new FileReader;U.addEventListener("load",function(){return g(U.result)},!1),U.addEventListener("error",function(S){return _(S)},!1),U.readAsDataURL(B.response)}else _("Failed to proxy resource "+p+" with status code "+B.status)},B.onerror=_;var E=c.indexOf("?")>-1?"&":"?";if(B.open("GET",""+c+E+"url="+encodeURIComponent(o)+"&responseType="+v),v!=="text"&&B instanceof XMLHttpRequest&&(B.responseType=v),l._options.imageTimeout){var x=l._options.imageTimeout;B.timeout=x,B.ontimeout=function(){return _("Timed out ("+x+"ms) proxying "+p)}}B.send()})},u})(),MU=/^data:image\/svg\+xml/i,$U=/^data:image\/.*;base64,/i,jU=/^data:image\/.*/i,KU=function(u){return Lt.SUPPORT_SVG_DRAWING||!GU(u)},ld=function(u){return jU.test(u)},zU=function(u){return $U.test(u)},fd=function(u){return u.substr(0,4)==="blob"},GU=function(u){return u.substr(-3).toLowerCase()==="svg"||MU.test(u)},z=(function(){function u(o,l){this.type=0,this.x=o,this.y=l}return u.prototype.add=function(o,l){return new u(this.x+o,this.y+l)},u})(),Ti=function(u,o,l){return new z(u.x+(o.x-u.x)*l,u.y+(o.y-u.y)*l)},ic=(function(){function u(o,l,c,p){this.type=1,this.start=o,this.startControl=l,this.endControl=c,this.end=p}return u.prototype.subdivide=function(o,l){var c=Ti(this.start,this.startControl,o),p=Ti(this.startControl,this.endControl,o),g=Ti(this.endControl,this.end,o),_=Ti(c,p,o),v=Ti(p,g,o),B=Ti(_,v,o);return l?new u(this.start,c,_,B):new u(B,v,g,this.end)},u.prototype.add=function(o,l){return new u(this.start.add(o,l),this.startControl.add(o,l),this.endControl.add(o,l),this.end.add(o,l))},u.prototype.reverse=function(){return new u(this.end,this.endControl,this.startControl,this.start)},u})(),jr=function(u){return u.type===1},VU=(function(){function u(o){var l=o.styles,c=o.bounds,p=ao(l.borderTopLeftRadius,c.width,c.height),g=p[0],_=p[1],v=ao(l.borderTopRightRadius,c.width,c.height),B=v[0],E=v[1],x=ao(l.borderBottomRightRadius,c.width,c.height),U=x[0],S=x[1],Z=ao(l.borderBottomLeftRadius,c.width,c.height),H=Z[0],j=Z[1],Oe=[];Oe.push((g+B)/c.width),Oe.push((H+U)/c.width),Oe.push((_+j)/c.height),Oe.push((E+S)/c.height);var se=Math.max.apply(Math,Oe);se>1&&(g/=se,_/=se,B/=se,E/=se,U/=se,S/=se,H/=se,j/=se);var ne=c.width-B,ze=c.height-S,Pe=c.width-U,Ee=c.height-j,G=l.borderTopWidth,je=l.borderRightWidth,Ke=l.borderBottomWidth,xe=l.borderLeftWidth,wt=Xe(l.paddingTop,o.bounds.width),pr=Xe(l.paddingRight,o.bounds.width),Ir=Xe(l.paddingBottom,o.bounds.width),We=Xe(l.paddingLeft,o.bounds.width);this.topLeftBorderDoubleOuterBox=g>0||_>0?rt(c.left+xe/3,c.top+G/3,g-xe/3,_-G/3,Ve.TOP_LEFT):new z(c.left+xe/3,c.top+G/3),this.topRightBorderDoubleOuterBox=g>0||_>0?rt(c.left+ne,c.top+G/3,B-je/3,E-G/3,Ve.TOP_RIGHT):new z(c.left+c.width-je/3,c.top+G/3),this.bottomRightBorderDoubleOuterBox=U>0||S>0?rt(c.left+Pe,c.top+ze,U-je/3,S-Ke/3,Ve.BOTTOM_RIGHT):new z(c.left+c.width-je/3,c.top+c.height-Ke/3),this.bottomLeftBorderDoubleOuterBox=H>0||j>0?rt(c.left+xe/3,c.top+Ee,H-xe/3,j-Ke/3,Ve.BOTTOM_LEFT):new z(c.left+xe/3,c.top+c.height-Ke/3),this.topLeftBorderDoubleInnerBox=g>0||_>0?rt(c.left+xe*2/3,c.top+G*2/3,g-xe*2/3,_-G*2/3,Ve.TOP_LEFT):new z(c.left+xe*2/3,c.top+G*2/3),this.topRightBorderDoubleInnerBox=g>0||_>0?rt(c.left+ne,c.top+G*2/3,B-je*2/3,E-G*2/3,Ve.TOP_RIGHT):new z(c.left+c.width-je*2/3,c.top+G*2/3),this.bottomRightBorderDoubleInnerBox=U>0||S>0?rt(c.left+Pe,c.top+ze,U-je*2/3,S-Ke*2/3,Ve.BOTTOM_RIGHT):new z(c.left+c.width-je*2/3,c.top+c.height-Ke*2/3),this.bottomLeftBorderDoubleInnerBox=H>0||j>0?rt(c.left+xe*2/3,c.top+Ee,H-xe*2/3,j-Ke*2/3,Ve.BOTTOM_LEFT):new z(c.left+xe*2/3,c.top+c.height-Ke*2/3),this.topLeftBorderStroke=g>0||_>0?rt(c.left+xe/2,c.top+G/2,g-xe/2,_-G/2,Ve.TOP_LEFT):new z(c.left+xe/2,c.top+G/2),this.topRightBorderStroke=g>0||_>0?rt(c.left+ne,c.top+G/2,B-je/2,E-G/2,Ve.TOP_RIGHT):new z(c.left+c.width-je/2,c.top+G/2),this.bottomRightBorderStroke=U>0||S>0?rt(c.left+Pe,c.top+ze,U-je/2,S-Ke/2,Ve.BOTTOM_RIGHT):new z(c.left+c.width-je/2,c.top+c.height-Ke/2),this.bottomLeftBorderStroke=H>0||j>0?rt(c.left+xe/2,c.top+Ee,H-xe/2,j-Ke/2,Ve.BOTTOM_LEFT):new z(c.left+xe/2,c.top+c.height-Ke/2),this.topLeftBorderBox=g>0||_>0?rt(c.left,c.top,g,_,Ve.TOP_LEFT):new z(c.left,c.top),this.topRightBorderBox=B>0||E>0?rt(c.left+ne,c.top,B,E,Ve.TOP_RIGHT):new z(c.left+c.width,c.top),this.bottomRightBorderBox=U>0||S>0?rt(c.left+Pe,c.top+ze,U,S,Ve.BOTTOM_RIGHT):new z(c.left+c.width,c.top+c.height),this.bottomLeftBorderBox=H>0||j>0?rt(c.left,c.top+Ee,H,j,Ve.BOTTOM_LEFT):new z(c.left,c.top+c.height),this.topLeftPaddingBox=g>0||_>0?rt(c.left+xe,c.top+G,Math.max(0,g-xe),Math.max(0,_-G),Ve.TOP_LEFT):new z(c.left+xe,c.top+G),this.topRightPaddingBox=B>0||E>0?rt(c.left+Math.min(ne,c.width-je),c.top+G,ne>c.width+je?0:Math.max(0,B-je),Math.max(0,E-G),Ve.TOP_RIGHT):new z(c.left+c.width-je,c.top+G),this.bottomRightPaddingBox=U>0||S>0?rt(c.left+Math.min(Pe,c.width-xe),c.top+Math.min(ze,c.height-Ke),Math.max(0,U-je),Math.max(0,S-Ke),Ve.BOTTOM_RIGHT):new z(c.left+c.width-je,c.top+c.height-Ke),this.bottomLeftPaddingBox=H>0||j>0?rt(c.left+xe,c.top+Math.min(Ee,c.height-Ke),Math.max(0,H-xe),Math.max(0,j-Ke),Ve.BOTTOM_LEFT):new z(c.left+xe,c.top+c.height-Ke),this.topLeftContentBox=g>0||_>0?rt(c.left+xe+We,c.top+G+wt,Math.max(0,g-(xe+We)),Math.max(0,_-(G+wt)),Ve.TOP_LEFT):new z(c.left+xe+We,c.top+G+wt),this.topRightContentBox=B>0||E>0?rt(c.left+Math.min(ne,c.width+xe+We),c.top+G+wt,ne>c.width+xe+We?0:B-xe+We,E-(G+wt),Ve.TOP_RIGHT):new z(c.left+c.width-(je+pr),c.top+G+wt),this.bottomRightContentBox=U>0||S>0?rt(c.left+Math.min(Pe,c.width-(xe+We)),c.top+Math.min(ze,c.height+G+wt),Math.max(0,U-(je+pr)),S-(Ke+Ir),Ve.BOTTOM_RIGHT):new z(c.left+c.width-(je+pr),c.top+c.height-(Ke+Ir)),this.bottomLeftContentBox=H>0||j>0?rt(c.left+xe+We,c.top+Ee,Math.max(0,H-(xe+We)),j-(Ke+Ir),Ve.BOTTOM_LEFT):new z(c.left+xe+We,c.top+c.height-(Ke+Ir))}return u})(),Ve;(function(u){u[u.TOP_LEFT=0]="TOP_LEFT",u[u.TOP_RIGHT=1]="TOP_RIGHT",u[u.BOTTOM_RIGHT=2]="BOTTOM_RIGHT",u[u.BOTTOM_LEFT=3]="BOTTOM_LEFT"})(Ve||(Ve={}));var rt=function(u,o,l,c,p){var g=4*((Math.sqrt(2)-1)/3),_=l*g,v=c*g,B=u+l,E=o+c;switch(p){case Ve.TOP_LEFT:return new ic(new z(u,E),new z(u,E-v),new z(B-_,o),new z(B,o));case Ve.TOP_RIGHT:return new ic(new z(u,o),new z(u+_,o),new z(B,E-v),new z(B,E));case Ve.BOTTOM_RIGHT:return new ic(new z(B,o),new z(B,o+v),new z(u+_,E),new z(u,E));case Ve.BOTTOM_LEFT:default:return new ic(new z(B,E),new z(B-_,E),new z(u,o+v),new z(u,o))}},ac=function(u){return[u.topLeftBorderBox,u.topRightBorderBox,u.bottomRightBorderBox,u.bottomLeftBorderBox]},ZU=function(u){return[u.topLeftContentBox,u.topRightContentBox,u.bottomRightContentBox,u.bottomLeftContentBox]},oc=function(u){return[u.topLeftPaddingBox,u.topRightPaddingBox,u.bottomRightPaddingBox,u.bottomLeftPaddingBox]},JU=(function(){function u(o,l,c){this.offsetX=o,this.offsetY=l,this.matrix=c,this.type=0,this.target=6}return u})(),uc=(function(){function u(o,l){this.path=o,this.target=l,this.type=1}return u})(),WU=(function(){function u(o){this.opacity=o,this.type=2,this.target=6}return u})(),qU=function(u){return u.type===0},Xg=function(u){return u.type===1},XU=function(u){return u.type===2},Yg=function(u,o){return u.length===o.length?u.some(function(l,c){return l===o[c]}):!1},YU=function(u,o,l,c,p){return u.map(function(g,_){switch(_){case 0:return g.add(o,l);case 1:return g.add(o+c,l);case 2:return g.add(o+c,l+p);case 3:return g.add(o,l+p)}return g})},ew=(function(){function u(o){this.element=o,this.inlineLevel=[],this.nonInlineLevel=[],this.negativeZIndex=[],this.zeroOrAutoZIndexOrTransformedOrOpacity=[],this.positiveZIndex=[],this.nonPositionedFloats=[],this.nonPositionedInlineLevel=[]}return u})(),tw=(function(){function u(o,l){if(this.container=o,this.parent=l,this.effects=[],this.curves=new VU(this.container),this.container.styles.opacity<1&&this.effects.push(new WU(this.container.styles.opacity)),this.container.styles.transform!==null){var c=this.container.bounds.left+this.container.styles.transformOrigin[0].number,p=this.container.bounds.top+this.container.styles.transformOrigin[1].number,g=this.container.styles.transform;this.effects.push(new JU(c,p,g))}if(this.container.styles.overflowX!==0){var _=ac(this.curves),v=oc(this.curves);Yg(_,v)?this.effects.push(new uc(_,6)):(this.effects.push(new uc(_,2)),this.effects.push(new uc(v,4)))}}return u.prototype.getEffects=function(o){for(var l=[2,3].indexOf(this.container.styles.position)===-1,c=this.parent,p=this.effects.slice(0);c;){var g=c.effects.filter(function(B){return!Xg(B)});if(l||c.container.styles.position!==0||!c.parent){if(p.unshift.apply(p,g),l=[2,3].indexOf(c.container.styles.position)===-1,c.container.styles.overflowX!==0){var _=ac(c.curves),v=oc(c.curves);Yg(_,v)||p.unshift(new uc(v,6))}}else p.unshift.apply(p,g);c=c.parent}return p.filter(function(B){return bt(B.target,o)})},u})(),dd=function(u,o,l,c){u.container.elements.forEach(function(p){var g=bt(p.flags,4),_=bt(p.flags,2),v=new tw(p,u);bt(p.styles.display,2048)&&c.push(v);var B=bt(p.flags,8)?[]:c;if(g||_){var E=g||p.styles.isPositioned()?l:o,x=new ew(v);if(p.styles.isPositioned()||p.styles.opacity<1||p.styles.isTransformed()){var U=p.styles.zIndex.order;if(U<0){var S=0;E.negativeZIndex.some(function(H,j){return U>H.element.container.styles.zIndex.order?(S=j,!1):S>0}),E.negativeZIndex.splice(S,0,x)}else if(U>0){var Z=0;E.positiveZIndex.some(function(H,j){return U>=H.element.container.styles.zIndex.order?(Z=j+1,!1):Z>0}),E.positiveZIndex.splice(Z,0,x)}else E.zeroOrAutoZIndexOrTransformedOrOpacity.push(x)}else p.styles.isFloating()?E.nonPositionedFloats.push(x):E.nonPositionedInlineLevel.push(x);dd(v,x,g?x:l,B)}else p.styles.isInlineLevel()?o.inlineLevel.push(v):o.nonInlineLevel.push(v),dd(v,o,l,B);bt(p.flags,8)&&rw(p,B)})},rw=function(u,o){for(var l=u instanceof rd?u.start:1,c=u instanceof rd?u.reversed:!1,p=0;p<o.length;p++){var g=o[p];g.container instanceof Ig&&typeof g.container.value=="number"&&g.container.value!==0&&(l=g.container.value),g.listValue=po(l,g.container.styles.listStyleType,!0),l+=c?-1:1}},eF=function(u){var o=new tw(u,null),l=new ew(o),c=[];return dd(o,l,l,c),rw(o.container,c),l},nw=function(u,o){switch(o){case 0:return Kr(u.topLeftBorderBox,u.topLeftPaddingBox,u.topRightBorderBox,u.topRightPaddingBox);case 1:return Kr(u.topRightBorderBox,u.topRightPaddingBox,u.bottomRightBorderBox,u.bottomRightPaddingBox);case 2:return Kr(u.bottomRightBorderBox,u.bottomRightPaddingBox,u.bottomLeftBorderBox,u.bottomLeftPaddingBox);case 3:default:return Kr(u.bottomLeftBorderBox,u.bottomLeftPaddingBox,u.topLeftBorderBox,u.topLeftPaddingBox)}},tF=function(u,o){switch(o){case 0:return Kr(u.topLeftBorderBox,u.topLeftBorderDoubleOuterBox,u.topRightBorderBox,u.topRightBorderDoubleOuterBox);case 1:return Kr(u.topRightBorderBox,u.topRightBorderDoubleOuterBox,u.bottomRightBorderBox,u.bottomRightBorderDoubleOuterBox);case 2:return Kr(u.bottomRightBorderBox,u.bottomRightBorderDoubleOuterBox,u.bottomLeftBorderBox,u.bottomLeftBorderDoubleOuterBox);case 3:default:return Kr(u.bottomLeftBorderBox,u.bottomLeftBorderDoubleOuterBox,u.topLeftBorderBox,u.topLeftBorderDoubleOuterBox)}},rF=function(u,o){switch(o){case 0:return Kr(u.topLeftBorderDoubleInnerBox,u.topLeftPaddingBox,u.topRightBorderDoubleInnerBox,u.topRightPaddingBox);case 1:return Kr(u.topRightBorderDoubleInnerBox,u.topRightPaddingBox,u.bottomRightBorderDoubleInnerBox,u.bottomRightPaddingBox);case 2:return Kr(u.bottomRightBorderDoubleInnerBox,u.bottomRightPaddingBox,u.bottomLeftBorderDoubleInnerBox,u.bottomLeftPaddingBox);case 3:default:return Kr(u.bottomLeftBorderDoubleInnerBox,u.bottomLeftPaddingBox,u.topLeftBorderDoubleInnerBox,u.topLeftPaddingBox)}},nF=function(u,o){switch(o){case 0:return cc(u.topLeftBorderStroke,u.topRightBorderStroke);case 1:return cc(u.topRightBorderStroke,u.bottomRightBorderStroke);case 2:return cc(u.bottomRightBorderStroke,u.bottomLeftBorderStroke);case 3:default:return cc(u.bottomLeftBorderStroke,u.topLeftBorderStroke)}},cc=function(u,o){var l=[];return jr(u)?l.push(u.subdivide(.5,!1)):l.push(u),jr(o)?l.push(o.subdivide(.5,!0)):l.push(o),l},Kr=function(u,o,l,c){var p=[];return jr(u)?p.push(u.subdivide(.5,!1)):p.push(u),jr(l)?p.push(l.subdivide(.5,!0)):p.push(l),jr(c)?p.push(c.subdivide(.5,!0).reverse()):p.push(c),jr(o)?p.push(o.subdivide(.5,!1).reverse()):p.push(o),p},Aw=function(u){var o=u.bounds,l=u.styles;return o.add(l.borderLeftWidth,l.borderTopWidth,-(l.borderRightWidth+l.borderLeftWidth),-(l.borderTopWidth+l.borderBottomWidth))},lc=function(u){var o=u.styles,l=u.bounds,c=Xe(o.paddingLeft,l.width),p=Xe(o.paddingRight,l.width),g=Xe(o.paddingTop,l.width),_=Xe(o.paddingBottom,l.width);return l.add(c+o.borderLeftWidth,g+o.borderTopWidth,-(o.borderRightWidth+o.borderLeftWidth+c+p),-(o.borderTopWidth+o.borderBottomWidth+g+_))},AF=function(u,o){return u===0?o.bounds:u===2?lc(o):Aw(o)},sF=function(u,o){return u===0?o.bounds:u===2?lc(o):Aw(o)},pd=function(u,o,l){var c=AF(Si(u.styles.backgroundOrigin,o),u),p=sF(Si(u.styles.backgroundClip,o),u),g=iF(Si(u.styles.backgroundSize,o),l,c),_=g[0],v=g[1],B=ao(Si(u.styles.backgroundPosition,o),c.width-_,c.height-v),E=aF(Si(u.styles.backgroundRepeat,o),B,g,c,p),x=Math.round(c.left+B[0]),U=Math.round(c.top+B[1]);return[E,x,U,_,v]},Oi=function(u){return Je(u)&&u.value===Ii.AUTO},fc=function(u){return typeof u=="number"},iF=function(u,o,l){var c=o[0],p=o[1],g=o[2],_=u[0],v=u[1];if(!_)return[0,0];if(gt(_)&&v&&gt(v))return[Xe(_,l.width),Xe(v,l.height)];var B=fc(g);if(Je(_)&&(_.value===Ii.CONTAIN||_.value===Ii.COVER)){if(fc(g)){var E=l.width/l.height;return E<g!=(_.value===Ii.COVER)?[l.width,l.width/g]:[l.height*g,l.height]}return[l.width,l.height]}var x=fc(c),U=fc(p),S=x||U;if(Oi(_)&&(!v||Oi(v))){if(x&&U)return[c,p];if(!B&&!S)return[l.width,l.height];if(S&&B){var Z=x?c:p*g,H=U?p:c/g;return[Z,H]}var j=x?c:l.width,Oe=U?p:l.height;return[j,Oe]}if(B){var se=0,ne=0;return gt(_)?se=Xe(_,l.width):gt(v)&&(ne=Xe(v,l.height)),Oi(_)?se=ne*g:(!v||Oi(v))&&(ne=se/g),[se,ne]}var ze=null,Pe=null;if(gt(_)?ze=Xe(_,l.width):v&&gt(v)&&(Pe=Xe(v,l.height)),ze!==null&&(!v||Oi(v))&&(Pe=x&&U?ze/c*p:l.height),Pe!==null&&Oi(_)&&(ze=x&&U?Pe/p*c:l.width),ze!==null&&Pe!==null)return[ze,Pe];throw new Error("Unable to calculate background-size for element")},Si=function(u,o){var l=u[o];return typeof l>"u"?u[0]:l},aF=function(u,o,l,c,p){var g=o[0],_=o[1],v=l[0],B=l[1];switch(u){case 2:return[new z(Math.round(c.left),Math.round(c.top+_)),new z(Math.round(c.left+c.width),Math.round(c.top+_)),new z(Math.round(c.left+c.width),Math.round(B+c.top+_)),new z(Math.round(c.left),Math.round(B+c.top+_))];case 3:return[new z(Math.round(c.left+g),Math.round(c.top)),new z(Math.round(c.left+g+v),Math.round(c.top)),new z(Math.round(c.left+g+v),Math.round(c.height+c.top)),new z(Math.round(c.left+g),Math.round(c.height+c.top))];case 1:return[new z(Math.round(c.left+g),Math.round(c.top+_)),new z(Math.round(c.left+g+v),Math.round(c.top+_)),new z(Math.round(c.left+g+v),Math.round(c.top+_+B)),new z(Math.round(c.left+g),Math.round(c.top+_+B))];default:return[new z(Math.round(p.left),Math.round(p.top)),new z(Math.round(p.left+p.width),Math.round(p.top)),new z(Math.round(p.left+p.width),Math.round(p.height+p.top)),new z(Math.round(p.left),Math.round(p.height+p.top))]}},oF="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",sw="Hidden Text",uF=(function(){function u(o){this._data={},this._document=o}return u.prototype.parseMetrics=function(o,l){var c=this._document.createElement("div"),p=this._document.createElement("img"),g=this._document.createElement("span"),_=this._document.body;c.style.visibility="hidden",c.style.fontFamily=o,c.style.fontSize=l,c.style.margin="0",c.style.padding="0",c.style.whiteSpace="nowrap",_.appendChild(c),p.src=oF,p.width=1,p.height=1,p.style.margin="0",p.style.padding="0",p.style.verticalAlign="baseline",g.style.fontFamily=o,g.style.fontSize=l,g.style.margin="0",g.style.padding="0",g.appendChild(this._document.createTextNode(sw)),c.appendChild(g),c.appendChild(p);var v=p.offsetTop-g.offsetTop+2;c.removeChild(g),c.appendChild(this._document.createTextNode(sw)),c.style.lineHeight="normal",p.style.verticalAlign="super";var B=p.offsetTop-c.offsetTop+2;return _.removeChild(c),{baseline:v,middle:B}},u.prototype.getMetrics=function(o,l){var c=o+" "+l;return typeof this._data[c]>"u"&&(this._data[c]=this.parseMetrics(o,l)),this._data[c]},u})(),iw=(function(){function u(o,l){this.context=o,this.options=l}return u})(),cF=1e4,lF=(function(u){e(o,u);function o(l,c){var p=u.call(this,l,c)||this;return p._activeEffects=[],p.canvas=c.canvas?c.canvas:document.createElement("canvas"),p.ctx=p.canvas.getContext("2d"),c.canvas||(p.canvas.width=Math.floor(c.width*c.scale),p.canvas.height=Math.floor(c.height*c.scale),p.canvas.style.width=c.width+"px",p.canvas.style.height=c.height+"px"),p.fontMetrics=new uF(document),p.ctx.scale(p.options.scale,p.options.scale),p.ctx.translate(-c.x,-c.y),p.ctx.textBaseline="bottom",p._activeEffects=[],p.context.logger.debug("Canvas renderer initialized ("+c.width+"x"+c.height+") with scale "+c.scale),p}return o.prototype.applyEffects=function(l){for(var c=this;this._activeEffects.length;)this.popEffect();l.forEach(function(p){return c.applyEffect(p)})},o.prototype.applyEffect=function(l){this.ctx.save(),XU(l)&&(this.ctx.globalAlpha=l.opacity),qU(l)&&(this.ctx.translate(l.offsetX,l.offsetY),this.ctx.transform(l.matrix[0],l.matrix[1],l.matrix[2],l.matrix[3],l.matrix[4],l.matrix[5]),this.ctx.translate(-l.offsetX,-l.offsetY)),Xg(l)&&(this.path(l.path),this.ctx.clip()),this._activeEffects.push(l)},o.prototype.popEffect=function(){this._activeEffects.pop(),this.ctx.restore()},o.prototype.renderStack=function(l){return n(this,void 0,void 0,function(){var c;return A(this,function(p){switch(p.label){case 0:return c=l.element.container.styles,c.isVisible()?[4,this.renderStackContent(l)]:[3,2];case 1:p.sent(),p.label=2;case 2:return[2]}})})},o.prototype.renderNode=function(l){return n(this,void 0,void 0,function(){return A(this,function(c){switch(c.label){case 0:if(bt(l.container.flags,16))debugger;return l.container.styles.isVisible()?[4,this.renderNodeBackgroundAndBorders(l)]:[3,3];case 1:return c.sent(),[4,this.renderNodeContent(l)];case 2:c.sent(),c.label=3;case 3:return[2]}})})},o.prototype.renderTextWithLetterSpacing=function(l,c,p){var g=this;if(c===0)this.ctx.fillText(l.text,l.bounds.left,l.bounds.top+p);else{var _=td(l.text);_.reduce(function(v,B){return g.ctx.fillText(B,v,l.bounds.top+p),v+g.ctx.measureText(B).width},l.bounds.left)}},o.prototype.createFontStyle=function(l){var c=l.fontVariant.filter(function(_){return _==="normal"||_==="small-caps"}).join(""),p=mF(l.fontFamily).join(", "),g=io(l.fontSize)?""+l.fontSize.number+l.fontSize.unit:l.fontSize.number+"px";return[[l.fontStyle,c,l.fontWeight,g,p].join(" "),p,g]},o.prototype.renderTextNode=function(l,c){return n(this,void 0,void 0,function(){var p,g,_,v,B,E,x,U,S=this;return A(this,function(Z){return p=this.createFontStyle(c),g=p[0],_=p[1],v=p[2],this.ctx.font=g,this.ctx.direction=c.direction===1?"rtl":"ltr",this.ctx.textAlign="left",this.ctx.textBaseline="alphabetic",B=this.fontMetrics.getMetrics(_,v),E=B.baseline,x=B.middle,U=c.paintOrder,l.textBounds.forEach(function(H){U.forEach(function(j){switch(j){case 0:S.ctx.fillStyle=St(c.color),S.renderTextWithLetterSpacing(H,c.letterSpacing,E);var Oe=c.textShadow;Oe.length&&H.text.trim().length&&(Oe.slice(0).reverse().forEach(function(se){S.ctx.shadowColor=St(se.color),S.ctx.shadowOffsetX=se.offsetX.number*S.options.scale,S.ctx.shadowOffsetY=se.offsetY.number*S.options.scale,S.ctx.shadowBlur=se.blur.number,S.renderTextWithLetterSpacing(H,c.letterSpacing,E)}),S.ctx.shadowColor="",S.ctx.shadowOffsetX=0,S.ctx.shadowOffsetY=0,S.ctx.shadowBlur=0),c.textDecorationLine.length&&(S.ctx.fillStyle=St(c.textDecorationColor||c.color),c.textDecorationLine.forEach(function(se){switch(se){case 1:S.ctx.fillRect(H.bounds.left,Math.round(H.bounds.top+E),H.bounds.width,1);break;case 2:S.ctx.fillRect(H.bounds.left,Math.round(H.bounds.top),H.bounds.width,1);break;case 3:S.ctx.fillRect(H.bounds.left,Math.ceil(H.bounds.top+x),H.bounds.width,1);break}}));break;case 1:c.webkitTextStrokeWidth&&H.text.trim().length&&(S.ctx.strokeStyle=St(c.webkitTextStrokeColor),S.ctx.lineWidth=c.webkitTextStrokeWidth,S.ctx.lineJoin=window.chrome?"miter":"round",S.ctx.strokeText(H.text,H.bounds.left,H.bounds.top+E)),S.ctx.strokeStyle="",S.ctx.lineWidth=0,S.ctx.lineJoin="miter";break}})}),[2]})})},o.prototype.renderReplacedElement=function(l,c,p){if(p&&l.intrinsicWidth>0&&l.intrinsicHeight>0){var g=lc(l),_=oc(c);this.path(_),this.ctx.save(),this.ctx.clip(),this.ctx.drawImage(p,0,0,l.intrinsicWidth,l.intrinsicHeight,g.left,g.top,g.width,g.height),this.ctx.restore()}},o.prototype.renderNodeContent=function(l){return n(this,void 0,void 0,function(){var c,p,g,_,v,B,ne,ne,E,x,U,S,Pe,Z,H,Ee,j,Oe,se,ne,ze,Pe,Ee;return A(this,function(G){switch(G.label){case 0:this.applyEffects(l.getEffects(4)),c=l.container,p=l.curves,g=c.styles,_=0,v=c.textNodes,G.label=1;case 1:return _<v.length?(B=v[_],[4,this.renderTextNode(B,g)]):[3,4];case 2:G.sent(),G.label=3;case 3:return _++,[3,1];case 4:if(!(c instanceof Cg))return[3,8];G.label=5;case 5:return G.trys.push([5,7,,8]),[4,this.context.cache.match(c.src)];case 6:return ne=G.sent(),this.renderReplacedElement(c,p,ne),[3,8];case 7:return G.sent(),this.context.logger.error("Error loading image "+c.src),[3,8];case 8:if(c instanceof Eg&&this.renderReplacedElement(c,p,c.canvas),!(c instanceof xg))return[3,12];G.label=9;case 9:return G.trys.push([9,11,,12]),[4,this.context.cache.match(c.svg)];case 10:return ne=G.sent(),this.renderReplacedElement(c,p,ne),[3,12];case 11:return G.sent(),this.context.logger.error("Error loading svg "+c.svg.substring(0,255)),[3,12];case 12:return c instanceof Tg&&c.tree?(E=new o(this.context,{scale:this.options.scale,backgroundColor:c.backgroundColor,x:0,y:0,width:c.width,height:c.height}),[4,E.render(c.tree)]):[3,14];case 13:x=G.sent(),c.width&&c.height&&this.ctx.drawImage(x,0,0,c.width,c.height,c.bounds.left,c.bounds.top,c.bounds.width,c.bounds.height),G.label=14;case 14:if(c instanceof nd&&(U=Math.min(c.bounds.width,c.bounds.height),c.type===ec?c.checked&&(this.ctx.save(),this.path([new z(c.bounds.left+U*.39363,c.bounds.top+U*.79),new z(c.bounds.left+U*.16,c.bounds.top+U*.5549),new z(c.bounds.left+U*.27347,c.bounds.top+U*.44071),new z(c.bounds.left+U*.39694,c.bounds.top+U*.5649),new z(c.bounds.left+U*.72983,c.bounds.top+U*.23),new z(c.bounds.left+U*.84,c.bounds.top+U*.34085),new z(c.bounds.left+U*.39363,c.bounds.top+U*.79)]),this.ctx.fillStyle=St(Ug),this.ctx.fill(),this.ctx.restore()):c.type===tc&&c.checked&&(this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(c.bounds.left+U/2,c.bounds.top+U/2,U/4,0,Math.PI*2,!0),this.ctx.fillStyle=St(Ug),this.ctx.fill(),this.ctx.restore())),fF(c)&&c.value.length){switch(S=this.createFontStyle(g),Pe=S[0],Z=S[1],H=this.fontMetrics.getMetrics(Pe,Z).baseline,this.ctx.font=Pe,this.ctx.fillStyle=St(g.color),this.ctx.textBaseline="alphabetic",this.ctx.textAlign=pF(c.styles.textAlign),Ee=lc(c),j=0,c.styles.textAlign){case 1:j+=Ee.width/2;break;case 2:j+=Ee.width;break}Oe=Ee.add(j,0,0,-Ee.height/2+1),this.ctx.save(),this.path([new z(Ee.left,Ee.top),new z(Ee.left+Ee.width,Ee.top),new z(Ee.left+Ee.width,Ee.top+Ee.height),new z(Ee.left,Ee.top+Ee.height)]),this.ctx.clip(),this.renderTextWithLetterSpacing(new lo(c.value,Oe),g.letterSpacing,H),this.ctx.restore(),this.ctx.textBaseline="alphabetic",this.ctx.textAlign="left"}if(!bt(c.styles.display,2048))return[3,20];if(c.styles.listStyleImage===null)return[3,19];if(se=c.styles.listStyleImage,se.type!==0)return[3,18];ne=void 0,ze=se.url,G.label=15;case 15:return G.trys.push([15,17,,18]),[4,this.context.cache.match(ze)];case 16:return ne=G.sent(),this.ctx.drawImage(ne,c.bounds.left-(ne.width+10),c.bounds.top),[3,18];case 17:return G.sent(),this.context.logger.error("Error loading list-style-image "+ze),[3,18];case 18:return[3,20];case 19:l.listValue&&c.styles.listStyleType!==-1&&(Pe=this.createFontStyle(g)[0],this.ctx.font=Pe,this.ctx.fillStyle=St(g.color),this.ctx.textBaseline="middle",this.ctx.textAlign="right",Ee=new i(c.bounds.left,c.bounds.top+Xe(c.styles.paddingTop,c.bounds.width),c.bounds.width,sg(g.lineHeight,g.fontSize.number)/2+1),this.renderTextWithLetterSpacing(new lo(l.listValue,Ee),g.letterSpacing,sg(g.lineHeight,g.fontSize.number)/2+2),this.ctx.textBaseline="bottom",this.ctx.textAlign="left"),G.label=20;case 20:return[2]}})})},o.prototype.renderStackContent=function(l){return n(this,void 0,void 0,function(){var c,p,se,g,_,se,v,B,se,E,x,se,U,S,se,Z,H,se,j,Oe,se;return A(this,function(ne){switch(ne.label){case 0:if(bt(l.element.container.flags,16))debugger;return[4,this.renderNodeBackgroundAndBorders(l.element)];case 1:ne.sent(),c=0,p=l.negativeZIndex,ne.label=2;case 2:return c<p.length?(se=p[c],[4,this.renderStack(se)]):[3,5];case 3:ne.sent(),ne.label=4;case 4:return c++,[3,2];case 5:return[4,this.renderNodeContent(l.element)];case 6:ne.sent(),g=0,_=l.nonInlineLevel,ne.label=7;case 7:return g<_.length?(se=_[g],[4,this.renderNode(se)]):[3,10];case 8:ne.sent(),ne.label=9;case 9:return g++,[3,7];case 10:v=0,B=l.nonPositionedFloats,ne.label=11;case 11:return v<B.length?(se=B[v],[4,this.renderStack(se)]):[3,14];case 12:ne.sent(),ne.label=13;case 13:return v++,[3,11];case 14:E=0,x=l.nonPositionedInlineLevel,ne.label=15;case 15:return E<x.length?(se=x[E],[4,this.renderStack(se)]):[3,18];case 16:ne.sent(),ne.label=17;case 17:return E++,[3,15];case 18:U=0,S=l.inlineLevel,ne.label=19;case 19:return U<S.length?(se=S[U],[4,this.renderNode(se)]):[3,22];case 20:ne.sent(),ne.label=21;case 21:return U++,[3,19];case 22:Z=0,H=l.zeroOrAutoZIndexOrTransformedOrOpacity,ne.label=23;case 23:return Z<H.length?(se=H[Z],[4,this.renderStack(se)]):[3,26];case 24:ne.sent(),ne.label=25;case 25:return Z++,[3,23];case 26:j=0,Oe=l.positiveZIndex,ne.label=27;case 27:return j<Oe.length?(se=Oe[j],[4,this.renderStack(se)]):[3,30];case 28:ne.sent(),ne.label=29;case 29:return j++,[3,27];case 30:return[2]}})})},o.prototype.mask=function(l){this.ctx.beginPath(),this.ctx.moveTo(0,0),this.ctx.lineTo(this.canvas.width,0),this.ctx.lineTo(this.canvas.width,this.canvas.height),this.ctx.lineTo(0,this.canvas.height),this.ctx.lineTo(0,0),this.formatPath(l.slice(0).reverse()),this.ctx.closePath()},o.prototype.path=function(l){this.ctx.beginPath(),this.formatPath(l),this.ctx.closePath()},o.prototype.formatPath=function(l){var c=this;l.forEach(function(p,g){var _=jr(p)?p.start:p;g===0?c.ctx.moveTo(_.x,_.y):c.ctx.lineTo(_.x,_.y),jr(p)&&c.ctx.bezierCurveTo(p.startControl.x,p.startControl.y,p.endControl.x,p.endControl.y,p.end.x,p.end.y)})},o.prototype.renderRepeat=function(l,c,p,g){this.path(l),this.ctx.fillStyle=c,this.ctx.translate(p,g),this.ctx.fill(),this.ctx.translate(-p,-g)},o.prototype.resizeImage=function(l,c,p){var g;if(l.width===c&&l.height===p)return l;var _=(g=this.canvas.ownerDocument)!==null&&g!==void 0?g:document,v=_.createElement("canvas");v.width=Math.max(1,c),v.height=Math.max(1,p);var B=v.getContext("2d");return B.drawImage(l,0,0,l.width,l.height,0,0,c,p),v},o.prototype.renderBackgroundImage=function(l){return n(this,void 0,void 0,function(){var c,p,g,_,v,B;return A(this,function(E){switch(E.label){case 0:c=l.styles.backgroundImage.length-1,p=function(x){var U,S,Z,wt,hr,mr,We,Ht,Ke,H,wt,hr,mr,We,Ht,j,Oe,se,ne,ze,Pe,Ee,G,je,Ke,xe,wt,pr,Ir,We,Ht,SA,hr,mr,gs,Cn,PA,ws,ys,eA,_s,tA;return A(this,function(Pi){switch(Pi.label){case 0:if(x.type!==0)return[3,5];U=void 0,S=x.url,Pi.label=1;case 1:return Pi.trys.push([1,3,,4]),[4,g.context.cache.match(S)];case 2:return U=Pi.sent(),[3,4];case 3:return Pi.sent(),g.context.logger.error("Error loading background-image "+S),[3,4];case 4:return U&&(Z=pd(l,c,[U.width,U.height,U.width/U.height]),wt=Z[0],hr=Z[1],mr=Z[2],We=Z[3],Ht=Z[4],Ke=g.ctx.createPattern(g.resizeImage(U,We,Ht),"repeat"),g.renderRepeat(wt,Ke,hr,mr)),[3,6];case 5:qE(x)?(H=pd(l,c,[null,null,null]),wt=H[0],hr=H[1],mr=H[2],We=H[3],Ht=H[4],j=GE(x.angle,We,Ht),Oe=j[0],se=j[1],ne=j[2],ze=j[3],Pe=j[4],Ee=document.createElement("canvas"),Ee.width=We,Ee.height=Ht,G=Ee.getContext("2d"),je=G.createLinearGradient(se,ze,ne,Pe),Zm(x.stops,Oe).forEach(function(mo){return je.addColorStop(mo.stop,St(mo.color))}),G.fillStyle=je,G.fillRect(0,0,We,Ht),We>0&&Ht>0&&(Ke=g.ctx.createPattern(Ee,"repeat"),g.renderRepeat(wt,Ke,hr,mr))):XE(x)&&(xe=pd(l,c,[null,null,null]),wt=xe[0],pr=xe[1],Ir=xe[2],We=xe[3],Ht=xe[4],SA=x.position.length===0?[Df]:x.position,hr=Xe(SA[0],We),mr=Xe(SA[SA.length-1],Ht),gs=VE(x,hr,mr,We,Ht),Cn=gs[0],PA=gs[1],Cn>0&&PA>0&&(ws=g.ctx.createRadialGradient(pr+hr,Ir+mr,0,pr+hr,Ir+mr,Cn),Zm(x.stops,Cn*2).forEach(function(mo){return ws.addColorStop(mo.stop,St(mo.color))}),g.path(wt),g.ctx.fillStyle=ws,Cn!==PA?(ys=l.bounds.left+.5*l.bounds.width,eA=l.bounds.top+.5*l.bounds.height,_s=PA/Cn,tA=1/_s,g.ctx.save(),g.ctx.translate(ys,eA),g.ctx.transform(1,0,0,_s,0,0),g.ctx.translate(-ys,-eA),g.ctx.fillRect(pr,tA*(Ir-eA)+eA,We,Ht*tA),g.ctx.restore()):g.ctx.fill())),Pi.label=6;case 6:return c--,[2]}})},g=this,_=0,v=l.styles.backgroundImage.slice(0).reverse(),E.label=1;case 1:return _<v.length?(B=v[_],[5,p(B)]):[3,4];case 2:E.sent(),E.label=3;case 3:return _++,[3,1];case 4:return[2]}})})},o.prototype.renderSolidBorder=function(l,c,p){return n(this,void 0,void 0,function(){return A(this,function(g){return this.path(nw(p,c)),this.ctx.fillStyle=St(l),this.ctx.fill(),[2]})})},o.prototype.renderDoubleBorder=function(l,c,p,g){return n(this,void 0,void 0,function(){var _,v;return A(this,function(B){switch(B.label){case 0:return c<3?[4,this.renderSolidBorder(l,p,g)]:[3,2];case 1:return B.sent(),[2];case 2:return _=tF(g,p),this.path(_),this.ctx.fillStyle=St(l),this.ctx.fill(),v=rF(g,p),this.path(v),this.ctx.fill(),[2]}})})},o.prototype.renderNodeBackgroundAndBorders=function(l){return n(this,void 0,void 0,function(){var c,p,g,_,v,B,E,x,U=this;return A(this,function(S){switch(S.label){case 0:return this.applyEffects(l.getEffects(2)),c=l.container.styles,p=!FA(c.backgroundColor)||c.backgroundImage.length,g=[{style:c.borderTopStyle,color:c.borderTopColor,width:c.borderTopWidth},{style:c.borderRightStyle,color:c.borderRightColor,width:c.borderRightWidth},{style:c.borderBottomStyle,color:c.borderBottomColor,width:c.borderBottomWidth},{style:c.borderLeftStyle,color:c.borderLeftColor,width:c.borderLeftWidth}],_=dF(Si(c.backgroundClip,0),l.curves),p||c.boxShadow.length?(this.ctx.save(),this.path(_),this.ctx.clip(),FA(c.backgroundColor)||(this.ctx.fillStyle=St(c.backgroundColor),this.ctx.fill()),[4,this.renderBackgroundImage(l.container)]):[3,2];case 1:S.sent(),this.ctx.restore(),c.boxShadow.slice(0).reverse().forEach(function(Z){U.ctx.save();var H=ac(l.curves),j=Z.inset?0:cF,Oe=YU(H,-j+(Z.inset?1:-1)*Z.spread.number,(Z.inset?1:-1)*Z.spread.number,Z.spread.number*(Z.inset?-2:2),Z.spread.number*(Z.inset?-2:2));Z.inset?(U.path(H),U.ctx.clip(),U.mask(Oe)):(U.mask(H),U.ctx.clip(),U.path(Oe)),U.ctx.shadowOffsetX=Z.offsetX.number+j,U.ctx.shadowOffsetY=Z.offsetY.number,U.ctx.shadowColor=St(Z.color),U.ctx.shadowBlur=Z.blur.number,U.ctx.fillStyle=Z.inset?St(Z.color):"rgba(0,0,0,1)",U.ctx.fill(),U.ctx.restore()}),S.label=2;case 2:v=0,B=0,E=g,S.label=3;case 3:return B<E.length?(x=E[B],x.style!==0&&!FA(x.color)&&x.width>0?x.style!==2?[3,5]:[4,this.renderDashedDottedBorder(x.color,x.width,v,l.curves,2)]:[3,11]):[3,13];case 4:return S.sent(),[3,11];case 5:return x.style!==3?[3,7]:[4,this.renderDashedDottedBorder(x.color,x.width,v,l.curves,3)];case 6:return S.sent(),[3,11];case 7:return x.style!==4?[3,9]:[4,this.renderDoubleBorder(x.color,x.width,v,l.curves)];case 8:return S.sent(),[3,11];case 9:return[4,this.renderSolidBorder(x.color,v,l.curves)];case 10:S.sent(),S.label=11;case 11:v++,S.label=12;case 12:return B++,[3,3];case 13:return[2]}})})},o.prototype.renderDashedDottedBorder=function(l,c,p,g,_){return n(this,void 0,void 0,function(){var v,B,E,x,U,S,Z,H,j,Oe,se,ne,ze,Pe,Ee,G,Ee,G;return A(this,function(je){return this.ctx.save(),v=nF(g,p),B=nw(g,p),_===2&&(this.path(B),this.ctx.clip()),jr(B[0])?(E=B[0].start.x,x=B[0].start.y):(E=B[0].x,x=B[0].y),jr(B[1])?(U=B[1].end.x,S=B[1].end.y):(U=B[1].x,S=B[1].y),p===0||p===2?Z=Math.abs(E-U):Z=Math.abs(x-S),this.ctx.beginPath(),_===3?this.formatPath(v):this.formatPath(B.slice(0,2)),H=c<3?c*3:c*2,j=c<3?c*2:c,_===3&&(H=c,j=c),Oe=!0,Z<=H*2?Oe=!1:Z<=H*2+j?(se=Z/(2*H+j),H*=se,j*=se):(ne=Math.floor((Z+j)/(H+j)),ze=(Z-ne*H)/(ne-1),Pe=(Z-(ne+1)*H)/ne,j=Pe<=0||Math.abs(j-ze)<Math.abs(j-Pe)?ze:Pe),Oe&&(_===3?this.ctx.setLineDash([0,H+j]):this.ctx.setLineDash([H,j])),_===3?(this.ctx.lineCap="round",this.ctx.lineWidth=c):this.ctx.lineWidth=c*2+1.1,this.ctx.strokeStyle=St(l),this.ctx.stroke(),this.ctx.setLineDash([]),_===2&&(jr(B[0])&&(Ee=B[3],G=B[0],this.ctx.beginPath(),this.formatPath([new z(Ee.end.x,Ee.end.y),new z(G.start.x,G.start.y)]),this.ctx.stroke()),jr(B[1])&&(Ee=B[1],G=B[2],this.ctx.beginPath(),this.formatPath([new z(Ee.end.x,Ee.end.y),new z(G.start.x,G.start.y)]),this.ctx.stroke())),this.ctx.restore(),[2]})})},o.prototype.render=function(l){return n(this,void 0,void 0,function(){var c;return A(this,function(p){switch(p.label){case 0:return this.options.backgroundColor&&(this.ctx.fillStyle=St(this.options.backgroundColor),this.ctx.fillRect(this.options.x,this.options.y,this.options.width,this.options.height)),c=eF(l),[4,this.renderStack(c)];case 1:return p.sent(),this.applyEffects([]),[2,this.canvas]}})})},o})(iw),fF=function(u){return u instanceof Qg||u instanceof Fg?!0:u instanceof nd&&u.type!==tc&&u.type!==ec},dF=function(u,o){switch(u){case 0:return ac(o);case 2:return ZU(o);case 1:default:return oc(o)}},pF=function(u){switch(u){case 1:return"center";case 2:return"right";case 0:default:return"left"}},hF=["-apple-system","system-ui"],mF=function(u){return/iPhone OS 15_(0|1)/.test(window.navigator.userAgent)?u.filter(function(o){return hF.indexOf(o)===-1}):u},gF=(function(u){e(o,u);function o(l,c){var p=u.call(this,l,c)||this;return p.canvas=c.canvas?c.canvas:document.createElement("canvas"),p.ctx=p.canvas.getContext("2d"),p.options=c,p.canvas.width=Math.floor(c.width*c.scale),p.canvas.height=Math.floor(c.height*c.scale),p.canvas.style.width=c.width+"px",p.canvas.style.height=c.height+"px",p.ctx.scale(p.options.scale,p.options.scale),p.ctx.translate(-c.x,-c.y),p.context.logger.debug("EXPERIMENTAL ForeignObject renderer initialized ("+c.width+"x"+c.height+" at "+c.x+","+c.y+") with scale "+c.scale),p}return o.prototype.render=function(l){return n(this,void 0,void 0,function(){var c,p;return A(this,function(g){switch(g.label){case 0:return c=ed(this.options.width*this.options.scale,this.options.height*this.options.scale,this.options.scale,this.options.scale,l),[4,wF(c)];case 1:return p=g.sent(),this.options.backgroundColor&&(this.ctx.fillStyle=St(this.options.backgroundColor),this.ctx.fillRect(0,0,this.options.width*this.options.scale,this.options.height*this.options.scale)),this.ctx.drawImage(p,-this.options.x*this.options.scale,-this.options.y*this.options.scale),[2,this.canvas]}})})},o})(iw),wF=function(u){return new Promise(function(o,l){var c=new Image;c.onload=function(){o(c)},c.onerror=l,c.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(u))})},yF=(function(){function u(o){var l=o.id,c=o.enabled;this.id=l,this.enabled=c,this.start=Date.now()}return u.prototype.debug=function(){for(var o=[],l=0;l<arguments.length;l++)o[l]=arguments[l];this.enabled&&(typeof window<"u"&&window.console&&typeof console.debug=="function"?console.debug.apply(console,s([this.id,this.getTime()+"ms"],o)):this.info.apply(this,o))},u.prototype.getTime=function(){return Date.now()-this.start},u.prototype.info=function(){for(var o=[],l=0;l<arguments.length;l++)o[l]=arguments[l];this.enabled&&typeof window<"u"&&window.console&&typeof console.info=="function"&&console.info.apply(console,s([this.id,this.getTime()+"ms"],o))},u.prototype.warn=function(){for(var o=[],l=0;l<arguments.length;l++)o[l]=arguments[l];this.enabled&&(typeof window<"u"&&window.console&&typeof console.warn=="function"?console.warn.apply(console,s([this.id,this.getTime()+"ms"],o)):this.info.apply(this,o))},u.prototype.error=function(){for(var o=[],l=0;l<arguments.length;l++)o[l]=arguments[l];this.enabled&&(typeof window<"u"&&window.console&&typeof console.error=="function"?console.error.apply(console,s([this.id,this.getTime()+"ms"],o)):this.info.apply(this,o))},u.instances={},u})(),_F=(function(){function u(o,l){var c;this.windowBounds=l,this.instanceName="#"+u.instanceCount++,this.logger=new yF({id:this.instanceName,enabled:o.logging}),this.cache=(c=o.cache)!==null&&c!==void 0?c:new DU(this,o)}return u.instanceCount=1,u})(),bF=function(u,o){return o===void 0&&(o={}),BF(u,o)};typeof window<"u"&&qg.setContext(window);var BF=function(u,o){return n(void 0,void 0,void 0,function(){var l,c,p,g,_,v,B,E,x,U,S,Z,H,j,Oe,se,ne,ze,Pe,Ee,je,G,je,Ke,xe,wt,pr,Ir,We,Ht,SA,hr,mr,gs,Cn,PA,ws,ys,eA,_s;return A(this,function(tA){switch(tA.label){case 0:if(!u||typeof u!="object")return[2,Promise.reject("Invalid element provided as first argument")];if(l=u.ownerDocument,!l)throw new Error("Element is not attached to a Document");if(c=l.defaultView,!c)throw new Error("Document is not attached to a Window");return p={allowTaint:(Ke=o.allowTaint)!==null&&Ke!==void 0?Ke:!1,imageTimeout:(xe=o.imageTimeout)!==null&&xe!==void 0?xe:15e3,proxy:o.proxy,useCORS:(wt=o.useCORS)!==null&&wt!==void 0?wt:!1},g=t({logging:(pr=o.logging)!==null&&pr!==void 0?pr:!0,cache:o.cache},p),_={windowWidth:(Ir=o.windowWidth)!==null&&Ir!==void 0?Ir:c.innerWidth,windowHeight:(We=o.windowHeight)!==null&&We!==void 0?We:c.innerHeight,scrollX:(Ht=o.scrollX)!==null&&Ht!==void 0?Ht:c.pageXOffset,scrollY:(SA=o.scrollY)!==null&&SA!==void 0?SA:c.pageYOffset},v=new i(_.scrollX,_.scrollY,_.windowWidth,_.windowHeight),B=new _F(g,v),E=(hr=o.foreignObjectRendering)!==null&&hr!==void 0?hr:!1,x={allowTaint:(mr=o.allowTaint)!==null&&mr!==void 0?mr:!1,onclone:o.onclone,ignoreElements:o.ignoreElements,inlineImages:E,copyStyles:E},B.logger.debug("Starting document clone with size "+v.width+"x"+v.height+" scrolled to "+-v.left+","+-v.top),U=new Jg(B,u,x),S=U.clonedReferenceElement,S?[4,U.toIFrame(l,v)]:[2,Promise.reject("Unable to find element in cloned iframe")];case 1:return Z=tA.sent(),H=sd(S)||vU(S)?f(S.ownerDocument):a(B,S),j=H.width,Oe=H.height,se=H.left,ne=H.top,ze=vF(B,S,o.backgroundColor),Pe={canvas:o.canvas,backgroundColor:ze,scale:(Cn=(gs=o.scale)!==null&&gs!==void 0?gs:c.devicePixelRatio)!==null&&Cn!==void 0?Cn:1,x:((PA=o.x)!==null&&PA!==void 0?PA:0)+se,y:((ws=o.y)!==null&&ws!==void 0?ws:0)+ne,width:(ys=o.width)!==null&&ys!==void 0?ys:Math.ceil(j),height:(eA=o.height)!==null&&eA!==void 0?eA:Math.ceil(Oe)},E?(B.logger.debug("Document cloned, using foreign object rendering"),je=new gF(B,Pe),[4,je.render(S)]):[3,3];case 2:return Ee=tA.sent(),[3,5];case 3:return B.logger.debug("Document cloned, element located at "+se+","+ne+" with size "+j+"x"+Oe+" using computed rendering"),B.logger.debug("Starting DOM parsing"),G=Sg(B,S),ze===G.styles.backgroundColor&&(G.styles.backgroundColor=Xn.TRANSPARENT),B.logger.debug("Starting renderer for element at "+Pe.x+","+Pe.y+" with size "+Pe.width+"x"+Pe.height),je=new lF(B,Pe),[4,je.render(G)];case 4:Ee=tA.sent(),tA.label=5;case 5:return(!((_s=o.removeContainer)!==null&&_s!==void 0)||_s)&&(Jg.destroy(Z)||B.logger.error("Cannot detach cloned iframe as it is not in the DOM anymore")),B.logger.debug("Finished rendering"),[2,Ee]}})})},vF=function(u,o,l){var c=o.ownerDocument,p=c.documentElement?oo(u,getComputedStyle(c.documentElement).backgroundColor):Xn.TRANSPARENT,g=c.body?oo(u,getComputedStyle(c.body).backgroundColor):Xn.TRANSPARENT,_=typeof l=="string"?oo(u,l):l===null?Xn.TRANSPARENT:4294967295;return o===c.documentElement?FA(p)?FA(g)?_:g:p:_};return bF}))});var dy=oe((h2,fy)=>{"use strict";fy.exports=function(r,e){if(typeof r!="string")throw new TypeError("Expected a string");return e=typeof e>"u"?"_":e,r.replace(/([a-z\d])([A-Z])/g,"$1"+e+"$2").replace(/([A-Z]+)([A-Z][a-z\d]+)/g,"$1"+e+"$2").toLowerCase()}});var _y=oe((m2,Ap)=>{"use strict";var zQ=/[\p{Lu}]/u,GQ=/[\p{Ll}]/u,py=/^[\p{Lu}](?![\p{Lu}])/gu,gy=/([\p{Alpha}\p{N}_]|$)/u,wy=/[_.\- ]+/,VQ=new RegExp("^"+wy.source),hy=new RegExp(wy.source+gy.source,"gu"),my=new RegExp("\\d+"+gy.source,"gu"),ZQ=(r,e,t)=>{let n=!1,A=!1,s=!1;for(let i=0;i<r.length;i++){let a=r[i];n&&zQ.test(a)?(r=r.slice(0,i)+"-"+r.slice(i),n=!1,s=A,A=!0,i++):A&&s&&GQ.test(a)?(r=r.slice(0,i-1)+"-"+r.slice(i-1),s=A,A=!1,n=!0):(n=e(a)===a&&t(a)!==a,s=A,A=t(a)===a&&e(a)!==a)}return r},JQ=(r,e)=>(py.lastIndex=0,r.replace(py,t=>e(t))),WQ=(r,e)=>(hy.lastIndex=0,my.lastIndex=0,r.replace(hy,(t,n)=>e(n)).replace(my,t=>e(t))),yy=(r,e)=>{if(!(typeof r=="string"||Array.isArray(r)))throw new TypeError("Expected the input to be `string | string[]`");if(e={pascalCase:!1,preserveConsecutiveUppercase:!1,...e},Array.isArray(r)?r=r.map(s=>s.trim()).filter(s=>s.length).join("-"):r=r.trim(),r.length===0)return"";let t=e.locale===!1?s=>s.toLowerCase():s=>s.toLocaleLowerCase(e.locale),n=e.locale===!1?s=>s.toUpperCase():s=>s.toLocaleUpperCase(e.locale);return r.length===1?e.pascalCase?n(r):t(r):(r!==t(r)&&(r=ZQ(r,t,n)),r=r.replace(VQ,""),e.preserveConsecutiveUppercase?r=JQ(r,t):r=t(r),e.pascalCase&&(r=n(r.charAt(0))+r.slice(1)),WQ(r,n))};Ap.exports=yy;Ap.exports.default=yy});var Gy=oe((Bj,zy)=>{"use strict";function Jr(r,e){typeof e=="boolean"&&(e={forever:e}),this._originalTimeouts=JSON.parse(JSON.stringify(r)),this._timeouts=r,this._options=e||{},this._maxRetryTime=e&&e.maxRetryTime||1/0,this._fn=null,this._errors=[],this._attempts=1,this._operationTimeout=null,this._operationTimeoutCb=null,this._timeout=null,this._operationStart=null,this._timer=null,this._options.forever&&(this._cachedTimeouts=this._timeouts.slice(0))}zy.exports=Jr;Jr.prototype.reset=function(){this._attempts=1,this._timeouts=this._originalTimeouts.slice(0)};Jr.prototype.stop=function(){this._timeout&&clearTimeout(this._timeout),this._timer&&clearTimeout(this._timer),this._timeouts=[],this._cachedTimeouts=null};Jr.prototype.retry=function(r){if(this._timeout&&clearTimeout(this._timeout),!r)return!1;var e=new Date().getTime();if(r&&e-this._operationStart>=this._maxRetryTime)return this._errors.push(r),this._errors.unshift(new Error("RetryOperation timeout occurred")),!1;this._errors.push(r);var t=this._timeouts.shift();if(t===void 0)if(this._cachedTimeouts)this._errors.splice(0,this._errors.length-1),t=this._cachedTimeouts.slice(-1);else return!1;var n=this;return this._timer=setTimeout(function(){n._attempts++,n._operationTimeoutCb&&(n._timeout=setTimeout(function(){n._operationTimeoutCb(n._attempts)},n._operationTimeout),n._options.unref&&n._timeout.unref()),n._fn(n._attempts)},t),this._options.unref&&this._timer.unref(),!0};Jr.prototype.attempt=function(r,e){this._fn=r,e&&(e.timeout&&(this._operationTimeout=e.timeout),e.cb&&(this._operationTimeoutCb=e.cb));var t=this;this._operationTimeoutCb&&(this._timeout=setTimeout(function(){t._operationTimeoutCb()},t._operationTimeout)),this._operationStart=new Date().getTime(),this._fn(this._attempts)};Jr.prototype.try=function(r){console.log("Using RetryOperation.try() is deprecated"),this.attempt(r)};Jr.prototype.start=function(r){console.log("Using RetryOperation.start() is deprecated"),this.attempt(r)};Jr.prototype.start=Jr.prototype.try;Jr.prototype.errors=function(){return this._errors};Jr.prototype.attempts=function(){return this._attempts};Jr.prototype.mainError=function(){if(this._errors.length===0)return null;for(var r={},e=null,t=0,n=0;n<this._errors.length;n++){var A=this._errors[n],s=A.message,i=(r[s]||0)+1;r[s]=i,i>=t&&(e=A,t=i)}return e}});var Vy=oe(ci=>{"use strict";var dO=Gy();ci.operation=function(r){var e=ci.timeouts(r);return new dO(e,{forever:r&&(r.forever||r.retries===1/0),unref:r&&r.unref,maxRetryTime:r&&r.maxRetryTime})};ci.timeouts=function(r){if(r instanceof Array)return[].concat(r);var e={retries:10,factor:2,minTimeout:1*1e3,maxTimeout:1/0,randomize:!1};for(var t in r)e[t]=r[t];if(e.minTimeout>e.maxTimeout)throw new Error("minTimeout is greater than maxTimeout");for(var n=[],A=0;A<e.retries;A++)n.push(this.createTimeout(A,e));return r&&r.forever&&!n.length&&n.push(this.createTimeout(A,e)),n.sort(function(s,i){return s-i}),n};ci.createTimeout=function(r,e){var t=e.randomize?Math.random()+1:1,n=Math.round(t*Math.max(e.minTimeout,1)*Math.pow(e.factor,r));return n=Math.min(n,e.maxTimeout),n};ci.wrap=function(r,e,t){if(e instanceof Array&&(t=e,e=null),!t){t=[];for(var n in r)typeof r[n]=="function"&&t.push(n)}for(var A=0;A<t.length;A++){var s=t[A],i=r[s];r[s]=function(f){var d=ci.operation(e),h=Array.prototype.slice.call(arguments,1),m=h.pop();h.push(function(y){d.retry(y)||(y&&(arguments[0]=d.mainError()),m.apply(this,arguments))}),d.attempt(function(){f.apply(r,h)})}.bind(r,i),r[s].options=e}}});var Jy=oe((Cj,Zy)=>{"use strict";Zy.exports=Vy()});var Wc=oe((Ej,Jc)=>{"use strict";var pO=Jy(),hO=["Failed to fetch","NetworkError when attempting to fetch resource.","The Internet connection appears to be offline.","Network request failed"],Zc=class extends Error{constructor(e){super(),e instanceof Error?(this.originalError=e,{message:e}=e):(this.originalError=new Error(e),this.originalError.stack=this.stack),this.name="AbortError",this.message=e}},mO=(r,e,t)=>{let n=t.retries-(e-1);return r.attemptNumber=e,r.retriesLeft=n,r},gO=r=>hO.includes(r),Wy=(r,e)=>new Promise((t,n)=>{e={onFailedAttempt:()=>{},retries:10,...e};let A=pO.operation(e);A.attempt(async s=>{try{t(await r(s))}catch(i){if(!(i instanceof Error)){n(new TypeError(`Non-error was thrown: "${i}". You should only throw errors.`));return}if(i instanceof Zc)A.stop(),n(i.originalError);else if(i instanceof TypeError&&!gO(i.message))A.stop(),n(i);else{mO(i,s,e);try{await e.onFailedAttempt(i)}catch(a){n(a);return}A.retry(i)||n(A.mainError())}}})});Jc.exports=Wy;Jc.exports.default=Wy;Jc.exports.AbortError=Zc});var M_=oe((EK,Dp)=>{"use strict";var VO=Object.prototype.hasOwnProperty,ir="~";function Vo(){}Object.create&&(Vo.prototype=Object.create(null),new Vo().__proto__||(ir=!1));function ZO(r,e,t){this.fn=r,this.context=e,this.once=t||!1}function D_(r,e,t,n,A){if(typeof t!="function")throw new TypeError("The listener must be a function");var s=new ZO(t,n||r,A),i=ir?ir+e:e;return r._events[i]?r._events[i].fn?r._events[i]=[r._events[i],s]:r._events[i].push(s):(r._events[i]=s,r._eventsCount++),r}function pl(r,e){--r._eventsCount===0?r._events=new Vo:delete r._events[e]}function qt(){this._events=new Vo,this._eventsCount=0}qt.prototype.eventNames=function(){var e=[],t,n;if(this._eventsCount===0)return e;for(n in t=this._events)VO.call(t,n)&&e.push(ir?n.slice(1):n);return Object.getOwnPropertySymbols?e.concat(Object.getOwnPropertySymbols(t)):e};qt.prototype.listeners=function(e){var t=ir?ir+e:e,n=this._events[t];if(!n)return[];if(n.fn)return[n.fn];for(var A=0,s=n.length,i=new Array(s);A<s;A++)i[A]=n[A].fn;return i};qt.prototype.listenerCount=function(e){var t=ir?ir+e:e,n=this._events[t];return n?n.fn?1:n.length:0};qt.prototype.emit=function(e,t,n,A,s,i){var a=ir?ir+e:e;if(!this._events[a])return!1;var f=this._events[a],d=arguments.length,h,m;if(f.fn){switch(f.once&&this.removeListener(e,f.fn,void 0,!0),d){case 1:return f.fn.call(f.context),!0;case 2:return f.fn.call(f.context,t),!0;case 3:return f.fn.call(f.context,t,n),!0;case 4:return f.fn.call(f.context,t,n,A),!0;case 5:return f.fn.call(f.context,t,n,A,s),!0;case 6:return f.fn.call(f.context,t,n,A,s,i),!0}for(m=1,h=new Array(d-1);m<d;m++)h[m-1]=arguments[m];f.fn.apply(f.context,h)}else{var y=f.length,w;for(m=0;m<y;m++)switch(f[m].once&&this.removeListener(e,f[m].fn,void 0,!0),d){case 1:f[m].fn.call(f[m].context);break;case 2:f[m].fn.call(f[m].context,t);break;case 3:f[m].fn.call(f[m].context,t,n);break;case 4:f[m].fn.call(f[m].context,t,n,A);break;default:if(!h)for(w=1,h=new Array(d-1);w<d;w++)h[w-1]=arguments[w];f[m].fn.apply(f[m].context,h)}}return!0};qt.prototype.on=function(e,t,n){return D_(this,e,t,n,!1)};qt.prototype.once=function(e,t,n){return D_(this,e,t,n,!0)};qt.prototype.removeListener=function(e,t,n,A){var s=ir?ir+e:e;if(!this._events[s])return this;if(!t)return pl(this,s),this;var i=this._events[s];if(i.fn)i.fn===t&&(!A||i.once)&&(!n||i.context===n)&&pl(this,s);else{for(var a=0,f=[],d=i.length;a<d;a++)(i[a].fn!==t||A&&!i[a].once||n&&i[a].context!==n)&&f.push(i[a]);f.length?this._events[s]=f.length===1?f[0]:f:pl(this,s)}return this};qt.prototype.removeAllListeners=function(e){var t;return e?(t=ir?ir+e:e,this._events[t]&&pl(this,t)):(this._events=new Vo,this._eventsCount=0),this};qt.prototype.off=qt.prototype.removeListener;qt.prototype.addListener=qt.prototype.on;qt.prefixed=ir;qt.EventEmitter=qt;typeof Dp<"u"&&(Dp.exports=qt)});var j_=oe((xK,$_)=>{"use strict";$_.exports=(r,e)=>(e=e||(()=>{}),r.then(t=>new Promise(n=>{n(e())}).then(()=>t),t=>new Promise(n=>{n(e())}).then(()=>{throw t})))});var z_=oe((IK,ml)=>{"use strict";var JO=j_(),hl=class extends Error{constructor(e){super(e),this.name="TimeoutError"}},K_=(r,e,t)=>new Promise((n,A)=>{if(typeof e!="number"||e<0)throw new TypeError("Expected `milliseconds` to be a positive number");if(e===1/0){n(r);return}let s=setTimeout(()=>{if(typeof t=="function"){try{n(t())}catch(f){A(f)}return}let i=typeof t=="string"?t:`Promise timed out after ${e} milliseconds`,a=t instanceof Error?t:new hl(i);typeof r.cancel=="function"&&r.cancel(),A(a)},e);JO(r.then(n,A),()=>{clearTimeout(s)})});ml.exports=K_;ml.exports.default=K_;ml.exports.TimeoutError=hl});var G_=oe(Mp=>{"use strict";Object.defineProperty(Mp,"__esModule",{value:!0});function WO(r,e,t){let n=0,A=r.length;for(;A>0;){let s=A/2|0,i=n+s;t(r[i],e)<=0?(n=++i,A-=s+1):A=s}return n}Mp.default=WO});var V_=oe(jp=>{"use strict";Object.defineProperty(jp,"__esModule",{value:!0});var qO=G_(),$p=class{constructor(){this._queue=[]}enqueue(e,t){t=Object.assign({priority:0},t);let n={priority:t.priority,run:e};if(this.size&&this._queue[this.size-1].priority>=t.priority){this._queue.push(n);return}let A=qO.default(this._queue,n,(s,i)=>i.priority-s.priority);this._queue.splice(A,0,n)}dequeue(){let e=this._queue.shift();return e?.run}filter(e){return this._queue.filter(t=>t.priority===e.priority).map(t=>t.run)}get size(){return this._queue.length}};jp.default=$p});var wl=oe(zp=>{"use strict";Object.defineProperty(zp,"__esModule",{value:!0});var XO=M_(),Z_=z_(),YO=V_(),gl=()=>{},eS=new Z_.TimeoutError,Kp=class extends XO{constructor(e){var t,n,A,s;if(super(),this._intervalCount=0,this._intervalEnd=0,this._pendingCount=0,this._resolveEmpty=gl,this._resolveIdle=gl,e=Object.assign({carryoverConcurrencyCount:!1,intervalCap:1/0,interval:0,concurrency:1/0,autoStart:!0,queueClass:YO.default},e),!(typeof e.intervalCap=="number"&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${(n=(t=e.intervalCap)===null||t===void 0?void 0:t.toString())!==null&&n!==void 0?n:""}\` (${typeof e.intervalCap})`);if(e.interval===void 0||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${(s=(A=e.interval)===null||A===void 0?void 0:A.toString())!==null&&s!==void 0?s:""}\` (${typeof e.interval})`);this._carryoverConcurrencyCount=e.carryoverConcurrencyCount,this._isIntervalIgnored=e.intervalCap===1/0||e.interval===0,this._intervalCap=e.intervalCap,this._interval=e.interval,this._queue=new e.queueClass,this._queueClass=e.queueClass,this.concurrency=e.concurrency,this._timeout=e.timeout,this._throwOnTimeout=e.throwOnTimeout===!0,this._isPaused=e.autoStart===!1}get _doesIntervalAllowAnother(){return this._isIntervalIgnored||this._intervalCount<this._intervalCap}get _doesConcurrentAllowAnother(){return this._pendingCount<this._concurrency}_next(){this._pendingCount--,this._tryToStartAnother(),this.emit("next")}_resolvePromises(){this._resolveEmpty(),this._resolveEmpty=gl,this._pendingCount===0&&(this._resolveIdle(),this._resolveIdle=gl,this.emit("idle"))}_onResumeInterval(){this._onInterval(),this._initializeIntervalIfNeeded(),this._timeoutId=void 0}_isIntervalPaused(){let e=Date.now();if(this._intervalId===void 0){let t=this._intervalEnd-e;if(t<0)this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0;else return this._timeoutId===void 0&&(this._timeoutId=setTimeout(()=>{this._onResumeInterval()},t)),!0}return!1}_tryToStartAnother(){if(this._queue.size===0)return this._intervalId&&clearInterval(this._intervalId),this._intervalId=void 0,this._resolvePromises(),!1;if(!this._isPaused){let e=!this._isIntervalPaused();if(this._doesIntervalAllowAnother&&this._doesConcurrentAllowAnother){let t=this._queue.dequeue();return t?(this.emit("active"),t(),e&&this._initializeIntervalIfNeeded(),!0):!1}}return!1}_initializeIntervalIfNeeded(){this._isIntervalIgnored||this._intervalId!==void 0||(this._intervalId=setInterval(()=>{this._onInterval()},this._interval),this._intervalEnd=Date.now()+this._interval)}_onInterval(){this._intervalCount===0&&this._pendingCount===0&&this._intervalId&&(clearInterval(this._intervalId),this._intervalId=void 0),this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0,this._processQueue()}_processQueue(){for(;this._tryToStartAnother(););}get concurrency(){return this._concurrency}set concurrency(e){if(!(typeof e=="number"&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);this._concurrency=e,this._processQueue()}async add(e,t={}){return new Promise((n,A)=>{let s=async()=>{this._pendingCount++,this._intervalCount++;try{let i=this._timeout===void 0&&t.timeout===void 0?e():Z_.default(Promise.resolve(e()),t.timeout===void 0?this._timeout:t.timeout,()=>{(t.throwOnTimeout===void 0?this._throwOnTimeout:t.throwOnTimeout)&&A(eS)});n(await i)}catch(i){A(i)}this._next()};this._queue.enqueue(s,t),this._tryToStartAnother(),this.emit("add")})}async addAll(e,t){return Promise.all(e.map(async n=>this.add(n,t)))}start(){return this._isPaused?(this._isPaused=!1,this._processQueue(),this):this}pause(){this._isPaused=!0}clear(){this._queue=new this._queueClass}async onEmpty(){if(this._queue.size!==0)return new Promise(e=>{let t=this._resolveEmpty;this._resolveEmpty=()=>{t(),e()}})}async onIdle(){if(!(this._pendingCount===0&&this._queue.size===0))return new Promise(e=>{let t=this._resolveIdle;this._resolveIdle=()=>{t(),e()}})}get size(){return this._queue.size}sizeBy(e){return this._queue.filter(e).length}get pending(){return this._pendingCount}get isPaused(){return this._isPaused}get timeout(){return this._timeout}set timeout(e){this._timeout=e}};zp.default=Kp});var Jo=oe((RK,q_)=>{"use strict";var nS="2.0.0",AS=Number.MAX_SAFE_INTEGER||9007199254740991,sS=16,iS=250,aS=["major","premajor","minor","preminor","patch","prepatch","prerelease"];q_.exports={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:sS,MAX_SAFE_BUILD_LENGTH:iS,MAX_SAFE_INTEGER:AS,RELEASE_TYPES:aS,SEMVER_SPEC_VERSION:nS,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}});var Wo=oe((kK,X_)=>{"use strict";var oS=typeof process=="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...r)=>console.error("SEMVER",...r):()=>{};X_.exports=oS});var Qa=oe((Dn,Y_)=>{"use strict";var{MAX_SAFE_COMPONENT_LENGTH:Zp,MAX_SAFE_BUILD_LENGTH:uS,MAX_LENGTH:cS}=Jo(),lS=Wo();Dn=Y_.exports={};var fS=Dn.re=[],dS=Dn.safeRe=[],q=Dn.src=[],pS=Dn.safeSrc=[],X=Dn.t={},hS=0,Jp="[a-zA-Z0-9-]",mS=[["\\s",1],["\\d",cS],[Jp,uS]],gS=r=>{for(let[e,t]of mS)r=r.split(`${e}*`).join(`${e}{0,${t}}`).split(`${e}+`).join(`${e}{1,${t}}`);return r},Fe=(r,e,t)=>{let n=gS(e),A=hS++;lS(r,A,e),X[r]=A,q[A]=e,pS[A]=n,fS[A]=new RegExp(e,t?"g":void 0),dS[A]=new RegExp(n,t?"g":void 0)};Fe("NUMERICIDENTIFIER","0|[1-9]\\d*");Fe("NUMERICIDENTIFIERLOOSE","\\d+");Fe("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${Jp}*`);Fe("MAINVERSION",`(${q[X.NUMERICIDENTIFIER]})\\.(${q[X.NUMERICIDENTIFIER]})\\.(${q[X.NUMERICIDENTIFIER]})`);Fe("MAINVERSIONLOOSE",`(${q[X.NUMERICIDENTIFIERLOOSE]})\\.(${q[X.NUMERICIDENTIFIERLOOSE]})\\.(${q[X.NUMERICIDENTIFIERLOOSE]})`);Fe("PRERELEASEIDENTIFIER",`(?:${q[X.NONNUMERICIDENTIFIER]}|${q[X.NUMERICIDENTIFIER]})`);Fe("PRERELEASEIDENTIFIERLOOSE",`(?:${q[X.NONNUMERICIDENTIFIER]}|${q[X.NUMERICIDENTIFIERLOOSE]})`);Fe("PRERELEASE",`(?:-(${q[X.PRERELEASEIDENTIFIER]}(?:\\.${q[X.PRERELEASEIDENTIFIER]})*))`);Fe("PRERELEASELOOSE",`(?:-?(${q[X.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${q[X.PRERELEASEIDENTIFIERLOOSE]})*))`);Fe("BUILDIDENTIFIER",`${Jp}+`);Fe("BUILD",`(?:\\+(${q[X.BUILDIDENTIFIER]}(?:\\.${q[X.BUILDIDENTIFIER]})*))`);Fe("FULLPLAIN",`v?${q[X.MAINVERSION]}${q[X.PRERELEASE]}?${q[X.BUILD]}?`);Fe("FULL",`^${q[X.FULLPLAIN]}$`);Fe("LOOSEPLAIN",`[v=\\s]*${q[X.MAINVERSIONLOOSE]}${q[X.PRERELEASELOOSE]}?${q[X.BUILD]}?`);Fe("LOOSE",`^${q[X.LOOSEPLAIN]}$`);Fe("GTLT","((?:<|>)?=?)");Fe("XRANGEIDENTIFIERLOOSE",`${q[X.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`);Fe("XRANGEIDENTIFIER",`${q[X.NUMERICIDENTIFIER]}|x|X|\\*`);Fe("XRANGEPLAIN",`[v=\\s]*(${q[X.XRANGEIDENTIFIER]})(?:\\.(${q[X.XRANGEIDENTIFIER]})(?:\\.(${q[X.XRANGEIDENTIFIER]})(?:${q[X.PRERELEASE]})?${q[X.BUILD]}?)?)?`);Fe("XRANGEPLAINLOOSE",`[v=\\s]*(${q[X.XRANGEIDENTIFIERLOOSE]})(?:\\.(${q[X.XRANGEIDENTIFIERLOOSE]})(?:\\.(${q[X.XRANGEIDENTIFIERLOOSE]})(?:${q[X.PRERELEASELOOSE]})?${q[X.BUILD]}?)?)?`);Fe("XRANGE",`^${q[X.GTLT]}\\s*${q[X.XRANGEPLAIN]}$`);Fe("XRANGELOOSE",`^${q[X.GTLT]}\\s*${q[X.XRANGEPLAINLOOSE]}$`);Fe("COERCEPLAIN",`(^|[^\\d])(\\d{1,${Zp}})(?:\\.(\\d{1,${Zp}}))?(?:\\.(\\d{1,${Zp}}))?`);Fe("COERCE",`${q[X.COERCEPLAIN]}(?:$|[^\\d])`);Fe("COERCEFULL",q[X.COERCEPLAIN]+`(?:${q[X.PRERELEASE]})?(?:${q[X.BUILD]})?(?:$|[^\\d])`);Fe("COERCERTL",q[X.COERCE],!0);Fe("COERCERTLFULL",q[X.COERCEFULL],!0);Fe("LONETILDE","(?:~>?)");Fe("TILDETRIM",`(\\s*)${q[X.LONETILDE]}\\s+`,!0);Dn.tildeTrimReplace="$1~";Fe("TILDE",`^${q[X.LONETILDE]}${q[X.XRANGEPLAIN]}$`);Fe("TILDELOOSE",`^${q[X.LONETILDE]}${q[X.XRANGEPLAINLOOSE]}$`);Fe("LONECARET","(?:\\^)");Fe("CARETTRIM",`(\\s*)${q[X.LONECARET]}\\s+`,!0);Dn.caretTrimReplace="$1^";Fe("CARET",`^${q[X.LONECARET]}${q[X.XRANGEPLAIN]}$`);Fe("CARETLOOSE",`^${q[X.LONECARET]}${q[X.XRANGEPLAINLOOSE]}$`);Fe("COMPARATORLOOSE",`^${q[X.GTLT]}\\s*(${q[X.LOOSEPLAIN]})$|^$`);Fe("COMPARATOR",`^${q[X.GTLT]}\\s*(${q[X.FULLPLAIN]})$|^$`);Fe("COMPARATORTRIM",`(\\s*)${q[X.GTLT]}\\s*(${q[X.LOOSEPLAIN]}|${q[X.XRANGEPLAIN]})`,!0);Dn.comparatorTrimReplace="$1$2$3";Fe("HYPHENRANGE",`^\\s*(${q[X.XRANGEPLAIN]})\\s+-\\s+(${q[X.XRANGEPLAIN]})\\s*$`);Fe("HYPHENRANGELOOSE",`^\\s*(${q[X.XRANGEPLAINLOOSE]})\\s+-\\s+(${q[X.XRANGEPLAINLOOSE]})\\s*$`);Fe("STAR","(<|>)?=?\\s*\\*");Fe("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$");Fe("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")});var bl=oe((NK,eb)=>{"use strict";var wS=Object.freeze({loose:!0}),yS=Object.freeze({}),_S=r=>r?typeof r!="object"?wS:r:yS;eb.exports=_S});var Wp=oe((LK,nb)=>{"use strict";var tb=/^[0-9]+$/,rb=(r,e)=>{let t=tb.test(r),n=tb.test(e);return t&&n&&(r=+r,e=+e),r===e?0:t&&!n?-1:n&&!t?1:r<e?-1:1},bS=(r,e)=>rb(e,r);nb.exports={compareIdentifiers:rb,rcompareIdentifiers:bS}});var Xt=oe((HK,sb)=>{"use strict";var Bl=Wo(),{MAX_LENGTH:Ab,MAX_SAFE_INTEGER:vl}=Jo(),{safeRe:Cl,t:El}=Qa(),BS=bl(),{compareIdentifiers:Ta}=Wp(),qp=class r{constructor(e,t){if(t=BS(t),e instanceof r){if(e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease)return e;e=e.version}else if(typeof e!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof e}".`);if(e.length>Ab)throw new TypeError(`version is longer than ${Ab} characters`);Bl("SemVer",e,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;let n=e.trim().match(t.loose?Cl[El.LOOSE]:Cl[El.FULL]);if(!n)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+n[1],this.minor=+n[2],this.patch=+n[3],this.major>vl||this.major<0)throw new TypeError("Invalid major version");if(this.minor>vl||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>vl||this.patch<0)throw new TypeError("Invalid patch version");n[4]?this.prerelease=n[4].split(".").map(A=>{if(/^[0-9]+$/.test(A)){let s=+A;if(s>=0&&s<vl)return s}return A}):this.prerelease=[],this.build=n[5]?n[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(Bl("SemVer.compare",this.version,this.options,e),!(e instanceof r)){if(typeof e=="string"&&e===this.version)return 0;e=new r(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof r||(e=new r(e,this.options)),Ta(this.major,e.major)||Ta(this.minor,e.minor)||Ta(this.patch,e.patch)}comparePre(e){if(e instanceof r||(e=new r(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let t=0;do{let n=this.prerelease[t],A=e.prerelease[t];if(Bl("prerelease compare",t,n,A),n===void 0&&A===void 0)return 0;if(A===void 0)return 1;if(n===void 0)return-1;if(n===A)continue;return Ta(n,A)}while(++t)}compareBuild(e){e instanceof r||(e=new r(e,this.options));let t=0;do{let n=this.build[t],A=e.build[t];if(Bl("build compare",t,n,A),n===void 0&&A===void 0)return 0;if(A===void 0)return 1;if(n===void 0)return-1;if(n===A)continue;return Ta(n,A)}while(++t)}inc(e,t,n){if(e.startsWith("pre")){if(!t&&n===!1)throw new Error("invalid increment argument: identifier is empty");if(t){let A=`-${t}`.match(this.options.loose?Cl[El.PRERELEASELOOSE]:Cl[El.PRERELEASE]);if(!A||A[1]!==t)throw new Error(`invalid identifier: ${t}`)}}switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t,n);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t,n);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t,n),this.inc("pre",t,n);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",t,n),this.inc("pre",t,n);break;case"release":if(this.prerelease.length===0)throw new Error(`version ${this.raw} is not a prerelease`);this.prerelease.length=0;break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{let A=Number(n)?1:0;if(this.prerelease.length===0)this.prerelease=[A];else{let s=this.prerelease.length;for(;--s>=0;)typeof this.prerelease[s]=="number"&&(this.prerelease[s]++,s=-2);if(s===-1){if(t===this.prerelease.join(".")&&n===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(A)}}if(t){let s=[t,A];n===!1&&(s=[t]),Ta(this.prerelease[0],t)===0?isNaN(this.prerelease[1])&&(this.prerelease=s):this.prerelease=s}break}default:throw new Error(`invalid increment argument: ${e}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}};sb.exports=qp});var pi=oe((DK,ab)=>{"use strict";var ib=Xt(),vS=(r,e,t=!1)=>{if(r instanceof ib)return r;try{return new ib(r,e)}catch(n){if(!t)return null;throw n}};ab.exports=vS});var ub=oe((MK,ob)=>{"use strict";var CS=pi(),ES=(r,e)=>{let t=CS(r,e);return t?t.version:null};ob.exports=ES});var lb=oe(($K,cb)=>{"use strict";var xS=pi(),IS=(r,e)=>{let t=xS(r.trim().replace(/^[=v]+/,""),e);return t?t.version:null};cb.exports=IS});var pb=oe((jK,db)=>{"use strict";var fb=Xt(),US=(r,e,t,n,A)=>{typeof t=="string"&&(A=n,n=t,t=void 0);try{return new fb(r instanceof fb?r.version:r,t).inc(e,n,A).version}catch{return null}};db.exports=US});var gb=oe((KK,mb)=>{"use strict";var hb=pi(),FS=(r,e)=>{let t=hb(r,null,!0),n=hb(e,null,!0),A=t.compare(n);if(A===0)return null;let s=A>0,i=s?t:n,a=s?n:t,f=!!i.prerelease.length;if(!!a.prerelease.length&&!f){if(!a.patch&&!a.minor)return"major";if(a.compareMain(i)===0)return a.minor&&!a.patch?"minor":"patch"}let h=f?"pre":"";return t.major!==n.major?h+"major":t.minor!==n.minor?h+"minor":t.patch!==n.patch?h+"patch":"prerelease"};mb.exports=FS});var yb=oe((zK,wb)=>{"use strict";var QS=Xt(),TS=(r,e)=>new QS(r,e).major;wb.exports=TS});var bb=oe((GK,_b)=>{"use strict";var OS=Xt(),SS=(r,e)=>new OS(r,e).minor;_b.exports=SS});var vb=oe((VK,Bb)=>{"use strict";var PS=Xt(),RS=(r,e)=>new PS(r,e).patch;Bb.exports=RS});var Eb=oe((ZK,Cb)=>{"use strict";var kS=pi(),NS=(r,e)=>{let t=kS(r,e);return t&&t.prerelease.length?t.prerelease:null};Cb.exports=NS});var Wr=oe((JK,Ib)=>{"use strict";var xb=Xt(),LS=(r,e,t)=>new xb(r,t).compare(new xb(e,t));Ib.exports=LS});var Fb=oe((WK,Ub)=>{"use strict";var HS=Wr(),DS=(r,e,t)=>HS(e,r,t);Ub.exports=DS});var Tb=oe((qK,Qb)=>{"use strict";var MS=Wr(),$S=(r,e)=>MS(r,e,!0);Qb.exports=$S});var xl=oe((XK,Sb)=>{"use strict";var Ob=Xt(),jS=(r,e,t)=>{let n=new Ob(r,t),A=new Ob(e,t);return n.compare(A)||n.compareBuild(A)};Sb.exports=jS});var Rb=oe((YK,Pb)=>{"use strict";var KS=xl(),zS=(r,e)=>r.sort((t,n)=>KS(t,n,e));Pb.exports=zS});var Nb=oe((ez,kb)=>{"use strict";var GS=xl(),VS=(r,e)=>r.sort((t,n)=>GS(n,t,e));kb.exports=VS});var qo=oe((tz,Lb)=>{"use strict";var ZS=Wr(),JS=(r,e,t)=>ZS(r,e,t)>0;Lb.exports=JS});var Il=oe((rz,Hb)=>{"use strict";var WS=Wr(),qS=(r,e,t)=>WS(r,e,t)<0;Hb.exports=qS});var Xp=oe((nz,Db)=>{"use strict";var XS=Wr(),YS=(r,e,t)=>XS(r,e,t)===0;Db.exports=YS});var Yp=oe((Az,Mb)=>{"use strict";var eP=Wr(),tP=(r,e,t)=>eP(r,e,t)!==0;Mb.exports=tP});var Ul=oe((sz,$b)=>{"use strict";var rP=Wr(),nP=(r,e,t)=>rP(r,e,t)>=0;$b.exports=nP});var Fl=oe((iz,jb)=>{"use strict";var AP=Wr(),sP=(r,e,t)=>AP(r,e,t)<=0;jb.exports=sP});var eh=oe((az,Kb)=>{"use strict";var iP=Xp(),aP=Yp(),oP=qo(),uP=Ul(),cP=Il(),lP=Fl(),fP=(r,e,t,n)=>{switch(e){case"===":return typeof r=="object"&&(r=r.version),typeof t=="object"&&(t=t.version),r===t;case"!==":return typeof r=="object"&&(r=r.version),typeof t=="object"&&(t=t.version),r!==t;case"":case"=":case"==":return iP(r,t,n);case"!=":return aP(r,t,n);case">":return oP(r,t,n);case">=":return uP(r,t,n);case"<":return cP(r,t,n);case"<=":return lP(r,t,n);default:throw new TypeError(`Invalid operator: ${e}`)}};Kb.exports=fP});var Gb=oe((oz,zb)=>{"use strict";var dP=Xt(),pP=pi(),{safeRe:Ql,t:Tl}=Qa(),hP=(r,e)=>{if(r instanceof dP)return r;if(typeof r=="number"&&(r=String(r)),typeof r!="string")return null;e=e||{};let t=null;if(!e.rtl)t=r.match(e.includePrerelease?Ql[Tl.COERCEFULL]:Ql[Tl.COERCE]);else{let f=e.includePrerelease?Ql[Tl.COERCERTLFULL]:Ql[Tl.COERCERTL],d;for(;(d=f.exec(r))&&(!t||t.index+t[0].length!==r.length);)(!t||d.index+d[0].length!==t.index+t[0].length)&&(t=d),f.lastIndex=d.index+d[1].length+d[2].length;f.lastIndex=-1}if(t===null)return null;let n=t[2],A=t[3]||"0",s=t[4]||"0",i=e.includePrerelease&&t[5]?`-${t[5]}`:"",a=e.includePrerelease&&t[6]?`+${t[6]}`:"";return pP(`${n}.${A}.${s}${i}${a}`,e)};zb.exports=hP});var Zb=oe((uz,Vb)=>{"use strict";var th=class{constructor(){this.max=1e3,this.map=new Map}get(e){let t=this.map.get(e);if(t!==void 0)return this.map.delete(e),this.map.set(e,t),t}delete(e){return this.map.delete(e)}set(e,t){if(!this.delete(e)&&t!==void 0){if(this.map.size>=this.max){let A=this.map.keys().next().value;this.delete(A)}this.map.set(e,t)}return this}};Vb.exports=th});var qr=oe((cz,Xb)=>{"use strict";var mP=/\s+/g,rh=class r{constructor(e,t){if(t=wP(t),e instanceof r)return e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease?e:new r(e.raw,t);if(e instanceof nh)return this.raw=e.value,this.set=[[e]],this.formatted=void 0,this;if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e.trim().replace(mP," "),this.set=this.raw.split("||").map(n=>this.parseRange(n.trim())).filter(n=>n.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){let n=this.set[0];if(this.set=this.set.filter(A=>!Wb(A[0])),this.set.length===0)this.set=[n];else if(this.set.length>1){for(let A of this.set)if(A.length===1&&EP(A[0])){this.set=[A];break}}}this.formatted=void 0}get range(){if(this.formatted===void 0){this.formatted="";for(let e=0;e<this.set.length;e++){e>0&&(this.formatted+="||");let t=this.set[e];for(let n=0;n<t.length;n++)n>0&&(this.formatted+=" "),this.formatted+=t[n].toString().trim()}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(e){let n=((this.options.includePrerelease&&vP)|(this.options.loose&&CP))+":"+e,A=Jb.get(n);if(A)return A;let s=this.options.loose,i=s?br[ar.HYPHENRANGELOOSE]:br[ar.HYPHENRANGE];e=e.replace(i,RP(this.options.includePrerelease)),et("hyphen replace",e),e=e.replace(br[ar.COMPARATORTRIM],_P),et("comparator trim",e),e=e.replace(br[ar.TILDETRIM],bP),et("tilde trim",e),e=e.replace(br[ar.CARETTRIM],BP),et("caret trim",e);let a=e.split(" ").map(m=>xP(m,this.options)).join(" ").split(/\s+/).map(m=>PP(m,this.options));s&&(a=a.filter(m=>(et("loose invalid filter",m,this.options),!!m.match(br[ar.COMPARATORLOOSE])))),et("range list",a);let f=new Map,d=a.map(m=>new nh(m,this.options));for(let m of d){if(Wb(m))return[m];f.set(m.value,m)}f.size>1&&f.has("")&&f.delete("");let h=[...f.values()];return Jb.set(n,h),h}intersects(e,t){if(!(e instanceof r))throw new TypeError("a Range is required");return this.set.some(n=>qb(n,t)&&e.set.some(A=>qb(A,t)&&n.every(s=>A.every(i=>s.intersects(i,t)))))}test(e){if(!e)return!1;if(typeof e=="string")try{e=new yP(e,this.options)}catch{return!1}for(let t=0;t<this.set.length;t++)if(kP(this.set[t],e,this.options))return!0;return!1}};Xb.exports=rh;var gP=Zb(),Jb=new gP,wP=bl(),nh=Xo(),et=Wo(),yP=Xt(),{safeRe:br,t:ar,comparatorTrimReplace:_P,tildeTrimReplace:bP,caretTrimReplace:BP}=Qa(),{FLAG_INCLUDE_PRERELEASE:vP,FLAG_LOOSE:CP}=Jo(),Wb=r=>r.value==="<0.0.0-0",EP=r=>r.value==="",qb=(r,e)=>{let t=!0,n=r.slice(),A=n.pop();for(;t&&n.length;)t=n.every(s=>A.intersects(s,e)),A=n.pop();return t},xP=(r,e)=>(et("comp",r,e),r=FP(r,e),et("caret",r),r=IP(r,e),et("tildes",r),r=TP(r,e),et("xrange",r),r=SP(r,e),et("stars",r),r),or=r=>!r||r.toLowerCase()==="x"||r==="*",IP=(r,e)=>r.trim().split(/\s+/).map(t=>UP(t,e)).join(" "),UP=(r,e)=>{let t=e.loose?br[ar.TILDELOOSE]:br[ar.TILDE];return r.replace(t,(n,A,s,i,a)=>{et("tilde",r,n,A,s,i,a);let f;return or(A)?f="":or(s)?f=`>=${A}.0.0 <${+A+1}.0.0-0`:or(i)?f=`>=${A}.${s}.0 <${A}.${+s+1}.0-0`:a?(et("replaceTilde pr",a),f=`>=${A}.${s}.${i}-${a} <${A}.${+s+1}.0-0`):f=`>=${A}.${s}.${i} <${A}.${+s+1}.0-0`,et("tilde return",f),f})},FP=(r,e)=>r.trim().split(/\s+/).map(t=>QP(t,e)).join(" "),QP=(r,e)=>{et("caret",r,e);let t=e.loose?br[ar.CARETLOOSE]:br[ar.CARET],n=e.includePrerelease?"-0":"";return r.replace(t,(A,s,i,a,f)=>{et("caret",r,A,s,i,a,f);let d;return or(s)?d="":or(i)?d=`>=${s}.0.0${n} <${+s+1}.0.0-0`:or(a)?s==="0"?d=`>=${s}.${i}.0${n} <${s}.${+i+1}.0-0`:d=`>=${s}.${i}.0${n} <${+s+1}.0.0-0`:f?(et("replaceCaret pr",f),s==="0"?i==="0"?d=`>=${s}.${i}.${a}-${f} <${s}.${i}.${+a+1}-0`:d=`>=${s}.${i}.${a}-${f} <${s}.${+i+1}.0-0`:d=`>=${s}.${i}.${a}-${f} <${+s+1}.0.0-0`):(et("no pr"),s==="0"?i==="0"?d=`>=${s}.${i}.${a}${n} <${s}.${i}.${+a+1}-0`:d=`>=${s}.${i}.${a}${n} <${s}.${+i+1}.0-0`:d=`>=${s}.${i}.${a} <${+s+1}.0.0-0`),et("caret return",d),d})},TP=(r,e)=>(et("replaceXRanges",r,e),r.split(/\s+/).map(t=>OP(t,e)).join(" ")),OP=(r,e)=>{r=r.trim();let t=e.loose?br[ar.XRANGELOOSE]:br[ar.XRANGE];return r.replace(t,(n,A,s,i,a,f)=>{et("xRange",r,n,A,s,i,a,f);let d=or(s),h=d||or(i),m=h||or(a),y=m;return A==="="&&y&&(A=""),f=e.includePrerelease?"-0":"",d?A===">"||A==="<"?n="<0.0.0-0":n="*":A&&y?(h&&(i=0),a=0,A===">"?(A=">=",h?(s=+s+1,i=0,a=0):(i=+i+1,a=0)):A==="<="&&(A="<",h?s=+s+1:i=+i+1),A==="<"&&(f="-0"),n=`${A+s}.${i}.${a}${f}`):h?n=`>=${s}.0.0${f} <${+s+1}.0.0-0`:m&&(n=`>=${s}.${i}.0${f} <${s}.${+i+1}.0-0`),et("xRange return",n),n})},SP=(r,e)=>(et("replaceStars",r,e),r.trim().replace(br[ar.STAR],"")),PP=(r,e)=>(et("replaceGTE0",r,e),r.trim().replace(br[e.includePrerelease?ar.GTE0PRE:ar.GTE0],"")),RP=r=>(e,t,n,A,s,i,a,f,d,h,m,y)=>(or(n)?t="":or(A)?t=`>=${n}.0.0${r?"-0":""}`:or(s)?t=`>=${n}.${A}.0${r?"-0":""}`:i?t=`>=${t}`:t=`>=${t}${r?"-0":""}`,or(d)?f="":or(h)?f=`<${+d+1}.0.0-0`:or(m)?f=`<${d}.${+h+1}.0-0`:y?f=`<=${d}.${h}.${m}-${y}`:r?f=`<${d}.${h}.${+m+1}-0`:f=`<=${f}`,`${t} ${f}`.trim()),kP=(r,e,t)=>{for(let n=0;n<r.length;n++)if(!r[n].test(e))return!1;if(e.prerelease.length&&!t.includePrerelease){for(let n=0;n<r.length;n++)if(et(r[n].semver),r[n].semver!==nh.ANY&&r[n].semver.prerelease.length>0){let A=r[n].semver;if(A.major===e.major&&A.minor===e.minor&&A.patch===e.patch)return!0}return!1}return!0}});var Xo=oe((lz,AB)=>{"use strict";var Yo=Symbol("SemVer ANY"),ih=class r{static get ANY(){return Yo}constructor(e,t){if(t=Yb(t),e instanceof r){if(e.loose===!!t.loose)return e;e=e.value}e=e.trim().split(/\s+/).join(" "),sh("comparator",e,t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===Yo?this.value="":this.value=this.operator+this.semver.version,sh("comp",this)}parse(e){let t=this.options.loose?eB[tB.COMPARATORLOOSE]:eB[tB.COMPARATOR],n=e.match(t);if(!n)throw new TypeError(`Invalid comparator: ${e}`);this.operator=n[1]!==void 0?n[1]:"",this.operator==="="&&(this.operator=""),n[2]?this.semver=new rB(n[2],this.options.loose):this.semver=Yo}toString(){return this.value}test(e){if(sh("Comparator.test",e,this.options.loose),this.semver===Yo||e===Yo)return!0;if(typeof e=="string")try{e=new rB(e,this.options)}catch{return!1}return Ah(e,this.operator,this.semver,this.options)}intersects(e,t){if(!(e instanceof r))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new nB(e.value,t).test(this.value):e.operator===""?e.value===""?!0:new nB(this.value,t).test(e.semver):(t=Yb(t),t.includePrerelease&&(this.value==="<0.0.0-0"||e.value==="<0.0.0-0")||!t.includePrerelease&&(this.value.startsWith("<0.0.0")||e.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&e.operator.startsWith(">")||this.operator.startsWith("<")&&e.operator.startsWith("<")||this.semver.version===e.semver.version&&this.operator.includes("=")&&e.operator.includes("=")||Ah(this.semver,"<",e.semver,t)&&this.operator.startsWith(">")&&e.operator.startsWith("<")||Ah(this.semver,">",e.semver,t)&&this.operator.startsWith("<")&&e.operator.startsWith(">")))}};AB.exports=ih;var Yb=bl(),{safeRe:eB,t:tB}=Qa(),Ah=eh(),sh=Wo(),rB=Xt(),nB=qr()});var eu=oe((fz,sB)=>{"use strict";var NP=qr(),LP=(r,e,t)=>{try{e=new NP(e,t)}catch{return!1}return e.test(r)};sB.exports=LP});var aB=oe((dz,iB)=>{"use strict";var HP=qr(),DP=(r,e)=>new HP(r,e).set.map(t=>t.map(n=>n.value).join(" ").trim().split(" "));iB.exports=DP});var uB=oe((pz,oB)=>{"use strict";var MP=Xt(),$P=qr(),jP=(r,e,t)=>{let n=null,A=null,s=null;try{s=new $P(e,t)}catch{return null}return r.forEach(i=>{s.test(i)&&(!n||A.compare(i)===-1)&&(n=i,A=new MP(n,t))}),n};oB.exports=jP});var lB=oe((hz,cB)=>{"use strict";var KP=Xt(),zP=qr(),GP=(r,e,t)=>{let n=null,A=null,s=null;try{s=new zP(e,t)}catch{return null}return r.forEach(i=>{s.test(i)&&(!n||A.compare(i)===1)&&(n=i,A=new KP(n,t))}),n};cB.exports=GP});var pB=oe((mz,dB)=>{"use strict";var ah=Xt(),VP=qr(),fB=qo(),ZP=(r,e)=>{r=new VP(r,e);let t=new ah("0.0.0");if(r.test(t)||(t=new ah("0.0.0-0"),r.test(t)))return t;t=null;for(let n=0;n<r.set.length;++n){let A=r.set[n],s=null;A.forEach(i=>{let a=new ah(i.semver.version);switch(i.operator){case">":a.prerelease.length===0?a.patch++:a.prerelease.push(0),a.raw=a.format();case"":case">=":(!s||fB(a,s))&&(s=a);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${i.operator}`)}}),s&&(!t||fB(t,s))&&(t=s)}return t&&r.test(t)?t:null};dB.exports=ZP});var mB=oe((gz,hB)=>{"use strict";var JP=qr(),WP=(r,e)=>{try{return new JP(r,e).range||"*"}catch{return null}};hB.exports=WP});var Ol=oe((wz,_B)=>{"use strict";var qP=Xt(),yB=Xo(),{ANY:XP}=yB,YP=qr(),eR=eu(),gB=qo(),wB=Il(),tR=Fl(),rR=Ul(),nR=(r,e,t,n)=>{r=new qP(r,n),e=new YP(e,n);let A,s,i,a,f;switch(t){case">":A=gB,s=tR,i=wB,a=">",f=">=";break;case"<":A=wB,s=rR,i=gB,a="<",f="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(eR(r,e,n))return!1;for(let d=0;d<e.set.length;++d){let h=e.set[d],m=null,y=null;if(h.forEach(w=>{w.semver===XP&&(w=new yB(">=0.0.0")),m=m||w,y=y||w,A(w.semver,m.semver,n)?m=w:i(w.semver,y.semver,n)&&(y=w)}),m.operator===a||m.operator===f||(!y.operator||y.operator===a)&&s(r,y.semver))return!1;if(y.operator===f&&i(r,y.semver))return!1}return!0};_B.exports=nR});var BB=oe((yz,bB)=>{"use strict";var AR=Ol(),sR=(r,e,t)=>AR(r,e,">",t);bB.exports=sR});var CB=oe((_z,vB)=>{"use strict";var iR=Ol(),aR=(r,e,t)=>iR(r,e,"<",t);vB.exports=aR});var IB=oe((bz,xB)=>{"use strict";var EB=qr(),oR=(r,e,t)=>(r=new EB(r,t),e=new EB(e,t),r.intersects(e,t));xB.exports=oR});var FB=oe((Bz,UB)=>{"use strict";var uR=eu(),cR=Wr();UB.exports=(r,e,t)=>{let n=[],A=null,s=null,i=r.sort((h,m)=>cR(h,m,t));for(let h of i)uR(h,e,t)?(s=h,A||(A=h)):(s&&n.push([A,s]),s=null,A=null);A&&n.push([A,null]);let a=[];for(let[h,m]of n)h===m?a.push(h):!m&&h===i[0]?a.push("*"):m?h===i[0]?a.push(`<=${m}`):a.push(`${h} - ${m}`):a.push(`>=${h}`);let f=a.join(" || "),d=typeof e.raw=="string"?e.raw:String(e);return f.length<d.length?f:e}});var RB=oe((vz,PB)=>{"use strict";var QB=qr(),uh=Xo(),{ANY:oh}=uh,tu=eu(),ch=Wr(),lR=(r,e,t={})=>{if(r===e)return!0;r=new QB(r,t),e=new QB(e,t);let n=!1;e:for(let A of r.set){for(let s of e.set){let i=dR(A,s,t);if(n=n||i!==null,i)continue e}if(n)return!1}return!0},fR=[new uh(">=0.0.0-0")],TB=[new uh(">=0.0.0")],dR=(r,e,t)=>{if(r===e)return!0;if(r.length===1&&r[0].semver===oh){if(e.length===1&&e[0].semver===oh)return!0;t.includePrerelease?r=fR:r=TB}if(e.length===1&&e[0].semver===oh){if(t.includePrerelease)return!0;e=TB}let n=new Set,A,s;for(let w of r)w.operator===">"||w.operator===">="?A=OB(A,w,t):w.operator==="<"||w.operator==="<="?s=SB(s,w,t):n.add(w.semver);if(n.size>1)return null;let i;if(A&&s){if(i=ch(A.semver,s.semver,t),i>0)return null;if(i===0&&(A.operator!==">="||s.operator!=="<="))return null}for(let w of n){if(A&&!tu(w,String(A),t)||s&&!tu(w,String(s),t))return null;for(let b of e)if(!tu(w,String(b),t))return!1;return!0}let a,f,d,h,m=s&&!t.includePrerelease&&s.semver.prerelease.length?s.semver:!1,y=A&&!t.includePrerelease&&A.semver.prerelease.length?A.semver:!1;m&&m.prerelease.length===1&&s.operator==="<"&&m.prerelease[0]===0&&(m=!1);for(let w of e){if(h=h||w.operator===">"||w.operator===">=",d=d||w.operator==="<"||w.operator==="<=",A){if(y&&w.semver.prerelease&&w.semver.prerelease.length&&w.semver.major===y.major&&w.semver.minor===y.minor&&w.semver.patch===y.patch&&(y=!1),w.operator===">"||w.operator===">="){if(a=OB(A,w,t),a===w&&a!==A)return!1}else if(A.operator===">="&&!tu(A.semver,String(w),t))return!1}if(s){if(m&&w.semver.prerelease&&w.semver.prerelease.length&&w.semver.major===m.major&&w.semver.minor===m.minor&&w.semver.patch===m.patch&&(m=!1),w.operator==="<"||w.operator==="<="){if(f=SB(s,w,t),f===w&&f!==s)return!1}else if(s.operator==="<="&&!tu(s.semver,String(w),t))return!1}if(!w.operator&&(s||A)&&i!==0)return!1}return!(A&&d&&!s&&i!==0||s&&h&&!A&&i!==0||y||m)},OB=(r,e,t)=>{if(!r)return e;let n=ch(r.semver,e.semver,t);return n>0?r:n<0||e.operator===">"&&r.operator===">="?e:r},SB=(r,e,t)=>{if(!r)return e;let n=ch(r.semver,e.semver,t);return n<0?r:n>0||e.operator==="<"&&r.operator==="<="?e:r};PB.exports=lR});var HB=oe((Cz,LB)=>{"use strict";var lh=Qa(),kB=Jo(),pR=Xt(),NB=Wp(),hR=pi(),mR=ub(),gR=lb(),wR=pb(),yR=gb(),_R=yb(),bR=bb(),BR=vb(),vR=Eb(),CR=Wr(),ER=Fb(),xR=Tb(),IR=xl(),UR=Rb(),FR=Nb(),QR=qo(),TR=Il(),OR=Xp(),SR=Yp(),PR=Ul(),RR=Fl(),kR=eh(),NR=Gb(),LR=Xo(),HR=qr(),DR=eu(),MR=aB(),$R=uB(),jR=lB(),KR=pB(),zR=mB(),GR=Ol(),VR=BB(),ZR=CB(),JR=IB(),WR=FB(),qR=RB();LB.exports={parse:hR,valid:mR,clean:gR,inc:wR,diff:yR,major:_R,minor:bR,patch:BR,prerelease:vR,compare:CR,rcompare:ER,compareLoose:xR,compareBuild:IR,sort:UR,rsort:FR,gt:QR,lt:TR,eq:OR,neq:SR,gte:PR,lte:RR,cmp:kR,coerce:NR,Comparator:LR,Range:HR,satisfies:DR,toComparators:MR,maxSatisfying:$R,minSatisfying:jR,minVersion:KR,validRange:zR,outside:GR,gtr:VR,ltr:ZR,intersects:JR,simplifyRange:WR,subset:qR,SemVer:pR,re:lh.re,src:lh.src,tokens:lh.t,SEMVER_SPEC_VERSION:kB.SEMVER_SPEC_VERSION,RELEASE_TYPES:kB.RELEASE_TYPES,compareIdentifiers:NB.compareIdentifiers,rcompareIdentifiers:NB.rcompareIdentifiers}});var A0=oe((cG,n0)=>{"use strict";var t0=(r=0)=>e=>`\x1B[${38+r};5;${e}m`,r0=(r=0)=>(e,t,n)=>`\x1B[${38+r};2;${e};${t};${n}m`;function Bk(){let r=new Map,e={modifier:{reset:[0,0],bold:[1,22],dim:[2,22],italic:[3,23],underline:[4,24],overline:[53,55],inverse:[7,27],hidden:[8,28],strikethrough:[9,29]},color:{black:[30,39],red:[31,39],green:[32,39],yellow:[33,39],blue:[34,39],magenta:[35,39],cyan:[36,39],white:[37,39],blackBright:[90,39],redBright:[91,39],greenBright:[92,39],yellowBright:[93,39],blueBright:[94,39],magentaBright:[95,39],cyanBright:[96,39],whiteBright:[97,39]},bgColor:{bgBlack:[40,49],bgRed:[41,49],bgGreen:[42,49],bgYellow:[43,49],bgBlue:[44,49],bgMagenta:[45,49],bgCyan:[46,49],bgWhite:[47,49],bgBlackBright:[100,49],bgRedBright:[101,49],bgGreenBright:[102,49],bgYellowBright:[103,49],bgBlueBright:[104,49],bgMagentaBright:[105,49],bgCyanBright:[106,49],bgWhiteBright:[107,49]}};e.color.gray=e.color.blackBright,e.bgColor.bgGray=e.bgColor.bgBlackBright,e.color.grey=e.color.blackBright,e.bgColor.bgGrey=e.bgColor.bgBlackBright;for(let[t,n]of Object.entries(e)){for(let[A,s]of Object.entries(n))e[A]={open:`\x1B[${s[0]}m`,close:`\x1B[${s[1]}m`},n[A]=e[A],r.set(s[0],s[1]);Object.defineProperty(e,t,{value:n,enumerable:!1})}return Object.defineProperty(e,"codes",{value:r,enumerable:!1}),e.color.close="\x1B[39m",e.bgColor.close="\x1B[49m",e.color.ansi256=t0(),e.color.ansi16m=r0(),e.bgColor.ansi256=t0(10),e.bgColor.ansi16m=r0(10),Object.defineProperties(e,{rgbToAnsi256:{value:(t,n,A)=>t===n&&n===A?t<8?16:t>248?231:Math.round((t-8)/247*24)+232:16+36*Math.round(t/255*5)+6*Math.round(n/255*5)+Math.round(A/255*5),enumerable:!1},hexToRgb:{value:t=>{let n=/(?<colorString>[a-f\d]{6}|[a-f\d]{3})/i.exec(t.toString(16));if(!n)return[0,0,0];let{colorString:A}=n.groups;A.length===3&&(A=A.split("").map(i=>i+i).join(""));let s=Number.parseInt(A,16);return[s>>16&255,s>>8&255,s&255]},enumerable:!1},hexToAnsi256:{value:t=>e.rgbToAnsi256(...e.hexToRgb(t)),enumerable:!1}}),e}Object.defineProperty(n0,"exports",{enumerable:!0,get:Bk})});var vv=oe(pf=>{"use strict";pf.byteLength=R1;pf.toByteArray=N1;pf.fromByteArray=D1;var Gn=[],rn=[],P1=typeof Uint8Array<"u"?Uint8Array:Array,Wh="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(wi=0,bv=Wh.length;wi<bv;++wi)Gn[wi]=Wh[wi],rn[Wh.charCodeAt(wi)]=wi;var wi,bv;rn[45]=62;rn[95]=63;function Bv(r){var e=r.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var t=r.indexOf("=");t===-1&&(t=e);var n=t===e?0:4-t%4;return[t,n]}function R1(r){var e=Bv(r),t=e[0],n=e[1];return(t+n)*3/4-n}function k1(r,e,t){return(e+t)*3/4-t}function N1(r){var e,t=Bv(r),n=t[0],A=t[1],s=new P1(k1(r,n,A)),i=0,a=A>0?n-4:n,f;for(f=0;f<a;f+=4)e=rn[r.charCodeAt(f)]<<18|rn[r.charCodeAt(f+1)]<<12|rn[r.charCodeAt(f+2)]<<6|rn[r.charCodeAt(f+3)],s[i++]=e>>16&255,s[i++]=e>>8&255,s[i++]=e&255;return A===2&&(e=rn[r.charCodeAt(f)]<<2|rn[r.charCodeAt(f+1)]>>4,s[i++]=e&255),A===1&&(e=rn[r.charCodeAt(f)]<<10|rn[r.charCodeAt(f+1)]<<4|rn[r.charCodeAt(f+2)]>>2,s[i++]=e>>8&255,s[i++]=e&255),s}function L1(r){return Gn[r>>18&63]+Gn[r>>12&63]+Gn[r>>6&63]+Gn[r&63]}function H1(r,e,t){for(var n,A=[],s=e;s<t;s+=3)n=(r[s]<<16&16711680)+(r[s+1]<<8&65280)+(r[s+2]&255),A.push(L1(n));return A.join("")}function D1(r){for(var e,t=r.length,n=t%3,A=[],s=16383,i=0,a=t-n;i<a;i+=s)A.push(H1(r,i,i+s>a?a:i+s));return n===1?(e=r[t-1],A.push(Gn[e>>2]+Gn[e<<4&63]+"==")):n===2&&(e=(r[t-2]<<8)+r[t-1],A.push(Gn[e>>10]+Gn[e>>4&63]+Gn[e<<2&63]+"=")),A.join("")}});var pN={};hd(pN,{CHAT_STORAGE_PREFIX:()=>Wa,ChatEnabled:()=>wd,DefaultChatbot:()=>vC,FloatingWindow:()=>dc,clearAllConversations:()=>BC,clearConversation:()=>bC,getConversationStorageKey:()=>gm});module.exports=QF(pN);var Vt=Ur(require("react"),1),uw=Ur(ow(),1);var nA=require("react"),En=require("react/jsx-runtime"),dc=({children:r,title:e,onClose:t,position:n="bottom-right",width:A=360,height:s=480,minWidth:i=280,minHeight:a=240,offset:f=16,zIndex:d=1e3,className:h,style:m,headerClassName:y,bodyClassName:w,closeButtonAriaLabel:b="Close",closeOnEscape:C=!0,draggable:I=!0,anchorRect:T})=>{let[Q,P]=(0,nA.useState)(!1),R=(0,nA.useRef)(null),[D,ee]=(0,nA.useState)(!1),Y=(0,nA.useRef)(null),[fe,ve]=(0,nA.useState)(null);(0,nA.useEffect)(()=>{if(!C)return;let $e=Ye=>{Ye.key==="Escape"&&t?.()};return window.addEventListener("keydown",$e),()=>window.removeEventListener("keydown",$e)},[C,t]);let Ie=(()=>{let $e=`${f}px`;switch(n){case"top-left":return{top:$e,left:$e};case"top-right":return{top:$e,right:$e};case"bottom-left":return{bottom:$e,left:$e};case"bottom-right":default:return{bottom:$e,right:$e}}})(),Te=(()=>{if(n!=="auto"||!T)return null;let $e=window.innerWidth,Ye=window.innerHeight,At=f,Ut=T.top<Ye/2,Ft=T.left>$e/2,Qt=Ut?["bottom","top"]:["top","bottom"],st=Ft?["right","left"]:["left","right"],de=[`${Qt[0]}-${st[0]}`,`${Qt[0]}-${st[1]}`,`${Qt[1]}-${st[0]}`,`${Qt[1]}-${st[1]}`];for(let ye of de){let Ze=0,Ge=0;if(ye==="bottom-right"?(Ze=T.bottom+At,Ge=T.right-A):ye==="bottom-left"?(Ze=T.bottom+At,Ge=T.left):ye==="top-right"?(Ze=T.top-s-At,Ge=T.right-A):(Ze=T.top-s-At,Ge=T.left),Ze>=0&&Ge>=0&&Ze+s<=Ye&&Ge+A<=$e)return{top:Ze,left:Ge}}let we=Math.min(Math.max(T.bottom+At,0),Ye-s),ue=Math.min(Math.max(T.right-A,0),$e-A);return{top:we,left:ue}})(),_t=$e=>{if(!I)return;let Ye=R.current;if(!Ye)return;let At=Ye.getBoundingClientRect();Y.current={x:$e.clientX,y:$e.clientY,top:At.top,left:At.left},ve({top:At.top,left:At.left}),ee(!0);let Ut=Qt=>{if(!Y.current)return;let st=Qt.clientX-Y.current.x,de=Qt.clientY-Y.current.y;ve({top:Y.current.top+de,left:Y.current.left+st})},Ft=()=>{ee(!1),Y.current=null,window.removeEventListener("pointermove",Ut),window.removeEventListener("pointerup",Ft)};window.addEventListener("pointermove",Ut),window.addEventListener("pointerup",Ft,{once:!0})};return(0,En.jsxs)("div",{ref:R,role:"dialog","aria-modal":"false",className:h,style:{position:"fixed",...fe?{top:fe.top,left:fe.left}:Te?{top:Te.top,left:Te.left}:Ie,width:A,height:s,minWidth:i,minHeight:a,zIndex:d,background:"#ffffff",border:"1px solid rgba(0,0,0,0.06)",borderRadius:12,boxShadow:"0 10px 30px rgba(0,0,0,0.15), 0 4px 12px rgba(0,0,0,0.08)",display:"flex",flexDirection:"column",overflow:"hidden",userSelect:D?"none":void 0,...m},children:[(0,En.jsxs)("div",{className:y,style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"10px 12px",borderBottom:"1px solid rgba(0,0,0,0.06)",background:"#f9fafb",cursor:I?"move":void 0},onPointerDown:_t,children:[(0,En.jsx)("div",{style:{fontWeight:600,color:"#111827"},children:e}),(0,En.jsx)("button",{type:"button",onClick:t,"aria-label":b,onMouseEnter:()=>P(!0),onMouseLeave:()=>P(!1),style:{width:28,height:28,display:"inline-flex",alignItems:"center",justifyContent:"center",borderRadius:8,border:"1px solid rgba(0,0,0,0.08)",background:"white",cursor:"pointer",color:Q?"#ef4444":void 0,transition:"color 120ms ease"},children:(0,En.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,En.jsx)("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),(0,En.jsx)("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),(0,En.jsx)("div",{className:w,style:{flex:1,overflow:"auto",background:"#ffffff"},children:r})]})};var AA=require("react/jsx-runtime"),wd=Vt.default.forwardRef(({children:r,onClick:e,label:t="Open chat",position:n="top-right",offset:A=8,icon:s,className:i,containerStyle:a,buttonClassName:f,buttonStyle:d,buttonSize:h=36,zIndex:m=10,disabled:y=!1,trigger:w,open:b,onOpenChange:C,renderButton:I,openWindowOnClick:T=!1,windowProps:Q,windowContent:P},R)=>{let[D,ee]=(0,Vt.useState)(!1),[Y,fe]=(0,Vt.useState)(!1),ve=(0,Vt.useRef)(null),Ie=(0,Vt.useRef)(null),Te=(0,Vt.useRef)(null),[_t,$e]=(0,Vt.useState)(null),Ye=w??"hover",At=(0,Vt.useMemo)(()=>{let ue={position:"absolute"},ye=`${A}px`;switch(n){case"top-left":return{...ue,top:ye,left:ye};case"top-right":return{...ue,top:ye,right:ye};case"bottom-left":return{...ue,bottom:ye,left:ye};case"bottom-right":default:return{...ue,bottom:ye,right:ye}}},[n,A]),Ut=Ye==="always"?!0:Ye==="manual"?!!b:D,Ft=ue=>{C&&C(ue)},Qt={onMouseEnter:Ye==="hover"?()=>{ee(!0),Ft(!0)}:void 0,onMouseLeave:Ye==="hover"?()=>{ee(!1),Ft(!1)}:void 0,onFocus:Ye==="focus"?()=>{ee(!0),Ft(!0)}:void 0,onBlur:Ye==="focus"?()=>{ee(!1),Ft(!1)}:void 0},st=!!Q?.sendComponentImageAsContext;(0,Vt.useEffect)(()=>{Y&&(async()=>{if(!st)return;let ye=Te.current;if(ye)try{await new Promise(Tt=>requestAnimationFrame(()=>setTimeout(Tt,50)));let Ge=(await(0,uw.default)(ye,{useCORS:!0,backgroundColor:null,scale:Math.min(2,Math.max(1,Math.ceil(ye.offsetWidth/280)))})).toDataURL("image/png",.92);$e(Ge)}catch{}})()},[Y,st]);let de=ue=>{ve.current=ue,typeof R=="function"?R(ue):R&&typeof R=="object"&&(R.current=ue)},we={type:"button","aria-label":t,onClick:ue=>{e?.(ue),!y&&T&&fe(!0)},className:f,disabled:y,style:{...At,zIndex:m,width:h,height:h,borderRadius:9999,display:"flex",alignItems:"center",justifyContent:"center",border:"1px solid rgba(0,0,0,0.08)",background:y?"#f3f4f6":"white",color:y?"#9ca3af":void 0,boxShadow:"0 2px 6px rgba(0,0,0,0.1), 0 1px 2px rgba(0,0,0,0.06)",cursor:y?"not-allowed":"pointer",transition:"opacity 120ms ease, transform 120ms ease",opacity:Ut?1:0,transform:Ut?"scale(1)":"scale(0.95)",pointerEvents:Ut?"auto":"none",...d},tabIndex:Ut?0:-1,"aria-hidden":Ut?void 0:!0,ref:de,visible:Ut};return(0,AA.jsxs)("div",{className:i,style:{position:"relative",display:"inline-block",...a},...Qt,ref:Ie,children:[(0,AA.jsx)("div",{ref:Te,style:{display:"inline-block"},children:r}),I?I(we):(0,AA.jsx)("button",{...we,children:s??(0,AA.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:Math.max(12,Math.floor(h*.5)),height:Math.max(12,Math.floor(h*.5)),viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,AA.jsx)("path",{d:"M21 15a4 4 0 0 1-4 4H7l-4 4V7a4 4 0 0 1 4-4h10a4 4 0 0 1 4 4z"})})}),T&&Y&&P&&(0,AA.jsx)(dc,{...Q,onClose:()=>{Q?.onClose?.(),fe(!1),$e(null)},anchorRect:Q?.anchorRect??(ve.current?ve.current.getBoundingClientRect():null),children:(()=>{if(st){if(!_t)return(0,AA.jsx)("div",{style:{padding:12,color:"#6b7280",fontSize:14},children:"Loading..."});if(Vt.default.isValidElement(P)){let ye=[...P.props?.contextImages??[],_t];try{return Vt.default.cloneElement(P,{contextImages:ye})}catch{return P}}}return P})()})]})});wd.displayName="ChatEnabled";var It=require("react");function ce(r,e,t,n,A){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!A)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!A:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?A.call(r,t):A?A.value=t:e.set(r,t),t}function F(r,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(r):n?n.value:e.get(r)}var yd=function(){let{crypto:r}=globalThis;if(r?.randomUUID)return yd=r.randomUUID.bind(r),r.randomUUID();let e=new Uint8Array(1),t=r?()=>r.getRandomValues(e)[0]:()=>Math.random()*255&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,n=>(+n^t()&15>>+n/4).toString(16))};function wo(r){return typeof r=="object"&&r!==null&&("name"in r&&r.name==="AbortError"||"message"in r&&String(r.message).includes("FetchRequestCanceledException"))}var yo=r=>{if(r instanceof Error)return r;if(typeof r=="object"&&r!==null){try{if(Object.prototype.toString.call(r)==="[object Error]"){let e=new Error(r.message,r.cause?{cause:r.cause}:{});return r.stack&&(e.stack=r.stack),r.cause&&!e.cause&&(e.cause=r.cause),r.name&&(e.name=r.name),e}}catch{}try{return new Error(JSON.stringify(r))}catch{}}return new Error(r)};var re=class extends Error{},Bt=class r extends re{constructor(e,t,n,A){super(`${r.makeMessage(e,t,n)}`),this.status=e,this.headers=A,this.requestID=A?.get("x-request-id"),this.error=t;let s=t;this.code=s?.code,this.param=s?.param,this.type=s?.type}static makeMessage(e,t,n){let A=t?.message?typeof t.message=="string"?t.message:JSON.stringify(t.message):t?JSON.stringify(t):n;return e&&A?`${e} ${A}`:e?`${e} status code (no body)`:A||"(no status code or body)"}static generate(e,t,n,A){if(!e||!A)return new RA({message:n,cause:yo(t)});let s=t?.error;return e===400?new Ri(e,s,n,A):e===401?new ki(e,s,n,A):e===403?new Ni(e,s,n,A):e===404?new Li(e,s,n,A):e===409?new Hi(e,s,n,A):e===422?new Di(e,s,n,A):e===429?new Mi(e,s,n,A):e>=500?new $i(e,s,n,A):new r(e,s,n,A)}},ot=class extends Bt{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}},RA=class extends Bt{constructor({message:e,cause:t}){super(void 0,void 0,e||"Connection error.",void 0),t&&(this.cause=t)}},xn=class extends RA{constructor({message:e}={}){super({message:e??"Request timed out."})}},Ri=class extends Bt{},ki=class extends Bt{},Ni=class extends Bt{},Li=class extends Bt{},Hi=class extends Bt{},Di=class extends Bt{},Mi=class extends Bt{},$i=class extends Bt{},ji=class extends re{constructor(){super("Could not parse response content as the length limit was reached")}},Ki=class extends re{constructor(){super("Could not parse response content as the request was rejected by the content filter")}},In=class extends Error{constructor(e){super(e)}};var OF=/^[a-z][a-z0-9+.-]*:/i,cw=r=>OF.test(r),Zt=r=>(Zt=Array.isArray,Zt(r)),_d=Zt;function lw(r){return typeof r!="object"?{}:r??{}}function fw(r){if(!r)return!0;for(let e in r)return!1;return!0}function dw(r,e){return Object.prototype.hasOwnProperty.call(r,e)}function _o(r){return r!=null&&typeof r=="object"&&!Array.isArray(r)}var pw=(r,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new re(`${r} must be an integer`);if(e<0)throw new re(`${r} must be a positive integer`);return e};var hw=r=>{try{return JSON.parse(r)}catch{return}};var Un=r=>new Promise(e=>setTimeout(e,r));var kA="5.12.2";var yw=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u";function SF(){return typeof Deno<"u"&&Deno.build!=null?"deno":typeof EdgeRuntime<"u"?"edge":Object.prototype.toString.call(typeof globalThis.process<"u"?globalThis.process:0)==="[object process]"?"node":"unknown"}var PF=()=>{let r=SF();if(r==="deno")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":kA,"X-Stainless-OS":gw(Deno.build.os),"X-Stainless-Arch":mw(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:Deno.version?.deno??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":kA,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if(r==="node")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":kA,"X-Stainless-OS":gw(globalThis.process.platform??"unknown"),"X-Stainless-Arch":mw(globalThis.process.arch??"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":globalThis.process.version??"unknown"};let e=RF();return e?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":kA,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${e.browser}`,"X-Stainless-Runtime-Version":e.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":kA,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function RF(){if(typeof navigator>"u"||!navigator)return null;let r=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(let{key:e,pattern:t}of r){let n=t.exec(navigator.userAgent);if(n){let A=n[1]||0,s=n[2]||0,i=n[3]||0;return{browser:e,version:`${A}.${s}.${i}`}}}return null}var mw=r=>r==="x32"?"x32":r==="x86_64"||r==="x64"?"x64":r==="arm"?"arm":r==="aarch64"||r==="arm64"?"arm64":r?`other:${r}`:"unknown",gw=r=>(r=r.toLowerCase(),r.includes("ios")?"iOS":r==="android"?"Android":r==="darwin"?"MacOS":r==="win32"?"Windows":r==="freebsd"?"FreeBSD":r==="openbsd"?"OpenBSD":r==="linux"?"Linux":r?`Other:${r}`:"Unknown"),ww,_w=()=>ww??(ww=PF());function bw(){if(typeof fetch<"u")return fetch;throw new Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new OpenAI({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}function bd(...r){let e=globalThis.ReadableStream;if(typeof e>"u")throw new Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new e(...r)}function pc(r){let e=Symbol.asyncIterator in r?r[Symbol.asyncIterator]():r[Symbol.iterator]();return bd({start(){},async pull(t){let{done:n,value:A}=await e.next();n?t.close():t.enqueue(A)},async cancel(){await e.return?.()}})}function Bd(r){if(r[Symbol.asyncIterator])return r;let e=r.getReader();return{async next(){try{let t=await e.read();return t?.done&&e.releaseLock(),t}catch(t){throw e.releaseLock(),t}},async return(){let t=e.cancel();return e.releaseLock(),await t,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}async function Bw(r){if(r===null||typeof r!="object")return;if(r[Symbol.asyncIterator]){await r[Symbol.asyncIterator]().return?.();return}let e=r.getReader(),t=e.cancel();e.releaseLock(),await t}var vw=({headers:r,body:e})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(e)});var hc="RFC3986",vd=r=>String(r),mc={RFC1738:r=>String(r).replace(/%20/g,"+"),RFC3986:vd},Cd="RFC1738";var gc=(r,e)=>(gc=Object.hasOwn??Function.prototype.call.bind(Object.prototype.hasOwnProperty),gc(r,e)),Fn=(()=>{let r=[];for(let e=0;e<256;++e)r.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return r})();var Ed=1024,Cw=(r,e,t,n,A)=>{if(r.length===0)return r;let s=r;if(typeof r=="symbol"?s=Symbol.prototype.toString.call(r):typeof r!="string"&&(s=String(r)),t==="iso-8859-1")return escape(s).replace(/%u[0-9a-f]{4}/gi,function(a){return"%26%23"+parseInt(a.slice(2),16)+"%3B"});let i="";for(let a=0;a<s.length;a+=Ed){let f=s.length>=Ed?s.slice(a,a+Ed):s,d=[];for(let h=0;h<f.length;++h){let m=f.charCodeAt(h);if(m===45||m===46||m===95||m===126||m>=48&&m<=57||m>=65&&m<=90||m>=97&&m<=122||A===Cd&&(m===40||m===41)){d[d.length]=f.charAt(h);continue}if(m<128){d[d.length]=Fn[m];continue}if(m<2048){d[d.length]=Fn[192|m>>6]+Fn[128|m&63];continue}if(m<55296||m>=57344){d[d.length]=Fn[224|m>>12]+Fn[128|m>>6&63]+Fn[128|m&63];continue}h+=1,m=65536+((m&1023)<<10|f.charCodeAt(h)&1023),d[d.length]=Fn[240|m>>18]+Fn[128|m>>12&63]+Fn[128|m>>6&63]+Fn[128|m&63]}i+=d.join("")}return i};function Ew(r){return!r||typeof r!="object"?!1:!!(r.constructor&&r.constructor.isBuffer&&r.constructor.isBuffer(r))}function xd(r,e){if(Zt(r)){let t=[];for(let n=0;n<r.length;n+=1)t.push(e(r[n]));return t}return e(r)}var Iw={brackets(r){return String(r)+"[]"},comma:"comma",indices(r,e){return String(r)+"["+e+"]"},repeat(r){return String(r)}},Uw=function(r,e){Array.prototype.push.apply(r,Zt(e)?e:[e])},xw,vt={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:Cw,encodeValuesOnly:!1,format:hc,formatter:vd,indices:!1,serializeDate(r){return(xw??(xw=Function.prototype.call.bind(Date.prototype.toISOString)))(r)},skipNulls:!1,strictNullHandling:!1};function LF(r){return typeof r=="string"||typeof r=="number"||typeof r=="boolean"||typeof r=="symbol"||typeof r=="bigint"}var Id={};function Fw(r,e,t,n,A,s,i,a,f,d,h,m,y,w,b,C,I,T){let Q=r,P=T,R=0,D=!1;for(;(P=P.get(Id))!==void 0&&!D;){let Ie=P.get(r);if(R+=1,typeof Ie<"u"){if(Ie===R)throw new RangeError("Cyclic object value");D=!0}typeof P.get(Id)>"u"&&(R=0)}if(typeof d=="function"?Q=d(e,Q):Q instanceof Date?Q=y?.(Q):t==="comma"&&Zt(Q)&&(Q=xd(Q,function(Ie){return Ie instanceof Date?y?.(Ie):Ie})),Q===null){if(s)return f&&!C?f(e,vt.encoder,I,"key",w):e;Q=""}if(LF(Q)||Ew(Q)){if(f){let Ie=C?e:f(e,vt.encoder,I,"key",w);return[b?.(Ie)+"="+b?.(f(Q,vt.encoder,I,"value",w))]}return[b?.(e)+"="+b?.(String(Q))]}let ee=[];if(typeof Q>"u")return ee;let Y;if(t==="comma"&&Zt(Q))C&&f&&(Q=xd(Q,f)),Y=[{value:Q.length>0?Q.join(",")||null:void 0}];else if(Zt(d))Y=d;else{let Ie=Object.keys(Q);Y=h?Ie.sort(h):Ie}let fe=a?String(e).replace(/\./g,"%2E"):String(e),ve=n&&Zt(Q)&&Q.length===1?fe+"[]":fe;if(A&&Zt(Q)&&Q.length===0)return ve+"[]";for(let Ie=0;Ie<Y.length;++Ie){let Te=Y[Ie],_t=typeof Te=="object"&&typeof Te.value<"u"?Te.value:Q[Te];if(i&&_t===null)continue;let $e=m&&a?Te.replace(/\./g,"%2E"):Te,Ye=Zt(Q)?typeof t=="function"?t(ve,$e):ve:ve+(m?"."+$e:"["+$e+"]");T.set(r,R);let At=new WeakMap;At.set(Id,T),Uw(ee,Fw(_t,Ye,t,n,A,s,i,a,t==="comma"&&C&&Zt(Q)?null:f,d,h,m,y,w,b,C,I,At))}return ee}function HF(r=vt){if(typeof r.allowEmptyArrays<"u"&&typeof r.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof r.encodeDotInKeys<"u"&&typeof r.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(r.encoder!==null&&typeof r.encoder<"u"&&typeof r.encoder!="function")throw new TypeError("Encoder has to be a function.");let e=r.charset||vt.charset;if(typeof r.charset<"u"&&r.charset!=="utf-8"&&r.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");let t=hc;if(typeof r.format<"u"){if(!gc(mc,r.format))throw new TypeError("Unknown format option provided.");t=r.format}let n=mc[t],A=vt.filter;(typeof r.filter=="function"||Zt(r.filter))&&(A=r.filter);let s;if(r.arrayFormat&&r.arrayFormat in Iw?s=r.arrayFormat:"indices"in r?s=r.indices?"indices":"repeat":s=vt.arrayFormat,"commaRoundTrip"in r&&typeof r.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");let i=typeof r.allowDots>"u"?r.encodeDotInKeys?!0:vt.allowDots:!!r.allowDots;return{addQueryPrefix:typeof r.addQueryPrefix=="boolean"?r.addQueryPrefix:vt.addQueryPrefix,allowDots:i,allowEmptyArrays:typeof r.allowEmptyArrays=="boolean"?!!r.allowEmptyArrays:vt.allowEmptyArrays,arrayFormat:s,charset:e,charsetSentinel:typeof r.charsetSentinel=="boolean"?r.charsetSentinel:vt.charsetSentinel,commaRoundTrip:!!r.commaRoundTrip,delimiter:typeof r.delimiter>"u"?vt.delimiter:r.delimiter,encode:typeof r.encode=="boolean"?r.encode:vt.encode,encodeDotInKeys:typeof r.encodeDotInKeys=="boolean"?r.encodeDotInKeys:vt.encodeDotInKeys,encoder:typeof r.encoder=="function"?r.encoder:vt.encoder,encodeValuesOnly:typeof r.encodeValuesOnly=="boolean"?r.encodeValuesOnly:vt.encodeValuesOnly,filter:A,format:t,formatter:n,serializeDate:typeof r.serializeDate=="function"?r.serializeDate:vt.serializeDate,skipNulls:typeof r.skipNulls=="boolean"?r.skipNulls:vt.skipNulls,sort:typeof r.sort=="function"?r.sort:null,strictNullHandling:typeof r.strictNullHandling=="boolean"?r.strictNullHandling:vt.strictNullHandling}}function Ud(r,e={}){let t=r,n=HF(e),A,s;typeof n.filter=="function"?(s=n.filter,t=s("",t)):Zt(n.filter)&&(s=n.filter,A=s);let i=[];if(typeof t!="object"||t===null)return"";let a=Iw[n.arrayFormat],f=a==="comma"&&n.commaRoundTrip;A||(A=Object.keys(t)),n.sort&&A.sort(n.sort);let d=new WeakMap;for(let y=0;y<A.length;++y){let w=A[y];n.skipNulls&&t[w]===null||Uw(i,Fw(t[w],w,a,f,n.allowEmptyArrays,n.strictNullHandling,n.skipNulls,n.encodeDotInKeys,n.encode?n.encoder:null,n.filter,n.sort,n.allowDots,n.serializeDate,n.format,n.formatter,n.encodeValuesOnly,n.charset,d))}let h=i.join(n.delimiter),m=n.addQueryPrefix===!0?"?":"";return n.charsetSentinel&&(n.charset==="iso-8859-1"?m+="utf8=%26%2310003%3B&":m+="utf8=%E2%9C%93&"),h.length>0?m+h:""}function Ow(r){let e=0;for(let A of r)e+=A.length;let t=new Uint8Array(e),n=0;for(let A of r)t.set(A,n),n+=A.length;return t}var Qw;function zi(r){let e;return(Qw??(e=new globalThis.TextEncoder,Qw=e.encode.bind(e)))(r)}var Tw;function Fd(r){let e;return(Tw??(e=new globalThis.TextDecoder,Tw=e.decode.bind(e)))(r)}var Fr,Qr,bs=class{constructor(){Fr.set(this,void 0),Qr.set(this,void 0),ce(this,Fr,new Uint8Array,"f"),ce(this,Qr,null,"f")}decode(e){if(e==null)return[];let t=e instanceof ArrayBuffer?new Uint8Array(e):typeof e=="string"?zi(e):e;ce(this,Fr,Ow([F(this,Fr,"f"),t]),"f");let n=[],A;for(;(A=MF(F(this,Fr,"f"),F(this,Qr,"f")))!=null;){if(A.carriage&&F(this,Qr,"f")==null){ce(this,Qr,A.index,"f");continue}if(F(this,Qr,"f")!=null&&(A.index!==F(this,Qr,"f")+1||A.carriage)){n.push(Fd(F(this,Fr,"f").subarray(0,F(this,Qr,"f")-1))),ce(this,Fr,F(this,Fr,"f").subarray(F(this,Qr,"f")),"f"),ce(this,Qr,null,"f");continue}let s=F(this,Qr,"f")!==null?A.preceding-1:A.preceding,i=Fd(F(this,Fr,"f").subarray(0,s));n.push(i),ce(this,Fr,F(this,Fr,"f").subarray(A.index),"f"),ce(this,Qr,null,"f")}return n}flush(){return F(this,Fr,"f").length?this.decode(`
`):[]}};Fr=new WeakMap,Qr=new WeakMap;bs.NEWLINE_CHARS=new Set([`
`,"\r"]);bs.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function MF(r,e){for(let A=e??0;A<r.length;A++){if(r[A]===10)return{preceding:A,index:A+1,carriage:!1};if(r[A]===13)return{preceding:A,index:A+1,carriage:!0}}return null}function Sw(r){for(let n=0;n<r.length-1;n++){if(r[n]===10&&r[n+1]===10||r[n]===13&&r[n+1]===13)return n+2;if(r[n]===13&&r[n+1]===10&&n+3<r.length&&r[n+2]===13&&r[n+3]===10)return n+4}return-1}var yc={off:0,error:200,warn:300,info:400,debug:500},Qd=(r,e,t)=>{if(r){if(dw(yc,r))return r;ft(t).warn(`${e} was set to ${JSON.stringify(r)}, expected one of ${JSON.stringify(Object.keys(yc))}`)}};function bo(){}function wc(r,e,t){return!e||yc[r]>yc[t]?bo:e[r].bind(e)}var $F={error:bo,warn:bo,info:bo,debug:bo},Pw=new WeakMap;function ft(r){let e=r.logger,t=r.logLevel??"off";if(!e)return $F;let n=Pw.get(e);if(n&&n[0]===t)return n[1];let A={error:wc("error",e,t),warn:wc("warn",e,t),info:wc("info",e,t),debug:wc("debug",e,t)};return Pw.set(e,[t,A]),A}var sA=r=>(r.options&&(r.options={...r.options},delete r.options.headers),r.headers&&(r.headers=Object.fromEntries((r.headers instanceof Headers?[...r.headers]:Object.entries(r.headers)).map(([e,t])=>[e,e.toLowerCase()==="authorization"||e.toLowerCase()==="cookie"||e.toLowerCase()==="set-cookie"?"***":t]))),"retryOfRequestLogID"in r&&(r.retryOfRequestLogID&&(r.retryOf=r.retryOfRequestLogID),delete r.retryOfRequestLogID),r);var Bo,Qn=class r{constructor(e,t,n){this.iterator=e,Bo.set(this,void 0),this.controller=t,ce(this,Bo,n,"f")}static fromSSEResponse(e,t,n){let A=!1,s=n?ft(n):console;async function*i(){if(A)throw new re("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");A=!0;let a=!1;try{for await(let f of jF(e,t))if(!a){if(f.data.startsWith("[DONE]")){a=!0;continue}if(f.event===null||!f.event.startsWith("thread.")){let d;try{d=JSON.parse(f.data)}catch(h){throw s.error("Could not parse message into JSON:",f.data),s.error("From chunk:",f.raw),h}if(d&&d.error)throw new Bt(void 0,d.error,void 0,e.headers);yield d}else{let d;try{d=JSON.parse(f.data)}catch(h){throw console.error("Could not parse message into JSON:",f.data),console.error("From chunk:",f.raw),h}if(f.event=="error")throw new Bt(void 0,d.error,d.message,void 0);yield{event:f.event,data:d}}}a=!0}catch(f){if(wo(f))return;throw f}finally{a||t.abort()}}return new r(i,t,n)}static fromReadableStream(e,t,n){let A=!1;async function*s(){let a=new bs,f=Bd(e);for await(let d of f)for(let h of a.decode(d))yield h;for(let d of a.flush())yield d}async function*i(){if(A)throw new re("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");A=!0;let a=!1;try{for await(let f of s())a||f&&(yield JSON.parse(f));a=!0}catch(f){if(wo(f))return;throw f}finally{a||t.abort()}}return new r(i,t,n)}[(Bo=new WeakMap,Symbol.asyncIterator)](){return this.iterator()}tee(){let e=[],t=[],n=this.iterator(),A=s=>({next:()=>{if(s.length===0){let i=n.next();e.push(i),t.push(i)}return s.shift()}});return[new r(()=>A(e),this.controller,F(this,Bo,"f")),new r(()=>A(t),this.controller,F(this,Bo,"f"))]}toReadableStream(){let e=this,t;return bd({async start(){t=e[Symbol.asyncIterator]()},async pull(n){try{let{value:A,done:s}=await t.next();if(s)return n.close();let i=zi(JSON.stringify(A)+`
`);n.enqueue(i)}catch(A){n.error(A)}},async cancel(){await t.return?.()}})}};async function*jF(r,e){if(!r.body)throw e.abort(),typeof globalThis.navigator<"u"&&globalThis.navigator.product==="ReactNative"?new re("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api"):new re("Attempted to iterate over a response with no body");let t=new Td,n=new bs,A=Bd(r.body);for await(let s of KF(A))for(let i of n.decode(s)){let a=t.decode(i);a&&(yield a)}for(let s of n.flush()){let i=t.decode(s);i&&(yield i)}}async function*KF(r){let e=new Uint8Array;for await(let t of r){if(t==null)continue;let n=t instanceof ArrayBuffer?new Uint8Array(t):typeof t=="string"?zi(t):t,A=new Uint8Array(e.length+n.length);A.set(e),A.set(n,e.length),e=A;let s;for(;(s=Sw(e))!==-1;)yield e.slice(0,s),e=e.slice(s)}e.length>0&&(yield e)}var Td=class{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;let s={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],s}if(this.chunks.push(e),e.startsWith(":"))return null;let[t,n,A]=zF(e,":");return A.startsWith(" ")&&(A=A.substring(1)),t==="event"?this.event=A:t==="data"&&this.data.push(A),null}};function zF(r,e){let t=r.indexOf(e);return t!==-1?[r.substring(0,t),e,r.substring(t+e.length)]:[r,"",""]}async function _c(r,e){let{response:t,requestLogID:n,retryOfRequestLogID:A,startTime:s}=e,i=await(async()=>{if(e.options.stream)return ft(r).debug("response",t.status,t.url,t.headers,t.body),e.options.__streamClass?e.options.__streamClass.fromSSEResponse(t,e.controller,r):Qn.fromSSEResponse(t,e.controller,r);if(t.status===204)return null;if(e.options.__binaryResponse)return t;let f=t.headers.get("content-type")?.split(";")[0]?.trim();if(f?.includes("application/json")||f?.endsWith("+json")){let m=await t.json();return Od(m,t)}return await t.text()})();return ft(r).debug(`[${n}] response parsed`,sA({retryOfRequestLogID:A,url:t.url,status:t.status,body:i,durationMs:Date.now()-s})),i}function Od(r,e){return!r||typeof r!="object"||Array.isArray(r)?r:Object.defineProperty(r,"_request_id",{value:e.headers.get("x-request-id"),enumerable:!1})}var vo,Bs=class r extends Promise{constructor(e,t,n=_c){super(A=>{A(null)}),this.responsePromise=t,this.parseResponse=n,vo.set(this,void 0),ce(this,vo,e,"f")}_thenUnwrap(e){return new r(F(this,vo,"f"),this.responsePromise,async(t,n)=>Od(e(await this.parseResponse(t,n),n),n.response))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){let[e,t]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:t,request_id:t.headers.get("x-request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(e=>this.parseResponse(F(this,vo,"f"),e))),this.parsedPromise}then(e,t){return this.parse().then(e,t)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}};vo=new WeakMap;var bc,Bc=class{constructor(e,t,n,A){bc.set(this,void 0),ce(this,bc,e,"f"),this.options=A,this.response=t,this.body=n}hasNextPage(){return this.getPaginatedItems().length?this.nextPageRequestOptions()!=null:!1}async getNextPage(){let e=this.nextPageRequestOptions();if(!e)throw new re("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");return await F(this,bc,"f").requestAPIList(this.constructor,e)}async*iterPages(){let e=this;for(yield e;e.hasNextPage();)e=await e.getNextPage(),yield e}async*[(bc=new WeakMap,Symbol.asyncIterator)](){for await(let e of this.iterPages())for(let t of e.getPaginatedItems())yield t}},Co=class extends Bs{constructor(e,t,n){super(e,t,async(A,s)=>new n(A,s.response,await _c(A,s),s.options))}async*[Symbol.asyncIterator](){let e=await this;for await(let t of e)yield t}},Tn=class extends Bc{constructor(e,t,n,A){super(e,t,n,A),this.data=n.data||[],this.object=n.object}getPaginatedItems(){return this.data??[]}nextPageRequestOptions(){return null}},Se=class extends Bc{constructor(e,t,n,A){super(e,t,n,A),this.data=n.data||[],this.has_more=n.has_more||!1}getPaginatedItems(){return this.data??[]}hasNextPage(){return this.has_more===!1?!1:super.hasNextPage()}nextPageRequestOptions(){let e=this.getPaginatedItems(),t=e[e.length-1]?.id;return t?{...this.options,query:{...lw(this.options.query),after:t}}:null}};var Pd=()=>{if(typeof File>"u"){let{process:r}=globalThis,e=typeof r?.versions?.node=="string"&&parseInt(r.versions.node.split("."))<20;throw new Error("`File` is not defined as a global, which is required for file uploads."+(e?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function Gi(r,e,t){return Pd(),new File(r,e??"unknown_file",t)}function Eo(r){return(typeof r=="object"&&r!==null&&("name"in r&&r.name&&String(r.name)||"url"in r&&r.url&&String(r.url)||"filename"in r&&r.filename&&String(r.filename)||"path"in r&&r.path&&String(r.path))||"").split(/[\\/]/).pop()||void 0}var Rd=r=>r!=null&&typeof r=="object"&&typeof r[Symbol.asyncIterator]=="function";var Tr=async(r,e)=>({...r,body:await ZF(r.body,e)}),Rw=new WeakMap;function VF(r){let e=typeof r=="function"?r:r.fetch,t=Rw.get(e);if(t)return t;let n=(async()=>{try{let A="Response"in e?e.Response:(await e("data:,")).constructor,s=new FormData;return s.toString()!==await new A(s).text()}catch{return!0}})();return Rw.set(e,n),n}var ZF=async(r,e)=>{if(!await VF(e))throw new TypeError("The provided fetch function does not support file uploads with the current global FormData class.");let t=new FormData;return await Promise.all(Object.entries(r||{}).map(([n,A])=>Sd(t,n,A))),t},JF=r=>r instanceof Blob&&"name"in r;var Sd=async(r,e,t)=>{if(t!==void 0){if(t==null)throw new TypeError(`Received null for "${e}"; to pass null in FormData, you must use the string 'null'`);if(typeof t=="string"||typeof t=="number"||typeof t=="boolean")r.append(e,String(t));else if(t instanceof Response)r.append(e,Gi([await t.blob()],Eo(t)));else if(Rd(t))r.append(e,Gi([await new Response(pc(t)).blob()],Eo(t)));else if(JF(t))r.append(e,t,Eo(t));else if(Array.isArray(t))await Promise.all(t.map(n=>Sd(r,e+"[]",n)));else if(typeof t=="object")await Promise.all(Object.entries(t).map(([n,A])=>Sd(r,`${e}[${n}]`,A)));else throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${t} instead`)}};var kw=r=>r!=null&&typeof r=="object"&&typeof r.size=="number"&&typeof r.type=="string"&&typeof r.text=="function"&&typeof r.slice=="function"&&typeof r.arrayBuffer=="function",WF=r=>r!=null&&typeof r=="object"&&typeof r.name=="string"&&typeof r.lastModified=="number"&&kw(r),qF=r=>r!=null&&typeof r=="object"&&typeof r.url=="string"&&typeof r.blob=="function";async function xo(r,e,t){if(Pd(),r=await r,WF(r))return r instanceof File?r:Gi([await r.arrayBuffer()],r.name);if(qF(r)){let A=await r.blob();return e||(e=new URL(r.url).pathname.split(/[\\/]/).pop()),Gi(await kd(A),e,t)}let n=await kd(r);if(e||(e=Eo(r)),!t?.type){let A=n.find(s=>typeof s=="object"&&"type"in s&&s.type);typeof A=="string"&&(t={...t,type:A})}return Gi(n,e,t)}async function kd(r){let e=[];if(typeof r=="string"||ArrayBuffer.isView(r)||r instanceof ArrayBuffer)e.push(r);else if(kw(r))e.push(r instanceof Blob?r:await r.arrayBuffer());else if(Rd(r))for await(let t of r)e.push(...await kd(t));else{let t=r?.constructor?.name;throw new Error(`Unexpected data type: ${typeof r}${t?`; constructor: ${t}`:""}${XF(r)}`)}return e}function XF(r){return typeof r!="object"||r===null?"":`; props: [${Object.getOwnPropertyNames(r).map(t=>`"${t}"`).join(", ")}]`}var L=class{constructor(e){this._client=e}};function Lw(r){return r.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}var Nw=Object.freeze(Object.create(null)),eQ=(r=Lw)=>function(t,...n){if(t.length===1)return t[0];let A=!1,s=[],i=t.reduce((h,m,y)=>{/[?#]/.test(m)&&(A=!0);let w=n[y],b=(A?encodeURIComponent:r)(""+w);return y!==n.length&&(w==null||typeof w=="object"&&w.toString===Object.getPrototypeOf(Object.getPrototypeOf(w.hasOwnProperty??Nw)??Nw)?.toString)&&(b=w+"",s.push({start:h.length+m.length,length:b.length,error:`Value of type ${Object.prototype.toString.call(w).slice(8,-1)} is not a valid path parameter`})),h+m+(y===n.length?"":b)},""),a=i.split(/[?#]/,1)[0],f=/(?<=^|\/)(?:\.|%2e){1,2}(?=\/|$)/gi,d;for(;(d=f.exec(a))!==null;)s.push({start:d.index,length:d[0].length,error:`Value "${d[0]}" can't be safely passed as a path parameter`});if(s.sort((h,m)=>h.start-m.start),s.length>0){let h=0,m=s.reduce((y,w)=>{let b=" ".repeat(w.start-h),C="^".repeat(w.length);return h=w.start+w.length,y+b+C},"");throw new re(`Path parameters result in path with invalid segments:
${s.map(y=>y.error).join(`
`)}
${i}
${m}`)}return i},k=eQ(Lw);var vs=class extends L{list(e,t={},n){return this._client.getAPIList(k`/chat/completions/${e}/messages`,Se,{query:t,...n})}};function Io(r){return r!==void 0&&"function"in r&&r.function!==void 0}function Hw(r,e){let t={...r};return Object.defineProperties(t,{$brand:{value:"auto-parseable-response-format",enumerable:!1},$parseRaw:{value:e,enumerable:!1}}),t}function Uo(r){return r?.$brand==="auto-parseable-response-format"}function Cs(r){return r?.$brand==="auto-parseable-tool"}function Dw(r,e){return!e||!Nd(e)?{...r,choices:r.choices.map(t=>($w(t.message.tool_calls),{...t,message:{...t.message,parsed:null,...t.message.tool_calls?{tool_calls:t.message.tool_calls}:void 0}}))}:Fo(r,e)}function Fo(r,e){let t=r.choices.map(n=>{if(n.finish_reason==="length")throw new ji;if(n.finish_reason==="content_filter")throw new Ki;return $w(n.message.tool_calls),{...n,message:{...n.message,...n.message.tool_calls?{tool_calls:n.message.tool_calls?.map(A=>AQ(e,A))??void 0}:void 0,parsed:n.message.content&&!n.message.refusal?nQ(e,n.message.content):null}}});return{...r,choices:t}}function nQ(r,e){return r.response_format?.type!=="json_schema"?null:r.response_format?.type==="json_schema"?"$parseRaw"in r.response_format?r.response_format.$parseRaw(e):JSON.parse(e):null}function AQ(r,e){let t=r.tools?.find(n=>Io(n)&&n.function?.name===e.function.name);return{...e,function:{...e.function,parsed_arguments:Cs(t)?t.$parseRaw(e.function.arguments):t?.function.strict?JSON.parse(e.function.arguments):null}}}function Mw(r,e){if(!r||!("tools"in r)||!r.tools)return!1;let t=r.tools?.find(n=>Io(n)&&n.function?.name===e.function.name);return Io(t)&&(Cs(t)||t?.function.strict||!1)}function Nd(r){return Uo(r.response_format)?!0:r.tools?.some(e=>Cs(e)||e.type==="function"&&e.function.strict===!0)??!1}function $w(r){for(let e of r||[])if(e.type!=="function")throw new re(`Currently only \`function\` tool calls are supported; Received \`${e.type}\``)}function jw(r){for(let e of r??[]){if(e.type!=="function")throw new re(`Currently only \`function\` tool types support auto-parsing; Received \`${e.type}\``);if(e.function.strict!==!0)throw new re(`The \`${e.function.name}\` tool is not marked with \`strict: true\`. Only strict function tools can be auto-parsed`)}}var Vi=r=>r?.role==="assistant",Ld=r=>r?.role==="tool";var Hd,vc,Cc,Qo,To,Ec,Oo,iA,So,xc,Ic,Zi,Kw,NA=class{constructor(){Hd.add(this),this.controller=new AbortController,vc.set(this,void 0),Cc.set(this,()=>{}),Qo.set(this,()=>{}),To.set(this,void 0),Ec.set(this,()=>{}),Oo.set(this,()=>{}),iA.set(this,{}),So.set(this,!1),xc.set(this,!1),Ic.set(this,!1),Zi.set(this,!1),ce(this,vc,new Promise((e,t)=>{ce(this,Cc,e,"f"),ce(this,Qo,t,"f")}),"f"),ce(this,To,new Promise((e,t)=>{ce(this,Ec,e,"f"),ce(this,Oo,t,"f")}),"f"),F(this,vc,"f").catch(()=>{}),F(this,To,"f").catch(()=>{})}_run(e){setTimeout(()=>{e().then(()=>{this._emitFinal(),this._emit("end")},F(this,Hd,"m",Kw).bind(this))},0)}_connected(){this.ended||(F(this,Cc,"f").call(this),this._emit("connect"))}get ended(){return F(this,So,"f")}get errored(){return F(this,xc,"f")}get aborted(){return F(this,Ic,"f")}abort(){this.controller.abort()}on(e,t){return(F(this,iA,"f")[e]||(F(this,iA,"f")[e]=[])).push({listener:t}),this}off(e,t){let n=F(this,iA,"f")[e];if(!n)return this;let A=n.findIndex(s=>s.listener===t);return A>=0&&n.splice(A,1),this}once(e,t){return(F(this,iA,"f")[e]||(F(this,iA,"f")[e]=[])).push({listener:t,once:!0}),this}emitted(e){return new Promise((t,n)=>{ce(this,Zi,!0,"f"),e!=="error"&&this.once("error",n),this.once(e,t)})}async done(){ce(this,Zi,!0,"f"),await F(this,To,"f")}_emit(e,...t){if(F(this,So,"f"))return;e==="end"&&(ce(this,So,!0,"f"),F(this,Ec,"f").call(this));let n=F(this,iA,"f")[e];if(n&&(F(this,iA,"f")[e]=n.filter(A=>!A.once),n.forEach(({listener:A})=>A(...t))),e==="abort"){let A=t[0];!F(this,Zi,"f")&&!n?.length&&Promise.reject(A),F(this,Qo,"f").call(this,A),F(this,Oo,"f").call(this,A),this._emit("end");return}if(e==="error"){let A=t[0];!F(this,Zi,"f")&&!n?.length&&Promise.reject(A),F(this,Qo,"f").call(this,A),F(this,Oo,"f").call(this,A),this._emit("end")}}_emitFinal(){}};vc=new WeakMap,Cc=new WeakMap,Qo=new WeakMap,To=new WeakMap,Ec=new WeakMap,Oo=new WeakMap,iA=new WeakMap,So=new WeakMap,xc=new WeakMap,Ic=new WeakMap,Zi=new WeakMap,Hd=new WeakSet,Kw=function(e){if(ce(this,xc,!0,"f"),e instanceof Error&&e.name==="AbortError"&&(e=new ot),e instanceof ot)return ce(this,Ic,!0,"f"),this._emit("abort",e);if(e instanceof re)return this._emit("error",e);if(e instanceof Error){let t=new re(e.message);return t.cause=e,this._emit("error",t)}return this._emit("error",new re(String(e)))};function zw(r){return typeof r.parse=="function"}var nr,Dd,Uc,Md,$d,jd,Gw,Vw,sQ=10,Ji=class extends NA{constructor(){super(...arguments),nr.add(this),this._chatCompletions=[],this.messages=[]}_addChatCompletion(e){this._chatCompletions.push(e),this._emit("chatCompletion",e);let t=e.choices[0]?.message;return t&&this._addMessage(t),e}_addMessage(e,t=!0){if("content"in e||(e.content=null),this.messages.push(e),t){if(this._emit("message",e),Ld(e)&&e.content)this._emit("functionToolCallResult",e.content);else if(Vi(e)&&e.tool_calls)for(let n of e.tool_calls)n.type==="function"&&this._emit("functionToolCall",n.function)}}async finalChatCompletion(){await this.done();let e=this._chatCompletions[this._chatCompletions.length-1];if(!e)throw new re("stream ended without producing a ChatCompletion");return e}async finalContent(){return await this.done(),F(this,nr,"m",Dd).call(this)}async finalMessage(){return await this.done(),F(this,nr,"m",Uc).call(this)}async finalFunctionToolCall(){return await this.done(),F(this,nr,"m",Md).call(this)}async finalFunctionToolCallResult(){return await this.done(),F(this,nr,"m",$d).call(this)}async totalUsage(){return await this.done(),F(this,nr,"m",jd).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emitFinal(){let e=this._chatCompletions[this._chatCompletions.length-1];e&&this._emit("finalChatCompletion",e);let t=F(this,nr,"m",Uc).call(this);t&&this._emit("finalMessage",t);let n=F(this,nr,"m",Dd).call(this);n&&this._emit("finalContent",n);let A=F(this,nr,"m",Md).call(this);A&&this._emit("finalFunctionToolCall",A);let s=F(this,nr,"m",$d).call(this);s!=null&&this._emit("finalFunctionToolCallResult",s),this._chatCompletions.some(i=>i.usage)&&this._emit("totalUsage",F(this,nr,"m",jd).call(this))}async _createChatCompletion(e,t,n){let A=n?.signal;A&&(A.aborted&&this.controller.abort(),A.addEventListener("abort",()=>this.controller.abort())),F(this,nr,"m",Gw).call(this,t);let s=await e.chat.completions.create({...t,stream:!1},{...n,signal:this.controller.signal});return this._connected(),this._addChatCompletion(Fo(s,t))}async _runChatCompletion(e,t,n){for(let A of t.messages)this._addMessage(A,!1);return await this._createChatCompletion(e,t,n)}async _runTools(e,t,n){let A="tool",{tool_choice:s="auto",stream:i,...a}=t,f=typeof s!="string"&&s.type==="function"&&s?.function?.name,{maxChatCompletions:d=sQ}=n||{},h=t.tools.map(w=>{if(Cs(w)){if(!w.$callback)throw new re("Tool given to `.runTools()` that does not have an associated function");return{type:"function",function:{function:w.$callback,name:w.function.name,description:w.function.description||"",parameters:w.function.parameters,parse:w.$parseRaw,strict:!0}}}return w}),m={};for(let w of h)w.type==="function"&&(m[w.function.name||w.function.function.name]=w.function);let y="tools"in t?h.map(w=>w.type==="function"?{type:"function",function:{name:w.function.name||w.function.function.name,parameters:w.function.parameters,description:w.function.description,strict:w.function.strict}}:w):void 0;for(let w of t.messages)this._addMessage(w,!1);for(let w=0;w<d;++w){let C=(await this._createChatCompletion(e,{...a,tool_choice:s,tools:y,messages:[...this.messages]},n)).choices[0]?.message;if(!C)throw new re("missing message in ChatCompletion response");if(!C.tool_calls?.length)return;for(let I of C.tool_calls){if(I.type!=="function")continue;let T=I.id,{name:Q,arguments:P}=I.function,R=m[Q];if(R){if(f&&f!==Q){let fe=`Invalid tool_call: ${JSON.stringify(Q)}. ${JSON.stringify(f)} requested. Please try again`;this._addMessage({role:A,tool_call_id:T,content:fe});continue}}else{let fe=`Invalid tool_call: ${JSON.stringify(Q)}. Available options are: ${Object.keys(m).map(ve=>JSON.stringify(ve)).join(", ")}. Please try again`;this._addMessage({role:A,tool_call_id:T,content:fe});continue}let D;try{D=zw(R)?await R.parse(P):P}catch(fe){let ve=fe instanceof Error?fe.message:String(fe);this._addMessage({role:A,tool_call_id:T,content:ve});continue}let ee=await R.function(D,this),Y=F(this,nr,"m",Vw).call(this,ee);if(this._addMessage({role:A,tool_call_id:T,content:Y}),f)return}}}};nr=new WeakSet,Dd=function(){return F(this,nr,"m",Uc).call(this).content??null},Uc=function(){let e=this.messages.length;for(;e-- >0;){let t=this.messages[e];if(Vi(t))return{...t,content:t.content??null,refusal:t.refusal??null}}throw new re("stream ended without producing a ChatCompletionMessage with role=assistant")},Md=function(){for(let e=this.messages.length-1;e>=0;e--){let t=this.messages[e];if(Vi(t)&&t?.tool_calls?.length)return t.tool_calls.filter(n=>n.type==="function").at(-1)?.function}},$d=function(){for(let e=this.messages.length-1;e>=0;e--){let t=this.messages[e];if(Ld(t)&&t.content!=null&&typeof t.content=="string"&&this.messages.some(n=>n.role==="assistant"&&n.tool_calls?.some(A=>A.type==="function"&&A.id===t.tool_call_id)))return t.content}},jd=function(){let e={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(let{usage:t}of this._chatCompletions)t&&(e.completion_tokens+=t.completion_tokens,e.prompt_tokens+=t.prompt_tokens,e.total_tokens+=t.total_tokens);return e},Gw=function(e){if(e.n!=null&&e.n>1)throw new re("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},Vw=function(e){return typeof e=="string"?e:e===void 0?"undefined":JSON.stringify(e)};var Po=class r extends Ji{static runTools(e,t,n){let A=new r,s={...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"runTools"}};return A._run(()=>A._runTools(e,t,s)),A}_addMessage(e,t=!0){super._addMessage(e,t),Vi(e)&&e.content&&this._emit("content",e.content)}};var Pt={STR:1,NUM:2,ARR:4,OBJ:8,NULL:16,BOOL:32,NAN:64,INFINITY:128,MINUS_INFINITY:256,INF:384,SPECIAL:496,ATOM:499,COLLECTION:12,ALL:511},Kd=class extends Error{},zd=class extends Error{};function iQ(r,e=Pt.ALL){if(typeof r!="string")throw new TypeError(`expecting str, got ${typeof r}`);if(!r.trim())throw new Error(`${r} is empty`);return aQ(r.trim(),e)}var aQ=(r,e)=>{let t=r.length,n=0,A=y=>{throw new Kd(`${y} at position ${n}`)},s=y=>{throw new zd(`${y} at position ${n}`)},i=()=>(m(),n>=t&&A("Unexpected end of input"),r[n]==='"'?a():r[n]==="{"?f():r[n]==="["?d():r.substring(n,n+4)==="null"||Pt.NULL&e&&t-n<4&&"null".startsWith(r.substring(n))?(n+=4,null):r.substring(n,n+4)==="true"||Pt.BOOL&e&&t-n<4&&"true".startsWith(r.substring(n))?(n+=4,!0):r.substring(n,n+5)==="false"||Pt.BOOL&e&&t-n<5&&"false".startsWith(r.substring(n))?(n+=5,!1):r.substring(n,n+8)==="Infinity"||Pt.INFINITY&e&&t-n<8&&"Infinity".startsWith(r.substring(n))?(n+=8,1/0):r.substring(n,n+9)==="-Infinity"||Pt.MINUS_INFINITY&e&&1<t-n&&t-n<9&&"-Infinity".startsWith(r.substring(n))?(n+=9,-1/0):r.substring(n,n+3)==="NaN"||Pt.NAN&e&&t-n<3&&"NaN".startsWith(r.substring(n))?(n+=3,NaN):h()),a=()=>{let y=n,w=!1;for(n++;n<t&&(r[n]!=='"'||w&&r[n-1]==="\\");)w=r[n]==="\\"?!w:!1,n++;if(r.charAt(n)=='"')try{return JSON.parse(r.substring(y,++n-Number(w)))}catch(b){s(String(b))}else if(Pt.STR&e)try{return JSON.parse(r.substring(y,n-Number(w))+'"')}catch{return JSON.parse(r.substring(y,r.lastIndexOf("\\"))+'"')}A("Unterminated string literal")},f=()=>{n++,m();let y={};try{for(;r[n]!=="}";){if(m(),n>=t&&Pt.OBJ&e)return y;let w=a();m(),n++;try{let b=i();Object.defineProperty(y,w,{value:b,writable:!0,enumerable:!0,configurable:!0})}catch(b){if(Pt.OBJ&e)return y;throw b}m(),r[n]===","&&n++}}catch{if(Pt.OBJ&e)return y;A("Expected '}' at end of object")}return n++,y},d=()=>{n++;let y=[];try{for(;r[n]!=="]";)y.push(i()),m(),r[n]===","&&n++}catch{if(Pt.ARR&e)return y;A("Expected ']' at end of array")}return n++,y},h=()=>{if(n===0){r==="-"&&Pt.NUM&e&&A("Not sure what '-' is");try{return JSON.parse(r)}catch(w){if(Pt.NUM&e)try{return r[r.length-1]==="."?JSON.parse(r.substring(0,r.lastIndexOf("."))):JSON.parse(r.substring(0,r.lastIndexOf("e")))}catch{}s(String(w))}}let y=n;for(r[n]==="-"&&n++;r[n]&&!",]}".includes(r[n]);)n++;n==t&&!(Pt.NUM&e)&&A("Unterminated number literal");try{return JSON.parse(r.substring(y,n))}catch{r.substring(y,n)==="-"&&Pt.NUM&e&&A("Not sure what '-' is");try{return JSON.parse(r.substring(y,r.lastIndexOf("e")))}catch(b){s(String(b))}}},m=()=>{for(;n<t&&` 
\r	`.includes(r[n]);)n++};return i()},Gd=r=>iQ(r,Pt.ALL^Pt.NUM);var Ct,aA,Wi,LA,Vd,Fc,Zd,Jd,Wd,Qc,qd,Zw,Es=class r extends Ji{constructor(e){super(),Ct.add(this),aA.set(this,void 0),Wi.set(this,void 0),LA.set(this,void 0),ce(this,aA,e,"f"),ce(this,Wi,[],"f")}get currentChatCompletionSnapshot(){return F(this,LA,"f")}static fromReadableStream(e){let t=new r(null);return t._run(()=>t._fromReadableStream(e)),t}static createChatCompletion(e,t,n){let A=new r(t);return A._run(()=>A._runChatCompletion(e,{...t,stream:!0},{...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"stream"}})),A}async _createChatCompletion(e,t,n){super._createChatCompletion;let A=n?.signal;A&&(A.aborted&&this.controller.abort(),A.addEventListener("abort",()=>this.controller.abort())),F(this,Ct,"m",Vd).call(this);let s=await e.chat.completions.create({...t,stream:!0},{...n,signal:this.controller.signal});this._connected();for await(let i of s)F(this,Ct,"m",Zd).call(this,i);if(s.controller.signal?.aborted)throw new ot;return this._addChatCompletion(F(this,Ct,"m",Qc).call(this))}async _fromReadableStream(e,t){let n=t?.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort())),F(this,Ct,"m",Vd).call(this),this._connected();let A=Qn.fromReadableStream(e,this.controller),s;for await(let i of A)s&&s!==i.id&&this._addChatCompletion(F(this,Ct,"m",Qc).call(this)),F(this,Ct,"m",Zd).call(this,i),s=i.id;if(A.controller.signal?.aborted)throw new ot;return this._addChatCompletion(F(this,Ct,"m",Qc).call(this))}[(aA=new WeakMap,Wi=new WeakMap,LA=new WeakMap,Ct=new WeakSet,Vd=function(){this.ended||ce(this,LA,void 0,"f")},Fc=function(t){let n=F(this,Wi,"f")[t.index];return n||(n={content_done:!1,refusal_done:!1,logprobs_content_done:!1,logprobs_refusal_done:!1,done_tool_calls:new Set,current_tool_call_index:null},F(this,Wi,"f")[t.index]=n,n)},Zd=function(t){if(this.ended)return;let n=F(this,Ct,"m",Zw).call(this,t);this._emit("chunk",t,n);for(let A of t.choices){let s=n.choices[A.index];A.delta.content!=null&&s.message?.role==="assistant"&&s.message?.content&&(this._emit("content",A.delta.content,s.message.content),this._emit("content.delta",{delta:A.delta.content,snapshot:s.message.content,parsed:s.message.parsed})),A.delta.refusal!=null&&s.message?.role==="assistant"&&s.message?.refusal&&this._emit("refusal.delta",{delta:A.delta.refusal,snapshot:s.message.refusal}),A.logprobs?.content!=null&&s.message?.role==="assistant"&&this._emit("logprobs.content.delta",{content:A.logprobs?.content,snapshot:s.logprobs?.content??[]}),A.logprobs?.refusal!=null&&s.message?.role==="assistant"&&this._emit("logprobs.refusal.delta",{refusal:A.logprobs?.refusal,snapshot:s.logprobs?.refusal??[]});let i=F(this,Ct,"m",Fc).call(this,s);s.finish_reason&&(F(this,Ct,"m",Wd).call(this,s),i.current_tool_call_index!=null&&F(this,Ct,"m",Jd).call(this,s,i.current_tool_call_index));for(let a of A.delta.tool_calls??[])i.current_tool_call_index!==a.index&&(F(this,Ct,"m",Wd).call(this,s),i.current_tool_call_index!=null&&F(this,Ct,"m",Jd).call(this,s,i.current_tool_call_index)),i.current_tool_call_index=a.index;for(let a of A.delta.tool_calls??[]){let f=s.message.tool_calls?.[a.index];f?.type&&(f?.type==="function"?this._emit("tool_calls.function.arguments.delta",{name:f.function?.name,index:a.index,arguments:f.function.arguments,parsed_arguments:f.function.parsed_arguments,arguments_delta:a.function?.arguments??""}):(f?.type,void 0))}}},Jd=function(t,n){if(F(this,Ct,"m",Fc).call(this,t).done_tool_calls.has(n))return;let s=t.message.tool_calls?.[n];if(!s)throw new Error("no tool call snapshot");if(!s.type)throw new Error("tool call snapshot missing `type`");if(s.type==="function"){let i=F(this,aA,"f")?.tools?.find(a=>Io(a)&&a.function.name===s.function.name);this._emit("tool_calls.function.arguments.done",{name:s.function.name,index:n,arguments:s.function.arguments,parsed_arguments:Cs(i)?i.$parseRaw(s.function.arguments):i?.function.strict?JSON.parse(s.function.arguments):null})}else s.type},Wd=function(t){let n=F(this,Ct,"m",Fc).call(this,t);if(t.message.content&&!n.content_done){n.content_done=!0;let A=F(this,Ct,"m",qd).call(this);this._emit("content.done",{content:t.message.content,parsed:A?A.$parseRaw(t.message.content):null})}t.message.refusal&&!n.refusal_done&&(n.refusal_done=!0,this._emit("refusal.done",{refusal:t.message.refusal})),t.logprobs?.content&&!n.logprobs_content_done&&(n.logprobs_content_done=!0,this._emit("logprobs.content.done",{content:t.logprobs.content})),t.logprobs?.refusal&&!n.logprobs_refusal_done&&(n.logprobs_refusal_done=!0,this._emit("logprobs.refusal.done",{refusal:t.logprobs.refusal}))},Qc=function(){if(this.ended)throw new re("stream has ended, this shouldn't happen");let t=F(this,LA,"f");if(!t)throw new re("request ended without sending any chunks");return ce(this,LA,void 0,"f"),ce(this,Wi,[],"f"),oQ(t,F(this,aA,"f"))},qd=function(){let t=F(this,aA,"f")?.response_format;return Uo(t)?t:null},Zw=function(t){var n,A,s,i;let a=F(this,LA,"f"),{choices:f,...d}=t;a?Object.assign(a,d):a=ce(this,LA,{...d,choices:[]},"f");for(let{delta:h,finish_reason:m,index:y,logprobs:w=null,...b}of t.choices){let C=a.choices[y];if(C||(C=a.choices[y]={finish_reason:m,index:y,message:{},logprobs:w,...b}),w)if(!C.logprobs)C.logprobs=Object.assign({},w);else{let{content:ee,refusal:Y,...fe}=w;Object.assign(C.logprobs,fe),ee&&((n=C.logprobs).content??(n.content=[]),C.logprobs.content.push(...ee)),Y&&((A=C.logprobs).refusal??(A.refusal=[]),C.logprobs.refusal.push(...Y))}if(m&&(C.finish_reason=m,F(this,aA,"f")&&Nd(F(this,aA,"f")))){if(m==="length")throw new ji;if(m==="content_filter")throw new Ki}if(Object.assign(C,b),!h)continue;let{content:I,refusal:T,function_call:Q,role:P,tool_calls:R,...D}=h;if(Object.assign(C.message,D),T&&(C.message.refusal=(C.message.refusal||"")+T),P&&(C.message.role=P),Q&&(C.message.function_call?(Q.name&&(C.message.function_call.name=Q.name),Q.arguments&&((s=C.message.function_call).arguments??(s.arguments=""),C.message.function_call.arguments+=Q.arguments)):C.message.function_call=Q),I&&(C.message.content=(C.message.content||"")+I,!C.message.refusal&&F(this,Ct,"m",qd).call(this)&&(C.message.parsed=Gd(C.message.content))),R){C.message.tool_calls||(C.message.tool_calls=[]);for(let{index:ee,id:Y,type:fe,function:ve,...Ie}of R){let Te=(i=C.message.tool_calls)[ee]??(i[ee]={});Object.assign(Te,Ie),Y&&(Te.id=Y),fe&&(Te.type=fe),ve&&(Te.function??(Te.function={name:ve.name??"",arguments:""})),ve?.name&&(Te.function.name=ve.name),ve?.arguments&&(Te.function.arguments+=ve.arguments,Mw(F(this,aA,"f"),Te)&&(Te.function.parsed_arguments=Gd(Te.function.arguments)))}}}return a},Symbol.asyncIterator)](){let e=[],t=[],n=!1;return this.on("chunk",A=>{let s=t.shift();s?s.resolve(A):e.push(A)}),this.on("end",()=>{n=!0;for(let A of t)A.resolve(void 0);t.length=0}),this.on("abort",A=>{n=!0;for(let s of t)s.reject(A);t.length=0}),this.on("error",A=>{n=!0;for(let s of t)s.reject(A);t.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:n?{value:void 0,done:!0}:new Promise((s,i)=>t.push({resolve:s,reject:i})).then(s=>s?{value:s,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new Qn(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}};function oQ(r,e){let{id:t,choices:n,created:A,model:s,system_fingerprint:i,...a}=r,f={...a,id:t,choices:n.map(({message:d,finish_reason:h,index:m,logprobs:y,...w})=>{if(!h)throw new re(`missing finish_reason for choice ${m}`);let{content:b=null,function_call:C,tool_calls:I,...T}=d,Q=d.role;if(!Q)throw new re(`missing role for choice ${m}`);if(C){let{arguments:P,name:R}=C;if(P==null)throw new re(`missing function_call.arguments for choice ${m}`);if(!R)throw new re(`missing function_call.name for choice ${m}`);return{...w,message:{content:b,function_call:{arguments:P,name:R},role:Q,refusal:d.refusal??null},finish_reason:h,index:m,logprobs:y}}return I?{...w,index:m,finish_reason:h,logprobs:y,message:{...T,role:Q,content:b,refusal:d.refusal??null,tool_calls:I.map((P,R)=>{let{function:D,type:ee,id:Y,...fe}=P,{arguments:ve,name:Ie,...Te}=D||{};if(Y==null)throw new re(`missing choices[${m}].tool_calls[${R}].id
${Tc(r)}`);if(ee==null)throw new re(`missing choices[${m}].tool_calls[${R}].type
${Tc(r)}`);if(Ie==null)throw new re(`missing choices[${m}].tool_calls[${R}].function.name
${Tc(r)}`);if(ve==null)throw new re(`missing choices[${m}].tool_calls[${R}].function.arguments
${Tc(r)}`);return{...fe,id:Y,type:ee,function:{...Te,name:Ie,arguments:ve}}})}}:{...w,message:{...T,content:b,role:Q,refusal:d.refusal??null},finish_reason:h,index:m,logprobs:y}}),created:A,model:s,object:"chat.completion",...i?{system_fingerprint:i}:{}};return Dw(f,e)}function Tc(r){return JSON.stringify(r)}var Ro=class r extends Es{static fromReadableStream(e){let t=new r(null);return t._run(()=>t._fromReadableStream(e)),t}static runTools(e,t,n){let A=new r(t),s={...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"runTools"}};return A._run(()=>A._runTools(e,t,s)),A}};var oA=class extends L{constructor(){super(...arguments),this.messages=new vs(this._client)}create(e,t){return this._client.post("/chat/completions",{body:e,...t,stream:e.stream??!1})}retrieve(e,t){return this._client.get(k`/chat/completions/${e}`,t)}update(e,t,n){return this._client.post(k`/chat/completions/${e}`,{body:t,...n})}list(e={},t){return this._client.getAPIList("/chat/completions",Se,{query:e,...t})}delete(e,t){return this._client.delete(k`/chat/completions/${e}`,t)}parse(e,t){return jw(e.tools),this._client.chat.completions.create(e,{...t,headers:{...t?.headers,"X-Stainless-Helper-Method":"chat.completions.parse"}})._thenUnwrap(n=>Fo(n,e))}runTools(e,t){return e.stream?Ro.runTools(this._client,e,t):Po.runTools(this._client,e,t)}stream(e,t){return Es.createChatCompletion(this._client,e,t)}};oA.Messages=vs;var HA=class extends L{constructor(){super(...arguments),this.completions=new oA(this._client)}};HA.Completions=oA;var Jw=Symbol("brand.privateNullableHeaders");function*cQ(r){if(!r)return;if(Jw in r){let{values:n,nulls:A}=r;yield*n.entries();for(let s of A)yield[s,null];return}let e=!1,t;r instanceof Headers?t=r.entries():_d(r)?t=r:(e=!0,t=Object.entries(r??{}));for(let n of t){let A=n[0];if(typeof A!="string")throw new TypeError("expected header name to be a string");let s=_d(n[1])?n[1]:[n[1]],i=!1;for(let a of s)a!==void 0&&(e&&!i&&(i=!0,yield[A,null]),yield[A,a])}}var K=r=>{let e=new Headers,t=new Set;for(let n of r){let A=new Set;for(let[s,i]of cQ(n)){let a=s.toLowerCase();A.has(a)||(e.delete(s),A.add(a)),i===null?(e.delete(s),t.add(a)):(e.append(s,i),t.delete(a))}}return{[Jw]:!0,values:e,nulls:t}};var qi=class extends L{create(e,t){return this._client.post("/audio/speech",{body:e,...t,headers:K([{Accept:"application/octet-stream"},t?.headers]),__binaryResponse:!0})}};var Xi=class extends L{create(e,t){return this._client.post("/audio/transcriptions",Tr({body:e,...t,stream:e.stream??!1,__metadata:{model:e.model}},this._client))}};var Yi=class extends L{create(e,t){return this._client.post("/audio/translations",Tr({body:e,...t,__metadata:{model:e.model}},this._client))}};var On=class extends L{constructor(){super(...arguments),this.transcriptions=new Xi(this._client),this.translations=new Yi(this._client),this.speech=new qi(this._client)}};On.Transcriptions=Xi;On.Translations=Yi;On.Speech=qi;var xs=class extends L{create(e,t){return this._client.post("/batches",{body:e,...t})}retrieve(e,t){return this._client.get(k`/batches/${e}`,t)}list(e={},t){return this._client.getAPIList("/batches",Se,{query:e,...t})}cancel(e,t){return this._client.post(k`/batches/${e}/cancel`,t)}};var ea=class extends L{create(e,t){return this._client.post("/assistants",{body:e,...t,headers:K([{"OpenAI-Beta":"assistants=v2"},t?.headers])})}retrieve(e,t){return this._client.get(k`/assistants/${e}`,{...t,headers:K([{"OpenAI-Beta":"assistants=v2"},t?.headers])})}update(e,t,n){return this._client.post(k`/assistants/${e}`,{body:t,...n,headers:K([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}list(e={},t){return this._client.getAPIList("/assistants",Se,{query:e,...t,headers:K([{"OpenAI-Beta":"assistants=v2"},t?.headers])})}delete(e,t){return this._client.delete(k`/assistants/${e}`,{...t,headers:K([{"OpenAI-Beta":"assistants=v2"},t?.headers])})}};var ta=class extends L{create(e,t){return this._client.post("/realtime/sessions",{body:e,...t,headers:K([{"OpenAI-Beta":"assistants=v2"},t?.headers])})}};var ra=class extends L{create(e,t){return this._client.post("/realtime/transcription_sessions",{body:e,...t,headers:K([{"OpenAI-Beta":"assistants=v2"},t?.headers])})}};var DA=class extends L{constructor(){super(...arguments),this.sessions=new ta(this._client),this.transcriptionSessions=new ra(this._client)}};DA.Sessions=ta;DA.TranscriptionSessions=ra;var na=class extends L{create(e,t,n){return this._client.post(k`/threads/${e}/messages`,{body:t,...n,headers:K([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}retrieve(e,t,n){let{thread_id:A}=t;return this._client.get(k`/threads/${A}/messages/${e}`,{...n,headers:K([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}update(e,t,n){let{thread_id:A,...s}=t;return this._client.post(k`/threads/${A}/messages/${e}`,{body:s,...n,headers:K([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}list(e,t={},n){return this._client.getAPIList(k`/threads/${e}/messages`,Se,{query:t,...n,headers:K([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}delete(e,t,n){let{thread_id:A}=t;return this._client.delete(k`/threads/${A}/messages/${e}`,{...n,headers:K([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}};var Aa=class extends L{retrieve(e,t,n){let{thread_id:A,run_id:s,...i}=t;return this._client.get(k`/threads/${A}/runs/${s}/steps/${e}`,{query:i,...n,headers:K([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}list(e,t,n){let{thread_id:A,...s}=t;return this._client.getAPIList(k`/threads/${A}/runs/${e}/steps`,Se,{query:s,...n,headers:K([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}};var Ww=r=>{if(typeof Buffer<"u"){let e=Buffer.from(r,"base64");return Array.from(new Float32Array(e.buffer,e.byteOffset,e.length/Float32Array.BYTES_PER_ELEMENT))}else{let e=atob(r),t=e.length,n=new Uint8Array(t);for(let A=0;A<t;A++)n[A]=e.charCodeAt(A);return Array.from(new Float32Array(n.buffer))}};var MA=r=>{if(typeof globalThis.process<"u")return globalThis.process.env?.[r]?.trim()??void 0;if(typeof globalThis.Deno<"u")return globalThis.Deno.env?.get?.(r)?.trim()};var Dt,Us,Xd,Sn,Oc,An,Fs,sa,Is,Rc,Or,Sc,Pc,Lo,ko,No,qw,Xw,Yw,ey,ty,ry,ny,uA=class extends NA{constructor(){super(...arguments),Dt.add(this),Xd.set(this,[]),Sn.set(this,{}),Oc.set(this,{}),An.set(this,void 0),Fs.set(this,void 0),sa.set(this,void 0),Is.set(this,void 0),Rc.set(this,void 0),Or.set(this,void 0),Sc.set(this,void 0),Pc.set(this,void 0),Lo.set(this,void 0)}[(Xd=new WeakMap,Sn=new WeakMap,Oc=new WeakMap,An=new WeakMap,Fs=new WeakMap,sa=new WeakMap,Is=new WeakMap,Rc=new WeakMap,Or=new WeakMap,Sc=new WeakMap,Pc=new WeakMap,Lo=new WeakMap,Dt=new WeakSet,Symbol.asyncIterator)](){let e=[],t=[],n=!1;return this.on("event",A=>{let s=t.shift();s?s.resolve(A):e.push(A)}),this.on("end",()=>{n=!0;for(let A of t)A.resolve(void 0);t.length=0}),this.on("abort",A=>{n=!0;for(let s of t)s.reject(A);t.length=0}),this.on("error",A=>{n=!0;for(let s of t)s.reject(A);t.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:n?{value:void 0,done:!0}:new Promise((s,i)=>t.push({resolve:s,reject:i})).then(s=>s?{value:s,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(e){let t=new Us;return t._run(()=>t._fromReadableStream(e)),t}async _fromReadableStream(e,t){let n=t?.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort())),this._connected();let A=Qn.fromReadableStream(e,this.controller);for await(let s of A)F(this,Dt,"m",ko).call(this,s);if(A.controller.signal?.aborted)throw new ot;return this._addRun(F(this,Dt,"m",No).call(this))}toReadableStream(){return new Qn(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(e,t,n,A){let s=new Us;return s._run(()=>s._runToolAssistantStream(e,t,n,{...A,headers:{...A?.headers,"X-Stainless-Helper-Method":"stream"}})),s}async _createToolAssistantStream(e,t,n,A){let s=A?.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort()));let i={...n,stream:!0},a=await e.submitToolOutputs(t,i,{...A,signal:this.controller.signal});this._connected();for await(let f of a)F(this,Dt,"m",ko).call(this,f);if(a.controller.signal?.aborted)throw new ot;return this._addRun(F(this,Dt,"m",No).call(this))}static createThreadAssistantStream(e,t,n){let A=new Us;return A._run(()=>A._threadAssistantStream(e,t,{...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"stream"}})),A}static createAssistantStream(e,t,n,A){let s=new Us;return s._run(()=>s._runAssistantStream(e,t,n,{...A,headers:{...A?.headers,"X-Stainless-Helper-Method":"stream"}})),s}currentEvent(){return F(this,Sc,"f")}currentRun(){return F(this,Pc,"f")}currentMessageSnapshot(){return F(this,An,"f")}currentRunStepSnapshot(){return F(this,Lo,"f")}async finalRunSteps(){return await this.done(),Object.values(F(this,Sn,"f"))}async finalMessages(){return await this.done(),Object.values(F(this,Oc,"f"))}async finalRun(){if(await this.done(),!F(this,Fs,"f"))throw Error("Final run was not received.");return F(this,Fs,"f")}async _createThreadAssistantStream(e,t,n){let A=n?.signal;A&&(A.aborted&&this.controller.abort(),A.addEventListener("abort",()=>this.controller.abort()));let s={...t,stream:!0},i=await e.createAndRun(s,{...n,signal:this.controller.signal});this._connected();for await(let a of i)F(this,Dt,"m",ko).call(this,a);if(i.controller.signal?.aborted)throw new ot;return this._addRun(F(this,Dt,"m",No).call(this))}async _createAssistantStream(e,t,n,A){let s=A?.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort()));let i={...n,stream:!0},a=await e.create(t,i,{...A,signal:this.controller.signal});this._connected();for await(let f of a)F(this,Dt,"m",ko).call(this,f);if(a.controller.signal?.aborted)throw new ot;return this._addRun(F(this,Dt,"m",No).call(this))}static accumulateDelta(e,t){for(let[n,A]of Object.entries(t)){if(!e.hasOwnProperty(n)){e[n]=A;continue}let s=e[n];if(s==null){e[n]=A;continue}if(n==="index"||n==="type"){e[n]=A;continue}if(typeof s=="string"&&typeof A=="string")s+=A;else if(typeof s=="number"&&typeof A=="number")s+=A;else if(_o(s)&&_o(A))s=this.accumulateDelta(s,A);else if(Array.isArray(s)&&Array.isArray(A)){if(s.every(i=>typeof i=="string"||typeof i=="number")){s.push(...A);continue}for(let i of A){if(!_o(i))throw new Error(`Expected array delta entry to be an object but got: ${i}`);let a=i.index;if(a==null)throw console.error(i),new Error("Expected array delta entry to have an `index` property");if(typeof a!="number")throw new Error(`Expected array delta entry \`index\` property to be a number but got ${a}`);let f=s[a];f==null?s.push(i):s[a]=this.accumulateDelta(f,i)}continue}else throw Error(`Unhandled record type: ${n}, deltaValue: ${A}, accValue: ${s}`);e[n]=s}return e}_addRun(e){return e}async _threadAssistantStream(e,t,n){return await this._createThreadAssistantStream(t,e,n)}async _runAssistantStream(e,t,n,A){return await this._createAssistantStream(t,e,n,A)}async _runToolAssistantStream(e,t,n,A){return await this._createToolAssistantStream(t,e,n,A)}};Us=uA,ko=function(e){if(!this.ended)switch(ce(this,Sc,e,"f"),F(this,Dt,"m",Yw).call(this,e),e.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.incomplete":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":F(this,Dt,"m",ny).call(this,e);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":F(this,Dt,"m",Xw).call(this,e);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":F(this,Dt,"m",qw).call(this,e);break;case"error":throw new Error("Encountered an error event in event processing - errors should be processed earlier");default:}},No=function(){if(this.ended)throw new re("stream has ended, this shouldn't happen");if(!F(this,Fs,"f"))throw Error("Final run has not been received");return F(this,Fs,"f")},qw=function(e){let[t,n]=F(this,Dt,"m",ty).call(this,e,F(this,An,"f"));ce(this,An,t,"f"),F(this,Oc,"f")[t.id]=t;for(let A of n){let s=t.content[A.index];s?.type=="text"&&this._emit("textCreated",s.text)}switch(e.event){case"thread.message.created":this._emit("messageCreated",e.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",e.data.delta,t),e.data.delta.content)for(let A of e.data.delta.content){if(A.type=="text"&&A.text){let s=A.text,i=t.content[A.index];if(i&&i.type=="text")this._emit("textDelta",s,i.text);else throw Error("The snapshot associated with this text delta is not text or missing")}if(A.index!=F(this,sa,"f")){if(F(this,Is,"f"))switch(F(this,Is,"f").type){case"text":this._emit("textDone",F(this,Is,"f").text,F(this,An,"f"));break;case"image_file":this._emit("imageFileDone",F(this,Is,"f").image_file,F(this,An,"f"));break}ce(this,sa,A.index,"f")}ce(this,Is,t.content[A.index],"f")}break;case"thread.message.completed":case"thread.message.incomplete":if(F(this,sa,"f")!==void 0){let A=e.data.content[F(this,sa,"f")];if(A)switch(A.type){case"image_file":this._emit("imageFileDone",A.image_file,F(this,An,"f"));break;case"text":this._emit("textDone",A.text,F(this,An,"f"));break}}F(this,An,"f")&&this._emit("messageDone",e.data),ce(this,An,void 0,"f")}},Xw=function(e){let t=F(this,Dt,"m",ey).call(this,e);switch(ce(this,Lo,t,"f"),e.event){case"thread.run.step.created":this._emit("runStepCreated",e.data);break;case"thread.run.step.delta":let n=e.data.delta;if(n.step_details&&n.step_details.type=="tool_calls"&&n.step_details.tool_calls&&t.step_details.type=="tool_calls")for(let s of n.step_details.tool_calls)s.index==F(this,Rc,"f")?this._emit("toolCallDelta",s,t.step_details.tool_calls[s.index]):(F(this,Or,"f")&&this._emit("toolCallDone",F(this,Or,"f")),ce(this,Rc,s.index,"f"),ce(this,Or,t.step_details.tool_calls[s.index],"f"),F(this,Or,"f")&&this._emit("toolCallCreated",F(this,Or,"f")));this._emit("runStepDelta",e.data.delta,t);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":ce(this,Lo,void 0,"f"),e.data.step_details.type=="tool_calls"&&F(this,Or,"f")&&(this._emit("toolCallDone",F(this,Or,"f")),ce(this,Or,void 0,"f")),this._emit("runStepDone",e.data,t);break;case"thread.run.step.in_progress":break}},Yw=function(e){F(this,Xd,"f").push(e),this._emit("event",e)},ey=function(e){switch(e.event){case"thread.run.step.created":return F(this,Sn,"f")[e.data.id]=e.data,e.data;case"thread.run.step.delta":let t=F(this,Sn,"f")[e.data.id];if(!t)throw Error("Received a RunStepDelta before creation of a snapshot");let n=e.data;if(n.delta){let A=Us.accumulateDelta(t,n.delta);F(this,Sn,"f")[e.data.id]=A}return F(this,Sn,"f")[e.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":F(this,Sn,"f")[e.data.id]=e.data;break}if(F(this,Sn,"f")[e.data.id])return F(this,Sn,"f")[e.data.id];throw new Error("No snapshot available")},ty=function(e,t){let n=[];switch(e.event){case"thread.message.created":return[e.data,n];case"thread.message.delta":if(!t)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let A=e.data;if(A.delta.content)for(let s of A.delta.content)if(s.index in t.content){let i=t.content[s.index];t.content[s.index]=F(this,Dt,"m",ry).call(this,s,i)}else t.content[s.index]=s,n.push(s);return[t,n];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(t)return[t,n];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},ry=function(e,t){return Us.accumulateDelta(t,e)},ny=function(e){switch(ce(this,Pc,e.data,"f"),e.event){case"thread.run.created":break;case"thread.run.queued":break;case"thread.run.in_progress":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":case"thread.run.incomplete":ce(this,Fs,e.data,"f"),F(this,Or,"f")&&(this._emit("toolCallDone",F(this,Or,"f")),ce(this,Or,void 0,"f"));break;case"thread.run.cancelling":break}};var Qs=class extends L{constructor(){super(...arguments),this.steps=new Aa(this._client)}create(e,t,n){let{include:A,...s}=t;return this._client.post(k`/threads/${e}/runs`,{query:{include:A},body:s,...n,headers:K([{"OpenAI-Beta":"assistants=v2"},n?.headers]),stream:t.stream??!1})}retrieve(e,t,n){let{thread_id:A}=t;return this._client.get(k`/threads/${A}/runs/${e}`,{...n,headers:K([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}update(e,t,n){let{thread_id:A,...s}=t;return this._client.post(k`/threads/${A}/runs/${e}`,{body:s,...n,headers:K([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}list(e,t={},n){return this._client.getAPIList(k`/threads/${e}/runs`,Se,{query:t,...n,headers:K([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}cancel(e,t,n){let{thread_id:A}=t;return this._client.post(k`/threads/${A}/runs/${e}/cancel`,{...n,headers:K([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}async createAndPoll(e,t,n){let A=await this.create(e,t,n);return await this.poll(A.id,{thread_id:e},n)}createAndStream(e,t,n){return uA.createAssistantStream(e,this._client.beta.threads.runs,t,n)}async poll(e,t,n){let A=K([n?.headers,{"X-Stainless-Poll-Helper":"true","X-Stainless-Custom-Poll-Interval":n?.pollIntervalMs?.toString()??void 0}]);for(;;){let{data:s,response:i}=await this.retrieve(e,t,{...n,headers:{...n?.headers,...A}}).withResponse();switch(s.status){case"queued":case"in_progress":case"cancelling":let a=5e3;if(n?.pollIntervalMs)a=n.pollIntervalMs;else{let f=i.headers.get("openai-poll-after-ms");if(f){let d=parseInt(f);isNaN(d)||(a=d)}}await Un(a);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return s}}}stream(e,t,n){return uA.createAssistantStream(e,this._client.beta.threads.runs,t,n)}submitToolOutputs(e,t,n){let{thread_id:A,...s}=t;return this._client.post(k`/threads/${A}/runs/${e}/submit_tool_outputs`,{body:s,...n,headers:K([{"OpenAI-Beta":"assistants=v2"},n?.headers]),stream:t.stream??!1})}async submitToolOutputsAndPoll(e,t,n){let A=await this.submitToolOutputs(e,t,n);return await this.poll(A.id,t,n)}submitToolOutputsStream(e,t,n){return uA.createToolAssistantStream(e,this._client.beta.threads.runs,t,n)}};Qs.Steps=Aa;var $A=class extends L{constructor(){super(...arguments),this.runs=new Qs(this._client),this.messages=new na(this._client)}create(e={},t){return this._client.post("/threads",{body:e,...t,headers:K([{"OpenAI-Beta":"assistants=v2"},t?.headers])})}retrieve(e,t){return this._client.get(k`/threads/${e}`,{...t,headers:K([{"OpenAI-Beta":"assistants=v2"},t?.headers])})}update(e,t,n){return this._client.post(k`/threads/${e}`,{body:t,...n,headers:K([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}delete(e,t){return this._client.delete(k`/threads/${e}`,{...t,headers:K([{"OpenAI-Beta":"assistants=v2"},t?.headers])})}createAndRun(e,t){return this._client.post("/threads/runs",{body:e,...t,headers:K([{"OpenAI-Beta":"assistants=v2"},t?.headers]),stream:e.stream??!1})}async createAndRunPoll(e,t){let n=await this.createAndRun(e,t);return await this.runs.poll(n.id,{thread_id:n.thread_id},t)}createAndRunStream(e,t){return uA.createThreadAssistantStream(e,this._client.beta.threads,t)}};$A.Runs=Qs;$A.Messages=na;var Pn=class extends L{constructor(){super(...arguments),this.realtime=new DA(this._client),this.assistants=new ea(this._client),this.threads=new $A(this._client)}};Pn.Realtime=DA;Pn.Assistants=ea;Pn.Threads=$A;var Ts=class extends L{create(e,t){return this._client.post("/completions",{body:e,...t,stream:e.stream??!1})}};var ia=class extends L{retrieve(e,t,n){let{container_id:A}=t;return this._client.get(k`/containers/${A}/files/${e}/content`,{...n,headers:K([{Accept:"application/binary"},n?.headers]),__binaryResponse:!0})}};var Os=class extends L{constructor(){super(...arguments),this.content=new ia(this._client)}create(e,t,n){return this._client.post(k`/containers/${e}/files`,Tr({body:t,...n},this._client))}retrieve(e,t,n){let{container_id:A}=t;return this._client.get(k`/containers/${A}/files/${e}`,n)}list(e,t={},n){return this._client.getAPIList(k`/containers/${e}/files`,Se,{query:t,...n})}delete(e,t,n){let{container_id:A}=t;return this._client.delete(k`/containers/${A}/files/${e}`,{...n,headers:K([{Accept:"*/*"},n?.headers])})}};Os.Content=ia;var jA=class extends L{constructor(){super(...arguments),this.files=new Os(this._client)}create(e,t){return this._client.post("/containers",{body:e,...t})}retrieve(e,t){return this._client.get(k`/containers/${e}`,t)}list(e={},t){return this._client.getAPIList("/containers",Se,{query:e,...t})}delete(e,t){return this._client.delete(k`/containers/${e}`,{...t,headers:K([{Accept:"*/*"},t?.headers])})}};jA.Files=Os;var Ss=class extends L{create(e,t){let n=!!e.encoding_format,A=n?e.encoding_format:"base64";n&&ft(this._client).debug("embeddings/user defined encoding_format:",e.encoding_format);let s=this._client.post("/embeddings",{body:{...e,encoding_format:A},...t});return n?s:(ft(this._client).debug("embeddings/decoding base64 embeddings from base64"),s._thenUnwrap(i=>(i&&i.data&&i.data.forEach(a=>{let f=a.embedding;a.embedding=Ww(f)}),i)))}};var aa=class extends L{retrieve(e,t,n){let{eval_id:A,run_id:s}=t;return this._client.get(k`/evals/${A}/runs/${s}/output_items/${e}`,n)}list(e,t,n){let{eval_id:A,...s}=t;return this._client.getAPIList(k`/evals/${A}/runs/${e}/output_items`,Se,{query:s,...n})}};var Ps=class extends L{constructor(){super(...arguments),this.outputItems=new aa(this._client)}create(e,t,n){return this._client.post(k`/evals/${e}/runs`,{body:t,...n})}retrieve(e,t,n){let{eval_id:A}=t;return this._client.get(k`/evals/${A}/runs/${e}`,n)}list(e,t={},n){return this._client.getAPIList(k`/evals/${e}/runs`,Se,{query:t,...n})}delete(e,t,n){let{eval_id:A}=t;return this._client.delete(k`/evals/${A}/runs/${e}`,n)}cancel(e,t,n){let{eval_id:A}=t;return this._client.post(k`/evals/${A}/runs/${e}`,n)}};Ps.OutputItems=aa;var KA=class extends L{constructor(){super(...arguments),this.runs=new Ps(this._client)}create(e,t){return this._client.post("/evals",{body:e,...t})}retrieve(e,t){return this._client.get(k`/evals/${e}`,t)}update(e,t,n){return this._client.post(k`/evals/${e}`,{body:t,...n})}list(e={},t){return this._client.getAPIList("/evals",Se,{query:e,...t})}delete(e,t){return this._client.delete(k`/evals/${e}`,t)}};KA.Runs=Ps;var Rs=class extends L{create(e,t){return this._client.post("/files",Tr({body:e,...t},this._client))}retrieve(e,t){return this._client.get(k`/files/${e}`,t)}list(e={},t){return this._client.getAPIList("/files",Se,{query:e,...t})}delete(e,t){return this._client.delete(k`/files/${e}`,t)}content(e,t){return this._client.get(k`/files/${e}/content`,{...t,headers:K([{Accept:"application/binary"},t?.headers]),__binaryResponse:!0})}async waitForProcessing(e,{pollInterval:t=5e3,maxWait:n=1800*1e3}={}){let A=new Set(["processed","error","deleted"]),s=Date.now(),i=await this.retrieve(e);for(;!i.status||!A.has(i.status);)if(await Un(t),i=await this.retrieve(e),Date.now()-s>n)throw new xn({message:`Giving up on waiting for file ${e} to finish processing after ${n} milliseconds.`});return i}};var oa=class extends L{};var ua=class extends L{run(e,t){return this._client.post("/fine_tuning/alpha/graders/run",{body:e,...t})}validate(e,t){return this._client.post("/fine_tuning/alpha/graders/validate",{body:e,...t})}};var ks=class extends L{constructor(){super(...arguments),this.graders=new ua(this._client)}};ks.Graders=ua;var ca=class extends L{create(e,t,n){return this._client.getAPIList(k`/fine_tuning/checkpoints/${e}/permissions`,Tn,{body:t,method:"post",...n})}retrieve(e,t={},n){return this._client.get(k`/fine_tuning/checkpoints/${e}/permissions`,{query:t,...n})}delete(e,t,n){let{fine_tuned_model_checkpoint:A}=t;return this._client.delete(k`/fine_tuning/checkpoints/${A}/permissions/${e}`,n)}};var Ns=class extends L{constructor(){super(...arguments),this.permissions=new ca(this._client)}};Ns.Permissions=ca;var la=class extends L{list(e,t={},n){return this._client.getAPIList(k`/fine_tuning/jobs/${e}/checkpoints`,Se,{query:t,...n})}};var Ls=class extends L{constructor(){super(...arguments),this.checkpoints=new la(this._client)}create(e,t){return this._client.post("/fine_tuning/jobs",{body:e,...t})}retrieve(e,t){return this._client.get(k`/fine_tuning/jobs/${e}`,t)}list(e={},t){return this._client.getAPIList("/fine_tuning/jobs",Se,{query:e,...t})}cancel(e,t){return this._client.post(k`/fine_tuning/jobs/${e}/cancel`,t)}listEvents(e,t={},n){return this._client.getAPIList(k`/fine_tuning/jobs/${e}/events`,Se,{query:t,...n})}pause(e,t){return this._client.post(k`/fine_tuning/jobs/${e}/pause`,t)}resume(e,t){return this._client.post(k`/fine_tuning/jobs/${e}/resume`,t)}};Ls.Checkpoints=la;var sn=class extends L{constructor(){super(...arguments),this.methods=new oa(this._client),this.jobs=new Ls(this._client),this.checkpoints=new Ns(this._client),this.alpha=new ks(this._client)}};sn.Methods=oa;sn.Jobs=Ls;sn.Checkpoints=Ns;sn.Alpha=ks;var fa=class extends L{};var zA=class extends L{constructor(){super(...arguments),this.graderModels=new fa(this._client)}};zA.GraderModels=fa;var Hs=class extends L{createVariation(e,t){return this._client.post("/images/variations",Tr({body:e,...t},this._client))}edit(e,t){return this._client.post("/images/edits",Tr({body:e,...t,stream:e.stream??!1},this._client))}generate(e,t){return this._client.post("/images/generations",{body:e,...t,stream:e.stream??!1})}};var Ds=class extends L{retrieve(e,t){return this._client.get(k`/models/${e}`,t)}list(e){return this._client.getAPIList("/models",Tn,e)}delete(e,t){return this._client.delete(k`/models/${e}`,t)}};var Ms=class extends L{create(e,t){return this._client.post("/moderations",{body:e,...t})}};function Ay(r,e){return!e||!RQ(e)?{...r,output_parsed:null,output:r.output.map(t=>t.type==="function_call"?{...t,parsed_arguments:null}:t.type==="message"?{...t,content:t.content.map(n=>({...n,parsed:null}))}:t)}:Yd(r,e)}function Yd(r,e){let t=r.output.map(A=>{if(A.type==="function_call")return{...A,parsed_arguments:LQ(e,A)};if(A.type==="message"){let s=A.content.map(i=>i.type==="output_text"?{...i,parsed:PQ(e,i.text)}:i);return{...A,content:s}}return A}),n=Object.assign({},r,{output:t});return Object.getOwnPropertyDescriptor(r,"output_text")||kc(n),Object.defineProperty(n,"output_parsed",{enumerable:!0,get(){for(let A of n.output)if(A.type==="message"){for(let s of A.content)if(s.type==="output_text"&&s.parsed!==null)return s.parsed}return null}}),n}function PQ(r,e){return r.text?.format?.type!=="json_schema"?null:"$parseRaw"in r.text?.format?(r.text?.format).$parseRaw(e):JSON.parse(e)}function RQ(r){return!!Uo(r.text?.format)}function kQ(r){return r?.$brand==="auto-parseable-tool"}function NQ(r,e){return r.find(t=>t.type==="function"&&t.name===e)}function LQ(r,e){let t=NQ(r.tools??[],e.name);return{...e,...e,parsed_arguments:kQ(t)?t.$parseRaw(e.arguments):t?.strict?JSON.parse(e.arguments):null}}function kc(r){let e=[];for(let t of r.output)if(t.type==="message")for(let n of t.content)n.type==="output_text"&&e.push(n.text);r.output_text=e.join("")}var da,Nc,GA,Lc,sy,iy,ay,oy,Hc=class r extends NA{constructor(e){super(),da.add(this),Nc.set(this,void 0),GA.set(this,void 0),Lc.set(this,void 0),ce(this,Nc,e,"f")}static createResponse(e,t,n){let A=new r(t);return A._run(()=>A._createOrRetrieveResponse(e,t,{...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"stream"}})),A}async _createOrRetrieveResponse(e,t,n){let A=n?.signal;A&&(A.aborted&&this.controller.abort(),A.addEventListener("abort",()=>this.controller.abort())),F(this,da,"m",sy).call(this);let s,i=null;"response_id"in t?(s=await e.responses.retrieve(t.response_id,{stream:!0},{...n,signal:this.controller.signal,stream:!0}),i=t.starting_after??null):s=await e.responses.create({...t,stream:!0},{...n,signal:this.controller.signal}),this._connected();for await(let a of s)F(this,da,"m",iy).call(this,a,i);if(s.controller.signal?.aborted)throw new ot;return F(this,da,"m",ay).call(this)}[(Nc=new WeakMap,GA=new WeakMap,Lc=new WeakMap,da=new WeakSet,sy=function(){this.ended||ce(this,GA,void 0,"f")},iy=function(t,n){if(this.ended)return;let A=(i,a)=>{(n==null||a.sequence_number>n)&&this._emit(i,a)},s=F(this,da,"m",oy).call(this,t);switch(A("event",t),t.type){case"response.output_text.delta":{let i=s.output[t.output_index];if(!i)throw new re(`missing output at index ${t.output_index}`);if(i.type==="message"){let a=i.content[t.content_index];if(!a)throw new re(`missing content at index ${t.content_index}`);if(a.type!=="output_text")throw new re(`expected content to be 'output_text', got ${a.type}`);A("response.output_text.delta",{...t,snapshot:a.text})}break}case"response.function_call_arguments.delta":{let i=s.output[t.output_index];if(!i)throw new re(`missing output at index ${t.output_index}`);i.type==="function_call"&&A("response.function_call_arguments.delta",{...t,snapshot:i.arguments});break}default:A(t.type,t);break}},ay=function(){if(this.ended)throw new re("stream has ended, this shouldn't happen");let t=F(this,GA,"f");if(!t)throw new re("request ended without sending any events");ce(this,GA,void 0,"f");let n=HQ(t,F(this,Nc,"f"));return ce(this,Lc,n,"f"),n},oy=function(t){let n=F(this,GA,"f");if(!n){if(t.type!=="response.created")throw new re(`When snapshot hasn't been set yet, expected 'response.created' event, got ${t.type}`);return n=ce(this,GA,t.response,"f"),n}switch(t.type){case"response.output_item.added":{n.output.push(t.item);break}case"response.content_part.added":{let A=n.output[t.output_index];if(!A)throw new re(`missing output at index ${t.output_index}`);A.type==="message"&&A.content.push(t.part);break}case"response.output_text.delta":{let A=n.output[t.output_index];if(!A)throw new re(`missing output at index ${t.output_index}`);if(A.type==="message"){let s=A.content[t.content_index];if(!s)throw new re(`missing content at index ${t.content_index}`);if(s.type!=="output_text")throw new re(`expected content to be 'output_text', got ${s.type}`);s.text+=t.delta}break}case"response.function_call_arguments.delta":{let A=n.output[t.output_index];if(!A)throw new re(`missing output at index ${t.output_index}`);A.type==="function_call"&&(A.arguments+=t.delta);break}case"response.completed":{ce(this,GA,t.response,"f");break}}return n},Symbol.asyncIterator)](){let e=[],t=[],n=!1;return this.on("event",A=>{let s=t.shift();s?s.resolve(A):e.push(A)}),this.on("end",()=>{n=!0;for(let A of t)A.resolve(void 0);t.length=0}),this.on("abort",A=>{n=!0;for(let s of t)s.reject(A);t.length=0}),this.on("error",A=>{n=!0;for(let s of t)s.reject(A);t.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:n?{value:void 0,done:!0}:new Promise((s,i)=>t.push({resolve:s,reject:i})).then(s=>s?{value:s,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}async finalResponse(){await this.done();let e=F(this,Lc,"f");if(!e)throw new re("stream ended without producing a ChatCompletion");return e}};function HQ(r,e){return Ay(r,e)}var pa=class extends L{list(e,t={},n){return this._client.getAPIList(k`/responses/${e}/input_items`,Se,{query:t,...n})}};var VA=class extends L{constructor(){super(...arguments),this.inputItems=new pa(this._client)}create(e,t){return this._client.post("/responses",{body:e,...t,stream:e.stream??!1})._thenUnwrap(n=>("object"in n&&n.object==="response"&&kc(n),n))}retrieve(e,t={},n){return this._client.get(k`/responses/${e}`,{query:t,...n,stream:t?.stream??!1})._thenUnwrap(A=>("object"in A&&A.object==="response"&&kc(A),A))}delete(e,t){return this._client.delete(k`/responses/${e}`,{...t,headers:K([{Accept:"*/*"},t?.headers])})}parse(e,t){return this._client.responses.create(e,t)._thenUnwrap(n=>Yd(n,e))}stream(e,t){return Hc.createResponse(this._client,e,t)}cancel(e,t){return this._client.post(k`/responses/${e}/cancel`,t)}};VA.InputItems=pa;var ha=class extends L{create(e,t,n){return this._client.post(k`/uploads/${e}/parts`,Tr({body:t,...n},this._client))}};var ZA=class extends L{constructor(){super(...arguments),this.parts=new ha(this._client)}create(e,t){return this._client.post("/uploads",{body:e,...t})}cancel(e,t){return this._client.post(k`/uploads/${e}/cancel`,t)}complete(e,t,n){return this._client.post(k`/uploads/${e}/complete`,{body:t,...n})}};ZA.Parts=ha;var uy=async r=>{let e=await Promise.allSettled(r),t=e.filter(A=>A.status==="rejected");if(t.length){for(let A of t)console.error(A.reason);throw new Error(`${t.length} promise(s) failed - see the above errors`)}let n=[];for(let A of e)A.status==="fulfilled"&&n.push(A.value);return n};var ma=class extends L{create(e,t,n){return this._client.post(k`/vector_stores/${e}/file_batches`,{body:t,...n,headers:K([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}retrieve(e,t,n){let{vector_store_id:A}=t;return this._client.get(k`/vector_stores/${A}/file_batches/${e}`,{...n,headers:K([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}cancel(e,t,n){let{vector_store_id:A}=t;return this._client.post(k`/vector_stores/${A}/file_batches/${e}/cancel`,{...n,headers:K([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}async createAndPoll(e,t,n){let A=await this.create(e,t);return await this.poll(e,A.id,n)}listFiles(e,t,n){let{vector_store_id:A,...s}=t;return this._client.getAPIList(k`/vector_stores/${A}/file_batches/${e}/files`,Se,{query:s,...n,headers:K([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}async poll(e,t,n){let A=K([n?.headers,{"X-Stainless-Poll-Helper":"true","X-Stainless-Custom-Poll-Interval":n?.pollIntervalMs?.toString()??void 0}]);for(;;){let{data:s,response:i}=await this.retrieve(t,{vector_store_id:e},{...n,headers:A}).withResponse();switch(s.status){case"in_progress":let a=5e3;if(n?.pollIntervalMs)a=n.pollIntervalMs;else{let f=i.headers.get("openai-poll-after-ms");if(f){let d=parseInt(f);isNaN(d)||(a=d)}}await Un(a);break;case"failed":case"cancelled":case"completed":return s}}}async uploadAndPoll(e,{files:t,fileIds:n=[]},A){if(t==null||t.length==0)throw new Error("No `files` provided to process. If you've already uploaded files you should use `.createAndPoll()` instead");let s=A?.maxConcurrency??5,i=Math.min(s,t.length),a=this._client,f=t.values(),d=[...n];async function h(y){for(let w of y){let b=await a.files.create({file:w,purpose:"assistants"},A);d.push(b.id)}}let m=Array(i).fill(f).map(h);return await uy(m),await this.createAndPoll(e,{file_ids:d})}};var ga=class extends L{create(e,t,n){return this._client.post(k`/vector_stores/${e}/files`,{body:t,...n,headers:K([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}retrieve(e,t,n){let{vector_store_id:A}=t;return this._client.get(k`/vector_stores/${A}/files/${e}`,{...n,headers:K([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}update(e,t,n){let{vector_store_id:A,...s}=t;return this._client.post(k`/vector_stores/${A}/files/${e}`,{body:s,...n,headers:K([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}list(e,t={},n){return this._client.getAPIList(k`/vector_stores/${e}/files`,Se,{query:t,...n,headers:K([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}delete(e,t,n){let{vector_store_id:A}=t;return this._client.delete(k`/vector_stores/${A}/files/${e}`,{...n,headers:K([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}async createAndPoll(e,t,n){let A=await this.create(e,t,n);return await this.poll(e,A.id,n)}async poll(e,t,n){let A=K([n?.headers,{"X-Stainless-Poll-Helper":"true","X-Stainless-Custom-Poll-Interval":n?.pollIntervalMs?.toString()??void 0}]);for(;;){let s=await this.retrieve(t,{vector_store_id:e},{...n,headers:A}).withResponse(),i=s.data;switch(i.status){case"in_progress":let a=5e3;if(n?.pollIntervalMs)a=n.pollIntervalMs;else{let f=s.response.headers.get("openai-poll-after-ms");if(f){let d=parseInt(f);isNaN(d)||(a=d)}}await Un(a);break;case"failed":case"completed":return i}}}async upload(e,t,n){let A=await this._client.files.create({file:t,purpose:"assistants"},n);return this.create(e,{file_id:A.id},n)}async uploadAndPoll(e,t,n){let A=await this.upload(e,t,n);return await this.poll(e,A.id,n)}content(e,t,n){let{vector_store_id:A}=t;return this._client.getAPIList(k`/vector_stores/${A}/files/${e}/content`,Tn,{...n,headers:K([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}};var cA=class extends L{constructor(){super(...arguments),this.files=new ga(this._client),this.fileBatches=new ma(this._client)}create(e,t){return this._client.post("/vector_stores",{body:e,...t,headers:K([{"OpenAI-Beta":"assistants=v2"},t?.headers])})}retrieve(e,t){return this._client.get(k`/vector_stores/${e}`,{...t,headers:K([{"OpenAI-Beta":"assistants=v2"},t?.headers])})}update(e,t,n){return this._client.post(k`/vector_stores/${e}`,{body:t,...n,headers:K([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}list(e={},t){return this._client.getAPIList("/vector_stores",Se,{query:e,...t,headers:K([{"OpenAI-Beta":"assistants=v2"},t?.headers])})}delete(e,t){return this._client.delete(k`/vector_stores/${e}`,{...t,headers:K([{"OpenAI-Beta":"assistants=v2"},t?.headers])})}search(e,t,n){return this._client.getAPIList(k`/vector_stores/${e}/search`,Tn,{body:t,method:"post",...n,headers:K([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}};cA.Files=ga;cA.FileBatches=ma;var wa,cy,Dc,$s=class extends L{constructor(){super(...arguments),wa.add(this)}async unwrap(e,t,n=this._client.webhookSecret,A=300){return await this.verifySignature(e,t,n,A),JSON.parse(e)}async verifySignature(e,t,n=this._client.webhookSecret,A=300){if(typeof crypto>"u"||typeof crypto.subtle.importKey!="function"||typeof crypto.subtle.verify!="function")throw new Error("Webhook signature verification is only supported when the `crypto` global is defined");F(this,wa,"m",cy).call(this,n);let s=K([t]).values,i=F(this,wa,"m",Dc).call(this,s,"webhook-signature"),a=F(this,wa,"m",Dc).call(this,s,"webhook-timestamp"),f=F(this,wa,"m",Dc).call(this,s,"webhook-id"),d=parseInt(a,10);if(isNaN(d))throw new In("Invalid webhook timestamp format");let h=Math.floor(Date.now()/1e3);if(h-d>A)throw new In("Webhook timestamp is too old");if(d>h+A)throw new In("Webhook timestamp is too new");let m=i.split(" ").map(C=>C.startsWith("v1,")?C.substring(3):C),y=n.startsWith("whsec_")?Buffer.from(n.replace("whsec_",""),"base64"):Buffer.from(n,"utf-8"),w=f?`${f}.${a}.${e}`:`${a}.${e}`,b=await crypto.subtle.importKey("raw",y,{name:"HMAC",hash:"SHA-256"},!1,["verify"]);for(let C of m)try{let I=Buffer.from(C,"base64");if(await crypto.subtle.verify("HMAC",b,I,new TextEncoder().encode(w)))return}catch{continue}throw new In("The given webhook signature does not match the expected signature")}};wa=new WeakSet,cy=function(e){if(typeof e!="string"||e.length===0)throw new Error("The webhook secret must either be set using the env var, OPENAI_WEBHOOK_SECRET, on the client class, OpenAI({ webhookSecret: '123' }), or passed to this function")},Dc=function(e,t){if(!e)throw new Error("Headers are required");let n=e.get(t);if(n==null)throw new Error(`Missing required header: ${t}`);return n};var ep,tp,Mc,ly,Ce=class{constructor({baseURL:e=MA("OPENAI_BASE_URL"),apiKey:t=MA("OPENAI_API_KEY"),organization:n=MA("OPENAI_ORG_ID")??null,project:A=MA("OPENAI_PROJECT_ID")??null,webhookSecret:s=MA("OPENAI_WEBHOOK_SECRET")??null,...i}={}){if(ep.add(this),Mc.set(this,void 0),this.completions=new Ts(this),this.chat=new HA(this),this.embeddings=new Ss(this),this.files=new Rs(this),this.images=new Hs(this),this.audio=new On(this),this.moderations=new Ms(this),this.models=new Ds(this),this.fineTuning=new sn(this),this.graders=new zA(this),this.vectorStores=new cA(this),this.webhooks=new $s(this),this.beta=new Pn(this),this.batches=new xs(this),this.uploads=new ZA(this),this.responses=new VA(this),this.evals=new KA(this),this.containers=new jA(this),t===void 0)throw new re("The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).");let a={apiKey:t,organization:n,project:A,webhookSecret:s,...i,baseURL:e||"https://api.openai.com/v1"};if(!a.dangerouslyAllowBrowser&&yw())throw new re(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new OpenAI({ apiKey, dangerouslyAllowBrowser: true });

https://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety
`);this.baseURL=a.baseURL,this.timeout=a.timeout??tp.DEFAULT_TIMEOUT,this.logger=a.logger??console;let f="warn";this.logLevel=f,this.logLevel=Qd(a.logLevel,"ClientOptions.logLevel",this)??Qd(MA("OPENAI_LOG"),"process.env['OPENAI_LOG']",this)??f,this.fetchOptions=a.fetchOptions,this.maxRetries=a.maxRetries??2,this.fetch=a.fetch??bw(),ce(this,Mc,vw,"f"),this._options=a,this.apiKey=t,this.organization=n,this.project=A,this.webhookSecret=s}withOptions(e){return new this.constructor({...this._options,baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,organization:this.organization,project:this.project,webhookSecret:this.webhookSecret,...e})}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:e,nulls:t}){}async authHeaders(e){return K([{Authorization:`Bearer ${this.apiKey}`}])}stringifyQuery(e){return Ud(e,{arrayFormat:"brackets"})}getUserAgent(){return`${this.constructor.name}/JS ${kA}`}defaultIdempotencyKey(){return`stainless-node-retry-${yd()}`}makeStatusError(e,t,n,A){return Bt.generate(e,t,n,A)}buildURL(e,t,n){let A=!F(this,ep,"m",ly).call(this)&&n||this.baseURL,s=cw(e)?new URL(e):new URL(A+(A.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),i=this.defaultQuery();return fw(i)||(t={...i,...t}),typeof t=="object"&&t&&!Array.isArray(t)&&(s.search=this.stringifyQuery(t)),s.toString()}async prepareOptions(e){}async prepareRequest(e,{url:t,options:n}){}get(e,t){return this.methodRequest("get",e,t)}post(e,t){return this.methodRequest("post",e,t)}patch(e,t){return this.methodRequest("patch",e,t)}put(e,t){return this.methodRequest("put",e,t)}delete(e,t){return this.methodRequest("delete",e,t)}methodRequest(e,t,n){return this.request(Promise.resolve(n).then(A=>({method:e,path:t,...A})))}request(e,t=null){return new Bs(this,this.makeRequest(e,t,void 0))}async makeRequest(e,t,n){let A=await e,s=A.maxRetries??this.maxRetries;t==null&&(t=s),await this.prepareOptions(A);let{req:i,url:a,timeout:f}=await this.buildRequest(A,{retryCount:s-t});await this.prepareRequest(i,{url:a,options:A});let d="log_"+(Math.random()*(1<<24)|0).toString(16).padStart(6,"0"),h=n===void 0?"":`, retryOf: ${n}`,m=Date.now();if(ft(this).debug(`[${d}] sending request`,sA({retryOfRequestLogID:n,method:A.method,url:a,options:A,headers:i.headers})),A.signal?.aborted)throw new ot;let y=new AbortController,w=await this.fetchWithTimeout(a,i,f,y).catch(yo),b=Date.now();if(w instanceof Error){let T=`retrying, ${t} attempts remaining`;if(A.signal?.aborted)throw new ot;let Q=wo(w)||/timed? ?out/i.test(String(w)+("cause"in w?String(w.cause):""));if(t)return ft(this).info(`[${d}] connection ${Q?"timed out":"failed"} - ${T}`),ft(this).debug(`[${d}] connection ${Q?"timed out":"failed"} (${T})`,sA({retryOfRequestLogID:n,url:a,durationMs:b-m,message:w.message})),this.retryRequest(A,t,n??d);throw ft(this).info(`[${d}] connection ${Q?"timed out":"failed"} - error; no more retries left`),ft(this).debug(`[${d}] connection ${Q?"timed out":"failed"} (error; no more retries left)`,sA({retryOfRequestLogID:n,url:a,durationMs:b-m,message:w.message})),Q?new xn:new RA({cause:w})}let C=[...w.headers.entries()].filter(([T])=>T==="x-request-id").map(([T,Q])=>", "+T+": "+JSON.stringify(Q)).join(""),I=`[${d}${h}${C}] ${i.method} ${a} ${w.ok?"succeeded":"failed"} with status ${w.status} in ${b-m}ms`;if(!w.ok){let T=await this.shouldRetry(w);if(t&&T){let Y=`retrying, ${t} attempts remaining`;return await Bw(w.body),ft(this).info(`${I} - ${Y}`),ft(this).debug(`[${d}] response error (${Y})`,sA({retryOfRequestLogID:n,url:w.url,status:w.status,headers:w.headers,durationMs:b-m})),this.retryRequest(A,t,n??d,w.headers)}let Q=T?"error; no more retries left":"error; not retryable";ft(this).info(`${I} - ${Q}`);let P=await w.text().catch(Y=>yo(Y).message),R=hw(P),D=R?void 0:P;throw ft(this).debug(`[${d}] response error (${Q})`,sA({retryOfRequestLogID:n,url:w.url,status:w.status,headers:w.headers,message:D,durationMs:Date.now()-m})),this.makeStatusError(w.status,R,D,w.headers)}return ft(this).info(I),ft(this).debug(`[${d}] response start`,sA({retryOfRequestLogID:n,url:w.url,status:w.status,headers:w.headers,durationMs:b-m})),{response:w,options:A,controller:y,requestLogID:d,retryOfRequestLogID:n,startTime:m}}getAPIList(e,t,n){return this.requestAPIList(t,{method:"get",path:e,...n})}requestAPIList(e,t){let n=this.makeRequest(t,null,void 0);return new Co(this,n,e)}async fetchWithTimeout(e,t,n,A){let{signal:s,method:i,...a}=t||{};s&&s.addEventListener("abort",()=>A.abort());let f=setTimeout(()=>A.abort(),n),d=globalThis.ReadableStream&&a.body instanceof globalThis.ReadableStream||typeof a.body=="object"&&a.body!==null&&Symbol.asyncIterator in a.body,h={signal:A.signal,...d?{duplex:"half"}:{},method:"GET",...a};i&&(h.method=i.toUpperCase());try{return await this.fetch.call(void 0,e,h)}finally{clearTimeout(f)}}async shouldRetry(e){let t=e.headers.get("x-should-retry");return t==="true"?!0:t==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,t,n,A){let s,i=A?.get("retry-after-ms");if(i){let f=parseFloat(i);Number.isNaN(f)||(s=f)}let a=A?.get("retry-after");if(a&&!s){let f=parseFloat(a);Number.isNaN(f)?s=Date.parse(a)-Date.now():s=f*1e3}if(!(s&&0<=s&&s<60*1e3)){let f=e.maxRetries??this.maxRetries;s=this.calculateDefaultRetryTimeoutMillis(t,f)}return await Un(s),this.makeRequest(e,t-1,n)}calculateDefaultRetryTimeoutMillis(e,t){let s=t-e,i=Math.min(.5*Math.pow(2,s),8),a=1-Math.random()*.25;return i*a*1e3}async buildRequest(e,{retryCount:t=0}={}){let n={...e},{method:A,path:s,query:i,defaultBaseURL:a}=n,f=this.buildURL(s,i,a);"timeout"in n&&pw("timeout",n.timeout),n.timeout=n.timeout??this.timeout;let{bodyHeaders:d,body:h}=this.buildBody({options:n}),m=await this.buildHeaders({options:e,method:A,bodyHeaders:d,retryCount:t});return{req:{method:A,headers:m,...n.signal&&{signal:n.signal},...globalThis.ReadableStream&&h instanceof globalThis.ReadableStream&&{duplex:"half"},...h&&{body:h},...this.fetchOptions??{},...n.fetchOptions??{}},url:f,timeout:n.timeout}}async buildHeaders({options:e,method:t,bodyHeaders:n,retryCount:A}){let s={};this.idempotencyHeader&&t!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),s[this.idempotencyHeader]=e.idempotencyKey);let i=K([s,{Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(A),...e.timeout?{"X-Stainless-Timeout":String(Math.trunc(e.timeout/1e3))}:{},..._w(),"OpenAI-Organization":this.organization,"OpenAI-Project":this.project},await this.authHeaders(e),this._options.defaultHeaders,n,e.headers]);return this.validateHeaders(i),i.values}buildBody({options:{body:e,headers:t}}){if(!e)return{bodyHeaders:void 0,body:void 0};let n=K([t]);return ArrayBuffer.isView(e)||e instanceof ArrayBuffer||e instanceof DataView||typeof e=="string"&&n.values.has("content-type")||e instanceof Blob||e instanceof FormData||e instanceof URLSearchParams||globalThis.ReadableStream&&e instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:e}:typeof e=="object"&&(Symbol.asyncIterator in e||Symbol.iterator in e&&"next"in e&&typeof e.next=="function")?{bodyHeaders:void 0,body:pc(e)}:F(this,Mc,"f").call(this,{body:e,headers:n})}};tp=Ce,Mc=new WeakMap,ep=new WeakSet,ly=function(){return this.baseURL!=="https://api.openai.com/v1"};Ce.OpenAI=tp;Ce.DEFAULT_TIMEOUT=6e5;Ce.OpenAIError=re;Ce.APIError=Bt;Ce.APIConnectionError=RA;Ce.APIConnectionTimeoutError=xn;Ce.APIUserAbortError=ot;Ce.NotFoundError=Li;Ce.ConflictError=Hi;Ce.RateLimitError=Mi;Ce.BadRequestError=Ri;Ce.AuthenticationError=ki;Ce.InternalServerError=$i;Ce.PermissionDeniedError=Ni;Ce.UnprocessableEntityError=Di;Ce.InvalidWebhookSignatureError=In;Ce.toFile=xo;Ce.Completions=Ts;Ce.Chat=HA;Ce.Embeddings=Ss;Ce.Files=Rs;Ce.Images=Hs;Ce.Audio=On;Ce.Moderations=Ms;Ce.Models=Ds;Ce.FineTuning=sn;Ce.Graders=zA;Ce.VectorStores=cA;Ce.Webhooks=$s;Ce.Beta=Pn;Ce.Batches=xs;Ce.Uploads=ZA;Ce.Responses=VA;Ce.Evals=KA;Ce.Containers=jA;function np(r,e=ya){r=r.trim();let t=r.indexOf("```");if(t===-1)return e(r);let n=r.substring(t+3);n.startsWith(`json
`)?n=n.substring(5):n.startsWith("json")?n=n.substring(4):n.startsWith(`
`)&&(n=n.substring(1));let A=n.indexOf("```"),s=n;return A!==-1&&(s=n.substring(0,A)),e(s.trim())}function ya(r){if(typeof r>"u")return null;try{return JSON.parse(r)}catch{}let e="",t=[],n=!1,A=!1;for(let s of r){if(n)s==='"'&&!A?n=!1:s===`
`&&!A?s="\\n":s==="\\"?A=!A:A=!1;else if(s==='"')n=!0,A=!1;else if(s==="{")t.push("}");else if(s==="[")t.push("]");else if(s==="}"||s==="]")if(t&&t[t.length-1]===s)t.pop();else return null;e+=s}n&&(e+='"');for(let s=t.length-1;s>=0;s-=1)e+=t[s];try{return JSON.parse(e)}catch{return null}}var by=Ur(dy(),1),qQ=Ur(_y(),1);function By(r,e){return e?.[r]||(0,by.default)(r)}function vy(r,e,t){let n={};for(let A in r)Object.hasOwn(r,A)&&(n[e(A,t)]=r[A]);return n}function Cy(r){return Array.isArray(r)?[...r]:{...r}}function XQ(r,e){let t=Cy(r);for(let[n,A]of Object.entries(e)){let[s,...i]=n.split(".").reverse(),a=t;for(let f of i.reverse()){if(a[f]===void 0)break;a[f]=Cy(a[f]),a=a[f]}a[s]!==void 0&&(a[s]={lc:1,type:"secret",id:[A]})}return t}function sp(r){let e=Object.getPrototypeOf(r);return typeof r.lc_name=="function"&&(typeof e.lc_name!="function"||r.lc_name()!==e.lc_name())?r.lc_name():r.name}var an=class r{static lc_name(){return this.name}get lc_id(){return[...this.lc_namespace,sp(this.constructor)]}get lc_secrets(){}get lc_attributes(){}get lc_aliases(){}get lc_serializable_keys(){}constructor(e,...t){Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.lc_serializable_keys!==void 0?this.lc_kwargs=Object.fromEntries(Object.entries(e||{}).filter(([n])=>this.lc_serializable_keys?.includes(n))):this.lc_kwargs=e??{}}toJSON(){if(!this.lc_serializable)return this.toJSONNotImplemented();if(this.lc_kwargs instanceof r||typeof this.lc_kwargs!="object"||Array.isArray(this.lc_kwargs))return this.toJSONNotImplemented();let e={},t={},n=Object.keys(this.lc_kwargs).reduce((A,s)=>(A[s]=s in this?this[s]:this.lc_kwargs[s],A),{});for(let A=Object.getPrototypeOf(this);A;A=Object.getPrototypeOf(A))Object.assign(e,Reflect.get(A,"lc_aliases",this)),Object.assign(t,Reflect.get(A,"lc_secrets",this)),Object.assign(n,Reflect.get(A,"lc_attributes",this));return Object.keys(t).forEach(A=>{let s=this,i=n,[a,...f]=A.split(".").reverse();for(let d of f.reverse()){if(!(d in s)||s[d]===void 0)return;(!(d in i)||i[d]===void 0)&&(typeof s[d]=="object"&&s[d]!=null?i[d]={}:Array.isArray(s[d])&&(i[d]=[])),s=s[d],i=i[d]}a in s&&s[a]!==void 0&&(i[a]=i[a]||s[a])}),{lc:1,type:"constructor",id:this.lc_id,kwargs:vy(Object.keys(t).length?XQ(n,t):n,By,e)}}toJSONNotImplemented(){return{lc:1,type:"not_implemented",id:this.lc_id}}};function lA(r){return typeof r=="object"&&r!==null&&"type"in r&&typeof r.type=="string"&&"source_type"in r&&(r.source_type==="url"||r.source_type==="base64"||r.source_type==="text"||r.source_type==="id")}function Ey(r){return lA(r)&&r.source_type==="url"&&"url"in r&&typeof r.url=="string"}function xy(r){return lA(r)&&r.source_type==="base64"&&"data"in r&&typeof r.data=="string"}function Iy(r){if(lA(r)){if(r.source_type==="url")return{type:"image_url",image_url:{url:r.url}};if(r.source_type==="base64"){if(!r.mime_type)throw new Error("mime_type key is required for base64 data.");return{type:"image_url",image_url:{url:`data:${r.mime_type};base64,${r.data}`}}}}throw new Error("Unsupported source type. Only 'url' and 'base64' are supported.")}function ip(r){let e=r.split(";")[0].split("/");if(e.length!==2)throw new Error(`Invalid mime type: "${r}" - does not match type/subtype format.`);let t=e[0].trim(),n=e[1].trim();if(t===""||n==="")throw new Error(`Invalid mime type: "${r}" - type or subtype is empty.`);let A={};for(let s of r.split(";").slice(1)){let i=s.split("=");if(i.length!==2)throw new Error(`Invalid parameter syntax in mime type: "${r}".`);let a=i[0].trim(),f=i[1].trim();if(a==="")throw new Error(`Invalid parameter syntax in mime type: "${r}".`);A[a]=f}return{type:t,subtype:n,parameters:A}}function ap({dataUrl:r,asTypedArray:e=!1}){let t=r.match(/^data:(\w+\/\w+);base64,([A-Za-z0-9+/]+=*)$/),n;if(t){n=t[1].toLowerCase();let A=e?Uint8Array.from(atob(t[2]),s=>s.charCodeAt(0)):t[2];return{mime_type:n,data:A}}}function op(r,e){if(r.type==="text"){if(!e.fromStandardTextBlock)throw new Error(`Converter for ${e.providerName} does not implement \`fromStandardTextBlock\` method.`);return e.fromStandardTextBlock(r)}if(r.type==="image"){if(!e.fromStandardImageBlock)throw new Error(`Converter for ${e.providerName} does not implement \`fromStandardImageBlock\` method.`);return e.fromStandardImageBlock(r)}if(r.type==="audio"){if(!e.fromStandardAudioBlock)throw new Error(`Converter for ${e.providerName} does not implement \`fromStandardAudioBlock\` method.`);return e.fromStandardAudioBlock(r)}if(r.type==="file"){if(!e.fromStandardFileBlock)throw new Error(`Converter for ${e.providerName} does not implement \`fromStandardFileBlock\` method.`);return e.fromStandardFileBlock(r)}throw new Error(`Unable to convert content block type '${r.type}' to provider-specific format: not recognized.`)}function zr(r,e){return typeof r=="string"?r===""?e:typeof e=="string"?r+e:Array.isArray(e)&&e.some(t=>lA(t))?[{type:"text",source_type:"text",text:r},...e]:[{type:"text",text:r},...e]:Array.isArray(e)?Ho(r,e)??[...r,...e]:e===""?r:Array.isArray(r)&&r.some(t=>lA(t))?[...r,{type:"file",source_type:"text",text:e}]:[...r,{type:"text",text:e}]}function Uy(r,e){return r==="error"||e==="error"?"error":"success"}function YQ(r,e){function t(n,A){if(typeof n!="object"||n===null||n===void 0)return n;if(A>=e)return Array.isArray(n)?"[Array]":"[Object]";if(Array.isArray(n))return n.map(i=>t(i,A+1));let s={};for(let i of Object.keys(n))s[i]=t(n[i],A+1);return s}return JSON.stringify(t(r,0),null,2)}var Ar=class extends an{get lc_aliases(){return{additional_kwargs:"additional_kwargs",response_metadata:"response_metadata"}}get text(){return typeof this.content=="string"?this.content:Array.isArray(this.content)?this.content.map(e=>typeof e=="string"?e:e.type==="text"?e.text:"").join(""):""}getType(){return this._getType()}constructor(e,t){typeof e=="string"&&(e={content:e,additional_kwargs:t,response_metadata:{}}),e.additional_kwargs||(e.additional_kwargs={}),e.response_metadata||(e.response_metadata={}),super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","messages"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"content",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"additional_kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"response_metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name=e.name,this.content=e.content,this.additional_kwargs=e.additional_kwargs,this.response_metadata=e.response_metadata,this.id=e.id}toDict(){return{type:this._getType(),data:this.toJSON().kwargs}}static lc_name(){return"BaseMessage"}get _printableFields(){return{id:this.id,content:this.content,name:this.name,additional_kwargs:this.additional_kwargs,response_metadata:this.response_metadata}}_updateId(e){this.id=e,this.lc_kwargs.id=e}get[Symbol.toStringTag](){return this.constructor.lc_name()}[Symbol.for("nodejs.util.inspect.custom")](e){if(e===null)return this;let t=YQ(this._printableFields,Math.max(4,e));return`${this.constructor.lc_name()} ${t}`}};function dt(r,e){let t={...r};for(let[n,A]of Object.entries(e))if(t[n]==null)t[n]=A;else{if(A==null)continue;if(typeof t[n]!=typeof A||Array.isArray(t[n])!==Array.isArray(A))throw new Error(`field[${n}] already exists in the message chunk, but with a different type.`);if(typeof t[n]=="string"){if(n==="type")continue;t[n]+=A}else if(typeof t[n]=="object"&&!Array.isArray(t[n]))t[n]=dt(t[n],A);else if(Array.isArray(t[n]))t[n]=Ho(t[n],A);else{if(t[n]===A)continue;console.warn(`field[${n}] already exists in this message chunk and value has unsupported type.`)}}return t}function Ho(r,e){if(!(r===void 0&&e===void 0)){if(r===void 0||e===void 0)return r||e;{let t=[...r];for(let n of e)if(typeof n=="object"&&"index"in n&&typeof n.index=="number"){let A=t.findIndex(s=>s.index===n.index);A!==-1?t[A]=dt(t[A],n):t.push(n)}else{if(typeof n=="object"&&"text"in n&&n.text==="")continue;t.push(n)}return t}}}function Fy(r,e){if(!r&&!e)throw new Error("Cannot merge two undefined objects.");if(!r||!e)return r||e;if(typeof r!=typeof e)throw new Error(`Cannot merge objects of different types.
Left ${typeof r}
Right ${typeof e}`);if(typeof r=="string"&&typeof e=="string")return r+e;if(Array.isArray(r)&&Array.isArray(e))return Ho(r,e);if(typeof r=="object"&&typeof e=="object")return dt(r,e);if(r===e)return r;throw new Error(`Can not merge objects of different types.
Left ${r}
Right ${e}`)}var gr=class extends Ar{};function Qy(r){return typeof r.role=="string"}function JA(r){return typeof r?._getType=="function"}function up(r){return JA(r)&&typeof r.concat=="function"}function Ty(r){return r!=null&&typeof r=="object"&&"lc_direct_tool_output"in r&&r.lc_direct_tool_output===!0}var on=class extends Ar{static lc_name(){return"ToolMessage"}get lc_aliases(){return{tool_call_id:"tool_call_id"}}constructor(e,t,n){typeof e=="string"&&(e={content:e,name:n,tool_call_id:t}),super(e),Object.defineProperty(this,"lc_direct_tool_output",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"status",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tool_call_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"artifact",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.tool_call_id=e.tool_call_id,this.artifact=e.artifact,this.status=e.status,this.metadata=e.metadata}_getType(){return"tool"}static isInstance(e){return e._getType()==="tool"}get _printableFields(){return{...super._printableFields,tool_call_id:this.tool_call_id,artifact:this.artifact}}},_a=class r extends gr{constructor(e){super(e),Object.defineProperty(this,"tool_call_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"status",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"artifact",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.tool_call_id=e.tool_call_id,this.artifact=e.artifact,this.status=e.status}static lc_name(){return"ToolMessageChunk"}_getType(){return"tool"}concat(e){return new r({content:zr(this.content,e.content),additional_kwargs:dt(this.additional_kwargs,e.additional_kwargs),response_metadata:dt(this.response_metadata,e.response_metadata),artifact:Fy(this.artifact,e.artifact),tool_call_id:this.tool_call_id,id:this.id??e.id,status:Uy(this.status,e.status)})}get _printableFields(){return{...super._printableFields,tool_call_id:this.tool_call_id,artifact:this.artifact}}};function Oy(r){let e=[],t=[];for(let n of r)if(n.function){let A=n.function.name;try{let s=JSON.parse(n.function.arguments),i={name:A||"",args:s||{},id:n.id};e.push(i)}catch{t.push({name:A,args:n.function.arguments,id:n.id,error:"Malformed args."})}}else continue;return[e,t]}var sr=class extends Ar{get lc_aliases(){return{...super.lc_aliases,tool_calls:"tool_calls",invalid_tool_calls:"invalid_tool_calls"}}constructor(e,t){let n;if(typeof e=="string")n={content:e,tool_calls:[],invalid_tool_calls:[],additional_kwargs:t??{}};else{n=e;let A=n.additional_kwargs?.tool_calls,s=n.tool_calls;A!=null&&A.length>0&&(s===void 0||s.length===0)&&console.warn(["New LangChain packages are available that more efficiently handle",`tool calling.

Please upgrade your packages to versions that set`,"message tool calls. e.g., `yarn add @langchain/anthropic`,","yarn add @langchain/openai`, etc."].join(" "));try{if(A!=null&&s===void 0){let[i,a]=Oy(A);n.tool_calls=i??[],n.invalid_tool_calls=a??[]}else n.tool_calls=n.tool_calls??[],n.invalid_tool_calls=n.invalid_tool_calls??[]}catch{n.tool_calls=[],n.invalid_tool_calls=[]}}super(n),Object.defineProperty(this,"tool_calls",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"invalid_tool_calls",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"usage_metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),typeof n!="string"&&(this.tool_calls=n.tool_calls??this.tool_calls,this.invalid_tool_calls=n.invalid_tool_calls??this.invalid_tool_calls),this.usage_metadata=n.usage_metadata}static lc_name(){return"AIMessage"}_getType(){return"ai"}get _printableFields(){return{...super._printableFields,tool_calls:this.tool_calls,invalid_tool_calls:this.invalid_tool_calls,usage_metadata:this.usage_metadata}}};function WA(r){return r._getType()==="ai"}function cp(r){return r._getType()==="ai"}var Sr=class r extends gr{constructor(e){let t;if(typeof e=="string")t={content:e,tool_calls:[],invalid_tool_calls:[],tool_call_chunks:[]};else if(e.tool_call_chunks===void 0)t={...e,tool_calls:e.tool_calls??[],invalid_tool_calls:[],tool_call_chunks:[],usage_metadata:e.usage_metadata!==void 0?e.usage_metadata:void 0};else{let n=e.tool_call_chunks.reduce((i,a)=>{let f=a.id||`fallback-${a.index||0}`;return i[f]=i[f]??[],i[f].push(a),i},{}),A=[],s=[];for(let[i,a]of Object.entries(n)){let f={},d=a[0]?.name??"",h=a.map(w=>w.args||"").join(""),m=h.length?h:"{}",y=a[0]?.id||i;try{if(f=ya(m),f===null||typeof f!="object"||Array.isArray(f))throw new Error("Malformed tool call chunk args.");A.push({name:d,args:f,id:y,type:"tool_call"})}catch{s.push({name:d,args:m,id:y,error:"Malformed args.",type:"invalid_tool_call"})}}t={...e,tool_calls:A,invalid_tool_calls:s,usage_metadata:e.usage_metadata!==void 0?e.usage_metadata:void 0}}super(t),Object.defineProperty(this,"tool_calls",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"invalid_tool_calls",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"tool_call_chunks",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"usage_metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.tool_call_chunks=t.tool_call_chunks??this.tool_call_chunks,this.tool_calls=t.tool_calls??this.tool_calls,this.invalid_tool_calls=t.invalid_tool_calls??this.invalid_tool_calls,this.usage_metadata=t.usage_metadata}get lc_aliases(){return{...super.lc_aliases,tool_calls:"tool_calls",invalid_tool_calls:"invalid_tool_calls",tool_call_chunks:"tool_call_chunks"}}static lc_name(){return"AIMessageChunk"}_getType(){return"ai"}get _printableFields(){return{...super._printableFields,tool_calls:this.tool_calls,tool_call_chunks:this.tool_call_chunks,invalid_tool_calls:this.invalid_tool_calls,usage_metadata:this.usage_metadata}}concat(e){let t={content:zr(this.content,e.content),additional_kwargs:dt(this.additional_kwargs,e.additional_kwargs),response_metadata:dt(this.response_metadata,e.response_metadata),tool_call_chunks:[],id:this.id??e.id};if(this.tool_call_chunks!==void 0||e.tool_call_chunks!==void 0){let n=Ho(this.tool_call_chunks,e.tool_call_chunks);n!==void 0&&n.length>0&&(t.tool_call_chunks=n)}if(this.usage_metadata!==void 0||e.usage_metadata!==void 0){let n={...(this.usage_metadata?.input_token_details?.audio!==void 0||e.usage_metadata?.input_token_details?.audio!==void 0)&&{audio:(this.usage_metadata?.input_token_details?.audio??0)+(e.usage_metadata?.input_token_details?.audio??0)},...(this.usage_metadata?.input_token_details?.cache_read!==void 0||e.usage_metadata?.input_token_details?.cache_read!==void 0)&&{cache_read:(this.usage_metadata?.input_token_details?.cache_read??0)+(e.usage_metadata?.input_token_details?.cache_read??0)},...(this.usage_metadata?.input_token_details?.cache_creation!==void 0||e.usage_metadata?.input_token_details?.cache_creation!==void 0)&&{cache_creation:(this.usage_metadata?.input_token_details?.cache_creation??0)+(e.usage_metadata?.input_token_details?.cache_creation??0)}},A={...(this.usage_metadata?.output_token_details?.audio!==void 0||e.usage_metadata?.output_token_details?.audio!==void 0)&&{audio:(this.usage_metadata?.output_token_details?.audio??0)+(e.usage_metadata?.output_token_details?.audio??0)},...(this.usage_metadata?.output_token_details?.reasoning!==void 0||e.usage_metadata?.output_token_details?.reasoning!==void 0)&&{reasoning:(this.usage_metadata?.output_token_details?.reasoning??0)+(e.usage_metadata?.output_token_details?.reasoning??0)}},s=this.usage_metadata??{input_tokens:0,output_tokens:0,total_tokens:0},i=e.usage_metadata??{input_tokens:0,output_tokens:0,total_tokens:0},a={input_tokens:s.input_tokens+i.input_tokens,output_tokens:s.output_tokens+i.output_tokens,total_tokens:s.total_tokens+i.total_tokens,...Object.keys(n).length>0&&{input_token_details:n},...Object.keys(A).length>0&&{output_token_details:A}};t.usage_metadata=a}return new r(t)}};var qA=class r extends Ar{static lc_name(){return"ChatMessage"}static _chatMessageClass(){return r}constructor(e,t){typeof e=="string"&&(e={content:e,role:t}),super(e),Object.defineProperty(this,"role",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.role=e.role}_getType(){return"generic"}static isInstance(e){return e._getType()==="generic"}get _printableFields(){return{...super._printableFields,role:this.role}}},js=class r extends gr{static lc_name(){return"ChatMessageChunk"}constructor(e,t){typeof e=="string"&&(e={content:e,role:t}),super(e),Object.defineProperty(this,"role",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.role=e.role}_getType(){return"generic"}concat(e){return new r({content:zr(this.content,e.content),additional_kwargs:dt(this.additional_kwargs,e.additional_kwargs),response_metadata:dt(this.response_metadata,e.response_metadata),role:this.role,id:this.id??e.id})}get _printableFields(){return{...super._printableFields,role:this.role}}};var Ks=class r extends gr{static lc_name(){return"FunctionMessageChunk"}_getType(){return"function"}concat(e){return new r({content:zr(this.content,e.content),additional_kwargs:dt(this.additional_kwargs,e.additional_kwargs),response_metadata:dt(this.response_metadata,e.response_metadata),name:this.name??"",id:this.id??e.id})}};var wr=class extends Ar{static lc_name(){return"HumanMessage"}_getType(){return"human"}constructor(e,t){super(e,t)}},zs=class r extends gr{static lc_name(){return"HumanMessageChunk"}_getType(){return"human"}constructor(e,t){super(e,t)}concat(e){return new r({content:zr(this.content,e.content),additional_kwargs:dt(this.additional_kwargs,e.additional_kwargs),response_metadata:dt(this.response_metadata,e.response_metadata),id:this.id??e.id})}};var XA=class extends Ar{static lc_name(){return"SystemMessage"}_getType(){return"system"}constructor(e,t){super(e,t)}},YA=class r extends gr{static lc_name(){return"SystemMessageChunk"}_getType(){return"system"}constructor(e,t){super(e,t)}concat(e){return new r({content:zr(this.content,e.content),additional_kwargs:dt(this.additional_kwargs,e.additional_kwargs),response_metadata:dt(this.response_metadata,e.response_metadata),id:this.id??e.id})}};function $c(r,e){return r.lc_error_code=e,r.message=`${r.message}

Troubleshooting URL: https://js.langchain.com/docs/troubleshooting/errors/${e}/
`,r}function es(r){return!!(r&&typeof r=="object"&&"type"in r&&r.type==="tool_call")}function Sy(r){return!!(r&&typeof r=="object"&&"toolCall"in r&&r.toolCall!=null&&typeof r.toolCall=="object"&&"id"in r.toolCall&&typeof r.toolCall.id=="string")}var Gs=class extends Error{constructor(e,t){super(e),Object.defineProperty(this,"output",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.output=t}};function tT(r){return es(r)?r:typeof r.id=="string"&&r.type==="function"&&typeof r.function=="object"&&r.function!==null&&"arguments"in r.function&&typeof r.function.arguments=="string"&&"name"in r.function&&typeof r.function.name=="string"?{id:r.id,args:JSON.parse(r.function.arguments),name:r.function.name,type:"tool_call"}:r}function rT(r){return typeof r=="object"&&r!=null&&r.lc===1&&Array.isArray(r.id)&&r.kwargs!=null&&typeof r.kwargs=="object"}function lp(r){let e,t;if(rT(r)){let n=r.id.at(-1);n==="HumanMessage"||n==="HumanMessageChunk"?e="user":n==="AIMessage"||n==="AIMessageChunk"?e="assistant":n==="SystemMessage"||n==="SystemMessageChunk"?e="system":n==="FunctionMessage"||n==="FunctionMessageChunk"?e="function":n==="ToolMessage"||n==="ToolMessageChunk"?e="tool":e="unknown",t=r.kwargs}else{let{type:n,...A}=r;e=n,t=A}if(e==="human"||e==="user")return new wr(t);if(e==="ai"||e==="assistant"){let{tool_calls:n,...A}=t;if(!Array.isArray(n))return new sr(t);let s=n.map(tT);return new sr({...A,tool_calls:s})}else{if(e==="system")return new XA(t);if(e==="developer")return new XA({...t,additional_kwargs:{...t.additional_kwargs,__openai_role__:"developer"}});if(e==="tool"&&"tool_call_id"in t)return new on({...t,content:t.content,tool_call_id:t.tool_call_id,name:t.name});throw $c(new Error(`Unable to coerce message from array: only human, AI, system, developer, or tool message coercion is currently supported.

Received: ${JSON.stringify(r,null,2)}`),"MESSAGE_COERCION_FAILURE")}}function Vs(r){if(typeof r=="string")return new wr(r);if(JA(r))return r;if(Array.isArray(r)){let[e,t]=r;return lp({type:e,content:t})}else if(Qy(r)){let{role:e,...t}=r;return lp({...t,type:e})}else return lp(r)}function Do(r,e="Human",t="AI"){let n=[];for(let A of r){let s;if(A._getType()==="human")s=e;else if(A._getType()==="ai")s=t;else if(A._getType()==="system")s="System";else if(A._getType()==="function")s="Function";else if(A._getType()==="tool")s="Tool";else if(A._getType()==="generic")s=A.role;else throw new Error(`Got unsupported message type: ${A._getType()}`);let i=A.name?`${A.name}, `:"",a=typeof A.content=="string"?A.content:JSON.stringify(A.content,null,2);n.push(`${s}: ${i}${a}`)}return n.join(`
`)}function fp(r){let e=r._getType();if(e==="human")return new zs({...r});if(e==="ai"){let t={...r};return"tool_calls"in t&&(t={...t,tool_call_chunks:t.tool_calls?.map(n=>({...n,type:"tool_call_chunk",index:void 0,args:JSON.stringify(n.args)}))}),new Sr({...t})}else{if(e==="system")return new YA({...r});if(e==="function")return new Ks({...r});if(qA.isInstance(r))return new js({...r});throw new Error("Unknown message type.")}}var Pr={};hd(Pr,{BRAND:()=>UT,DIRTY:()=>Zs,EMPTY_PATH:()=>iT,INVALID:()=>ge,NEVER:()=>fO,OK:()=>Jt,ParseStatus:()=>Mt,Schema:()=>Re,ZodAny:()=>ns,ZodArray:()=>hA,ZodBigInt:()=>Ws,ZodBoolean:()=>qs,ZodBranded:()=>$o,ZodCatch:()=>oi,ZodDate:()=>Xs,ZodDefault:()=>ai,ZodDiscriminatedUnion:()=>zc,ZodEffects:()=>Zr,ZodEnum:()=>si,ZodError:()=>yr,ZodFirstPartyTypeKind:()=>O,ZodFunction:()=>Vc,ZodIntersection:()=>ri,ZodIssueCode:()=>N,ZodLazy:()=>ni,ZodLiteral:()=>Ai,ZodMap:()=>xa,ZodNaN:()=>Ua,ZodNativeEnum:()=>ii,ZodNever:()=>un,ZodNull:()=>ei,ZodNullable:()=>Nn,ZodNumber:()=>Js,ZodObject:()=>_r,ZodOptional:()=>Gr,ZodParsedType:()=>V,ZodPipeline:()=>jo,ZodPromise:()=>As,ZodReadonly:()=>ui,ZodRecord:()=>Gc,ZodSchema:()=>Re,ZodSet:()=>Ia,ZodString:()=>rs,ZodSymbol:()=>Ca,ZodTransformer:()=>Zr,ZodTuple:()=>kn,ZodType:()=>Re,ZodUndefined:()=>Ys,ZodUnion:()=>ti,ZodUnknown:()=>pA,ZodVoid:()=>Ea,addIssueToContext:()=>$,any:()=>NT,array:()=>MT,bigint:()=>OT,boolean:()=>Ky,coerce:()=>lO,custom:()=>My,date:()=>ST,datetimeRegex:()=>Hy,defaultErrorMap:()=>fA,discriminatedUnion:()=>zT,effect:()=>nO,enum:()=>eO,function:()=>qT,getErrorMap:()=>ba,getParsedType:()=>Rn,instanceof:()=>QT,intersection:()=>GT,isAborted:()=>jc,isAsync:()=>Ba,isDirty:()=>Kc,isValid:()=>ts,late:()=>FT,lazy:()=>XT,literal:()=>YT,makeIssue:()=>Mo,map:()=>JT,nan:()=>TT,nativeEnum:()=>tO,never:()=>HT,null:()=>kT,nullable:()=>sO,number:()=>jy,object:()=>$T,objectUtil:()=>dp,oboolean:()=>cO,onumber:()=>uO,optional:()=>AO,ostring:()=>oO,pipeline:()=>aO,preprocess:()=>iO,promise:()=>rO,quotelessJson:()=>nT,record:()=>ZT,set:()=>WT,setErrorMap:()=>sT,strictObject:()=>jT,string:()=>$y,symbol:()=>PT,transformer:()=>nO,tuple:()=>VT,undefined:()=>RT,union:()=>KT,unknown:()=>LT,util:()=>Ne,void:()=>DT});var Ne;(function(r){r.assertEqual=A=>{};function e(A){}r.assertIs=e;function t(A){throw new Error}r.assertNever=t,r.arrayToEnum=A=>{let s={};for(let i of A)s[i]=i;return s},r.getValidEnumValues=A=>{let s=r.objectKeys(A).filter(a=>typeof A[A[a]]!="number"),i={};for(let a of s)i[a]=A[a];return r.objectValues(i)},r.objectValues=A=>r.objectKeys(A).map(function(s){return A[s]}),r.objectKeys=typeof Object.keys=="function"?A=>Object.keys(A):A=>{let s=[];for(let i in A)Object.prototype.hasOwnProperty.call(A,i)&&s.push(i);return s},r.find=(A,s)=>{for(let i of A)if(s(i))return i},r.isInteger=typeof Number.isInteger=="function"?A=>Number.isInteger(A):A=>typeof A=="number"&&Number.isFinite(A)&&Math.floor(A)===A;function n(A,s=" | "){return A.map(i=>typeof i=="string"?`'${i}'`:i).join(s)}r.joinValues=n,r.jsonStringifyReplacer=(A,s)=>typeof s=="bigint"?s.toString():s})(Ne||(Ne={}));var dp;(function(r){r.mergeShapes=(e,t)=>({...e,...t})})(dp||(dp={}));var V=Ne.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Rn=r=>{switch(typeof r){case"undefined":return V.undefined;case"string":return V.string;case"number":return Number.isNaN(r)?V.nan:V.number;case"boolean":return V.boolean;case"function":return V.function;case"bigint":return V.bigint;case"symbol":return V.symbol;case"object":return Array.isArray(r)?V.array:r===null?V.null:r.then&&typeof r.then=="function"&&r.catch&&typeof r.catch=="function"?V.promise:typeof Map<"u"&&r instanceof Map?V.map:typeof Set<"u"&&r instanceof Set?V.set:typeof Date<"u"&&r instanceof Date?V.date:V.object;default:return V.unknown}};var N=Ne.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),nT=r=>JSON.stringify(r,null,2).replace(/"([^"]+)":/g,"$1:"),yr=class r extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};let t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}format(e){let t=e||function(s){return s.message},n={_errors:[]},A=s=>{for(let i of s.issues)if(i.code==="invalid_union")i.unionErrors.map(A);else if(i.code==="invalid_return_type")A(i.returnTypeError);else if(i.code==="invalid_arguments")A(i.argumentsError);else if(i.path.length===0)n._errors.push(t(i));else{let a=n,f=0;for(;f<i.path.length;){let d=i.path[f];f===i.path.length-1?(a[d]=a[d]||{_errors:[]},a[d]._errors.push(t(i))):a[d]=a[d]||{_errors:[]},a=a[d],f++}}};return A(this),n}static assert(e){if(!(e instanceof r))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Ne.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=t=>t.message){let t={},n=[];for(let A of this.issues)if(A.path.length>0){let s=A.path[0];t[s]=t[s]||[],t[s].push(e(A))}else n.push(e(A));return{formErrors:n,fieldErrors:t}}get formErrors(){return this.flatten()}};yr.create=r=>new yr(r);var AT=(r,e)=>{let t;switch(r.code){case N.invalid_type:r.received===V.undefined?t="Required":t=`Expected ${r.expected}, received ${r.received}`;break;case N.invalid_literal:t=`Invalid literal value, expected ${JSON.stringify(r.expected,Ne.jsonStringifyReplacer)}`;break;case N.unrecognized_keys:t=`Unrecognized key(s) in object: ${Ne.joinValues(r.keys,", ")}`;break;case N.invalid_union:t="Invalid input";break;case N.invalid_union_discriminator:t=`Invalid discriminator value. Expected ${Ne.joinValues(r.options)}`;break;case N.invalid_enum_value:t=`Invalid enum value. Expected ${Ne.joinValues(r.options)}, received '${r.received}'`;break;case N.invalid_arguments:t="Invalid function arguments";break;case N.invalid_return_type:t="Invalid function return type";break;case N.invalid_date:t="Invalid date";break;case N.invalid_string:typeof r.validation=="object"?"includes"in r.validation?(t=`Invalid input: must include "${r.validation.includes}"`,typeof r.validation.position=="number"&&(t=`${t} at one or more positions greater than or equal to ${r.validation.position}`)):"startsWith"in r.validation?t=`Invalid input: must start with "${r.validation.startsWith}"`:"endsWith"in r.validation?t=`Invalid input: must end with "${r.validation.endsWith}"`:Ne.assertNever(r.validation):r.validation!=="regex"?t=`Invalid ${r.validation}`:t="Invalid";break;case N.too_small:r.type==="array"?t=`Array must contain ${r.exact?"exactly":r.inclusive?"at least":"more than"} ${r.minimum} element(s)`:r.type==="string"?t=`String must contain ${r.exact?"exactly":r.inclusive?"at least":"over"} ${r.minimum} character(s)`:r.type==="number"?t=`Number must be ${r.exact?"exactly equal to ":r.inclusive?"greater than or equal to ":"greater than "}${r.minimum}`:r.type==="bigint"?t=`Number must be ${r.exact?"exactly equal to ":r.inclusive?"greater than or equal to ":"greater than "}${r.minimum}`:r.type==="date"?t=`Date must be ${r.exact?"exactly equal to ":r.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(r.minimum))}`:t="Invalid input";break;case N.too_big:r.type==="array"?t=`Array must contain ${r.exact?"exactly":r.inclusive?"at most":"less than"} ${r.maximum} element(s)`:r.type==="string"?t=`String must contain ${r.exact?"exactly":r.inclusive?"at most":"under"} ${r.maximum} character(s)`:r.type==="number"?t=`Number must be ${r.exact?"exactly":r.inclusive?"less than or equal to":"less than"} ${r.maximum}`:r.type==="bigint"?t=`BigInt must be ${r.exact?"exactly":r.inclusive?"less than or equal to":"less than"} ${r.maximum}`:r.type==="date"?t=`Date must be ${r.exact?"exactly":r.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(r.maximum))}`:t="Invalid input";break;case N.custom:t="Invalid input";break;case N.invalid_intersection_types:t="Intersection results could not be merged";break;case N.not_multiple_of:t=`Number must be a multiple of ${r.multipleOf}`;break;case N.not_finite:t="Number must be finite";break;default:t=e.defaultError,Ne.assertNever(r)}return{message:t}},fA=AT;var Py=fA;function sT(r){Py=r}function ba(){return Py}var Mo=r=>{let{data:e,path:t,errorMaps:n,issueData:A}=r,s=[...t,...A.path||[]],i={...A,path:s};if(A.message!==void 0)return{...A,path:s,message:A.message};let a="",f=n.filter(d=>!!d).slice().reverse();for(let d of f)a=d(i,{data:e,defaultError:a}).message;return{...A,path:s,message:a}},iT=[];function $(r,e){let t=ba(),n=Mo({issueData:e,data:r.data,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,t,t===fA?void 0:fA].filter(A=>!!A)});r.common.issues.push(n)}var Mt=class r{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,t){let n=[];for(let A of t){if(A.status==="aborted")return ge;A.status==="dirty"&&e.dirty(),n.push(A.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,t){let n=[];for(let A of t){let s=await A.key,i=await A.value;n.push({key:s,value:i})}return r.mergeObjectSync(e,n)}static mergeObjectSync(e,t){let n={};for(let A of t){let{key:s,value:i}=A;if(s.status==="aborted"||i.status==="aborted")return ge;s.status==="dirty"&&e.dirty(),i.status==="dirty"&&e.dirty(),s.value!=="__proto__"&&(typeof i.value<"u"||A.alwaysSet)&&(n[s.value]=i.value)}return{status:e.value,value:n}}},ge=Object.freeze({status:"aborted"}),Zs=r=>({status:"dirty",value:r}),Jt=r=>({status:"valid",value:r}),jc=r=>r.status==="aborted",Kc=r=>r.status==="dirty",ts=r=>r.status==="valid",Ba=r=>typeof Promise<"u"&&r instanceof Promise;var ie;(function(r){r.errToObj=e=>typeof e=="string"?{message:e}:e||{},r.toString=e=>typeof e=="string"?e:e?.message})(ie||(ie={}));var Vr=class{constructor(e,t,n,A){this._cachedPath=[],this.parent=e,this.data=t,this._path=n,this._key=A}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}},Ry=(r,e)=>{if(ts(e))return{success:!0,data:e.value};if(!r.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let t=new yr(r.common.issues);return this._error=t,this._error}}};function Qe(r){if(!r)return{};let{errorMap:e,invalid_type_error:t,required_error:n,description:A}=r;if(e&&(t||n))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:A}:{errorMap:(i,a)=>{let{message:f}=r;return i.code==="invalid_enum_value"?{message:f??a.defaultError}:typeof a.data>"u"?{message:f??n??a.defaultError}:i.code!=="invalid_type"?{message:a.defaultError}:{message:f??t??a.defaultError}},description:A}}var Re=class{get description(){return this._def.description}_getType(e){return Rn(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:Rn(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new Mt,ctx:{common:e.parent.common,data:e.data,parsedType:Rn(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){let t=this._parse(e);if(Ba(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){let t=this._parse(e);return Promise.resolve(t)}parse(e,t){let n=this.safeParse(e,t);if(n.success)return n.data;throw n.error}safeParse(e,t){let n={common:{issues:[],async:t?.async??!1,contextualErrorMap:t?.errorMap},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Rn(e)},A=this._parseSync({data:e,path:n.path,parent:n});return Ry(n,A)}"~validate"(e){let t={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Rn(e)};if(!this["~standard"].async)try{let n=this._parseSync({data:e,path:[],parent:t});return ts(n)?{value:n.value}:{issues:t.common.issues}}catch(n){n?.message?.toLowerCase()?.includes("encountered")&&(this["~standard"].async=!0),t.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:t}).then(n=>ts(n)?{value:n.value}:{issues:t.common.issues})}async parseAsync(e,t){let n=await this.safeParseAsync(e,t);if(n.success)return n.data;throw n.error}async safeParseAsync(e,t){let n={common:{issues:[],contextualErrorMap:t?.errorMap,async:!0},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Rn(e)},A=this._parse({data:e,path:n.path,parent:n}),s=await(Ba(A)?A:Promise.resolve(A));return Ry(n,s)}refine(e,t){let n=A=>typeof t=="string"||typeof t>"u"?{message:t}:typeof t=="function"?t(A):t;return this._refinement((A,s)=>{let i=e(A),a=()=>s.addIssue({code:N.custom,...n(A)});return typeof Promise<"u"&&i instanceof Promise?i.then(f=>f?!0:(a(),!1)):i?!0:(a(),!1)})}refinement(e,t){return this._refinement((n,A)=>e(n)?!0:(A.addIssue(typeof t=="function"?t(n,A):t),!1))}_refinement(e){return new Zr({schema:this,typeName:O.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:t=>this["~validate"](t)}}optional(){return Gr.create(this,this._def)}nullable(){return Nn.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return hA.create(this)}promise(){return As.create(this,this._def)}or(e){return ti.create([this,e],this._def)}and(e){return ri.create(this,e,this._def)}transform(e){return new Zr({...Qe(this._def),schema:this,typeName:O.ZodEffects,effect:{type:"transform",transform:e}})}default(e){let t=typeof e=="function"?e:()=>e;return new ai({...Qe(this._def),innerType:this,defaultValue:t,typeName:O.ZodDefault})}brand(){return new $o({typeName:O.ZodBranded,type:this,...Qe(this._def)})}catch(e){let t=typeof e=="function"?e:()=>e;return new oi({...Qe(this._def),innerType:this,catchValue:t,typeName:O.ZodCatch})}describe(e){let t=this.constructor;return new t({...this._def,description:e})}pipe(e){return jo.create(this,e)}readonly(){return ui.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}},aT=/^c[^\s-]{8,}$/i,oT=/^[0-9a-z]+$/,uT=/^[0-9A-HJKMNP-TV-Z]{26}$/i,cT=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,lT=/^[a-z0-9_-]{21}$/i,fT=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,dT=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,pT=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,hT="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$",pp,mT=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,gT=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,wT=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,yT=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,_T=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,bT=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,Ny="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",BT=new RegExp(`^${Ny}$`);function Ly(r){let e="[0-5]\\d";r.precision?e=`${e}\\.\\d{${r.precision}}`:r.precision==null&&(e=`${e}(\\.\\d+)?`);let t=r.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${e})${t}`}function vT(r){return new RegExp(`^${Ly(r)}$`)}function Hy(r){let e=`${Ny}T${Ly(r)}`,t=[];return t.push(r.local?"Z?":"Z"),r.offset&&t.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${t.join("|")})`,new RegExp(`^${e}$`)}function CT(r,e){return!!((e==="v4"||!e)&&mT.test(r)||(e==="v6"||!e)&&wT.test(r))}function ET(r,e){if(!fT.test(r))return!1;try{let[t]=r.split(".");if(!t)return!1;let n=t.replace(/-/g,"+").replace(/_/g,"/").padEnd(t.length+(4-t.length%4)%4,"="),A=JSON.parse(atob(n));return!(typeof A!="object"||A===null||"typ"in A&&A?.typ!=="JWT"||!A.alg||e&&A.alg!==e)}catch{return!1}}function xT(r,e){return!!((e==="v4"||!e)&&gT.test(r)||(e==="v6"||!e)&&yT.test(r))}var rs=class r extends Re{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==V.string){let s=this._getOrReturnCtx(e);return $(s,{code:N.invalid_type,expected:V.string,received:s.parsedType}),ge}let n=new Mt,A;for(let s of this._def.checks)if(s.kind==="min")e.data.length<s.value&&(A=this._getOrReturnCtx(e,A),$(A,{code:N.too_small,minimum:s.value,type:"string",inclusive:!0,exact:!1,message:s.message}),n.dirty());else if(s.kind==="max")e.data.length>s.value&&(A=this._getOrReturnCtx(e,A),$(A,{code:N.too_big,maximum:s.value,type:"string",inclusive:!0,exact:!1,message:s.message}),n.dirty());else if(s.kind==="length"){let i=e.data.length>s.value,a=e.data.length<s.value;(i||a)&&(A=this._getOrReturnCtx(e,A),i?$(A,{code:N.too_big,maximum:s.value,type:"string",inclusive:!0,exact:!0,message:s.message}):a&&$(A,{code:N.too_small,minimum:s.value,type:"string",inclusive:!0,exact:!0,message:s.message}),n.dirty())}else if(s.kind==="email")pT.test(e.data)||(A=this._getOrReturnCtx(e,A),$(A,{validation:"email",code:N.invalid_string,message:s.message}),n.dirty());else if(s.kind==="emoji")pp||(pp=new RegExp(hT,"u")),pp.test(e.data)||(A=this._getOrReturnCtx(e,A),$(A,{validation:"emoji",code:N.invalid_string,message:s.message}),n.dirty());else if(s.kind==="uuid")cT.test(e.data)||(A=this._getOrReturnCtx(e,A),$(A,{validation:"uuid",code:N.invalid_string,message:s.message}),n.dirty());else if(s.kind==="nanoid")lT.test(e.data)||(A=this._getOrReturnCtx(e,A),$(A,{validation:"nanoid",code:N.invalid_string,message:s.message}),n.dirty());else if(s.kind==="cuid")aT.test(e.data)||(A=this._getOrReturnCtx(e,A),$(A,{validation:"cuid",code:N.invalid_string,message:s.message}),n.dirty());else if(s.kind==="cuid2")oT.test(e.data)||(A=this._getOrReturnCtx(e,A),$(A,{validation:"cuid2",code:N.invalid_string,message:s.message}),n.dirty());else if(s.kind==="ulid")uT.test(e.data)||(A=this._getOrReturnCtx(e,A),$(A,{validation:"ulid",code:N.invalid_string,message:s.message}),n.dirty());else if(s.kind==="url")try{new URL(e.data)}catch{A=this._getOrReturnCtx(e,A),$(A,{validation:"url",code:N.invalid_string,message:s.message}),n.dirty()}else s.kind==="regex"?(s.regex.lastIndex=0,s.regex.test(e.data)||(A=this._getOrReturnCtx(e,A),$(A,{validation:"regex",code:N.invalid_string,message:s.message}),n.dirty())):s.kind==="trim"?e.data=e.data.trim():s.kind==="includes"?e.data.includes(s.value,s.position)||(A=this._getOrReturnCtx(e,A),$(A,{code:N.invalid_string,validation:{includes:s.value,position:s.position},message:s.message}),n.dirty()):s.kind==="toLowerCase"?e.data=e.data.toLowerCase():s.kind==="toUpperCase"?e.data=e.data.toUpperCase():s.kind==="startsWith"?e.data.startsWith(s.value)||(A=this._getOrReturnCtx(e,A),$(A,{code:N.invalid_string,validation:{startsWith:s.value},message:s.message}),n.dirty()):s.kind==="endsWith"?e.data.endsWith(s.value)||(A=this._getOrReturnCtx(e,A),$(A,{code:N.invalid_string,validation:{endsWith:s.value},message:s.message}),n.dirty()):s.kind==="datetime"?Hy(s).test(e.data)||(A=this._getOrReturnCtx(e,A),$(A,{code:N.invalid_string,validation:"datetime",message:s.message}),n.dirty()):s.kind==="date"?BT.test(e.data)||(A=this._getOrReturnCtx(e,A),$(A,{code:N.invalid_string,validation:"date",message:s.message}),n.dirty()):s.kind==="time"?vT(s).test(e.data)||(A=this._getOrReturnCtx(e,A),$(A,{code:N.invalid_string,validation:"time",message:s.message}),n.dirty()):s.kind==="duration"?dT.test(e.data)||(A=this._getOrReturnCtx(e,A),$(A,{validation:"duration",code:N.invalid_string,message:s.message}),n.dirty()):s.kind==="ip"?CT(e.data,s.version)||(A=this._getOrReturnCtx(e,A),$(A,{validation:"ip",code:N.invalid_string,message:s.message}),n.dirty()):s.kind==="jwt"?ET(e.data,s.alg)||(A=this._getOrReturnCtx(e,A),$(A,{validation:"jwt",code:N.invalid_string,message:s.message}),n.dirty()):s.kind==="cidr"?xT(e.data,s.version)||(A=this._getOrReturnCtx(e,A),$(A,{validation:"cidr",code:N.invalid_string,message:s.message}),n.dirty()):s.kind==="base64"?_T.test(e.data)||(A=this._getOrReturnCtx(e,A),$(A,{validation:"base64",code:N.invalid_string,message:s.message}),n.dirty()):s.kind==="base64url"?bT.test(e.data)||(A=this._getOrReturnCtx(e,A),$(A,{validation:"base64url",code:N.invalid_string,message:s.message}),n.dirty()):Ne.assertNever(s);return{status:n.value,value:e.data}}_regex(e,t,n){return this.refinement(A=>e.test(A),{validation:t,code:N.invalid_string,...ie.errToObj(n)})}_addCheck(e){return new r({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...ie.errToObj(e)})}url(e){return this._addCheck({kind:"url",...ie.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...ie.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...ie.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...ie.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...ie.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...ie.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...ie.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...ie.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...ie.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...ie.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...ie.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...ie.errToObj(e)})}datetime(e){return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof e?.precision>"u"?null:e?.precision,offset:e?.offset??!1,local:e?.local??!1,...ie.errToObj(e?.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof e?.precision>"u"?null:e?.precision,...ie.errToObj(e?.message)})}duration(e){return this._addCheck({kind:"duration",...ie.errToObj(e)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...ie.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:t?.position,...ie.errToObj(t?.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...ie.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...ie.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...ie.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...ie.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...ie.errToObj(t)})}nonempty(e){return this.min(1,ie.errToObj(e))}trim(){return new r({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new r({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new r({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(let t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(let t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}};rs.create=r=>new rs({checks:[],typeName:O.ZodString,coerce:r?.coerce??!1,...Qe(r)});function IT(r,e){let t=(r.toString().split(".")[1]||"").length,n=(e.toString().split(".")[1]||"").length,A=t>n?t:n,s=Number.parseInt(r.toFixed(A).replace(".","")),i=Number.parseInt(e.toFixed(A).replace(".",""));return s%i/10**A}var Js=class r extends Re{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==V.number){let s=this._getOrReturnCtx(e);return $(s,{code:N.invalid_type,expected:V.number,received:s.parsedType}),ge}let n,A=new Mt;for(let s of this._def.checks)s.kind==="int"?Ne.isInteger(e.data)||(n=this._getOrReturnCtx(e,n),$(n,{code:N.invalid_type,expected:"integer",received:"float",message:s.message}),A.dirty()):s.kind==="min"?(s.inclusive?e.data<s.value:e.data<=s.value)&&(n=this._getOrReturnCtx(e,n),$(n,{code:N.too_small,minimum:s.value,type:"number",inclusive:s.inclusive,exact:!1,message:s.message}),A.dirty()):s.kind==="max"?(s.inclusive?e.data>s.value:e.data>=s.value)&&(n=this._getOrReturnCtx(e,n),$(n,{code:N.too_big,maximum:s.value,type:"number",inclusive:s.inclusive,exact:!1,message:s.message}),A.dirty()):s.kind==="multipleOf"?IT(e.data,s.value)!==0&&(n=this._getOrReturnCtx(e,n),$(n,{code:N.not_multiple_of,multipleOf:s.value,message:s.message}),A.dirty()):s.kind==="finite"?Number.isFinite(e.data)||(n=this._getOrReturnCtx(e,n),$(n,{code:N.not_finite,message:s.message}),A.dirty()):Ne.assertNever(s);return{status:A.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,ie.toString(t))}gt(e,t){return this.setLimit("min",e,!1,ie.toString(t))}lte(e,t){return this.setLimit("max",e,!0,ie.toString(t))}lt(e,t){return this.setLimit("max",e,!1,ie.toString(t))}setLimit(e,t,n,A){return new r({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:n,message:ie.toString(A)}]})}_addCheck(e){return new r({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:ie.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:ie.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:ie.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:ie.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:ie.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:ie.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:ie.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:ie.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:ie.toString(e)})}get minValue(){let e=null;for(let t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(let t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&Ne.isInteger(e.value))}get isFinite(){let e=null,t=null;for(let n of this._def.checks){if(n.kind==="finite"||n.kind==="int"||n.kind==="multipleOf")return!0;n.kind==="min"?(t===null||n.value>t)&&(t=n.value):n.kind==="max"&&(e===null||n.value<e)&&(e=n.value)}return Number.isFinite(t)&&Number.isFinite(e)}};Js.create=r=>new Js({checks:[],typeName:O.ZodNumber,coerce:r?.coerce||!1,...Qe(r)});var Ws=class r extends Re{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==V.bigint)return this._getInvalidInput(e);let n,A=new Mt;for(let s of this._def.checks)s.kind==="min"?(s.inclusive?e.data<s.value:e.data<=s.value)&&(n=this._getOrReturnCtx(e,n),$(n,{code:N.too_small,type:"bigint",minimum:s.value,inclusive:s.inclusive,message:s.message}),A.dirty()):s.kind==="max"?(s.inclusive?e.data>s.value:e.data>=s.value)&&(n=this._getOrReturnCtx(e,n),$(n,{code:N.too_big,type:"bigint",maximum:s.value,inclusive:s.inclusive,message:s.message}),A.dirty()):s.kind==="multipleOf"?e.data%s.value!==BigInt(0)&&(n=this._getOrReturnCtx(e,n),$(n,{code:N.not_multiple_of,multipleOf:s.value,message:s.message}),A.dirty()):Ne.assertNever(s);return{status:A.value,value:e.data}}_getInvalidInput(e){let t=this._getOrReturnCtx(e);return $(t,{code:N.invalid_type,expected:V.bigint,received:t.parsedType}),ge}gte(e,t){return this.setLimit("min",e,!0,ie.toString(t))}gt(e,t){return this.setLimit("min",e,!1,ie.toString(t))}lte(e,t){return this.setLimit("max",e,!0,ie.toString(t))}lt(e,t){return this.setLimit("max",e,!1,ie.toString(t))}setLimit(e,t,n,A){return new r({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:n,message:ie.toString(A)}]})}_addCheck(e){return new r({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:ie.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:ie.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:ie.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:ie.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:ie.toString(t)})}get minValue(){let e=null;for(let t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(let t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}};Ws.create=r=>new Ws({checks:[],typeName:O.ZodBigInt,coerce:r?.coerce??!1,...Qe(r)});var qs=class extends Re{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==V.boolean){let n=this._getOrReturnCtx(e);return $(n,{code:N.invalid_type,expected:V.boolean,received:n.parsedType}),ge}return Jt(e.data)}};qs.create=r=>new qs({typeName:O.ZodBoolean,coerce:r?.coerce||!1,...Qe(r)});var Xs=class r extends Re{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==V.date){let s=this._getOrReturnCtx(e);return $(s,{code:N.invalid_type,expected:V.date,received:s.parsedType}),ge}if(Number.isNaN(e.data.getTime())){let s=this._getOrReturnCtx(e);return $(s,{code:N.invalid_date}),ge}let n=new Mt,A;for(let s of this._def.checks)s.kind==="min"?e.data.getTime()<s.value&&(A=this._getOrReturnCtx(e,A),$(A,{code:N.too_small,message:s.message,inclusive:!0,exact:!1,minimum:s.value,type:"date"}),n.dirty()):s.kind==="max"?e.data.getTime()>s.value&&(A=this._getOrReturnCtx(e,A),$(A,{code:N.too_big,message:s.message,inclusive:!0,exact:!1,maximum:s.value,type:"date"}),n.dirty()):Ne.assertNever(s);return{status:n.value,value:new Date(e.data.getTime())}}_addCheck(e){return new r({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:ie.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:ie.toString(t)})}get minDate(){let e=null;for(let t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(let t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e!=null?new Date(e):null}};Xs.create=r=>new Xs({checks:[],coerce:r?.coerce||!1,typeName:O.ZodDate,...Qe(r)});var Ca=class extends Re{_parse(e){if(this._getType(e)!==V.symbol){let n=this._getOrReturnCtx(e);return $(n,{code:N.invalid_type,expected:V.symbol,received:n.parsedType}),ge}return Jt(e.data)}};Ca.create=r=>new Ca({typeName:O.ZodSymbol,...Qe(r)});var Ys=class extends Re{_parse(e){if(this._getType(e)!==V.undefined){let n=this._getOrReturnCtx(e);return $(n,{code:N.invalid_type,expected:V.undefined,received:n.parsedType}),ge}return Jt(e.data)}};Ys.create=r=>new Ys({typeName:O.ZodUndefined,...Qe(r)});var ei=class extends Re{_parse(e){if(this._getType(e)!==V.null){let n=this._getOrReturnCtx(e);return $(n,{code:N.invalid_type,expected:V.null,received:n.parsedType}),ge}return Jt(e.data)}};ei.create=r=>new ei({typeName:O.ZodNull,...Qe(r)});var ns=class extends Re{constructor(){super(...arguments),this._any=!0}_parse(e){return Jt(e.data)}};ns.create=r=>new ns({typeName:O.ZodAny,...Qe(r)});var pA=class extends Re{constructor(){super(...arguments),this._unknown=!0}_parse(e){return Jt(e.data)}};pA.create=r=>new pA({typeName:O.ZodUnknown,...Qe(r)});var un=class extends Re{_parse(e){let t=this._getOrReturnCtx(e);return $(t,{code:N.invalid_type,expected:V.never,received:t.parsedType}),ge}};un.create=r=>new un({typeName:O.ZodNever,...Qe(r)});var Ea=class extends Re{_parse(e){if(this._getType(e)!==V.undefined){let n=this._getOrReturnCtx(e);return $(n,{code:N.invalid_type,expected:V.void,received:n.parsedType}),ge}return Jt(e.data)}};Ea.create=r=>new Ea({typeName:O.ZodVoid,...Qe(r)});var hA=class r extends Re{_parse(e){let{ctx:t,status:n}=this._processInputParams(e),A=this._def;if(t.parsedType!==V.array)return $(t,{code:N.invalid_type,expected:V.array,received:t.parsedType}),ge;if(A.exactLength!==null){let i=t.data.length>A.exactLength.value,a=t.data.length<A.exactLength.value;(i||a)&&($(t,{code:i?N.too_big:N.too_small,minimum:a?A.exactLength.value:void 0,maximum:i?A.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:A.exactLength.message}),n.dirty())}if(A.minLength!==null&&t.data.length<A.minLength.value&&($(t,{code:N.too_small,minimum:A.minLength.value,type:"array",inclusive:!0,exact:!1,message:A.minLength.message}),n.dirty()),A.maxLength!==null&&t.data.length>A.maxLength.value&&($(t,{code:N.too_big,maximum:A.maxLength.value,type:"array",inclusive:!0,exact:!1,message:A.maxLength.message}),n.dirty()),t.common.async)return Promise.all([...t.data].map((i,a)=>A.type._parseAsync(new Vr(t,i,t.path,a)))).then(i=>Mt.mergeArray(n,i));let s=[...t.data].map((i,a)=>A.type._parseSync(new Vr(t,i,t.path,a)));return Mt.mergeArray(n,s)}get element(){return this._def.type}min(e,t){return new r({...this._def,minLength:{value:e,message:ie.toString(t)}})}max(e,t){return new r({...this._def,maxLength:{value:e,message:ie.toString(t)}})}length(e,t){return new r({...this._def,exactLength:{value:e,message:ie.toString(t)}})}nonempty(e){return this.min(1,e)}};hA.create=(r,e)=>new hA({type:r,minLength:null,maxLength:null,exactLength:null,typeName:O.ZodArray,...Qe(e)});function va(r){if(r instanceof _r){let e={};for(let t in r.shape){let n=r.shape[t];e[t]=Gr.create(va(n))}return new _r({...r._def,shape:()=>e})}else return r instanceof hA?new hA({...r._def,type:va(r.element)}):r instanceof Gr?Gr.create(va(r.unwrap())):r instanceof Nn?Nn.create(va(r.unwrap())):r instanceof kn?kn.create(r.items.map(e=>va(e))):r}var _r=class r extends Re{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;let e=this._def.shape(),t=Ne.objectKeys(e);return this._cached={shape:e,keys:t},this._cached}_parse(e){if(this._getType(e)!==V.object){let d=this._getOrReturnCtx(e);return $(d,{code:N.invalid_type,expected:V.object,received:d.parsedType}),ge}let{status:n,ctx:A}=this._processInputParams(e),{shape:s,keys:i}=this._getCached(),a=[];if(!(this._def.catchall instanceof un&&this._def.unknownKeys==="strip"))for(let d in A.data)i.includes(d)||a.push(d);let f=[];for(let d of i){let h=s[d],m=A.data[d];f.push({key:{status:"valid",value:d},value:h._parse(new Vr(A,m,A.path,d)),alwaysSet:d in A.data})}if(this._def.catchall instanceof un){let d=this._def.unknownKeys;if(d==="passthrough")for(let h of a)f.push({key:{status:"valid",value:h},value:{status:"valid",value:A.data[h]}});else if(d==="strict")a.length>0&&($(A,{code:N.unrecognized_keys,keys:a}),n.dirty());else if(d!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{let d=this._def.catchall;for(let h of a){let m=A.data[h];f.push({key:{status:"valid",value:h},value:d._parse(new Vr(A,m,A.path,h)),alwaysSet:h in A.data})}}return A.common.async?Promise.resolve().then(async()=>{let d=[];for(let h of f){let m=await h.key,y=await h.value;d.push({key:m,value:y,alwaysSet:h.alwaysSet})}return d}).then(d=>Mt.mergeObjectSync(n,d)):Mt.mergeObjectSync(n,f)}get shape(){return this._def.shape()}strict(e){return ie.errToObj,new r({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(t,n)=>{let A=this._def.errorMap?.(t,n).message??n.defaultError;return t.code==="unrecognized_keys"?{message:ie.errToObj(e).message??A}:{message:A}}}:{}})}strip(){return new r({...this._def,unknownKeys:"strip"})}passthrough(){return new r({...this._def,unknownKeys:"passthrough"})}extend(e){return new r({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new r({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:O.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new r({...this._def,catchall:e})}pick(e){let t={};for(let n of Ne.objectKeys(e))e[n]&&this.shape[n]&&(t[n]=this.shape[n]);return new r({...this._def,shape:()=>t})}omit(e){let t={};for(let n of Ne.objectKeys(this.shape))e[n]||(t[n]=this.shape[n]);return new r({...this._def,shape:()=>t})}deepPartial(){return va(this)}partial(e){let t={};for(let n of Ne.objectKeys(this.shape)){let A=this.shape[n];e&&!e[n]?t[n]=A:t[n]=A.optional()}return new r({...this._def,shape:()=>t})}required(e){let t={};for(let n of Ne.objectKeys(this.shape))if(e&&!e[n])t[n]=this.shape[n];else{let s=this.shape[n];for(;s instanceof Gr;)s=s._def.innerType;t[n]=s}return new r({...this._def,shape:()=>t})}keyof(){return Dy(Ne.objectKeys(this.shape))}};_r.create=(r,e)=>new _r({shape:()=>r,unknownKeys:"strip",catchall:un.create(),typeName:O.ZodObject,...Qe(e)});_r.strictCreate=(r,e)=>new _r({shape:()=>r,unknownKeys:"strict",catchall:un.create(),typeName:O.ZodObject,...Qe(e)});_r.lazycreate=(r,e)=>new _r({shape:r,unknownKeys:"strip",catchall:un.create(),typeName:O.ZodObject,...Qe(e)});var ti=class extends Re{_parse(e){let{ctx:t}=this._processInputParams(e),n=this._def.options;function A(s){for(let a of s)if(a.result.status==="valid")return a.result;for(let a of s)if(a.result.status==="dirty")return t.common.issues.push(...a.ctx.common.issues),a.result;let i=s.map(a=>new yr(a.ctx.common.issues));return $(t,{code:N.invalid_union,unionErrors:i}),ge}if(t.common.async)return Promise.all(n.map(async s=>{let i={...t,common:{...t.common,issues:[]},parent:null};return{result:await s._parseAsync({data:t.data,path:t.path,parent:i}),ctx:i}})).then(A);{let s,i=[];for(let f of n){let d={...t,common:{...t.common,issues:[]},parent:null},h=f._parseSync({data:t.data,path:t.path,parent:d});if(h.status==="valid")return h;h.status==="dirty"&&!s&&(s={result:h,ctx:d}),d.common.issues.length&&i.push(d.common.issues)}if(s)return t.common.issues.push(...s.ctx.common.issues),s.result;let a=i.map(f=>new yr(f));return $(t,{code:N.invalid_union,unionErrors:a}),ge}}get options(){return this._def.options}};ti.create=(r,e)=>new ti({options:r,typeName:O.ZodUnion,...Qe(e)});var dA=r=>r instanceof ni?dA(r.schema):r instanceof Zr?dA(r.innerType()):r instanceof Ai?[r.value]:r instanceof si?r.options:r instanceof ii?Ne.objectValues(r.enum):r instanceof ai?dA(r._def.innerType):r instanceof Ys?[void 0]:r instanceof ei?[null]:r instanceof Gr?[void 0,...dA(r.unwrap())]:r instanceof Nn?[null,...dA(r.unwrap())]:r instanceof $o||r instanceof ui?dA(r.unwrap()):r instanceof oi?dA(r._def.innerType):[],zc=class r extends Re{_parse(e){let{ctx:t}=this._processInputParams(e);if(t.parsedType!==V.object)return $(t,{code:N.invalid_type,expected:V.object,received:t.parsedType}),ge;let n=this.discriminator,A=t.data[n],s=this.optionsMap.get(A);return s?t.common.async?s._parseAsync({data:t.data,path:t.path,parent:t}):s._parseSync({data:t.data,path:t.path,parent:t}):($(t,{code:N.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[n]}),ge)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,t,n){let A=new Map;for(let s of t){let i=dA(s.shape[e]);if(!i.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(let a of i){if(A.has(a))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(a)}`);A.set(a,s)}}return new r({typeName:O.ZodDiscriminatedUnion,discriminator:e,options:t,optionsMap:A,...Qe(n)})}};function hp(r,e){let t=Rn(r),n=Rn(e);if(r===e)return{valid:!0,data:r};if(t===V.object&&n===V.object){let A=Ne.objectKeys(e),s=Ne.objectKeys(r).filter(a=>A.indexOf(a)!==-1),i={...r,...e};for(let a of s){let f=hp(r[a],e[a]);if(!f.valid)return{valid:!1};i[a]=f.data}return{valid:!0,data:i}}else if(t===V.array&&n===V.array){if(r.length!==e.length)return{valid:!1};let A=[];for(let s=0;s<r.length;s++){let i=r[s],a=e[s],f=hp(i,a);if(!f.valid)return{valid:!1};A.push(f.data)}return{valid:!0,data:A}}else return t===V.date&&n===V.date&&+r==+e?{valid:!0,data:r}:{valid:!1}}var ri=class extends Re{_parse(e){let{status:t,ctx:n}=this._processInputParams(e),A=(s,i)=>{if(jc(s)||jc(i))return ge;let a=hp(s.value,i.value);return a.valid?((Kc(s)||Kc(i))&&t.dirty(),{status:t.value,value:a.data}):($(n,{code:N.invalid_intersection_types}),ge)};return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then(([s,i])=>A(s,i)):A(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}};ri.create=(r,e,t)=>new ri({left:r,right:e,typeName:O.ZodIntersection,...Qe(t)});var kn=class r extends Re{_parse(e){let{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==V.array)return $(n,{code:N.invalid_type,expected:V.array,received:n.parsedType}),ge;if(n.data.length<this._def.items.length)return $(n,{code:N.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),ge;!this._def.rest&&n.data.length>this._def.items.length&&($(n,{code:N.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());let s=[...n.data].map((i,a)=>{let f=this._def.items[a]||this._def.rest;return f?f._parse(new Vr(n,i,n.path,a)):null}).filter(i=>!!i);return n.common.async?Promise.all(s).then(i=>Mt.mergeArray(t,i)):Mt.mergeArray(t,s)}get items(){return this._def.items}rest(e){return new r({...this._def,rest:e})}};kn.create=(r,e)=>{if(!Array.isArray(r))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new kn({items:r,typeName:O.ZodTuple,rest:null,...Qe(e)})};var Gc=class r extends Re{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==V.object)return $(n,{code:N.invalid_type,expected:V.object,received:n.parsedType}),ge;let A=[],s=this._def.keyType,i=this._def.valueType;for(let a in n.data)A.push({key:s._parse(new Vr(n,a,n.path,a)),value:i._parse(new Vr(n,n.data[a],n.path,a)),alwaysSet:a in n.data});return n.common.async?Mt.mergeObjectAsync(t,A):Mt.mergeObjectSync(t,A)}get element(){return this._def.valueType}static create(e,t,n){return t instanceof Re?new r({keyType:e,valueType:t,typeName:O.ZodRecord,...Qe(n)}):new r({keyType:rs.create(),valueType:e,typeName:O.ZodRecord,...Qe(t)})}},xa=class extends Re{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==V.map)return $(n,{code:N.invalid_type,expected:V.map,received:n.parsedType}),ge;let A=this._def.keyType,s=this._def.valueType,i=[...n.data.entries()].map(([a,f],d)=>({key:A._parse(new Vr(n,a,n.path,[d,"key"])),value:s._parse(new Vr(n,f,n.path,[d,"value"]))}));if(n.common.async){let a=new Map;return Promise.resolve().then(async()=>{for(let f of i){let d=await f.key,h=await f.value;if(d.status==="aborted"||h.status==="aborted")return ge;(d.status==="dirty"||h.status==="dirty")&&t.dirty(),a.set(d.value,h.value)}return{status:t.value,value:a}})}else{let a=new Map;for(let f of i){let d=f.key,h=f.value;if(d.status==="aborted"||h.status==="aborted")return ge;(d.status==="dirty"||h.status==="dirty")&&t.dirty(),a.set(d.value,h.value)}return{status:t.value,value:a}}}};xa.create=(r,e,t)=>new xa({valueType:e,keyType:r,typeName:O.ZodMap,...Qe(t)});var Ia=class r extends Re{_parse(e){let{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==V.set)return $(n,{code:N.invalid_type,expected:V.set,received:n.parsedType}),ge;let A=this._def;A.minSize!==null&&n.data.size<A.minSize.value&&($(n,{code:N.too_small,minimum:A.minSize.value,type:"set",inclusive:!0,exact:!1,message:A.minSize.message}),t.dirty()),A.maxSize!==null&&n.data.size>A.maxSize.value&&($(n,{code:N.too_big,maximum:A.maxSize.value,type:"set",inclusive:!0,exact:!1,message:A.maxSize.message}),t.dirty());let s=this._def.valueType;function i(f){let d=new Set;for(let h of f){if(h.status==="aborted")return ge;h.status==="dirty"&&t.dirty(),d.add(h.value)}return{status:t.value,value:d}}let a=[...n.data.values()].map((f,d)=>s._parse(new Vr(n,f,n.path,d)));return n.common.async?Promise.all(a).then(f=>i(f)):i(a)}min(e,t){return new r({...this._def,minSize:{value:e,message:ie.toString(t)}})}max(e,t){return new r({...this._def,maxSize:{value:e,message:ie.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}};Ia.create=(r,e)=>new Ia({valueType:r,minSize:null,maxSize:null,typeName:O.ZodSet,...Qe(e)});var Vc=class r extends Re{constructor(){super(...arguments),this.validate=this.implement}_parse(e){let{ctx:t}=this._processInputParams(e);if(t.parsedType!==V.function)return $(t,{code:N.invalid_type,expected:V.function,received:t.parsedType}),ge;function n(a,f){return Mo({data:a,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,ba(),fA].filter(d=>!!d),issueData:{code:N.invalid_arguments,argumentsError:f}})}function A(a,f){return Mo({data:a,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,ba(),fA].filter(d=>!!d),issueData:{code:N.invalid_return_type,returnTypeError:f}})}let s={errorMap:t.common.contextualErrorMap},i=t.data;if(this._def.returns instanceof As){let a=this;return Jt(async function(...f){let d=new yr([]),h=await a._def.args.parseAsync(f,s).catch(w=>{throw d.addIssue(n(f,w)),d}),m=await Reflect.apply(i,this,h);return await a._def.returns._def.type.parseAsync(m,s).catch(w=>{throw d.addIssue(A(m,w)),d})})}else{let a=this;return Jt(function(...f){let d=a._def.args.safeParse(f,s);if(!d.success)throw new yr([n(f,d.error)]);let h=Reflect.apply(i,this,d.data),m=a._def.returns.safeParse(h,s);if(!m.success)throw new yr([A(h,m.error)]);return m.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new r({...this._def,args:kn.create(e).rest(pA.create())})}returns(e){return new r({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,t,n){return new r({args:e||kn.create([]).rest(pA.create()),returns:t||pA.create(),typeName:O.ZodFunction,...Qe(n)})}},ni=class extends Re{get schema(){return this._def.getter()}_parse(e){let{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}};ni.create=(r,e)=>new ni({getter:r,typeName:O.ZodLazy,...Qe(e)});var Ai=class extends Re{_parse(e){if(e.data!==this._def.value){let t=this._getOrReturnCtx(e);return $(t,{received:t.data,code:N.invalid_literal,expected:this._def.value}),ge}return{status:"valid",value:e.data}}get value(){return this._def.value}};Ai.create=(r,e)=>new Ai({value:r,typeName:O.ZodLiteral,...Qe(e)});function Dy(r,e){return new si({values:r,typeName:O.ZodEnum,...Qe(e)})}var si=class r extends Re{_parse(e){if(typeof e.data!="string"){let t=this._getOrReturnCtx(e),n=this._def.values;return $(t,{expected:Ne.joinValues(n),received:t.parsedType,code:N.invalid_type}),ge}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(e.data)){let t=this._getOrReturnCtx(e),n=this._def.values;return $(t,{received:t.data,code:N.invalid_enum_value,options:n}),ge}return Jt(e.data)}get options(){return this._def.values}get enum(){let e={};for(let t of this._def.values)e[t]=t;return e}get Values(){let e={};for(let t of this._def.values)e[t]=t;return e}get Enum(){let e={};for(let t of this._def.values)e[t]=t;return e}extract(e,t=this._def){return r.create(e,{...this._def,...t})}exclude(e,t=this._def){return r.create(this.options.filter(n=>!e.includes(n)),{...this._def,...t})}};si.create=Dy;var ii=class extends Re{_parse(e){let t=Ne.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(e);if(n.parsedType!==V.string&&n.parsedType!==V.number){let A=Ne.objectValues(t);return $(n,{expected:Ne.joinValues(A),received:n.parsedType,code:N.invalid_type}),ge}if(this._cache||(this._cache=new Set(Ne.getValidEnumValues(this._def.values))),!this._cache.has(e.data)){let A=Ne.objectValues(t);return $(n,{received:n.data,code:N.invalid_enum_value,options:A}),ge}return Jt(e.data)}get enum(){return this._def.values}};ii.create=(r,e)=>new ii({values:r,typeName:O.ZodNativeEnum,...Qe(e)});var As=class extends Re{unwrap(){return this._def.type}_parse(e){let{ctx:t}=this._processInputParams(e);if(t.parsedType!==V.promise&&t.common.async===!1)return $(t,{code:N.invalid_type,expected:V.promise,received:t.parsedType}),ge;let n=t.parsedType===V.promise?t.data:Promise.resolve(t.data);return Jt(n.then(A=>this._def.type.parseAsync(A,{path:t.path,errorMap:t.common.contextualErrorMap})))}};As.create=(r,e)=>new As({type:r,typeName:O.ZodPromise,...Qe(e)});var Zr=class extends Re{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===O.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){let{status:t,ctx:n}=this._processInputParams(e),A=this._def.effect||null,s={addIssue:i=>{$(n,i),i.fatal?t.abort():t.dirty()},get path(){return n.path}};if(s.addIssue=s.addIssue.bind(s),A.type==="preprocess"){let i=A.transform(n.data,s);if(n.common.async)return Promise.resolve(i).then(async a=>{if(t.value==="aborted")return ge;let f=await this._def.schema._parseAsync({data:a,path:n.path,parent:n});return f.status==="aborted"?ge:f.status==="dirty"?Zs(f.value):t.value==="dirty"?Zs(f.value):f});{if(t.value==="aborted")return ge;let a=this._def.schema._parseSync({data:i,path:n.path,parent:n});return a.status==="aborted"?ge:a.status==="dirty"?Zs(a.value):t.value==="dirty"?Zs(a.value):a}}if(A.type==="refinement"){let i=a=>{let f=A.refinement(a,s);if(n.common.async)return Promise.resolve(f);if(f instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return a};if(n.common.async===!1){let a=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return a.status==="aborted"?ge:(a.status==="dirty"&&t.dirty(),i(a.value),{status:t.value,value:a.value})}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(a=>a.status==="aborted"?ge:(a.status==="dirty"&&t.dirty(),i(a.value).then(()=>({status:t.value,value:a.value}))))}if(A.type==="transform")if(n.common.async===!1){let i=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!ts(i))return ge;let a=A.transform(i.value,s);if(a instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:a}}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(i=>ts(i)?Promise.resolve(A.transform(i.value,s)).then(a=>({status:t.value,value:a})):ge);Ne.assertNever(A)}};Zr.create=(r,e,t)=>new Zr({schema:r,typeName:O.ZodEffects,effect:e,...Qe(t)});Zr.createWithPreprocess=(r,e,t)=>new Zr({schema:e,effect:{type:"preprocess",transform:r},typeName:O.ZodEffects,...Qe(t)});var Gr=class extends Re{_parse(e){return this._getType(e)===V.undefined?Jt(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};Gr.create=(r,e)=>new Gr({innerType:r,typeName:O.ZodOptional,...Qe(e)});var Nn=class extends Re{_parse(e){return this._getType(e)===V.null?Jt(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};Nn.create=(r,e)=>new Nn({innerType:r,typeName:O.ZodNullable,...Qe(e)});var ai=class extends Re{_parse(e){let{ctx:t}=this._processInputParams(e),n=t.data;return t.parsedType===V.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:t.path,parent:t})}removeDefault(){return this._def.innerType}};ai.create=(r,e)=>new ai({innerType:r,typeName:O.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...Qe(e)});var oi=class extends Re{_parse(e){let{ctx:t}=this._processInputParams(e),n={...t,common:{...t.common,issues:[]}},A=this._def.innerType._parse({data:n.data,path:n.path,parent:{...n}});return Ba(A)?A.then(s=>({status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new yr(n.common.issues)},input:n.data})})):{status:"valid",value:A.status==="valid"?A.value:this._def.catchValue({get error(){return new yr(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}};oi.create=(r,e)=>new oi({innerType:r,typeName:O.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...Qe(e)});var Ua=class extends Re{_parse(e){if(this._getType(e)!==V.nan){let n=this._getOrReturnCtx(e);return $(n,{code:N.invalid_type,expected:V.nan,received:n.parsedType}),ge}return{status:"valid",value:e.data}}};Ua.create=r=>new Ua({typeName:O.ZodNaN,...Qe(r)});var UT=Symbol("zod_brand"),$o=class extends Re{_parse(e){let{ctx:t}=this._processInputParams(e),n=t.data;return this._def.type._parse({data:n,path:t.path,parent:t})}unwrap(){return this._def.type}},jo=class r extends Re{_parse(e){let{status:t,ctx:n}=this._processInputParams(e);if(n.common.async)return(async()=>{let s=await this._def.in._parseAsync({data:n.data,path:n.path,parent:n});return s.status==="aborted"?ge:s.status==="dirty"?(t.dirty(),Zs(s.value)):this._def.out._parseAsync({data:s.value,path:n.path,parent:n})})();{let A=this._def.in._parseSync({data:n.data,path:n.path,parent:n});return A.status==="aborted"?ge:A.status==="dirty"?(t.dirty(),{status:"dirty",value:A.value}):this._def.out._parseSync({data:A.value,path:n.path,parent:n})}}static create(e,t){return new r({in:e,out:t,typeName:O.ZodPipeline})}},ui=class extends Re{_parse(e){let t=this._def.innerType._parse(e),n=A=>(ts(A)&&(A.value=Object.freeze(A.value)),A);return Ba(t)?t.then(A=>n(A)):n(t)}unwrap(){return this._def.innerType}};ui.create=(r,e)=>new ui({innerType:r,typeName:O.ZodReadonly,...Qe(e)});function ky(r,e){let t=typeof r=="function"?r(e):typeof r=="string"?{message:r}:r;return typeof t=="string"?{message:t}:t}function My(r,e={},t){return r?ns.create().superRefine((n,A)=>{let s=r(n);if(s instanceof Promise)return s.then(i=>{if(!i){let a=ky(e,n),f=a.fatal??t??!0;A.addIssue({code:"custom",...a,fatal:f})}});if(!s){let i=ky(e,n),a=i.fatal??t??!0;A.addIssue({code:"custom",...i,fatal:a})}}):ns.create()}var FT={object:_r.lazycreate},O;(function(r){r.ZodString="ZodString",r.ZodNumber="ZodNumber",r.ZodNaN="ZodNaN",r.ZodBigInt="ZodBigInt",r.ZodBoolean="ZodBoolean",r.ZodDate="ZodDate",r.ZodSymbol="ZodSymbol",r.ZodUndefined="ZodUndefined",r.ZodNull="ZodNull",r.ZodAny="ZodAny",r.ZodUnknown="ZodUnknown",r.ZodNever="ZodNever",r.ZodVoid="ZodVoid",r.ZodArray="ZodArray",r.ZodObject="ZodObject",r.ZodUnion="ZodUnion",r.ZodDiscriminatedUnion="ZodDiscriminatedUnion",r.ZodIntersection="ZodIntersection",r.ZodTuple="ZodTuple",r.ZodRecord="ZodRecord",r.ZodMap="ZodMap",r.ZodSet="ZodSet",r.ZodFunction="ZodFunction",r.ZodLazy="ZodLazy",r.ZodLiteral="ZodLiteral",r.ZodEnum="ZodEnum",r.ZodEffects="ZodEffects",r.ZodNativeEnum="ZodNativeEnum",r.ZodOptional="ZodOptional",r.ZodNullable="ZodNullable",r.ZodDefault="ZodDefault",r.ZodCatch="ZodCatch",r.ZodPromise="ZodPromise",r.ZodBranded="ZodBranded",r.ZodPipeline="ZodPipeline",r.ZodReadonly="ZodReadonly"})(O||(O={}));var QT=(r,e={message:`Input not instance of ${r.name}`})=>My(t=>t instanceof r,e),$y=rs.create,jy=Js.create,TT=Ua.create,OT=Ws.create,Ky=qs.create,ST=Xs.create,PT=Ca.create,RT=Ys.create,kT=ei.create,NT=ns.create,LT=pA.create,HT=un.create,DT=Ea.create,MT=hA.create,$T=_r.create,jT=_r.strictCreate,KT=ti.create,zT=zc.create,GT=ri.create,VT=kn.create,ZT=Gc.create,JT=xa.create,WT=Ia.create,qT=Vc.create,XT=ni.create,YT=Ai.create,eO=si.create,tO=ii.create,rO=As.create,nO=Zr.create,AO=Gr.create,sO=Nn.create,iO=Zr.createWithPreprocess,aO=jo.create,oO=()=>$y().optional(),uO=()=>jy().optional(),cO=()=>Ky().optional(),lO={string:(r=>rs.create({...r,coerce:!0})),number:(r=>Js.create({...r,coerce:!0})),boolean:(r=>qs.create({...r,coerce:!0})),bigint:(r=>Ws.create({...r,coerce:!0})),date:(r=>Xs.create({...r,coerce:!0}))};var fO=ge;var Gh=Ur(Wc(),1);var qy=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-8][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/i;function wO(r){return typeof r=="string"&&qy.test(r)}var ss=wO;function yO(r){if(!ss(r))throw TypeError("Invalid UUID");var e,t=new Uint8Array(16);return t[0]=(e=parseInt(r.slice(0,8),16))>>>24,t[1]=e>>>16&255,t[2]=e>>>8&255,t[3]=e&255,t[4]=(e=parseInt(r.slice(9,13),16))>>>8,t[5]=e&255,t[6]=(e=parseInt(r.slice(14,18),16))>>>8,t[7]=e&255,t[8]=(e=parseInt(r.slice(19,23),16))>>>8,t[9]=e&255,t[10]=(e=parseInt(r.slice(24,36),16))/1099511627776&255,t[11]=e/4294967296&255,t[12]=e>>>24&255,t[13]=e>>>16&255,t[14]=e>>>8&255,t[15]=e&255,t}var Xy=yO;var $t=[];for(qc=0;qc<256;++qc)$t.push((qc+256).toString(16).slice(1));var qc;function Xc(r,e=0){return($t[r[e+0]]+$t[r[e+1]]+$t[r[e+2]]+$t[r[e+3]]+"-"+$t[r[e+4]]+$t[r[e+5]]+"-"+$t[r[e+6]]+$t[r[e+7]]+"-"+$t[r[e+8]]+$t[r[e+9]]+"-"+$t[r[e+10]]+$t[r[e+11]]+$t[r[e+12]]+$t[r[e+13]]+$t[r[e+14]]+$t[r[e+15]]).toLowerCase()}var Yc,_O=new Uint8Array(16);function mp(){if(!Yc&&(Yc=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Yc))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Yc(_O)}function bO(r){r=unescape(encodeURIComponent(r));for(var e=[],t=0;t<r.length;++t)e.push(r.charCodeAt(t));return e}var BO="6ba7b810-9dad-11d1-80b4-00c04fd430c8",vO="6ba7b811-9dad-11d1-80b4-00c04fd430c8";function gp(r,e,t){function n(A,s,i,a){var f;if(typeof A=="string"&&(A=bO(A)),typeof s=="string"&&(s=Xy(s)),((f=s)===null||f===void 0?void 0:f.length)!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");var d=new Uint8Array(16+A.length);if(d.set(s),d.set(A,s.length),d=t(d),d[6]=d[6]&15|e,d[8]=d[8]&63|128,i){a=a||0;for(var h=0;h<16;++h)i[a+h]=d[h];return i}return Xc(d)}try{n.name=r}catch{}return n.DNS=BO,n.URL=vO,n}var CO=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),wp={randomUUID:CO};function EO(r,e,t){if(wp.randomUUID&&!e&&!r)return wp.randomUUID();r=r||{};var n=r.random||(r.rng||mp)();if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,e){t=t||0;for(var A=0;A<16;++A)e[t+A]=n[A];return e}return Xc(n)}var ut=EO;function xO(r,e,t,n){switch(r){case 0:return e&t^~e&n;case 1:return e^t^n;case 2:return e&t^e&n^t&n;case 3:return e^t^n}}function yp(r,e){return r<<e|r>>>32-e}function IO(r){var e=[1518500249,1859775393,2400959708,3395469782],t=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof r=="string"){var n=unescape(encodeURIComponent(r));r=[];for(var A=0;A<n.length;++A)r.push(n.charCodeAt(A))}else Array.isArray(r)||(r=Array.prototype.slice.call(r));r.push(128);for(var s=r.length/4+2,i=Math.ceil(s/16),a=new Array(i),f=0;f<i;++f){for(var d=new Uint32Array(16),h=0;h<16;++h)d[h]=r[f*64+h*4]<<24|r[f*64+h*4+1]<<16|r[f*64+h*4+2]<<8|r[f*64+h*4+3];a[f]=d}a[i-1][14]=(r.length-1)*8/Math.pow(2,32),a[i-1][14]=Math.floor(a[i-1][14]),a[i-1][15]=(r.length-1)*8&4294967295;for(var m=0;m<i;++m){for(var y=new Uint32Array(80),w=0;w<16;++w)y[w]=a[m][w];for(var b=16;b<80;++b)y[b]=yp(y[b-3]^y[b-8]^y[b-14]^y[b-16],1);for(var C=t[0],I=t[1],T=t[2],Q=t[3],P=t[4],R=0;R<80;++R){var D=Math.floor(R/20),ee=yp(C,5)+xO(D,I,T,Q)+P+e[D]+y[R]>>>0;P=Q,Q=T,T=yp(I,30)>>>0,I=C,C=ee}t[0]=t[0]+C>>>0,t[1]=t[1]+I>>>0,t[2]=t[2]+T>>>0,t[3]=t[3]+Q>>>0,t[4]=t[4]+P>>>0}return[t[0]>>24&255,t[0]>>16&255,t[0]>>8&255,t[0]&255,t[1]>>24&255,t[1]>>16&255,t[1]>>8&255,t[1]&255,t[2]>>24&255,t[2]>>16&255,t[2]>>8&255,t[2]&255,t[3]>>24&255,t[3]>>16&255,t[3]>>8&255,t[3]&255,t[4]>>24&255,t[4]>>16&255,t[4]>>8&255,t[4]&255]}var Yy=IO;var UO=gp("v5",80,Yy),el=UO;var Bp=class{getStore(){}run(e,t){return t()}},bp=Symbol.for("ls:tracing_async_local_storage"),FO=new Bp,vp=class{getInstance(){return globalThis[bp]??FO}initializeGlobalInstance(e){globalThis[bp]===void 0&&(globalThis[bp]=e)}},QO=new vp;function e_(r=!1){let e=QO.getInstance().getStore();if(!r&&e===void 0)throw new Error(`Could not get the current run tree.

Please make sure you are calling this method within a traceable function and that tracing is enabled.`);return e}var Zj=Symbol.for("langsmith:traceable:root");function tl(r){return typeof r=="function"&&"langsmith:traceable"in r}var Cp={};hd(Cp,{JsonPatchError:()=>ct,_areEquals:()=>zo,applyOperation:()=>fi,applyPatch:()=>is,applyReducer:()=>PO,deepClone:()=>OO,getValueByPointer:()=>il,validate:()=>r_,validator:()=>al});var TO=Object.prototype.hasOwnProperty;function nl(r,e){return TO.call(r,e)}function Al(r){if(Array.isArray(r)){let t=new Array(r.length);for(let n=0;n<t.length;n++)t[n]=""+n;return t}if(Object.keys)return Object.keys(r);let e=[];for(let t in r)nl(r,t)&&e.push(t);return e}function Wt(r){switch(typeof r){case"object":return JSON.parse(JSON.stringify(r));case"undefined":return null;default:return r}}function sl(r){let e=0,t=r.length,n;for(;e<t;){if(n=r.charCodeAt(e),n>=48&&n<=57){e++;continue}return!1}return!0}function Ln(r){return r.indexOf("/")===-1&&r.indexOf("~")===-1?r:r.replace(/~/g,"~0").replace(/\//g,"~1")}function Ko(r){return r.replace(/~1/g,"/").replace(/~0/g,"~")}function rl(r){if(r===void 0)return!0;if(r){if(Array.isArray(r)){for(let t=0,n=r.length;t<n;t++)if(rl(r[t]))return!0}else if(typeof r=="object"){let t=Al(r),n=t.length;for(var e=0;e<n;e++)if(rl(r[t[e]]))return!0}}return!1}function t_(r,e){let t=[r];for(let n in e){let A=typeof e[n]=="object"?JSON.stringify(e[n],null,2):e[n];typeof A<"u"&&t.push(`${n}: ${A}`)}return t.join(`
`)}var li=class extends Error{constructor(e,t,n,A,s){super(t_(e,{name:t,index:n,operation:A,tree:s})),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"index",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(this,"operation",{enumerable:!0,configurable:!0,writable:!0,value:A}),Object.defineProperty(this,"tree",{enumerable:!0,configurable:!0,writable:!0,value:s}),Object.setPrototypeOf(this,new.target.prototype),this.message=t_(e,{name:t,index:n,operation:A,tree:s})}};var ct=li,OO=Wt,Fa={add:function(r,e,t){return r[e]=this.value,{newDocument:t}},remove:function(r,e,t){var n=r[e];return delete r[e],{newDocument:t,removed:n}},replace:function(r,e,t){var n=r[e];return r[e]=this.value,{newDocument:t,removed:n}},move:function(r,e,t){let n=il(t,this.path);n&&(n=Wt(n));let A=fi(t,{op:"remove",path:this.from}).removed;return fi(t,{op:"add",path:this.path,value:A}),{newDocument:t,removed:n}},copy:function(r,e,t){let n=il(t,this.from);return fi(t,{op:"add",path:this.path,value:Wt(n)}),{newDocument:t}},test:function(r,e,t){return{newDocument:t,test:zo(r[e],this.value)}},_get:function(r,e,t){return this.value=r[e],{newDocument:t}}},SO={add:function(r,e,t){return sl(e)?r.splice(e,0,this.value):r[e]=this.value,{newDocument:t,index:e}},remove:function(r,e,t){var n=r.splice(e,1);return{newDocument:t,removed:n[0]}},replace:function(r,e,t){var n=r[e];return r[e]=this.value,{newDocument:t,removed:n}},move:Fa.move,copy:Fa.copy,test:Fa.test,_get:Fa._get};function il(r,e){if(e=="")return r;var t={op:"_get",path:e};return fi(r,t),t.value}function fi(r,e,t=!1,n=!0,A=!0,s=0){if(t&&(typeof t=="function"?t(e,0,r,e.path):al(e,0)),e.path===""){let i={newDocument:r};if(e.op==="add")return i.newDocument=e.value,i;if(e.op==="replace")return i.newDocument=e.value,i.removed=r,i;if(e.op==="move"||e.op==="copy")return i.newDocument=il(r,e.from),e.op==="move"&&(i.removed=r),i;if(e.op==="test"){if(i.test=zo(r,e.value),i.test===!1)throw new ct("Test operation failed","TEST_OPERATION_FAILED",s,e,r);return i.newDocument=r,i}else{if(e.op==="remove")return i.removed=r,i.newDocument=null,i;if(e.op==="_get")return e.value=r,i;if(t)throw new ct("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",s,e,r);return i}}else{n||(r=Wt(r));let a=(e.path||"").split("/"),f=r,d=1,h=a.length,m,y,w;for(typeof t=="function"?w=t:w=al;;){if(y=a[d],y&&y.indexOf("~")!=-1&&(y=Ko(y)),A&&(y=="__proto__"||y=="prototype"&&d>0&&a[d-1]=="constructor"))throw new TypeError("JSON-Patch: modifying `__proto__` or `constructor/prototype` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(t&&m===void 0&&(f[y]===void 0?m=a.slice(0,d).join("/"):d==h-1&&(m=e.path),m!==void 0&&w(e,0,r,m)),d++,Array.isArray(f)){if(y==="-")y=f.length;else{if(t&&!sl(y))throw new ct("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",s,e,r);sl(y)&&(y=~~y)}if(d>=h){if(t&&e.op==="add"&&y>f.length)throw new ct("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",s,e,r);let b=SO[e.op].call(e,f,y,r);if(b.test===!1)throw new ct("Test operation failed","TEST_OPERATION_FAILED",s,e,r);return b}}else if(d>=h){let b=Fa[e.op].call(e,f,y,r);if(b.test===!1)throw new ct("Test operation failed","TEST_OPERATION_FAILED",s,e,r);return b}if(f=f[y],t&&d<h&&(!f||typeof f!="object"))throw new ct("Cannot perform operation at the desired path","OPERATION_PATH_UNRESOLVABLE",s,e,r)}}}function is(r,e,t,n=!0,A=!0){if(t&&!Array.isArray(e))throw new ct("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");n||(r=Wt(r));let s=new Array(e.length);for(let i=0,a=e.length;i<a;i++)s[i]=fi(r,e[i],t,!0,A,i),r=s[i].newDocument;return s.newDocument=r,s}function PO(r,e,t){let n=fi(r,e);if(n.test===!1)throw new ct("Test operation failed","TEST_OPERATION_FAILED",t,e,r);return n.newDocument}function al(r,e,t,n){if(typeof r!="object"||r===null||Array.isArray(r))throw new ct("Operation is not an object","OPERATION_NOT_AN_OBJECT",e,r,t);if(Fa[r.op]){if(typeof r.path!="string")throw new ct("Operation `path` property is not a string","OPERATION_PATH_INVALID",e,r,t);if(r.path.indexOf("/")!==0&&r.path.length>0)throw new ct('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",e,r,t);if((r.op==="move"||r.op==="copy")&&typeof r.from!="string")throw new ct("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",e,r,t);if((r.op==="add"||r.op==="replace"||r.op==="test")&&r.value===void 0)throw new ct("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",e,r,t);if((r.op==="add"||r.op==="replace"||r.op==="test")&&rl(r.value))throw new ct("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",e,r,t);if(t){if(r.op=="add"){var A=r.path.split("/").length,s=n.split("/").length;if(A!==s+1&&A!==s)throw new ct("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",e,r,t)}else if(r.op==="replace"||r.op==="remove"||r.op==="_get"){if(r.path!==n)throw new ct("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",e,r,t)}else if(r.op==="move"||r.op==="copy"){var i={op:"_get",path:r.from,value:void 0},a=r_([i],t);if(a&&a.name==="OPERATION_PATH_UNRESOLVABLE")throw new ct("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",e,r,t)}}}else throw new ct("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",e,r,t)}function r_(r,e,t){try{if(!Array.isArray(r))throw new ct("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(e)is(Wt(e),Wt(r),t||!0);else{t=t||al;for(var n=0;n<r.length;n++)t(r[n],n,e,void 0)}}catch(A){if(A instanceof ct)return A;throw A}}function zo(r,e){if(r===e)return!0;if(r&&e&&typeof r=="object"&&typeof e=="object"){var t=Array.isArray(r),n=Array.isArray(e),A,s,i;if(t&&n){if(s=r.length,s!=e.length)return!1;for(A=s;A--!==0;)if(!zo(r[A],e[A]))return!1;return!0}if(t!=n)return!1;var a=Object.keys(r);if(s=a.length,s!==Object.keys(e).length)return!1;for(A=s;A--!==0;)if(!e.hasOwnProperty(a[A]))return!1;for(A=s;A--!==0;)if(i=a[A],!zo(r[i],e[i]))return!1;return!0}return r!==r&&e!==e}function n_(r,e,t,n,A){if(e!==r){typeof e.toJSON=="function"&&(e=e.toJSON());for(var s=Al(e),i=Al(r),a=!1,f=!1,d=i.length-1;d>=0;d--){var h=i[d],m=r[h];if(nl(e,h)&&!(e[h]===void 0&&m!==void 0&&Array.isArray(e)===!1)){var y=e[h];typeof m=="object"&&m!=null&&typeof y=="object"&&y!=null&&Array.isArray(m)===Array.isArray(y)?n_(m,y,t,n+"/"+Ln(h),A):m!==y&&(a=!0,A&&t.push({op:"test",path:n+"/"+Ln(h),value:Wt(m)}),t.push({op:"replace",path:n+"/"+Ln(h),value:Wt(y)}))}else Array.isArray(r)===Array.isArray(e)?(A&&t.push({op:"test",path:n+"/"+Ln(h),value:Wt(m)}),t.push({op:"remove",path:n+"/"+Ln(h)}),f=!0):(A&&t.push({op:"test",path:n,value:r}),t.push({op:"replace",path:n,value:e}),a=!0)}if(!(!f&&s.length==i.length))for(var d=0;d<s.length;d++){var h=s[d];!nl(r,h)&&e[h]!==void 0&&t.push({op:"add",path:n+"/"+Ln(h),value:Wt(e[h])})}}}function ol(r,e,t=!1){var n=[];return n_(r,e,n,"",t),n}var AK={...Cp,JsonPatchError:li,deepClone:Wt,escapePathComponent:Ln,unescapePathComponent:Ko};var A_="gen_ai.operation.name",s_="gen_ai.system",Ep="gen_ai.request.model",i_="gen_ai.response.model",xp="gen_ai.usage.input_tokens",Ip="gen_ai.usage.output_tokens",Up="gen_ai.usage.total_tokens",a_="gen_ai.request.max_tokens",o_="gen_ai.request.temperature",u_="gen_ai.request.top_p",c_="gen_ai.request.frequency_penalty",l_="gen_ai.request.presence_penalty",f_="gen_ai.response.finish_reasons",d_="gen_ai.prompt",p_="gen_ai.completion",h_="gen_ai.request.extra_query",m_="gen_ai.request.extra_body",g_="gen_ai.serialized.name",w_="gen_ai.serialized.signature",y_="gen_ai.serialized.doc",__="gen_ai.response.id",b_="gen_ai.response.service_tier",B_="gen_ai.response.system_fingerprint",v_="gen_ai.usage.input_token_details",C_="gen_ai.usage.output_token_details",E_="langsmith.trace.session_id",x_="langsmith.trace.session_name",I_="langsmith.span.kind",U_="langsmith.trace.name",F_="langsmith.metadata",Fp="langsmith.span.tags";var Q_="langsmith.request.streaming",T_="langsmith.request.headers";var kO=(...r)=>fetch(...r),O_=Symbol.for("ls:fetch_implementation");var S_=()=>{let r=globalThis[O_];return r?typeof r=="function"&&"Headers"in r&&"Request"in r&&"Response"in r:!1},P_=r=>async(...e)=>{if(r||yt("DEBUG")==="true"){let[n,A]=e;console.log(`\u2192 ${A?.method||"GET"} ${n}`)}let t=await(globalThis[O_]??kO)(...e);return(r||yt("DEBUG")==="true")&&console.log(`\u2190 ${t.status} ${t.statusText} ${t.url}`),t};var Go=()=>yt("PROJECT")??Rr("LANGCHAIN_SESSION")??"default";var ul="0.3.67";var Hn,NO=()=>typeof window<"u"&&typeof window.document<"u",LO=()=>typeof globalThis=="object"&&globalThis.constructor&&globalThis.constructor.name==="DedicatedWorkerGlobalScope",HO=()=>typeof window<"u"&&window.name==="nodejs"||typeof navigator<"u"&&navigator.userAgent.includes("jsdom"),R_=()=>typeof Deno<"u",DO=()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"&&!R_(),Op=()=>Hn||(typeof Bun<"u"?Hn="bun":NO()?Hn="browser":DO()?Hn="node":LO()?Hn="webworker":HO()?Hn="jsdom":R_()?Hn="deno":Hn="other",Hn),Qp;function cl(){if(Qp===void 0){let r=Op(),e=$O();Qp={library:"langsmith",runtime:r,sdk:"langsmith-js",sdk_version:ul,...e}}return Qp}function k_(){let r=MO()||{},e={},t=["LANGCHAIN_API_KEY","LANGCHAIN_ENDPOINT","LANGCHAIN_TRACING_V2","LANGCHAIN_PROJECT","LANGCHAIN_SESSION","LANGSMITH_API_KEY","LANGSMITH_ENDPOINT","LANGSMITH_TRACING_V2","LANGSMITH_PROJECT","LANGSMITH_SESSION"];for(let[n,A]of Object.entries(r))(n.startsWith("LANGCHAIN_")||n.startsWith("LANGSMITH_"))&&typeof A=="string"&&!t.includes(n)&&!n.toLowerCase().includes("key")&&!n.toLowerCase().includes("secret")&&!n.toLowerCase().includes("token")&&(n==="LANGCHAIN_REVISION_ID"?e.revision_id=A:e[n]=A);return e}function MO(){try{return typeof process<"u"&&process.env?Object.entries(process.env).reduce((r,[e,t])=>(r[e]=String(t),r),{}):void 0}catch{return}}function Rr(r){try{return typeof process<"u"?process.env?.[r]:void 0}catch{return}}function yt(r){return Rr(`LANGSMITH_${r}`)||Rr(`LANGCHAIN_${r}`)}var Tp;function $O(){if(Tp!==void 0)return Tp;let r=["VERCEL_GIT_COMMIT_SHA","NEXT_PUBLIC_VERCEL_GIT_COMMIT_SHA","COMMIT_REF","RENDER_GIT_COMMIT","CI_COMMIT_SHA","CIRCLE_SHA1","CF_PAGES_COMMIT_SHA","REACT_APP_GIT_SHA","SOURCE_VERSION","GITHUB_SHA","TRAVIS_COMMIT","GIT_COMMIT","BUILD_VCS_NUMBER","bamboo_planRepository_revision","Build.SourceVersion","BITBUCKET_COMMIT","DRONE_COMMIT_SHA","SEMAPHORE_GIT_SHA","BUILDKITE_COMMIT"],e={};for(let t of r){let n=Rr(t);n!==void 0&&(e[t]=n)}return Tp=e,e}function ll(){return Rr("OTEL_ENABLED")==="true"||yt("OTEL_ENABLED")==="true"}var Rp=class{constructor(){Object.defineProperty(this,"hasWarned",{enumerable:!0,configurable:!0,writable:!0,value:!1})}startActiveSpan(e,...t){!this.hasWarned&&ll()&&(console.warn('You have enabled OTEL export via the `OTEL_ENABLED` or `LANGSMITH_OTEL_ENABLED` environment variable, but have not initialized the required OTEL instances. Please add:\n```\nimport { initializeOTEL } from "langsmith/experimental/otel/setup";\ninitializeOTEL();\n```\nat the beginning of your code.'),this.hasWarned=!0);let n;if(t.length===1&&typeof t[0]=="function"?n=t[0]:t.length===2&&typeof t[1]=="function"?n=t[1]:t.length===3&&typeof t[2]=="function"&&(n=t[2]),typeof n=="function")return n()}},kp=class{constructor(){Object.defineProperty(this,"mockTracer",{enumerable:!0,configurable:!0,writable:!0,value:new Rp})}getTracer(e,t){return this.mockTracer}getActiveSpan(){}setSpan(e,t){return e}getSpan(e){}setSpanContext(e,t){return e}getTracerProvider(){}setGlobalTracerProvider(e){return!1}},Np=class{active(){return{}}with(e,t){return t()}},Sp=Symbol.for("ls:otel_trace"),Pp=Symbol.for("ls:otel_context"),N_=Symbol.for("ls:otel_get_default_otlp_tracer_provider"),jO=new kp,KO=new Np,Lp=class{getTraceInstance(){return globalThis[Sp]??jO}getContextInstance(){return globalThis[Pp]??KO}initializeGlobalInstances(e){globalThis[Sp]===void 0&&(globalThis[Sp]=e.trace),globalThis[Pp]===void 0&&(globalThis[Pp]=e.context)}setDefaultOTLPTracerComponents(e){globalThis[N_]=e}getDefaultOTLPTracerComponents(){return globalThis[N_]??void 0}},Hp=new Lp;function fl(){return Hp.getTraceInstance()}function L_(){return Hp.getContextInstance()}function H_(){return Hp.getDefaultOTLPTracerComponents()}var zO={llm:"chat",tool:"execute_tool",retriever:"embeddings",embedding:"embeddings",prompt:"chat"};function GO(r){return zO[r]||r}var dl=class{constructor(){Object.defineProperty(this,"spans",{enumerable:!0,configurable:!0,writable:!0,value:new Map})}exportBatch(e,t){for(let n of e)try{if(!n.run)continue;if(n.operation==="post"){let A=this.createSpanForRun(n,n.run,t.get(n.id));A&&!n.run.end_time&&this.spans.set(n.id,A)}else this.updateSpanForRun(n,n.run)}catch(A){console.error(`Error processing operation ${n.id}:`,A)}}createSpanForRun(e,t,n){let A=n&&fl().getSpan(n);if(A)try{return this.finishSpanSetup(A,t,e)}catch(s){console.error(`Failed to create span for run ${e.id}:`,s);return}}finishSpanSetup(e,t,n){return this.setSpanAttributes(e,t,n),t.error?(e.setStatus({code:2}),e.recordException(new Error(t.error))):e.setStatus({code:1}),t.end_time&&e.end(new Date(t.end_time)),e}updateSpanForRun(e,t){try{let n=this.spans.get(e.id);if(!n){console.debug(`No span found for run ${e.id} during update`);return}this.setSpanAttributes(n,t,e),t.error?(n.setStatus({code:2}),n.recordException(new Error(t.error))):n.setStatus({code:1});let A=t.end_time;A&&(n.end(new Date(A)),this.spans.delete(e.id))}catch(n){console.error(`Failed to update span for run ${e.id}:`,n)}}extractModelName(e){if(e.extra?.metadata){let t=e.extra.metadata;if(t.ls_model_name)return t.ls_model_name;if(t.invocation_params){let n=t.invocation_params;if(n.model)return n.model;if(n.model_name)return n.model_name}}}setSpanAttributes(e,t,n){if("run_type"in t&&t.run_type){e.setAttribute(I_,t.run_type);let a=GO(t.run_type||"chain");e.setAttribute(A_,a)}"name"in t&&t.name&&e.setAttribute(U_,t.name),"session_id"in t&&t.session_id&&e.setAttribute(E_,t.session_id),"session_name"in t&&t.session_name&&e.setAttribute(x_,t.session_name),this.setGenAiSystem(e,t);let A=this.extractModelName(t);A&&e.setAttribute(Ep,A),"prompt_tokens"in t&&typeof t.prompt_tokens=="number"&&e.setAttribute(xp,t.prompt_tokens),"completion_tokens"in t&&typeof t.completion_tokens=="number"&&e.setAttribute(Ip,t.completion_tokens),"total_tokens"in t&&typeof t.total_tokens=="number"&&e.setAttribute(Up,t.total_tokens),this.setInvocationParameters(e,t);let s=t.extra?.metadata||{};for(let[a,f]of Object.entries(s))f!=null&&e.setAttribute(`${F_}.${a}`,String(f));let i=t.tags;if(i&&Array.isArray(i)?e.setAttribute(Fp,i.join(", ")):i&&e.setAttribute(Fp,String(i)),"serialized"in t&&typeof t.serialized=="object"){let a=t.serialized;a.name&&e.setAttribute(g_,String(a.name)),a.signature&&e.setAttribute(w_,String(a.signature)),a.doc&&e.setAttribute(y_,String(a.doc))}this.setIOAttributes(e,n)}setGenAiSystem(e,t){let n="langchain",A=this.extractModelName(t);if(A){let s=A.toLowerCase();s.includes("anthropic")||s.startsWith("claude")?n="anthropic":s.includes("bedrock")?n="aws.bedrock":s.includes("azure")&&s.includes("openai")?n="az.ai.openai":s.includes("azure")&&s.includes("inference")?n="az.ai.inference":s.includes("cohere")?n="cohere":s.includes("deepseek")?n="deepseek":s.includes("gemini")?n="gemini":s.includes("groq")?n="groq":s.includes("watson")||s.includes("ibm")?n="ibm.watsonx.ai":s.includes("mistral")?n="mistral_ai":s.includes("gpt")||s.includes("openai")?n="openai":s.includes("perplexity")||s.includes("sonar")?n="perplexity":s.includes("vertex")?n="vertex_ai":(s.includes("xai")||s.includes("grok"))&&(n="xai")}e.setAttribute(s_,n)}setInvocationParameters(e,t){if(!t.extra?.metadata?.invocation_params)return;let n=t.extra.metadata.invocation_params;n.max_tokens!==void 0&&e.setAttribute(a_,n.max_tokens),n.temperature!==void 0&&e.setAttribute(o_,n.temperature),n.top_p!==void 0&&e.setAttribute(u_,n.top_p),n.frequency_penalty!==void 0&&e.setAttribute(c_,n.frequency_penalty),n.presence_penalty!==void 0&&e.setAttribute(l_,n.presence_penalty)}setIOAttributes(e,t){if(t.run.inputs)try{let n=t.run.inputs;typeof n=="object"&&n!==null&&(n.model&&Array.isArray(n.messages)&&e.setAttribute(Ep,n.model),n.stream!==void 0&&e.setAttribute(Q_,n.stream),n.extra_headers&&e.setAttribute(T_,JSON.stringify(n.extra_headers)),n.extra_query&&e.setAttribute(h_,JSON.stringify(n.extra_query)),n.extra_body&&e.setAttribute(m_,JSON.stringify(n.extra_body))),e.setAttribute(d_,JSON.stringify(n))}catch(n){console.debug(`Failed to process inputs for run ${t.id}`,n)}if(t.run.outputs)try{let n=t.run.outputs,A=this.getUnifiedRunTokens(n);if(A&&(e.setAttribute(xp,A[0]),e.setAttribute(Ip,A[1]),e.setAttribute(Up,A[0]+A[1])),n&&typeof n=="object"){if(n.model&&e.setAttribute(i_,String(n.model)),n.id&&e.setAttribute(__,n.id),n.choices&&Array.isArray(n.choices)){let s=n.choices.map(i=>i.finish_reason).filter(i=>i).map(String);s.length>0&&e.setAttribute(f_,s.join(", "))}if(n.service_tier&&e.setAttribute(b_,n.service_tier),n.system_fingerprint&&e.setAttribute(B_,n.system_fingerprint),n.usage_metadata&&typeof n.usage_metadata=="object"){let s=n.usage_metadata;s.input_token_details&&e.setAttribute(v_,JSON.stringify(s.input_token_details)),s.output_token_details&&e.setAttribute(C_,JSON.stringify(s.output_token_details))}}e.setAttribute(p_,JSON.stringify(n))}catch(n){console.debug(`Failed to process outputs for run ${t.id}`,n)}}getUnifiedRunTokens(e){if(!e)return null;let t=this.extractUnifiedRunTokens(e.usage_metadata);if(t)return t;let n=Object.keys(e);for(let i of n){let a=e[i];if(!(!a||typeof a!="object")&&(t=this.extractUnifiedRunTokens(a.usage_metadata),t||a.lc===1&&a.kwargs&&typeof a.kwargs=="object"&&(t=this.extractUnifiedRunTokens(a.kwargs.usage_metadata),t)))return t}let A=e.generations||[];if(!Array.isArray(A))return null;let s=Array.isArray(A[0])?A.flat():A;for(let i of s)if(typeof i=="object"&&i.message&&typeof i.message=="object"&&i.message.kwargs&&typeof i.message.kwargs=="object"&&(t=this.extractUnifiedRunTokens(i.message.kwargs.usage_metadata),t))return t;return null}extractUnifiedRunTokens(e){return!e||typeof e!="object"||typeof e.input_tokens!="number"||typeof e.output_tokens!="number"?null:[e.input_tokens,e.output_tokens]}};var J_=Ur(Wc(),1),yl=Ur(wl(),1),tS=[429,500,502,503,504],Zo=class{constructor(e){Object.defineProperty(this,"maxConcurrency",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxRetries",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"queue",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"onFailedResponseHook",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxConcurrency=e.maxConcurrency??1/0,this.maxRetries=e.maxRetries??6,"default"in yl.default?this.queue=new yl.default.default({concurrency:this.maxConcurrency}):this.queue=new yl.default({concurrency:this.maxConcurrency}),this.onFailedResponseHook=e?.onFailedResponseHook}call(e,...t){let n=this.onFailedResponseHook;return this.queue.add(()=>(0,J_.default)(()=>e(...t).catch(A=>{throw A instanceof Error?A:new Error(A)}),{async onFailedAttempt(A){if(A.message.startsWith("Cancel")||A.message.startsWith("TimeoutError")||A.name==="TimeoutError"||A.message.startsWith("AbortError")||A?.code==="ECONNABORTED")throw A;let s=A?.response;if(n&&await n(s))return;let i=s?.status??A?.status;if(i&&!tS.includes(+i))throw A},retries:this.maxRetries,randomize:!0}),{throwOnTimeout:!0})}callWithOptions(e,t,...n){return e.signal?Promise.race([this.call(t,...n),new Promise((A,s)=>{e.signal?.addEventListener("abort",()=>{s(new Error("AbortError"))})})]):this.call(t,...n)}};function Gp(r){return typeof r?._getType=="function"}function Vp(r){let e={type:r._getType(),data:{content:r.content}};return r?.additional_kwargs&&Object.keys(r.additional_kwargs).length>0&&(e.data.additional_kwargs={...r.additional_kwargs}),e}var rS=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;function Ue(r,e){if(!rS.test(r)){let t=e!==void 0?`Invalid UUID for ${e}: ${r}`:`Invalid UUID: ${r}`;throw new Error(t)}return r}var W_={};function _l(r){W_[r]||(console.warn(r),W_[r]=!0)}var XR=Ur(HB(),1);function mA(r){if(!r||r.split("/").length>2||r.startsWith("/")||r.endsWith("/")||r.split(":").length>2)throw new Error(`Invalid identifier format: ${r}`);let[e,t]=r.split(":"),n=t||"latest";if(e.includes("/")){let[A,s]=e.split("/",2);if(!A||!s)throw new Error(`Invalid identifier format: ${r}`);return[A,s,n]}else{if(!e)throw new Error(`Invalid identifier format: ${r}`);return["-",e,n]}}var fh=class extends Error{constructor(e){super(e),Object.defineProperty(this,"status",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name="LangSmithConflictError",this.status=409}};async function le(r,e,t){let n;if(r.ok){t&&(n=await r.text());return}if(r.status===403)try{if((await r.json())?.error==="org_scoped_key_requires_workspace")throw new Error("This API key is org-scoped and requires workspace specification. Please provide 'workspaceId' parameter, or set LANGSMITH_WORKSPACE_ID environment variable.")}catch{throw new Error(`${r.status} ${r.statusText}`)}n=await r.text();let A=`Failed to ${e}. Received status [${r.status}]: ${r.statusText}. Server response: ${n}`;if(r.status===409)throw new fh(A);let s=new Error(A);throw s.status=r.status,s}var DB="ERR_CONFLICTING_ENDPOINTS",Sl=class extends Error{constructor(){super("You cannot provide both LANGSMITH_ENDPOINT / LANGCHAIN_ENDPOINT and LANGSMITH_RUNS_ENDPOINTS."),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:DB}),this.name="ConflictingEndpointsError"}};function MB(r){return typeof r=="object"&&r!==null&&r.code===DB}var $B="[...]",YR={result:"[Circular]"},Rl=[],Oa=[],ek=new TextEncoder;function tk(){return{depthLimit:Number.MAX_SAFE_INTEGER,edgesLimit:Number.MAX_SAFE_INTEGER}}function Pl(r){return ek.encode(r)}function jB(r){if(r&&typeof r=="object"&&r!==null){if(r instanceof Map)return Object.fromEntries(r);if(r instanceof Set)return Array.from(r);if(r instanceof Date)return r.toISOString();if(r instanceof RegExp)return r.toString();if(r instanceof Error)return{name:r.name,message:r.message}}else if(typeof r=="bigint")return r.toString();return r}function rk(r){return function(e,t){if(r){let n=r.call(this,e,t);if(n!==void 0)return n}return jB(t)}}function Br(r,e,t,n,A){try{let s=JSON.stringify(r,rk(t),n);return Pl(s)}catch(s){if(!s.message?.includes("Converting circular structure to JSON"))return console.warn(`[WARNING]: LangSmith received unserializable value.${e?`
Context: ${e}`:""}`),Pl("[Unserializable]");yt("SUPPRESS_CIRCULAR_JSON_WARNINGS")!=="true"&&console.warn(`[WARNING]: LangSmith received circular JSON. This will decrease tracer performance. ${e?`
Context: ${e}`:""}`),typeof A>"u"&&(A=tk()),ph(r,"",0,[],void 0,0,A);let i;try{Oa.length===0?i=JSON.stringify(r,t,n):i=JSON.stringify(r,nk(t),n)}catch{return Pl("[unable to serialize, circular reference is too complex to analyze]")}finally{for(;Rl.length!==0;){let a=Rl.pop();a.length===4?Object.defineProperty(a[0],a[1],a[3]):a[0][a[1]]=a[2]}}return Pl(i)}}function dh(r,e,t,n){var A=Object.getOwnPropertyDescriptor(n,t);A.get!==void 0?A.configurable?(Object.defineProperty(n,t,{value:r}),Rl.push([n,t,e,A])):Oa.push([e,t,r]):(n[t]=r,Rl.push([n,t,e]))}function ph(r,e,t,n,A,s,i){s+=1;var a;if(typeof r=="object"&&r!==null){for(a=0;a<n.length;a++)if(n[a]===r){dh(YR,r,e,A);return}if(typeof i.depthLimit<"u"&&s>i.depthLimit){dh($B,r,e,A);return}if(typeof i.edgesLimit<"u"&&t+1>i.edgesLimit){dh($B,r,e,A);return}if(n.push(r),Array.isArray(r))for(a=0;a<r.length;a++)ph(r[a],a,a,n,r,s,i);else{r=jB(r);var f=Object.keys(r);for(a=0;a<f.length;a++){var d=f[a];ph(r[d],d,a,n,r,s,i)}}n.pop()}}function nk(r){return r=typeof r<"u"?r:function(e,t){return t},function(e,t){if(Oa.length>0)for(var n=0;n<Oa.length;n++){var A=Oa[n];if(A[1]===e&&A[0]===t){t=A[2],Oa.splice(n,1);break}}return r.call(this,e,t)}}function KB(r){let e=cl(),t=k_(),n=r.extra??{},A=n.metadata;return r.extra={...n,runtime:{...e,...n?.runtime},metadata:{...t,...t.revision_id||"revision_id"in r&&r.revision_id?{revision_id:("revision_id"in r?r.revision_id:void 0)??t.revision_id}:{},...A}},r}var Ak=r=>{let e=r?.toString()??yt("TRACING_SAMPLING_RATE");if(e===void 0)return;let t=parseFloat(e);if(t<0||t>1)throw new Error(`LANGSMITH_TRACING_SAMPLING_RATE must be between 0 and 1 if set. Got: ${t}`);return t},sk=r=>{let t=r.replace("http://","").replace("https://","").split("/")[0].split(":")[0];return t==="localhost"||t==="127.0.0.1"||t==="::1"};async function ik(r){let e=[];for await(let t of r)e.push(t);return e}function kl(r){if(r!==void 0)return r.trim().replace(/^"(.*)"$/,"$1").replace(/^'(.*)'$/,"$1")}var ak=async r=>{if(r?.status===429){let e=parseInt(r.headers.get("retry-after")??"10",10)*1e3;if(e>0)return await new Promise(t=>setTimeout(t,e)),!0}return!1};function zB(r){return typeof r=="number"?Number(r.toFixed(4)):r}var hh=class{constructor(){Object.defineProperty(this,"items",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"sizeBytes",{enumerable:!0,configurable:!0,writable:!0,value:0})}peek(){return this.items[0]}push(e){let t,n=new Promise(s=>{t=s}),A=Br(e.item,`Serializing run with id: ${e.item.id}`).length;return this.items.push({action:e.action,payload:e.item,otelContext:e.otelContext,apiKey:e.apiKey,apiUrl:e.apiUrl,itemPromiseResolve:t,itemPromise:n,size:A}),this.sizeBytes+=A,n}pop(e){if(e<1)throw new Error("Number of bytes to pop off may not be less than 1.");let t=[],n=0;for(;n+(this.peek()?.size??0)<e&&this.items.length>0;){let A=this.items.shift();A&&(t.push(A),n+=A.size,this.sizeBytes-=A.size)}if(t.length===0&&this.items.length>0){let A=this.items.shift();t.push(A),n+=A.size,this.sizeBytes-=A.size}return[t.map(A=>({action:A.action,item:A.payload,otelContext:A.otelContext,apiKey:A.apiKey,apiUrl:A.apiUrl})),()=>t.forEach(A=>A.itemPromiseResolve())]}},ok=24*1024*1024,uk=1e4,GB="https://api.smith.langchain.com",di=class r{get _fetch(){return this.fetchImplementation||P_(this.debug)}constructor(e={}){Object.defineProperty(this,"apiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"apiUrl",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"webUrl",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"workspaceId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"caller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"batchIngestCaller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"timeout_ms",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_tenantId",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"hideInputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"hideOutputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tracingSampleRate",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"filteredPostUuids",{enumerable:!0,configurable:!0,writable:!0,value:new Set}),Object.defineProperty(this,"autoBatchTracing",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"autoBatchQueue",{enumerable:!0,configurable:!0,writable:!0,value:new hh}),Object.defineProperty(this,"autoBatchTimeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"autoBatchAggregationDelayMs",{enumerable:!0,configurable:!0,writable:!0,value:250}),Object.defineProperty(this,"batchSizeBytesLimit",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fetchOptions",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"settings",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"blockOnRootRunFinalization",{enumerable:!0,configurable:!0,writable:!0,value:Rr("LANGSMITH_TRACING_BACKGROUND")==="false"}),Object.defineProperty(this,"traceBatchConcurrency",{enumerable:!0,configurable:!0,writable:!0,value:5}),Object.defineProperty(this,"_serverInfo",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_getServerInfoPromise",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"manualFlushMode",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"langSmithToOTELTranslator",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fetchImplementation",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"multipartStreamingDisabled",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"debug",{enumerable:!0,configurable:!0,writable:!0,value:Rr("LANGSMITH_DEBUG")==="true"});let t=r.getDefaultClientConfig();if(this.tracingSampleRate=Ak(e.tracingSamplingRate),this.apiUrl=kl(e.apiUrl??t.apiUrl)??"",this.apiUrl.endsWith("/")&&(this.apiUrl=this.apiUrl.slice(0,-1)),this.apiKey=kl(e.apiKey??t.apiKey),this.webUrl=kl(e.webUrl??t.webUrl),this.webUrl?.endsWith("/")&&(this.webUrl=this.webUrl.slice(0,-1)),this.workspaceId=kl(e.workspaceId??yt("WORKSPACE_ID")),this.timeout_ms=e.timeout_ms??9e4,this.caller=new Zo({...e.callerOptions??{},maxRetries:4,debug:e.debug??this.debug}),this.traceBatchConcurrency=e.traceBatchConcurrency??this.traceBatchConcurrency,this.traceBatchConcurrency<1)throw new Error("Trace batch concurrency must be positive.");this.debug=e.debug??this.debug,this.fetchImplementation=e.fetchImplementation,this.batchIngestCaller=new Zo({maxRetries:2,maxConcurrency:this.traceBatchConcurrency,...e.callerOptions??{},onFailedResponseHook:ak,debug:e.debug??this.debug}),this.hideInputs=e.hideInputs??e.anonymizer??t.hideInputs,this.hideOutputs=e.hideOutputs??e.anonymizer??t.hideOutputs,this.autoBatchTracing=e.autoBatchTracing??this.autoBatchTracing,this.blockOnRootRunFinalization=e.blockOnRootRunFinalization??this.blockOnRootRunFinalization,this.batchSizeBytesLimit=e.batchSizeBytesLimit,this.fetchOptions=e.fetchOptions||{},this.manualFlushMode=e.manualFlushMode??this.manualFlushMode,ll()&&(this.langSmithToOTELTranslator=new dl)}static getDefaultClientConfig(){let e=yt("API_KEY"),t=yt("ENDPOINT")??GB,n=yt("HIDE_INPUTS")==="true",A=yt("HIDE_OUTPUTS")==="true";return{apiUrl:t,apiKey:e,webUrl:void 0,hideInputs:n,hideOutputs:A}}getHostUrl(){return this.webUrl?this.webUrl:sk(this.apiUrl)?(this.webUrl="http://localhost:3000",this.webUrl):this.apiUrl.endsWith("/api/v1")?(this.webUrl=this.apiUrl.replace("/api/v1",""),this.webUrl):this.apiUrl.includes("/api")&&!this.apiUrl.split(".",1)[0].endsWith("api")?(this.webUrl=this.apiUrl.replace("/api",""),this.webUrl):this.apiUrl.split(".",1)[0].includes("dev")?(this.webUrl="https://dev.smith.langchain.com",this.webUrl):this.apiUrl.split(".",1)[0].includes("eu")?(this.webUrl="https://eu.smith.langchain.com",this.webUrl):this.apiUrl.split(".",1)[0].includes("beta")?(this.webUrl="https://beta.smith.langchain.com",this.webUrl):(this.webUrl="https://smith.langchain.com",this.webUrl)}get headers(){let e={"User-Agent":`langsmith-js/${ul}`};return this.apiKey&&(e["x-api-key"]=`${this.apiKey}`),this.workspaceId&&(e["x-tenant-id"]=this.workspaceId),e}_getPlatformEndpointPath(e){return this.apiUrl.slice(-3)!=="/v1"&&this.apiUrl.slice(-4)!=="/v1/"?`/v1/platform/${e}`:`/platform/${e}`}async processInputs(e){return this.hideInputs===!1?e:this.hideInputs===!0?{}:typeof this.hideInputs=="function"?this.hideInputs(e):e}async processOutputs(e){return this.hideOutputs===!1?e:this.hideOutputs===!0?{}:typeof this.hideOutputs=="function"?this.hideOutputs(e):e}async prepareRunCreateOrUpdateInputs(e){let t={...e};return t.inputs!==void 0&&(t.inputs=await this.processInputs(t.inputs)),t.outputs!==void 0&&(t.outputs=await this.processOutputs(t.outputs)),t}async _getResponse(e,t){let n=t?.toString()??"",A=`${this.apiUrl}${e}?${n}`;return await this.caller.call(async()=>{let i=await this._fetch(A,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await le(i,`Failed to fetch ${e}`),i})}async _get(e,t){return(await this._getResponse(e,t)).json()}async*_getPaginated(e,t=new URLSearchParams,n){let A=Number(t.get("offset"))||0,s=Number(t.get("limit"))||100;for(;;){t.set("offset",String(A)),t.set("limit",String(s));let i=`${this.apiUrl}${e}?${t}`,a=await this.caller.call(async()=>{let d=await this._fetch(i,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await le(d,`Failed to fetch ${e}`),d}),f=n?n(await a.json()):await a.json();if(f.length===0||(yield f,f.length<s))break;A+=f.length}}async*_getCursorPaginatedList(e,t=null,n="POST",A="runs"){let s=t?{...t}:{};for(;;){let i=JSON.stringify(s),f=await(await this.caller.call(async()=>{let h=await this._fetch(`${this.apiUrl}${e}`,{method:n,headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:i});return await le(h,`Failed to fetch ${e}`),h})).json();if(!f||!f[A])break;yield f[A];let d=f.cursors;if(!d||!d.next)break;s.cursor=d.next}}_shouldSample(){return this.tracingSampleRate===void 0?!0:Math.random()<this.tracingSampleRate}_filterForSampling(e,t=!1){if(this.tracingSampleRate===void 0)return e;if(t){let n=[];for(let A of e)this.filteredPostUuids.has(A.trace_id)?A.id===A.trace_id&&this.filteredPostUuids.delete(A.trace_id):n.push(A);return n}else{let n=[];for(let A of e){let s=A.trace_id??A.id;this.filteredPostUuids.has(s)||(A.id===s?this._shouldSample()?n.push(A):this.filteredPostUuids.add(s):n.push(A))}return n}}async _getBatchSizeLimitBytes(){let e=await this._ensureServerInfo();return this.batchSizeBytesLimit??e.batch_ingest_config?.size_limit_bytes??ok}async _getDatasetExamplesMultiPartSupport(){return(await this._ensureServerInfo()).instance_flags?.dataset_examples_multipart_enabled??!1}drainAutoBatchQueue(e){let t=[];for(;this.autoBatchQueue.items.length>0;){let[n,A]=this.autoBatchQueue.pop(e);if(!n.length){A();break}let s=n.reduce((f,d)=>{let h=d.apiUrl??this.apiUrl,m=d.apiKey??this.apiKey,w=d.apiKey===this.apiKey&&d.apiUrl===this.apiUrl?"default":`${h}|${m}`;return f[w]||(f[w]=[]),f[w].push(d),f},{}),i=[];for(let[f,d]of Object.entries(s)){let h=this._processBatch(d,{apiUrl:f==="default"?void 0:f.split("|")[0],apiKey:f==="default"?void 0:f.split("|")[1]});i.push(h)}let a=Promise.all(i).finally(A);t.push(a)}return Promise.all(t)}async _processBatch(e,t){if(e.length)try{if(this.langSmithToOTELTranslator!==void 0)this._sendBatchToOTELTranslator(e);else{let n={runCreates:e.filter(s=>s.action==="create").map(s=>s.item),runUpdates:e.filter(s=>s.action==="update").map(s=>s.item)},A=await this._ensureServerInfo();if(A?.batch_ingest_config?.use_multipart_endpoint){let s=A?.instance_flags?.gzip_body_enabled;await this.multipartIngestRuns(n,{...t,useGzip:s})}else await this.batchIngestRuns(n,t)}}catch(n){console.error("Error exporting batch:",n)}}_sendBatchToOTELTranslator(e){if(this.langSmithToOTELTranslator!==void 0){let t=new Map,n=[];for(let A of e)A.item.id&&A.otelContext&&(t.set(A.item.id,A.otelContext),A.action==="create"?n.push({operation:"post",id:A.item.id,trace_id:A.item.trace_id??A.item.id,run:A.item}):n.push({operation:"patch",id:A.item.id,trace_id:A.item.trace_id??A.item.id,run:A.item}));this.langSmithToOTELTranslator.exportBatch(n,t)}}async processRunOperation(e){clearTimeout(this.autoBatchTimeout),this.autoBatchTimeout=void 0,e.item=KB(e.item);let t=this.autoBatchQueue.push(e);if(this.manualFlushMode)return t;let n=await this._getBatchSizeLimitBytes();return this.autoBatchQueue.sizeBytes>n&&this.drainAutoBatchQueue(n),this.autoBatchQueue.items.length>0&&(this.autoBatchTimeout=setTimeout(()=>{this.autoBatchTimeout=void 0,this.drainAutoBatchQueue(n)},this.autoBatchAggregationDelayMs)),t}async _getServerInfo(){let t=await(await this.caller.call(async()=>{let n=await this._fetch(`${this.apiUrl}/info`,{method:"GET",headers:{Accept:"application/json"},signal:AbortSignal.timeout(uk),...this.fetchOptions});return await le(n,"get server info"),n})).json();return this.debug&&console.log(`
=== LangSmith Server Configuration ===
`+JSON.stringify(t,null,2)+`
`),t}async _ensureServerInfo(){return this._getServerInfoPromise===void 0&&(this._getServerInfoPromise=(async()=>{if(this._serverInfo===void 0)try{this._serverInfo=await this._getServerInfo()}catch(e){console.warn(`[LANGSMITH]: Failed to fetch info on supported operations. Falling back to batch operations and default limits. Info: ${e.status??"Unspecified status code"} ${e.message}`)}return this._serverInfo??{}})()),this._getServerInfoPromise.then(e=>(this._serverInfo===void 0&&(this._getServerInfoPromise=void 0),e))}async _getSettings(){return this.settings||(this.settings=this._get("/settings")),await this.settings}async flush(){let e=await this._getBatchSizeLimitBytes();await this.drainAutoBatchQueue(e)}_cloneCurrentOTELContext(){let e=fl(),t=L_();if(this.langSmithToOTELTranslator!==void 0){let n=e.getActiveSpan();if(n)return e.setSpan(t.active(),n)}}async createRun(e,t){if(!this._filterForSampling([e]).length)return;let n={...this.headers,"Content-Type":"application/json"},A=e.project_name;delete e.project_name;let s=await this.prepareRunCreateOrUpdateInputs({session_name:A,...e,start_time:e.start_time??Date.now()});if(this.autoBatchTracing&&s.trace_id!==void 0&&s.dotted_order!==void 0){let f=this._cloneCurrentOTELContext();this.processRunOperation({action:"create",item:s,otelContext:f,apiKey:t?.apiKey,apiUrl:t?.apiUrl}).catch(console.error);return}let i=KB(s);t?.apiKey!==void 0&&(n["x-api-key"]=t.apiKey),t?.workspaceId!==void 0&&(n["x-tenant-id"]=t.workspaceId);let a=Br(i,`Creating run with id: ${i.id}`);await this.caller.call(async()=>{let f=await this._fetch(`${t?.apiUrl??this.apiUrl}/runs`,{method:"POST",headers:n,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:a});return await le(f,"create run",!0),f})}async batchIngestRuns({runCreates:e,runUpdates:t},n){if(e===void 0&&t===void 0)return;let A=await Promise.all(e?.map(f=>this.prepareRunCreateOrUpdateInputs(f))??[]),s=await Promise.all(t?.map(f=>this.prepareRunCreateOrUpdateInputs(f))??[]);if(A.length>0&&s.length>0){let f=A.reduce((h,m)=>(m.id&&(h[m.id]=m),h),{}),d=[];for(let h of s)h.id!==void 0&&f[h.id]?f[h.id]={...f[h.id],...h}:d.push(h);A=Object.values(f),s=d}let i={post:A,patch:s};if(!i.post.length&&!i.patch.length)return;let a={post:[],patch:[]};for(let f of["post","patch"]){let d=f,h=i[d].reverse(),m=h.pop();for(;m!==void 0;)a[d].push(m),m=h.pop()}if(a.post.length>0||a.patch.length>0){let f=a.post.map(d=>d.id).concat(a.patch.map(d=>d.id)).join(",");await this._postBatchIngestRuns(Br(a,`Ingesting runs with ids: ${f}`),n)}}async _postBatchIngestRuns(e,t){let n={...this.headers,"Content-Type":"application/json",Accept:"application/json"};t?.apiKey!==void 0&&(n["x-api-key"]=t.apiKey),await this.batchIngestCaller.call(async()=>{let A=await this._fetch(`${t?.apiUrl??this.apiUrl}/runs/batch`,{method:"POST",headers:n,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:e});return await le(A,"batch create run",!0),A})}async multipartIngestRuns({runCreates:e,runUpdates:t},n){if(e===void 0&&t===void 0)return;let A={},s=[];for(let m of e??[]){let y=await this.prepareRunCreateOrUpdateInputs(m);y.id!==void 0&&y.attachments!==void 0&&(A[y.id]=y.attachments),delete y.attachments,s.push(y)}let i=[];for(let m of t??[])i.push(await this.prepareRunCreateOrUpdateInputs(m));if(s.find(m=>m.trace_id===void 0||m.dotted_order===void 0)!==void 0)throw new Error('Multipart ingest requires "trace_id" and "dotted_order" to be set when creating a run');if(i.find(m=>m.trace_id===void 0||m.dotted_order===void 0)!==void 0)throw new Error('Multipart ingest requires "trace_id" and "dotted_order" to be set when updating a run');if(s.length>0&&i.length>0){let m=s.reduce((w,b)=>(b.id&&(w[b.id]=b),w),{}),y=[];for(let w of i)w.id!==void 0&&m[w.id]?m[w.id]={...m[w.id],...w}:y.push(w);s=Object.values(m),i=y}if(s.length===0&&i.length===0)return;let d=[],h=[];for(let[m,y]of[["post",s],["patch",i]])for(let w of y){let{inputs:b,outputs:C,events:I,extra:T,error:Q,serialized:P,attachments:R,...D}=w,ee={inputs:b,outputs:C,events:I,extra:T,error:Q,serialized:P},Y=Br(D,`Serializing for multipart ingestion of run with id: ${D.id}`);h.push({name:`${m}.${D.id}`,payload:new Blob([Y],{type:`application/json; length=${Y.length}`})});for(let[fe,ve]of Object.entries(ee)){if(ve===void 0)continue;let Ie=Br(ve,`Serializing ${fe} for multipart ingestion of run with id: ${D.id}`);h.push({name:`${m}.${D.id}.${fe}`,payload:new Blob([Ie],{type:`application/json; length=${Ie.length}`})})}if(D.id!==void 0){let fe=A[D.id];if(fe){delete A[D.id];for(let[ve,Ie]of Object.entries(fe)){let Te,_t;if(Array.isArray(Ie)?[Te,_t]=Ie:(Te=Ie.mimeType,_t=Ie.data),ve.includes(".")){console.warn(`Skipping attachment '${ve}' for run ${D.id}: Invalid attachment name. Attachment names must not contain periods ('.'). Please rename the attachment and try again.`);continue}h.push({name:`attachment.${D.id}.${ve}`,payload:new Blob([_t],{type:`${Te}; length=${_t.byteLength}`})})}}}d.push(`trace=${D.trace_id},id=${D.id}`)}await this._sendMultipartRequest(h,d.join("; "),n)}async _createNodeFetchBody(e,t){let n=[];for(let i of e)n.push(new Blob([`--${t}\r
`])),n.push(new Blob([`Content-Disposition: form-data; name="${i.name}"\r
`,`Content-Type: ${i.payload.type}\r
\r
`])),n.push(i.payload),n.push(new Blob([`\r
`]));return n.push(new Blob([`--${t}--\r
`])),await new Blob(n).arrayBuffer()}async _createMultipartStream(e,t){let n=new TextEncoder;return new ReadableStream({async start(s){let i=async a=>{typeof a=="string"?s.enqueue(n.encode(a)):s.enqueue(a)};for(let a of e){await i(`--${t}\r
`),await i(`Content-Disposition: form-data; name="${a.name}"\r
`),await i(`Content-Type: ${a.payload.type}\r
\r
`);let d=a.payload.stream().getReader();try{let h;for(;!(h=await d.read()).done;)s.enqueue(h.value)}finally{d.releaseLock()}await i(`\r
`)}await i(`--${t}--\r
`),s.close()}})}async _sendMultipartRequest(e,t,n){let A="----LangSmithFormBoundary"+Math.random().toString(36).slice(2),s=S_(),i=()=>this._createNodeFetchBody(e,A),a=()=>this._createMultipartStream(e,A),f=async d=>this.batchIngestCaller.call(async()=>{let h=await d(),m={...this.headers,"Content-Type":`multipart/form-data; boundary=${A}`};n?.apiKey!==void 0&&(m["x-api-key"]=n.apiKey);let y=h;n?.useGzip&&typeof h=="object"&&"pipeThrough"in h&&(y=h.pipeThrough(new CompressionStream("gzip")),m["Content-Encoding"]="gzip");let w=await this._fetch(`${n?.apiUrl??this.apiUrl}/runs/multipart`,{method:"POST",headers:m,body:y,duplex:"half",signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await le(w,"Failed to send multipart request",!0),w});try{let d,h=!1;!s&&!this.multipartStreamingDisabled&&Op()!=="bun"?(h=!0,d=await f(a)):d=await f(i),(!this.multipartStreamingDisabled||h)&&d.status===422&&(n?.apiUrl??this.apiUrl)!==GB&&(console.warn(`Streaming multipart upload to ${n?.apiUrl??this.apiUrl}/runs/multipart failed. This usually means the host does not support chunked uploads. Retrying with a buffered upload for operation "${t}".`),this.multipartStreamingDisabled=!0,d=await f(i))}catch(d){console.warn(`${d.message.trim()}

Context: ${t}`)}}async updateRun(e,t,n){Ue(e),t.inputs&&(t.inputs=await this.processInputs(t.inputs)),t.outputs&&(t.outputs=await this.processOutputs(t.outputs));let A={...t,id:e};if(!this._filterForSampling([A],!0).length)return;if(this.autoBatchTracing&&A.trace_id!==void 0&&A.dotted_order!==void 0){let a=this._cloneCurrentOTELContext();if(t.end_time!==void 0&&A.parent_run_id===void 0&&this.blockOnRootRunFinalization&&!this.manualFlushMode){await this.processRunOperation({action:"update",item:A,otelContext:a,apiKey:n?.apiKey,apiUrl:n?.apiUrl}).catch(console.error);return}else this.processRunOperation({action:"update",item:A,otelContext:a,apiKey:n?.apiKey,apiUrl:n?.apiUrl}).catch(console.error);return}let s={...this.headers,"Content-Type":"application/json"};n?.apiKey!==void 0&&(s["x-api-key"]=n.apiKey),n?.workspaceId!==void 0&&(s["x-tenant-id"]=n.workspaceId);let i=Br(t,`Serializing payload to update run with id: ${e}`);await this.caller.call(async()=>{let a=await this._fetch(`${n?.apiUrl??this.apiUrl}/runs/${e}`,{method:"PATCH",headers:s,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:i});return await le(a,"update run",!0),a})}async readRun(e,{loadChildRuns:t}={loadChildRuns:!1}){Ue(e);let n=await this._get(`/runs/${e}`);return t&&(n=await this._loadChildRuns(n)),n}async getRunUrl({runId:e,run:t,projectOpts:n}){if(t!==void 0){let A;t.session_id?A=t.session_id:n?.projectName?A=(await this.readProject({projectName:n?.projectName})).id:n?.projectId?A=n?.projectId:A=(await this.readProject({projectName:yt("PROJECT")||"default"})).id;let s=await this._getTenantId();return`${this.getHostUrl()}/o/${s}/projects/p/${A}/r/${t.id}?poll=true`}else if(e!==void 0){let A=await this.readRun(e);if(!A.app_path)throw new Error(`Run ${e} has no app_path`);return`${this.getHostUrl()}${A.app_path}`}else throw new Error("Must provide either runId or run")}async _loadChildRuns(e){let t=await ik(this.listRuns({isRoot:!1,projectId:e.session_id,traceId:e.trace_id})),n={},A={};t.sort((s,i)=>(s?.dotted_order??"").localeCompare(i?.dotted_order??""));for(let s of t){if(s.parent_run_id===null||s.parent_run_id===void 0)throw new Error(`Child run ${s.id} has no parent`);s.dotted_order?.startsWith(e.dotted_order??"")&&s.id!==e.id&&(s.parent_run_id in n||(n[s.parent_run_id]=[]),n[s.parent_run_id].push(s),A[s.id]=s)}e.child_runs=n[e.id]||[];for(let s in n)s!==e.id&&(A[s].child_runs=n[s]);return e}async*listRuns(e){let{projectId:t,projectName:n,parentRunId:A,traceId:s,referenceExampleId:i,startTime:a,executionOrder:f,isRoot:d,runType:h,error:m,id:y,query:w,filter:b,traceFilter:C,treeFilter:I,limit:T,select:Q,order:P}=e,R=[];if(t&&(R=Array.isArray(t)?t:[t]),n){let fe=Array.isArray(n)?n:[n],ve=await Promise.all(fe.map(Ie=>this.readProject({projectName:Ie}).then(Te=>Te.id)));R.push(...ve)}let D=["app_path","completion_cost","completion_tokens","dotted_order","end_time","error","events","extra","feedback_stats","first_token_time","id","inputs","name","outputs","parent_run_id","parent_run_ids","prompt_cost","prompt_tokens","reference_example_id","run_type","session_id","start_time","status","tags","total_cost","total_tokens","trace_id"],ee={session:R.length?R:null,run_type:h,reference_example:i,query:w,filter:b,trace_filter:C,tree_filter:I,execution_order:f,parent_run:A,start_time:a?a.toISOString():null,error:m,id:y,limit:T,trace:s,select:Q||D,is_root:d,order:P},Y=0;for await(let fe of this._getCursorPaginatedList("/runs/query",ee))if(T){if(Y>=T)break;if(fe.length+Y>T){yield*fe.slice(0,T-Y);break}Y+=fe.length,yield*fe}else yield*fe}async*listGroupRuns(e){let{projectId:t,projectName:n,groupBy:A,filter:s,startTime:i,endTime:a,limit:f,offset:d}=e,m={session_id:t||(await this.readProject({projectName:n})).id,group_by:A,filter:s,start_time:i?i.toISOString():null,end_time:a?a.toISOString():null,limit:Number(f)||100},y=Number(d)||0,w="/runs/group",b=`${this.apiUrl}${w}`;for(;;){let C={...m,offset:y},I=Object.fromEntries(Object.entries(C).filter(([ee,Y])=>Y!==void 0)),T=JSON.stringify(I),P=await(await this.caller.call(async()=>{let ee=await this._fetch(b,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:T});return await le(ee,`Failed to fetch ${w}`),ee})).json(),{groups:R,total:D}=P;if(R.length===0)break;for(let ee of R)yield ee;if(y+=R.length,y>=D)break}}async getRunStats({id:e,trace:t,parentRun:n,runType:A,projectNames:s,projectIds:i,referenceExampleIds:a,startTime:f,endTime:d,error:h,query:m,filter:y,traceFilter:w,treeFilter:b,isRoot:C,dataSourceType:I}){let T=i||[];s&&(T=[...i||[],...await Promise.all(s.map(Y=>this.readProject({projectName:Y}).then(fe=>fe.id)))]);let P=Object.fromEntries(Object.entries({id:e,trace:t,parent_run:n,run_type:A,session:T,reference_example:a,start_time:f,end_time:d,error:h,query:m,filter:y,trace_filter:w,tree_filter:b,is_root:C,data_source_type:I}).filter(([Y,fe])=>fe!==void 0)),R=JSON.stringify(P);return await(await this.caller.call(async()=>{let Y=await this._fetch(`${this.apiUrl}/runs/stats`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:R});return await le(Y,"get run stats"),Y})).json()}async shareRun(e,{shareId:t}={}){let n={run_id:e,share_token:t||ut()};Ue(e);let A=JSON.stringify(n),i=await(await this.caller.call(async()=>{let a=await this._fetch(`${this.apiUrl}/runs/${e}/share`,{method:"PUT",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:A});return await le(a,"share run"),a})).json();if(i===null||!("share_token"in i))throw new Error("Invalid response from server");return`${this.getHostUrl()}/public/${i.share_token}/r`}async unshareRun(e){Ue(e),await this.caller.call(async()=>{let t=await this._fetch(`${this.apiUrl}/runs/${e}/share`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await le(t,"unshare run",!0),t})}async readRunSharedLink(e){Ue(e);let n=await(await this.caller.call(async()=>{let A=await this._fetch(`${this.apiUrl}/runs/${e}/share`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await le(A,"read run shared link"),A})).json();if(!(n===null||!("share_token"in n)))return`${this.getHostUrl()}/public/${n.share_token}/r`}async listSharedRuns(e,{runIds:t}={}){let n=new URLSearchParams({share_token:e});if(t!==void 0)for(let i of t)n.append("id",i);return Ue(e),await(await this.caller.call(async()=>{let i=await this._fetch(`${this.apiUrl}/public/${e}/runs${n}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await le(i,"list shared runs"),i})).json()}async readDatasetSharedSchema(e,t){if(!e&&!t)throw new Error("Either datasetId or datasetName must be given");e||(e=(await this.readDataset({datasetName:t})).id),Ue(e);let A=await(await this.caller.call(async()=>{let s=await this._fetch(`${this.apiUrl}/datasets/${e}/share`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await le(s,"read dataset shared schema"),s})).json();return A.url=`${this.getHostUrl()}/public/${A.share_token}/d`,A}async shareDataset(e,t){if(!e&&!t)throw new Error("Either datasetId or datasetName must be given");e||(e=(await this.readDataset({datasetName:t})).id);let n={dataset_id:e};Ue(e);let A=JSON.stringify(n),i=await(await this.caller.call(async()=>{let a=await this._fetch(`${this.apiUrl}/datasets/${e}/share`,{method:"PUT",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:A});return await le(a,"share dataset"),a})).json();return i.url=`${this.getHostUrl()}/public/${i.share_token}/d`,i}async unshareDataset(e){Ue(e),await this.caller.call(async()=>{let t=await this._fetch(`${this.apiUrl}/datasets/${e}/share`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await le(t,"unshare dataset",!0),t})}async readSharedDataset(e){return Ue(e),await(await this.caller.call(async()=>{let A=await this._fetch(`${this.apiUrl}/public/${e}/datasets`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await le(A,"read shared dataset"),A})).json()}async listSharedExamples(e,t){let n={};t?.exampleIds&&(n.id=t.exampleIds);let A=new URLSearchParams;Object.entries(n).forEach(([a,f])=>{Array.isArray(f)?f.forEach(d=>A.append(a,d)):A.append(a,f)});let s=await this.caller.call(async()=>{let a=await this._fetch(`${this.apiUrl}/public/${e}/examples?${A.toString()}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await le(a,"list shared examples"),a}),i=await s.json();if(!s.ok)throw"detail"in i?new Error(`Failed to list shared examples.
Status: ${s.status}
Message: ${Array.isArray(i.detail)?i.detail.join(`
`):"Unspecified error"}`):new Error(`Failed to list shared examples: ${s.status} ${s.statusText}`);return i.map(a=>({...a,_hostUrl:this.getHostUrl()}))}async createProject({projectName:e,description:t=null,metadata:n=null,upsert:A=!1,projectExtra:s=null,referenceDatasetId:i=null}){let a=A?"?upsert=true":"",f=`${this.apiUrl}/sessions${a}`,d=s||{};n&&(d.metadata=n);let h={name:e,extra:d,description:t};i!==null&&(h.reference_dataset_id=i);let m=JSON.stringify(h);return await(await this.caller.call(async()=>{let b=await this._fetch(f,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:m});return await le(b,"create project"),b})).json()}async updateProject(e,{name:t=null,description:n=null,metadata:A=null,projectExtra:s=null,endTime:i=null}){let a=`${this.apiUrl}/sessions/${e}`,f=s;A&&(f={...f||{},metadata:A});let d=JSON.stringify({name:t,extra:f,description:n,end_time:i?new Date(i).toISOString():null});return await(await this.caller.call(async()=>{let y=await this._fetch(a,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:d});return await le(y,"update project"),y})).json()}async hasProject({projectId:e,projectName:t}){let n="/sessions",A=new URLSearchParams;if(e!==void 0&&t!==void 0)throw new Error("Must provide either projectName or projectId, not both");if(e!==void 0)Ue(e),n+=`/${e}`;else if(t!==void 0)A.append("name",t);else throw new Error("Must provide projectName or projectId");let s=await this.caller.call(async()=>{let i=await this._fetch(`${this.apiUrl}${n}?${A}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await le(i,"has project"),i});try{let i=await s.json();return s.ok?Array.isArray(i)?i.length>0:!0:!1}catch{return!1}}async readProject({projectId:e,projectName:t,includeStats:n}){let A="/sessions",s=new URLSearchParams;if(e!==void 0&&t!==void 0)throw new Error("Must provide either projectName or projectId, not both");if(e!==void 0)Ue(e),A+=`/${e}`;else if(t!==void 0)s.append("name",t);else throw new Error("Must provide projectName or projectId");n!==void 0&&s.append("include_stats",n.toString());let i=await this._get(A,s),a;if(Array.isArray(i)){if(i.length===0)throw new Error(`Project[id=${e}, name=${t}] not found`);a=i[0]}else a=i;return a}async getProjectUrl({projectId:e,projectName:t}){if(e===void 0&&t===void 0)throw new Error("Must provide either projectName or projectId");let n=await this.readProject({projectId:e,projectName:t}),A=await this._getTenantId();return`${this.getHostUrl()}/o/${A}/projects/p/${n.id}`}async getDatasetUrl({datasetId:e,datasetName:t}){if(e===void 0&&t===void 0)throw new Error("Must provide either datasetName or datasetId");let n=await this.readDataset({datasetId:e,datasetName:t}),A=await this._getTenantId();return`${this.getHostUrl()}/o/${A}/datasets/${n.id}`}async _getTenantId(){if(this._tenantId!==null)return this._tenantId;let e=new URLSearchParams({limit:"1"});for await(let t of this._getPaginated("/sessions",e))return this._tenantId=t[0].tenant_id,t[0].tenant_id;throw new Error("No projects found to resolve tenant.")}async*listProjects({projectIds:e,name:t,nameContains:n,referenceDatasetId:A,referenceDatasetName:s,includeStats:i,datasetVersion:a,referenceFree:f,metadata:d}={}){let h=new URLSearchParams;if(e!==void 0)for(let m of e)h.append("id",m);if(t!==void 0&&h.append("name",t),n!==void 0&&h.append("name_contains",n),A!==void 0)h.append("reference_dataset",A);else if(s!==void 0){let m=await this.readDataset({datasetName:s});h.append("reference_dataset",m.id)}i!==void 0&&h.append("include_stats",i.toString()),a!==void 0&&h.append("dataset_version",a),f!==void 0&&h.append("reference_free",f.toString()),d!==void 0&&h.append("metadata",JSON.stringify(d));for await(let m of this._getPaginated("/sessions",h))yield*m}async deleteProject({projectId:e,projectName:t}){let n;if(e===void 0&&t===void 0)throw new Error("Must provide projectName or projectId");if(e!==void 0&&t!==void 0)throw new Error("Must provide either projectName or projectId, not both");e===void 0?n=(await this.readProject({projectName:t})).id:n=e,Ue(n),await this.caller.call(async()=>{let A=await this._fetch(`${this.apiUrl}/sessions/${n}`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await le(A,`delete session ${n} (${t})`,!0),A})}async uploadCsv({csvFile:e,fileName:t,inputKeys:n,outputKeys:A,description:s,dataType:i,name:a}){let f=`${this.apiUrl}/datasets/upload`,d=new FormData;return d.append("file",e,t),n.forEach(y=>{d.append("input_keys",y)}),A.forEach(y=>{d.append("output_keys",y)}),s&&d.append("description",s),i&&d.append("data_type",i),a&&d.append("name",a),await(await this.caller.call(async()=>{let y=await this._fetch(f,{method:"POST",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:d});return await le(y,"upload CSV"),y})).json()}async createDataset(e,{description:t,dataType:n,inputsSchema:A,outputsSchema:s,metadata:i}={}){let a={name:e,description:t,extra:i?{metadata:i}:void 0};n&&(a.data_type=n),A&&(a.inputs_schema_definition=A),s&&(a.outputs_schema_definition=s);let f=JSON.stringify(a);return await(await this.caller.call(async()=>{let m=await this._fetch(`${this.apiUrl}/datasets`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:f});return await le(m,"create dataset"),m})).json()}async readDataset({datasetId:e,datasetName:t}){let n="/datasets",A=new URLSearchParams({limit:"1"});if(e&&t)throw new Error("Must provide either datasetName or datasetId, not both");if(e)Ue(e),n+=`/${e}`;else if(t)A.append("name",t);else throw new Error("Must provide datasetName or datasetId");let s=await this._get(n,A),i;if(Array.isArray(s)){if(s.length===0)throw new Error(`Dataset[id=${e}, name=${t}] not found`);i=s[0]}else i=s;return i}async hasDataset({datasetId:e,datasetName:t}){try{return await this.readDataset({datasetId:e,datasetName:t}),!0}catch(n){if(n instanceof Error&&n.message.toLocaleLowerCase().includes("not found"))return!1;throw n}}async diffDatasetVersions({datasetId:e,datasetName:t,fromVersion:n,toVersion:A}){let s=e;if(s===void 0&&t===void 0)throw new Error("Must provide either datasetName or datasetId");if(s!==void 0&&t!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");s===void 0&&(s=(await this.readDataset({datasetName:t})).id);let i=new URLSearchParams({from_version:typeof n=="string"?n:n.toISOString(),to_version:typeof A=="string"?A:A.toISOString()});return await this._get(`/datasets/${s}/versions/diff`,i)}async readDatasetOpenaiFinetuning({datasetId:e,datasetName:t}){let n="/datasets";if(e===void 0)if(t!==void 0)e=(await this.readDataset({datasetName:t})).id;else throw new Error("Must provide either datasetName or datasetId");return(await(await this._getResponse(`${n}/${e}/openai_ft`)).text()).trim().split(`
`).map(a=>JSON.parse(a))}async*listDatasets({limit:e=100,offset:t=0,datasetIds:n,datasetName:A,datasetNameContains:s,metadata:i}={}){let a="/datasets",f=new URLSearchParams({limit:e.toString(),offset:t.toString()});if(n!==void 0)for(let d of n)f.append("id",d);A!==void 0&&f.append("name",A),s!==void 0&&f.append("name_contains",s),i!==void 0&&f.append("metadata",JSON.stringify(i));for await(let d of this._getPaginated(a,f))yield*d}async updateDataset(e){let{datasetId:t,datasetName:n,...A}=e;if(!t&&!n)throw new Error("Must provide either datasetName or datasetId");let s=t??(await this.readDataset({datasetName:n})).id;Ue(s);let i=JSON.stringify(A);return await(await this.caller.call(async()=>{let f=await this._fetch(`${this.apiUrl}/datasets/${s}`,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:i});return await le(f,"update dataset"),f})).json()}async updateDatasetTag(e){let{datasetId:t,datasetName:n,asOf:A,tag:s}=e;if(!t&&!n)throw new Error("Must provide either datasetName or datasetId");let i=t??(await this.readDataset({datasetName:n})).id;Ue(i);let a=JSON.stringify({as_of:typeof A=="string"?A:A.toISOString(),tag:s});await this.caller.call(async()=>{let f=await this._fetch(`${this.apiUrl}/datasets/${i}/tags`,{method:"PUT",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:a});return await le(f,"update dataset tags",!0),f})}async deleteDataset({datasetId:e,datasetName:t}){let n="/datasets",A=e;if(e!==void 0&&t!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");if(t!==void 0&&(A=(await this.readDataset({datasetName:t})).id),A!==void 0)Ue(A),n+=`/${A}`;else throw new Error("Must provide datasetName or datasetId");await this.caller.call(async()=>{let s=await this._fetch(this.apiUrl+n,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await le(s,`delete ${n}`,!0),s})}async indexDataset({datasetId:e,datasetName:t,tag:n}){let A=e;if(!A&&!t)throw new Error("Must provide either datasetName or datasetId");if(A&&t)throw new Error("Must provide either datasetName or datasetId, not both");A||(A=(await this.readDataset({datasetName:t})).id),Ue(A);let i=JSON.stringify({tag:n});await(await this.caller.call(async()=>{let f=await this._fetch(`${this.apiUrl}/datasets/${A}/index`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:i});return await le(f,"index dataset"),f})).json()}async similarExamples(e,t,n,{filter:A}={}){let s={limit:n,inputs:e};A!==void 0&&(s.filter=A),Ue(t);let i=JSON.stringify(s);return(await(await this.caller.call(async()=>{let d=await this._fetch(`${this.apiUrl}/datasets/${t}/search`,{headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,method:"POST",body:i});return await le(d,"fetch similar examples"),d})).json()).examples}async createExample(e,t,n){if(VB(e)&&(t!==void 0||n!==void 0))throw new Error("Cannot provide outputs or options when using ExampleCreate object");let A=t?n?.datasetId:e.dataset_id,s=t?n?.datasetName:e.dataset_name;if(A===void 0&&s===void 0)throw new Error("Must provide either datasetName or datasetId");if(A!==void 0&&s!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");A===void 0&&(A=(await this.readDataset({datasetName:s})).id);let i=(t?n?.createdAt:e.created_at)||new Date,a;VB(e)?a=e:a={inputs:e,outputs:t,created_at:i?.toISOString(),id:n?.exampleId,metadata:n?.metadata,split:n?.split,source_run_id:n?.sourceRunId,use_source_run_io:n?.useSourceRunIO,use_source_run_attachments:n?.useSourceRunAttachments,attachments:n?.attachments};let f=await this._uploadExamplesMultipart(A,[a]);return await this.readExample(f.example_ids?.[0]??ut())}async createExamples(e){if(Array.isArray(e)){if(e.length===0)return[];let Q=e,P=Q[0].dataset_id,R=Q[0].dataset_name;if(P===void 0&&R===void 0)throw new Error("Must provide either datasetName or datasetId");if(P!==void 0&&R!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");P===void 0&&(P=(await this.readDataset({datasetName:R})).id);let D=await this._uploadExamplesMultipart(P,Q);return await Promise.all(D.example_ids.map(Y=>this.readExample(Y)))}let{inputs:t,outputs:n,metadata:A,splits:s,sourceRunIds:i,useSourceRunIOs:a,useSourceRunAttachments:f,attachments:d,exampleIds:h,datasetId:m,datasetName:y}=e;if(t===void 0)throw new Error("Must provide inputs when using legacy parameters");let w=m,b=y;if(w===void 0&&b===void 0)throw new Error("Must provide either datasetName or datasetId");if(w!==void 0&&b!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");w===void 0&&(w=(await this.readDataset({datasetName:b})).id);let C=t.map((Q,P)=>({dataset_id:w,inputs:Q,outputs:n?.[P],metadata:A?.[P],split:s?.[P],id:h?.[P],attachments:d?.[P],source_run_id:i?.[P],use_source_run_io:a?.[P],use_source_run_attachments:f?.[P]})),I=await this._uploadExamplesMultipart(w,C);return await Promise.all(I.example_ids.map(Q=>this.readExample(Q)))}async createLLMExample(e,t,n){return this.createExample({input:e},{output:t},n)}async createChatExample(e,t,n){let A=e.map(i=>Gp(i)?Vp(i):i),s=Gp(t)?Vp(t):t;return this.createExample({input:A},{output:s},n)}async readExample(e){Ue(e);let t=`/examples/${e}`,n=await this._get(t),{attachment_urls:A,...s}=n,i=s;return A&&(i.attachments=Object.entries(A).reduce((a,[f,d])=>(a[f.slice(11)]={presigned_url:d.presigned_url,mime_type:d.mime_type},a),{})),i}async*listExamples({datasetId:e,datasetName:t,exampleIds:n,asOf:A,splits:s,inlineS3Urls:i,metadata:a,limit:f,offset:d,filter:h,includeAttachments:m}={}){let y;if(e!==void 0&&t!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");if(e!==void 0)y=e;else if(t!==void 0)y=(await this.readDataset({datasetName:t})).id;else throw new Error("Must provide a datasetName or datasetId");let w=new URLSearchParams({dataset:y}),b=A?typeof A=="string"?A:A?.toISOString():void 0;b&&w.append("as_of",b);let C=i??!0;if(w.append("inline_s3_urls",C.toString()),n!==void 0)for(let T of n)w.append("id",T);if(s!==void 0)for(let T of s)w.append("splits",T);if(a!==void 0){let T=JSON.stringify(a);w.append("metadata",T)}f!==void 0&&w.append("limit",f.toString()),d!==void 0&&w.append("offset",d.toString()),h!==void 0&&w.append("filter",h),m===!0&&["attachment_urls","outputs","metadata"].forEach(T=>w.append("select",T));let I=0;for await(let T of this._getPaginated("/examples",w)){for(let Q of T){let{attachment_urls:P,...R}=Q,D=R;P&&(D.attachments=Object.entries(P).reduce((ee,[Y,fe])=>(ee[Y.slice(11)]={presigned_url:fe.presigned_url,mime_type:fe.mime_type||void 0},ee),{})),yield D,I++}if(f!==void 0&&I>=f)break}}async deleteExample(e){Ue(e);let t=`/examples/${e}`;await this.caller.call(async()=>{let n=await this._fetch(this.apiUrl+t,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await le(n,`delete ${t}`,!0),n})}async updateExample(e,t){let n;t?n=e:n=e.id,Ue(n);let A;t?A={id:n,...t}:A=e;let s;return A.dataset_id!==void 0?s=A.dataset_id:s=(await this.readExample(n)).dataset_id,this._updateExamplesMultipart(s,[A])}async updateExamples(e){let t;return e[0].dataset_id===void 0?t=(await this.readExample(e[0].id)).dataset_id:t=e[0].dataset_id,this._updateExamplesMultipart(t,e)}async readDatasetVersion({datasetId:e,datasetName:t,asOf:n,tag:A}){let s;if(e?s=e:s=(await this.readDataset({datasetName:t})).id,Ue(s),n&&A||!n&&!A)throw new Error("Exactly one of asOf and tag must be specified.");let i=new URLSearchParams;return n!==void 0&&i.append("as_of",typeof n=="string"?n:n.toISOString()),A!==void 0&&i.append("tag",A),await(await this.caller.call(async()=>{let f=await this._fetch(`${this.apiUrl}/datasets/${s}/version?${i.toString()}`,{method:"GET",headers:{...this.headers},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await le(f,"read dataset version"),f})).json()}async listDatasetSplits({datasetId:e,datasetName:t,asOf:n}){let A;if(e===void 0&&t===void 0)throw new Error("Must provide dataset name or ID");if(e!==void 0&&t!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");e===void 0?A=(await this.readDataset({datasetName:t})).id:A=e,Ue(A);let s=new URLSearchParams,i=n?typeof n=="string"?n:n?.toISOString():void 0;return i&&s.append("as_of",i),await this._get(`/datasets/${A}/splits`,s)}async updateDatasetSplits({datasetId:e,datasetName:t,splitName:n,exampleIds:A,remove:s=!1}){let i;if(e===void 0&&t===void 0)throw new Error("Must provide dataset name or ID");if(e!==void 0&&t!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");e===void 0?i=(await this.readDataset({datasetName:t})).id:i=e,Ue(i);let a={split_name:n,examples:A.map(d=>(Ue(d),d)),remove:s},f=JSON.stringify(a);await this.caller.call(async()=>{let d=await this._fetch(`${this.apiUrl}/datasets/${i}/splits`,{method:"PUT",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:f});return await le(d,"update dataset splits",!0),d})}async evaluateRun(e,t,{sourceInfo:n,loadChildRuns:A,referenceExample:s}={loadChildRuns:!1}){_l("This method is deprecated and will be removed in future LangSmith versions, use `evaluate` from `langsmith/evaluation` instead.");let i;if(typeof e=="string")i=await this.readRun(e,{loadChildRuns:A});else if(typeof e=="object"&&"id"in e)i=e;else throw new Error(`Invalid run type: ${typeof e}`);i.reference_example_id!==null&&i.reference_example_id!==void 0&&(s=await this.readExample(i.reference_example_id));let a=await t.evaluateRun(i,s),[f,d]=await this._logEvaluationFeedback(a,i,n);return d[0]}async createFeedback(e,t,{score:n,value:A,correction:s,comment:i,sourceInfo:a,feedbackSourceType:f="api",sourceRunId:d,feedbackId:h,feedbackConfig:m,projectId:y,comparativeExperimentId:w}){if(!e&&!y)throw new Error("One of runId or projectId must be provided");if(e&&y)throw new Error("Only one of runId or projectId can be provided");let b={type:f??"api",metadata:a??{}};d!==void 0&&b?.metadata!==void 0&&!b.metadata.__run&&(b.metadata.__run={run_id:d}),b?.metadata!==void 0&&b.metadata.__run?.run_id!==void 0&&Ue(b.metadata.__run.run_id);let C={id:h??ut(),run_id:e,key:t,score:zB(n),value:A,correction:s,comment:i,feedback_source:b,comparative_experiment_id:w,feedbackConfig:m,session_id:y},I=JSON.stringify(C),T=`${this.apiUrl}/feedback`;return await this.caller.call(async()=>{let Q=await this._fetch(T,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:I});return await le(Q,"create feedback",!0),Q}),C}async updateFeedback(e,{score:t,value:n,correction:A,comment:s}){let i={};t!=null&&(i.score=zB(t)),n!=null&&(i.value=n),A!=null&&(i.correction=A),s!=null&&(i.comment=s),Ue(e);let a=JSON.stringify(i);await this.caller.call(async()=>{let f=await this._fetch(`${this.apiUrl}/feedback/${e}`,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:a});return await le(f,"update feedback",!0),f})}async readFeedback(e){Ue(e);let t=`/feedback/${e}`;return await this._get(t)}async deleteFeedback(e){Ue(e);let t=`/feedback/${e}`;await this.caller.call(async()=>{let n=await this._fetch(this.apiUrl+t,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await le(n,`delete ${t}`,!0),n})}async*listFeedback({runIds:e,feedbackKeys:t,feedbackSourceTypes:n}={}){let A=new URLSearchParams;if(e)for(let s of e)Ue(s),A.append("run",s);if(t)for(let s of t)A.append("key",s);if(n)for(let s of n)A.append("source",s);for await(let s of this._getPaginated("/feedback",A))yield*s}async createPresignedFeedbackToken(e,t,{expiration:n,feedbackConfig:A}={}){let s={run_id:e,feedback_key:t,feedback_config:A};n?typeof n=="string"?s.expires_at=n:(n?.hours||n?.minutes||n?.days)&&(s.expires_in=n):s.expires_in={hours:3};let i=JSON.stringify(s);return await(await this.caller.call(async()=>{let f=await this._fetch(`${this.apiUrl}/feedback/tokens`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:i});return await le(f,"create presigned feedback token"),f})).json()}async createComparativeExperiment({name:e,experimentIds:t,referenceDatasetId:n,createdAt:A,description:s,metadata:i,id:a}){if(t.length===0)throw new Error("At least one experiment is required");if(n||(n=(await this.readProject({projectId:t[0]})).reference_dataset_id),!n==null)throw new Error("A reference dataset is required");let f={id:a,name:e,experiment_ids:t,reference_dataset_id:n,description:s,created_at:(A??new Date)?.toISOString(),extra:{}};i&&(f.extra.metadata=i);let d=JSON.stringify(f);return(await this.caller.call(async()=>{let m=await this._fetch(`${this.apiUrl}/datasets/comparative`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:d});return await le(m,"create comparative experiment"),m})).json()}async*listPresignedFeedbackTokens(e){Ue(e);let t=new URLSearchParams({run_id:e});for await(let n of this._getPaginated("/feedback/tokens",t))yield*n}_selectEvalResults(e){let t;return"results"in e?t=e.results:Array.isArray(e)?t=e:t=[e],t}async _logEvaluationFeedback(e,t,n){let A=this._selectEvalResults(e),s=[];for(let i of A){let a=n||{};i.evaluatorInfo&&(a={...i.evaluatorInfo,...a});let f=null;i.targetRunId?f=i.targetRunId:t&&(f=t.id),s.push(await this.createFeedback(f,i.key,{score:i.score,value:i.value,comment:i.comment,correction:i.correction,sourceInfo:a,sourceRunId:i.sourceRunId,feedbackConfig:i.feedbackConfig,feedbackSourceType:"model"}))}return[A,s]}async logEvaluationFeedback(e,t,n){let[A]=await this._logEvaluationFeedback(e,t,n);return A}async*listAnnotationQueues(e={}){let{queueIds:t,name:n,nameContains:A,limit:s}=e,i=new URLSearchParams;t&&t.forEach((f,d)=>{Ue(f,`queueIds[${d}]`),i.append("ids",f)}),n&&i.append("name",n),A&&i.append("name_contains",A),i.append("limit",(s!==void 0?Math.min(s,100):100).toString());let a=0;for await(let f of this._getPaginated("/annotation-queues",i))if(yield*f,a++,s!==void 0&&a>=s)break}async createAnnotationQueue(e){let{name:t,description:n,queueId:A,rubricInstructions:s}=e,i={name:t,description:n,id:A||ut(),rubric_instructions:s},a=JSON.stringify(Object.fromEntries(Object.entries(i).filter(([d,h])=>h!==void 0)));return(await this.caller.call(async()=>{let d=await this._fetch(`${this.apiUrl}/annotation-queues`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:a});return await le(d,"create annotation queue"),d})).json()}async readAnnotationQueue(e){return(await this.caller.call(async()=>{let n=await this._fetch(`${this.apiUrl}/annotation-queues/${Ue(e,"queueId")}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await le(n,"read annotation queue"),n})).json()}async updateAnnotationQueue(e,t){let{name:n,description:A,rubricInstructions:s}=t,i=JSON.stringify({name:n,description:A,rubric_instructions:s});await this.caller.call(async()=>{let a=await this._fetch(`${this.apiUrl}/annotation-queues/${Ue(e,"queueId")}`,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:i});return await le(a,"update annotation queue",!0),a})}async deleteAnnotationQueue(e){await this.caller.call(async()=>{let t=await this._fetch(`${this.apiUrl}/annotation-queues/${Ue(e,"queueId")}`,{method:"DELETE",headers:{...this.headers,Accept:"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await le(t,"delete annotation queue",!0),t})}async addRunsToAnnotationQueue(e,t){let n=JSON.stringify(t.map((A,s)=>Ue(A,`runIds[${s}]`).toString()));await this.caller.call(async()=>{let A=await this._fetch(`${this.apiUrl}/annotation-queues/${Ue(e,"queueId")}/runs`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:n});return await le(A,"add runs to annotation queue",!0),A})}async getRunFromAnnotationQueue(e,t){let n=`/annotation-queues/${Ue(e,"queueId")}/run`;return(await this.caller.call(async()=>{let s=await this._fetch(`${this.apiUrl}${n}/${t}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await le(s,"get run from annotation queue"),s})).json()}async deleteRunFromAnnotationQueue(e,t){await this.caller.call(async()=>{let n=await this._fetch(`${this.apiUrl}/annotation-queues/${Ue(e,"queueId")}/runs/${Ue(t,"queueRunId")}`,{method:"DELETE",headers:{...this.headers,Accept:"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await le(n,"delete run from annotation queue",!0),n})}async getSizeFromAnnotationQueue(e){return(await this.caller.call(async()=>{let n=await this._fetch(`${this.apiUrl}/annotation-queues/${Ue(e,"queueId")}/size`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await le(n,"get size from annotation queue"),n})).json()}async _currentTenantIsOwner(e){let t=await this._getSettings();return e=="-"||t.tenant_handle===e}async _ownerConflictError(e,t){let n=await this._getSettings();return new Error(`Cannot ${e} for another tenant.

      Current tenant: ${n.tenant_handle}

      Requested tenant: ${t}`)}async _getLatestCommitHash(e){let n=await(await this.caller.call(async()=>{let A=await this._fetch(`${this.apiUrl}/commits/${e}/?limit=1&offset=0`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await le(A,"get latest commit hash"),A})).json();if(n.commits.length!==0)return n.commits[0].commit_hash}async _likeOrUnlikePrompt(e,t){let[n,A,s]=mA(e),i=JSON.stringify({like:t});return(await this.caller.call(async()=>{let f=await this._fetch(`${this.apiUrl}/likes/${n}/${A}`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:i});return await le(f,`${t?"like":"unlike"} prompt`),f})).json()}async _getPromptUrl(e){let[t,n,A]=mA(e);if(await this._currentTenantIsOwner(t)){let s=await this._getSettings();return A!=="latest"?`${this.getHostUrl()}/prompts/${n}/${A.substring(0,8)}?organizationId=${s.id}`:`${this.getHostUrl()}/prompts/${n}?organizationId=${s.id}`}else return A!=="latest"?`${this.getHostUrl()}/hub/${t}/${n}/${A.substring(0,8)}`:`${this.getHostUrl()}/hub/${t}/${n}`}async promptExists(e){return!!await this.getPrompt(e)}async likePrompt(e){return this._likeOrUnlikePrompt(e,!0)}async unlikePrompt(e){return this._likeOrUnlikePrompt(e,!1)}async*listCommits(e){for await(let t of this._getPaginated(`/commits/${e}/`,new URLSearchParams,n=>n.commits))yield*t}async*listPrompts(e){let t=new URLSearchParams;t.append("sort_field",e?.sortField??"updated_at"),t.append("sort_direction","desc"),t.append("is_archived",(!!e?.isArchived).toString()),e?.isPublic!==void 0&&t.append("is_public",e.isPublic.toString()),e?.query&&t.append("query",e.query);for await(let n of this._getPaginated("/repos",t,A=>A.repos))yield*n}async getPrompt(e){let[t,n,A]=mA(e),i=await(await this.caller.call(async()=>{let a=await this._fetch(`${this.apiUrl}/repos/${t}/${n}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return a?.status===404?null:(await le(a,"get prompt"),a)}))?.json();return i?.repo?i.repo:null}async createPrompt(e,t){let n=await this._getSettings();if(t?.isPublic&&!n.tenant_handle)throw new Error(`Cannot create a public prompt without first

        creating a LangChain Hub handle.
        You can add a handle by creating a public prompt at:

        https://smith.langchain.com/prompts`);let[A,s,i]=mA(e);if(!await this._currentTenantIsOwner(A))throw await this._ownerConflictError("create a prompt",A);let a={repo_handle:s,...t?.description&&{description:t.description},...t?.readme&&{readme:t.readme},...t?.tags&&{tags:t.tags},is_public:!!t?.isPublic},f=JSON.stringify(a),d=await this.caller.call(async()=>{let m=await this._fetch(`${this.apiUrl}/repos/`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:f});return await le(m,"create prompt"),m}),{repo:h}=await d.json();return h}async createCommit(e,t,n){if(!await this.promptExists(e))throw new Error("Prompt does not exist, you must create it first.");let[A,s,i]=mA(e),a=n?.parentCommitHash==="latest"||!n?.parentCommitHash?await this._getLatestCommitHash(`${A}/${s}`):n?.parentCommitHash,f={manifest:JSON.parse(JSON.stringify(t)),parent_commit:a},d=JSON.stringify(f),m=await(await this.caller.call(async()=>{let y=await this._fetch(`${this.apiUrl}/commits/${A}/${s}`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:d});return await le(y,"create commit"),y})).json();return this._getPromptUrl(`${A}/${s}${m.commit_hash?`:${m.commit_hash}`:""}`)}async updateExamplesMultipart(e,t=[]){return this._updateExamplesMultipart(e,t)}async _updateExamplesMultipart(e,t=[]){if(!await this._getDatasetExamplesMultiPartSupport())throw new Error("Your LangSmith deployment does not allow using the multipart examples endpoint, please upgrade your deployment to the latest version.");let n=new FormData;for(let i of t){let a=i.id,f={...i.metadata&&{metadata:i.metadata},...i.split&&{split:i.split}},d=Br(f,`Serializing body for example with id: ${a}`),h=new Blob([d],{type:"application/json"});if(n.append(a,h),i.inputs){let m=Br(i.inputs,`Serializing inputs for example with id: ${a}`),y=new Blob([m],{type:"application/json"});n.append(`${a}.inputs`,y)}if(i.outputs){let m=Br(i.outputs,`Serializing outputs whle updating example with id: ${a}`),y=new Blob([m],{type:"application/json"});n.append(`${a}.outputs`,y)}if(i.attachments)for(let[m,y]of Object.entries(i.attachments)){let w,b;Array.isArray(y)?[w,b]=y:(w=y.mimeType,b=y.data);let C=new Blob([b],{type:`${w}; length=${b.byteLength}`});n.append(`${a}.attachment.${m}`,C)}if(i.attachments_operations){let m=Br(i.attachments_operations,`Serializing attachments while updating example with id: ${a}`),y=new Blob([m],{type:"application/json"});n.append(`${a}.attachments_operations`,y)}}let A=e??t[0]?.dataset_id;return(await this.caller.call(async()=>{let i=await this._fetch(`${this.apiUrl}${this._getPlatformEndpointPath(`datasets/${A}/examples`)}`,{method:"PATCH",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:n});return await le(i,"update examples"),i})).json()}async uploadExamplesMultipart(e,t=[]){return this._uploadExamplesMultipart(e,t)}async _uploadExamplesMultipart(e,t=[]){if(!await this._getDatasetExamplesMultiPartSupport())throw new Error("Your LangSmith deployment does not allow using the multipart examples endpoint, please upgrade your deployment to the latest version.");let n=new FormData;for(let s of t){let i=(s.id??ut()).toString(),a={created_at:s.created_at,...s.metadata&&{metadata:s.metadata},...s.split&&{split:s.split},...s.source_run_id&&{source_run_id:s.source_run_id},...s.use_source_run_io&&{use_source_run_io:s.use_source_run_io},...s.use_source_run_attachments&&{use_source_run_attachments:s.use_source_run_attachments}},f=Br(a,`Serializing body for uploaded example with id: ${i}`),d=new Blob([f],{type:"application/json"});if(n.append(i,d),s.inputs){let h=Br(s.inputs,`Serializing inputs for uploaded example with id: ${i}`),m=new Blob([h],{type:"application/json"});n.append(`${i}.inputs`,m)}if(s.outputs){let h=Br(s.outputs,`Serializing outputs for uploaded example with id: ${i}`),m=new Blob([h],{type:"application/json"});n.append(`${i}.outputs`,m)}if(s.attachments)for(let[h,m]of Object.entries(s.attachments)){let y,w;Array.isArray(m)?[y,w]=m:(y=m.mimeType,w=m.data);let b=new Blob([w],{type:`${y}; length=${w.byteLength}`});n.append(`${i}.attachment.${h}`,b)}}return(await this.caller.call(async()=>{let s=await this._fetch(`${this.apiUrl}${this._getPlatformEndpointPath(`datasets/${e}/examples`)}`,{method:"POST",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:n});return await le(s,"upload examples"),s})).json()}async updatePrompt(e,t){if(!await this.promptExists(e))throw new Error("Prompt does not exist, you must create it first.");let[n,A]=mA(e);if(!await this._currentTenantIsOwner(n))throw await this._ownerConflictError("update a prompt",n);let s={};if(t?.description!==void 0&&(s.description=t.description),t?.readme!==void 0&&(s.readme=t.readme),t?.tags!==void 0&&(s.tags=t.tags),t?.isPublic!==void 0&&(s.is_public=t.isPublic),t?.isArchived!==void 0&&(s.is_archived=t.isArchived),Object.keys(s).length===0)throw new Error("No valid update options provided");let i=JSON.stringify(s);return(await this.caller.call(async()=>{let f=await this._fetch(`${this.apiUrl}/repos/${n}/${A}`,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:i});return await le(f,"update prompt"),f})).json()}async deletePrompt(e){if(!await this.promptExists(e))throw new Error("Prompt does not exist, you must create it first.");let[t,n,A]=mA(e);if(!await this._currentTenantIsOwner(t))throw await this._ownerConflictError("delete a prompt",t);return(await this.caller.call(async()=>{let i=await this._fetch(`${this.apiUrl}/repos/${t}/${n}`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await le(i,"delete prompt"),i})).json()}async pullPromptCommit(e,t){let[n,A,s]=mA(e),a=await(await this.caller.call(async()=>{let f=await this._fetch(`${this.apiUrl}/commits/${n}/${A}/${s}${t?.includeModel?"?include_model=true":""}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await le(f,"pull prompt commit"),f})).json();return{owner:n,repo:A,commit_hash:a.commit_hash,manifest:a.manifest,examples:a.examples}}async _pullPrompt(e,t){let n=await this.pullPromptCommit(e,{includeModel:t?.includeModel});return JSON.stringify(n.manifest)}async pushPrompt(e,t){return await this.promptExists(e)?t&&Object.keys(t).some(A=>A!=="object")&&await this.updatePrompt(e,{description:t?.description,readme:t?.readme,tags:t?.tags,isPublic:t?.isPublic}):await this.createPrompt(e,{description:t?.description,readme:t?.readme,tags:t?.tags,isPublic:t?.isPublic}),t?.object?await this.createCommit(e,t?.object,{parentCommitHash:t?.parentCommitHash}):await this._getPromptUrl(e)}async clonePublicDataset(e,t={}){let{sourceApiUrl:n=this.apiUrl,datasetName:A}=t,[s,i]=this.parseTokenOrUrl(e,n),a=new r({apiUrl:s,apiKey:"placeholder"}),f=await a.readSharedDataset(i),d=A||f.name;try{if(await this.hasDataset({datasetId:d})){console.log(`Dataset ${d} already exists in your tenant. Skipping.`);return}}catch{}let h=await a.listSharedExamples(i),m=await this.createDataset(d,{description:f.description,dataType:f.data_type||"kv",inputsSchema:f.inputs_schema_definition??void 0,outputsSchema:f.outputs_schema_definition??void 0});try{await this.createExamples({inputs:h.map(y=>y.inputs),outputs:h.flatMap(y=>y.outputs?[y.outputs]:[]),datasetId:m.id})}catch(y){throw console.error(`An error occurred while creating dataset ${d}. You should delete it manually.`),y}}parseTokenOrUrl(e,t,n=2,A="dataset"){try{return Ue(e),[t,e]}catch{}try{let i=new URL(e).pathname.split("/").filter(a=>a!=="");if(i.length>=n){let a=i[i.length-n];return[t,a]}else throw new Error(`Invalid public ${A} URL: ${e}`)}catch{throw new Error(`Invalid public ${A} URL or token: ${e}`)}}async awaitPendingTraceBatches(){if(this.manualFlushMode)return console.warn("[WARNING]: When tracing in manual flush mode, you must call `await client.flush()` manually to submit trace batches."),Promise.resolve();await Promise.all([...this.autoBatchQueue.items.map(({itemPromise:e})=>e),this.batchIngestCaller.queue.onIdle()]),this.langSmithToOTELTranslator!==void 0&&await H_()?.DEFAULT_LANGSMITH_SPAN_PROCESSOR?.forceFlush()}};function VB(r){return"dataset_id"in r||"dataset_name"in r}var ZB=r=>r!==void 0?r:!!["TRACING_V2","TRACING"].find(t=>yt(t)==="true");var Nl=Symbol.for("lc:context_variables");function ck(r){return r.replace(/[-:.]/g,"")}function mh(r,e,t=1){let n=t.toFixed(0).slice(0,3).padStart(3,"0"),A=`${new Date(r).toISOString().slice(0,-1)}${n}Z`;return{dottedOrder:ck(A)+e,microsecondPrecisionDatestring:A}}var Ll=class r{constructor(e,t,n,A){Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"project_name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"replicas",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.metadata=e,this.tags=t,this.project_name=n,this.replicas=A}static fromHeader(e){let t=e.split(","),n={},A=[],s,i;for(let a of t){let[f,d]=a.split("="),h=decodeURIComponent(d);f==="langsmith-metadata"?n=JSON.parse(h):f==="langsmith-tags"?A=h.split(","):f==="langsmith-project"?s=h:f==="langsmith-replicas"&&(i=JSON.parse(h))}return new r(n,A,s,i)}toHeader(){let e=[];return this.metadata&&Object.keys(this.metadata).length>0&&e.push(`langsmith-metadata=${encodeURIComponent(JSON.stringify(this.metadata))}`),this.tags&&this.tags.length>0&&e.push(`langsmith-tags=${encodeURIComponent(this.tags.join(","))}`),this.project_name&&e.push(`langsmith-project=${encodeURIComponent(this.project_name)}`),e.join(",")}},cn=class r{constructor(e){if(Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"run_type",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"project_name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"parent_run",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"parent_run_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"child_runs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"start_time",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"end_time",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"extra",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"error",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"serialized",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"inputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"outputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"reference_example_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"events",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"trace_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"dotted_order",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tracingEnabled",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"execution_order",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"child_execution_order",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"attachments",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"replicas",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_serialized_start_time",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),WB(e)){Object.assign(this,{...e});return}let t=r.getDefaultConfig(),{metadata:n,...A}=e,s=A.client??r.getSharedClient(),i={...n,...A?.extra?.metadata};if(A.extra={...A.extra,metadata:i},Object.assign(this,{...t,...A,client:s}),this.trace_id||(this.parent_run?this.trace_id=this.parent_run.trace_id??this.id:this.trace_id=this.id),this.replicas=hk(this.replicas),this.execution_order??(this.execution_order=1),this.child_execution_order??(this.child_execution_order=1),!this.dotted_order){let{dottedOrder:a,microsecondPrecisionDatestring:f}=mh(this.start_time,this.id,this.execution_order);this.parent_run?this.dotted_order=this.parent_run.dotted_order+"."+a:this.dotted_order=a,this._serialized_start_time=f}}set metadata(e){this.extra={...this.extra,metadata:{...this.extra?.metadata,...e}}}get metadata(){return this.extra?.metadata}static getDefaultConfig(){return{id:ut(),run_type:"chain",project_name:Go(),child_runs:[],api_url:Rr("LANGCHAIN_ENDPOINT")??"http://localhost:1984",api_key:Rr("LANGCHAIN_API_KEY"),caller_options:{},start_time:Date.now(),serialized:{},inputs:{},extra:{}}}static getSharedClient(){return r.sharedClient||(r.sharedClient=new di),r.sharedClient}createChild(e){let t=this.child_execution_order+1,n=new r({...e,parent_run:this,project_name:this.project_name,replicas:this.replicas,client:this.client,tracingEnabled:this.tracingEnabled,execution_order:t,child_execution_order:t});Nl in this&&(n[Nl]=this[Nl]);let A=Symbol.for("lc:child_config"),s=e.extra?.[A]??this.extra[A];if(fk(s)){let f={...s},d=lk(f.callbacks)?f.callbacks.copy?.():void 0;d&&(Object.assign(d,{_parentRunId:n.id}),d.handlers?.find(qB)?.updateFromRunTree?.(n),f.callbacks=d),n.extra[A]=f}let i=new Set,a=this;for(;a!=null&&!i.has(a.id);)i.add(a.id),a.child_execution_order=Math.max(a.child_execution_order,t),a=a.parent_run;return this.child_runs.push(n),n}async end(e,t,n=Date.now(),A){this.outputs=this.outputs??e,this.error=this.error??t,this.end_time=this.end_time??n,A&&Object.keys(A).length>0&&(this.extra=this.extra?{...this.extra,metadata:{...this.extra.metadata,...A}}:{metadata:A})}_convertToCreate(e,t,n=!0){let A=e.extra??{};if(A?.runtime?.library===void 0&&(A.runtime||(A.runtime={}),t))for(let[a,f]of Object.entries(t))A.runtime[a]||(A.runtime[a]=f);let s,i;return n?(i=e.parent_run?.id??e.parent_run_id,s=[]):(s=e.child_runs.map(a=>this._convertToCreate(a,t,n)),i=void 0),{id:e.id,name:e.name,start_time:e._serialized_start_time??e.start_time,end_time:e.end_time,run_type:e.run_type,reference_example_id:e.reference_example_id,extra:A,serialized:e.serialized,error:e.error,inputs:e.inputs,outputs:e.outputs,session_name:e.project_name,child_runs:s,parent_run_id:i,trace_id:e.trace_id,dotted_order:e.dotted_order,tags:e.tags,attachments:e.attachments,events:e.events}}_remapForProject(e,t,n=!0){let A=this._convertToCreate(this,t,n);if(e===this.project_name)return A;let s=m=>el(`${m}:${e}`,el.DNS),i=s(A.id),a=A.trace_id?s(A.trace_id):void 0,f=A.parent_run_id?s(A.parent_run_id):void 0,d;if(A.dotted_order){let m=dk(A.dotted_order),y=[];for(let b=0;b<m.length-1;b++){let[C,I]=m[b],T=s(I);y.push(C.toISOString().replace(/[-:]/g,"").replace(".","")+T)}let[w]=m[m.length-1];y.push(w.toISOString().replace(/[-:]/g,"").replace(".","")+i),d=y.join(".")}else d=void 0;return{...A,id:i,trace_id:a,parent_run_id:f,dotted_order:d,session_name:e}}async postRun(e=!0){try{let t=cl();if(this.replicas&&this.replicas.length>0)for(let{projectName:n,apiKey:A,apiUrl:s,workspaceId:i}of this.replicas){let a=this._remapForProject(n??this.project_name,t,!0);await this.client.createRun(a,{apiKey:A,apiUrl:s,workspaceId:i})}else{let n=this._convertToCreate(this,t,e);await this.client.createRun(n)}if(!e){_l("Posting with excludeChildRuns=false is deprecated and will be removed in a future version.");for(let n of this.child_runs)await n.postRun(!1)}}catch(t){console.error(`Error in postRun for run ${this.id}:`,t)}}async patchRun(e){if(this.replicas&&this.replicas.length>0)for(let{projectName:t,apiKey:n,apiUrl:A,workspaceId:s,updates:i}of this.replicas){let a=this._remapForProject(t??this.project_name),f={id:a.id,outputs:a.outputs,error:a.error,parent_run_id:a.parent_run_id,session_name:a.session_name,reference_example_id:a.reference_example_id,end_time:a.end_time,dotted_order:a.dotted_order,trace_id:a.trace_id,events:a.events,tags:a.tags,extra:a.extra,attachments:this.attachments,...i};e?.excludeInputs||(f.inputs=a.inputs),await this.client.updateRun(a.id,f,{apiKey:n,apiUrl:A,workspaceId:s})}else try{let t={end_time:this.end_time,error:this.error,outputs:this.outputs,parent_run_id:this.parent_run?.id??this.parent_run_id,reference_example_id:this.reference_example_id,extra:this.extra,events:this.events,dotted_order:this.dotted_order,trace_id:this.trace_id,tags:this.tags,attachments:this.attachments,session_name:this.project_name};e?.excludeInputs||(t.inputs=this.inputs),await this.client.updateRun(this.id,t)}catch(t){console.error(`Error in patchRun for run ${this.id}`,t)}}toJSON(){return this._convertToCreate(this,void 0,!1)}addEvent(e){this.events||(this.events=[]),typeof e=="string"?this.events.push({name:"event",time:new Date().toISOString(),message:e}):this.events.push({...e,time:e.time??new Date().toISOString()})}static fromRunnableConfig(e,t){let n=e?.callbacks,A,s,i,a=ZB();if(n){let d=n?.getParentRunId?.()??"",h=n?.handlers?.find(m=>m?.name=="langchain_tracer");A=h?.getRun?.(d),s=h?.projectName,i=h?.client,a=a||!!h}return A?new r({name:A.name,id:A.id,trace_id:A.trace_id,dotted_order:A.dotted_order,client:i,tracingEnabled:a,project_name:s,tags:[...new Set((A?.tags??[]).concat(e?.tags??[]))],extra:{metadata:{...A?.extra?.metadata,...e?.metadata}}}).createChild(t):new r({...t,client:i,tracingEnabled:a,project_name:s})}static fromDottedOrder(e){return this.fromHeaders({"langsmith-trace":e})}static fromHeaders(e,t){let n="get"in e&&typeof e.get=="function"?{"langsmith-trace":e.get("langsmith-trace"),baggage:e.get("baggage")}:e,A=n["langsmith-trace"];if(!A||typeof A!="string")return;let s=A.trim(),i=s.split(".").map(d=>{let[h,m]=d.split("Z");return{strTime:h,time:Date.parse(h+"Z"),uuid:m}}),a=i[0].uuid,f={...t,name:t?.name??"parent",run_type:t?.run_type??"chain",start_time:t?.start_time??Date.now(),id:i.at(-1)?.uuid,trace_id:a,dotted_order:s};if(n.baggage&&typeof n.baggage=="string"){let d=Ll.fromHeader(n.baggage);f.metadata=d.metadata,f.tags=d.tags,f.project_name=d.project_name,f.replicas=d.replicas}return new r(f)}toHeaders(e){let t={"langsmith-trace":this.dotted_order,baggage:new Ll(this.extra?.metadata,this.tags,this.project_name,this.replicas).toHeader()};if(e)for(let[n,A]of Object.entries(t))e.set(n,A);return t}};Object.defineProperty(cn,"sharedClient",{enumerable:!0,configurable:!0,writable:!0,value:null});function WB(r){return r!=null&&typeof r.createChild=="function"&&typeof r.postRun=="function"}function qB(r){return typeof r=="object"&&r!=null&&typeof r.name=="string"&&r.name==="langchain_tracer"}function JB(r){return Array.isArray(r)&&r.some(e=>qB(e))}function lk(r){return typeof r=="object"&&r!=null&&Array.isArray(r.handlers)}function fk(r){return r!=null&&typeof r.callbacks=="object"&&(JB(r.callbacks?.handlers)||JB(r.callbacks))}function dk(r){return r.split(".").map(t=>{let n=t.slice(0,-36),A=t.slice(-36),s=parseInt(n.slice(0,4)),i=parseInt(n.slice(4,6))-1,a=parseInt(n.slice(6,8)),f=parseInt(n.slice(9,11)),d=parseInt(n.slice(11,13)),h=parseInt(n.slice(13,15)),m=parseInt(n.slice(15,21));return[new Date(s,i,a,f,d,h,m/1e3),A]})}function pk(){let r=Rr("LANGSMITH_RUNS_ENDPOINTS");if(!r)return[];try{let e=JSON.parse(r);if(Array.isArray(e)){let t=[];for(let n of e){if(typeof n!="object"||n===null){console.warn(`Invalid item type in LANGSMITH_RUNS_ENDPOINTS: expected object, got ${typeof n}`);continue}if(typeof n.api_url!="string"){console.warn(`Invalid api_url type in LANGSMITH_RUNS_ENDPOINTS: expected string, got ${typeof n.api_url}`);continue}if(typeof n.api_key!="string"){console.warn(`Invalid api_key type in LANGSMITH_RUNS_ENDPOINTS: expected string, got ${typeof n.api_key}`);continue}t.push({apiUrl:n.api_url.replace(/\/$/,""),apiKey:n.api_key})}return t}else if(typeof e=="object"&&e!==null){mk(e);let t=[];for(let[n,A]of Object.entries(e)){let s=n.replace(/\/$/,"");if(typeof A=="string")t.push({apiUrl:s,apiKey:A});else{console.warn(`Invalid value type in LANGSMITH_RUNS_ENDPOINTS for URL ${n}: expected string, got ${typeof A}`);continue}}return t}else return console.warn(`Invalid LANGSMITH_RUNS_ENDPOINTS \u2013 must be valid JSON array of objects with api_url and api_key properties, or object mapping url->apiKey, got ${typeof e}`),[]}catch(e){if(MB(e))throw e;return console.warn("Invalid LANGSMITH_RUNS_ENDPOINTS \u2013 must be valid JSON array of objects with api_url and api_key properties, or object mapping url->apiKey"),[]}}function hk(r){return r?r.map(e=>Array.isArray(e)?{projectName:e[0],updates:e[1]}:e):pk()}function mk(r){if(Object.keys(r).length>0&&yt("ENDPOINT"))throw new Sl}var gk=()=>typeof window<"u"&&typeof window.document<"u",wk=()=>typeof globalThis=="object"&&globalThis.constructor&&globalThis.constructor.name==="DedicatedWorkerGlobalScope",yk=()=>typeof window<"u"&&window.name==="nodejs"||typeof navigator<"u"&&navigator.userAgent.includes("jsdom"),wh=()=>typeof Deno<"u",_k=()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"&&!wh(),XB=()=>{let r;return gk()?r="browser":_k()?r="node":wk()?r="webworker":yk()?r="jsdom":wh()?r="deno":r="other",r},gh;function YB(){return gh===void 0&&(gh={library:"langchain-js",runtime:XB()}),gh}function pt(r){try{return typeof process<"u"?process.env?.[r]:wh()?Deno?.env.get(r):void 0}catch{return}}var yh=class{};function _h(r){return"lc_prefer_streaming"in r&&r.lc_prefer_streaming}var hi=class r extends yh{get lc_namespace(){return["langchain_core","callbacks",this.name]}get lc_secrets(){}get lc_attributes(){}get lc_aliases(){}get lc_serializable_keys(){}static lc_name(){return this.name}get lc_id(){return[...this.lc_namespace,sp(this.constructor)]}constructor(e){super(),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"ignoreLLM",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreChain",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreAgent",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreRetriever",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreCustomEvent",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"raiseError",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"awaitHandlers",{enumerable:!0,configurable:!0,writable:!0,value:pt("LANGCHAIN_CALLBACKS_BACKGROUND")==="false"}),this.lc_kwargs=e||{},e&&(this.ignoreLLM=e.ignoreLLM??this.ignoreLLM,this.ignoreChain=e.ignoreChain??this.ignoreChain,this.ignoreAgent=e.ignoreAgent??this.ignoreAgent,this.ignoreRetriever=e.ignoreRetriever??this.ignoreRetriever,this.ignoreCustomEvent=e.ignoreCustomEvent??this.ignoreCustomEvent,this.raiseError=e.raiseError??this.raiseError,this.awaitHandlers=this.raiseError||(e._awaitHandler??this.awaitHandlers))}copy(){return new this.constructor(this)}toJSON(){return an.prototype.toJSON.call(this)}toJSONNotImplemented(){return an.prototype.toJSONNotImplemented.call(this)}static fromMethods(e){class t extends r{constructor(){super(),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:ut()}),Object.assign(this,e)}}return new t}},e0=r=>{let e=r;return e!==void 0&&typeof e.copy=="function"&&typeof e.name=="string"&&typeof e.awaitHandlers=="boolean"};var bk=r=>{if(r)return r.events=r.events??[],r.child_runs=r.child_runs??[],r};function Bh(r,e){if(r)return new cn({...r,start_time:r._serialized_start_time??r.start_time,parent_run:Bh(e),child_runs:r.child_runs.map(t=>Bh(t)).filter(t=>t!==void 0),extra:{...r.extra,runtime:YB()},tracingEnabled:!1})}function bh(r,e){return r&&!Array.isArray(r)&&typeof r=="object"?r:{[e]:r}}function Sa(r){return typeof r._addRunToRunMap=="function"}var Xr=class extends hi{constructor(e){super(...arguments),Object.defineProperty(this,"runMap",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"runTreeMap",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"usesRunTreeMap",{enumerable:!0,configurable:!0,writable:!0,value:!1})}copy(){return this}getRunById(e){if(e!==void 0)return this.usesRunTreeMap?bk(this.runTreeMap.get(e)):this.runMap.get(e)}stringifyError(e){return e instanceof Error?e.message+(e?.stack?`

${e.stack}`:""):typeof e=="string"?e:`${e}`}_addChildRun(e,t){e.child_runs.push(t)}_addRunToRunMap(e){let{dottedOrder:t,microsecondPrecisionDatestring:n}=mh(new Date(e.start_time).getTime(),e.id,e.execution_order),A={...e},s=this.getRunById(A.parent_run_id);if(A.parent_run_id!==void 0?s&&(this._addChildRun(s,A),s.child_execution_order=Math.max(s.child_execution_order,A.child_execution_order),A.trace_id=s.trace_id,s.dotted_order!==void 0&&(A.dotted_order=[s.dotted_order,t].join("."),A._serialized_start_time=n)):(A.trace_id=A.id,A.dotted_order=t,A._serialized_start_time=n),this.usesRunTreeMap){let i=Bh(A,s);i!==void 0&&this.runTreeMap.set(A.id,i)}else this.runMap.set(A.id,A);return A}async _endTrace(e){let t=e.parent_run_id!==void 0&&this.getRunById(e.parent_run_id);t?t.child_execution_order=Math.max(t.child_execution_order,e.child_execution_order):await this.persistRun(e),await this.onRunUpdate?.(e),this.usesRunTreeMap?this.runTreeMap.delete(e.id):this.runMap.delete(e.id)}_getExecutionOrder(e){let t=e!==void 0&&this.getRunById(e);return t?t.child_execution_order+1:1}_createRunForLLMStart(e,t,n,A,s,i,a,f){let d=this._getExecutionOrder(A),h=Date.now(),m=a?{...s,metadata:a}:s,y={id:n,name:f??e.id[e.id.length-1],parent_run_id:A,start_time:h,serialized:e,events:[{name:"start",time:new Date(h).toISOString()}],inputs:{prompts:t},execution_order:d,child_runs:[],child_execution_order:d,run_type:"llm",extra:m??{},tags:i||[]};return this._addRunToRunMap(y)}async handleLLMStart(e,t,n,A,s,i,a,f){let d=this.getRunById(n)??this._createRunForLLMStart(e,t,n,A,s,i,a,f);return await this.onRunCreate?.(d),await this.onLLMStart?.(d),d}_createRunForChatModelStart(e,t,n,A,s,i,a,f){let d=this._getExecutionOrder(A),h=Date.now(),m=a?{...s,metadata:a}:s,y={id:n,name:f??e.id[e.id.length-1],parent_run_id:A,start_time:h,serialized:e,events:[{name:"start",time:new Date(h).toISOString()}],inputs:{messages:t},execution_order:d,child_runs:[],child_execution_order:d,run_type:"llm",extra:m??{},tags:i||[]};return this._addRunToRunMap(y)}async handleChatModelStart(e,t,n,A,s,i,a,f){let d=this.getRunById(n)??this._createRunForChatModelStart(e,t,n,A,s,i,a,f);return await this.onRunCreate?.(d),await this.onLLMStart?.(d),d}async handleLLMEnd(e,t,n,A,s){let i=this.getRunById(t);if(!i||i?.run_type!=="llm")throw new Error("No LLM run to end.");return i.end_time=Date.now(),i.outputs=e,i.events.push({name:"end",time:new Date(i.end_time).toISOString()}),i.extra={...i.extra,...s},await this.onLLMEnd?.(i),await this._endTrace(i),i}async handleLLMError(e,t,n,A,s){let i=this.getRunById(t);if(!i||i?.run_type!=="llm")throw new Error("No LLM run to end.");return i.end_time=Date.now(),i.error=this.stringifyError(e),i.events.push({name:"error",time:new Date(i.end_time).toISOString()}),i.extra={...i.extra,...s},await this.onLLMError?.(i),await this._endTrace(i),i}_createRunForChainStart(e,t,n,A,s,i,a,f){let d=this._getExecutionOrder(A),h=Date.now(),m={id:n,name:f??e.id[e.id.length-1],parent_run_id:A,start_time:h,serialized:e,events:[{name:"start",time:new Date(h).toISOString()}],inputs:t,execution_order:d,child_execution_order:d,run_type:a??"chain",child_runs:[],extra:i?{metadata:i}:{},tags:s||[]};return this._addRunToRunMap(m)}async handleChainStart(e,t,n,A,s,i,a,f){let d=this.getRunById(n)??this._createRunForChainStart(e,t,n,A,s,i,a,f);return await this.onRunCreate?.(d),await this.onChainStart?.(d),d}async handleChainEnd(e,t,n,A,s){let i=this.getRunById(t);if(!i)throw new Error("No chain run to end.");return i.end_time=Date.now(),i.outputs=bh(e,"output"),i.events.push({name:"end",time:new Date(i.end_time).toISOString()}),s?.inputs!==void 0&&(i.inputs=bh(s.inputs,"input")),await this.onChainEnd?.(i),await this._endTrace(i),i}async handleChainError(e,t,n,A,s){let i=this.getRunById(t);if(!i)throw new Error("No chain run to end.");return i.end_time=Date.now(),i.error=this.stringifyError(e),i.events.push({name:"error",time:new Date(i.end_time).toISOString()}),s?.inputs!==void 0&&(i.inputs=bh(s.inputs,"input")),await this.onChainError?.(i),await this._endTrace(i),i}_createRunForToolStart(e,t,n,A,s,i,a){let f=this._getExecutionOrder(A),d=Date.now(),h={id:n,name:a??e.id[e.id.length-1],parent_run_id:A,start_time:d,serialized:e,events:[{name:"start",time:new Date(d).toISOString()}],inputs:{input:t},execution_order:f,child_execution_order:f,run_type:"tool",child_runs:[],extra:i?{metadata:i}:{},tags:s||[]};return this._addRunToRunMap(h)}async handleToolStart(e,t,n,A,s,i,a){let f=this.getRunById(n)??this._createRunForToolStart(e,t,n,A,s,i,a);return await this.onRunCreate?.(f),await this.onToolStart?.(f),f}async handleToolEnd(e,t){let n=this.getRunById(t);if(!n||n?.run_type!=="tool")throw new Error("No tool run to end");return n.end_time=Date.now(),n.outputs={output:e},n.events.push({name:"end",time:new Date(n.end_time).toISOString()}),await this.onToolEnd?.(n),await this._endTrace(n),n}async handleToolError(e,t){let n=this.getRunById(t);if(!n||n?.run_type!=="tool")throw new Error("No tool run to end");return n.end_time=Date.now(),n.error=this.stringifyError(e),n.events.push({name:"error",time:new Date(n.end_time).toISOString()}),await this.onToolError?.(n),await this._endTrace(n),n}async handleAgentAction(e,t){let n=this.getRunById(t);if(!n||n?.run_type!=="chain")return;let A=n;A.actions=A.actions||[],A.actions.push(e),A.events.push({name:"agent_action",time:new Date().toISOString(),kwargs:{action:e}}),await this.onAgentAction?.(n)}async handleAgentEnd(e,t){let n=this.getRunById(t);!n||n?.run_type!=="chain"||(n.events.push({name:"agent_end",time:new Date().toISOString(),kwargs:{action:e}}),await this.onAgentEnd?.(n))}_createRunForRetrieverStart(e,t,n,A,s,i,a){let f=this._getExecutionOrder(A),d=Date.now(),h={id:n,name:a??e.id[e.id.length-1],parent_run_id:A,start_time:d,serialized:e,events:[{name:"start",time:new Date(d).toISOString()}],inputs:{query:t},execution_order:f,child_execution_order:f,run_type:"retriever",child_runs:[],extra:i?{metadata:i}:{},tags:s||[]};return this._addRunToRunMap(h)}async handleRetrieverStart(e,t,n,A,s,i,a){let f=this.getRunById(n)??this._createRunForRetrieverStart(e,t,n,A,s,i,a);return await this.onRunCreate?.(f),await this.onRetrieverStart?.(f),f}async handleRetrieverEnd(e,t){let n=this.getRunById(t);if(!n||n?.run_type!=="retriever")throw new Error("No retriever run to end");return n.end_time=Date.now(),n.outputs={documents:e},n.events.push({name:"end",time:new Date(n.end_time).toISOString()}),await this.onRetrieverEnd?.(n),await this._endTrace(n),n}async handleRetrieverError(e,t){let n=this.getRunById(t);if(!n||n?.run_type!=="retriever")throw new Error("No retriever run to end");return n.end_time=Date.now(),n.error=this.stringifyError(e),n.events.push({name:"error",time:new Date(n.end_time).toISOString()}),await this.onRetrieverError?.(n),await this._endTrace(n),n}async handleText(e,t){let n=this.getRunById(t);!n||n?.run_type!=="chain"||(n.events.push({name:"text",time:new Date().toISOString(),kwargs:{text:e}}),await this.onText?.(n))}async handleLLMNewToken(e,t,n,A,s,i){let a=this.getRunById(n);if(!a||a?.run_type!=="llm")throw new Error('Invalid "runId" provided to "handleLLMNewToken" callback.');return a.events.push({name:"new_token",time:new Date().toISOString(),kwargs:{token:e,idx:t,chunk:i?.chunk}}),await this.onLLMNewToken?.(a,e,{chunk:i?.chunk}),a}};var vh=Ur(A0(),1);function ur(r,e){return`${r.open}${e}${r.close}`}function Yr(r,e){try{return JSON.stringify(r,null,2)}catch{return e}}function s0(r){return typeof r=="string"?r.trim():r==null?r:Yr(r,r.toString())}function as(r){if(!r.end_time)return"";let e=r.end_time-r.start_time;return e<1e3?`${e}ms`:`${(e/1e3).toFixed(2)}s`}var{color:vr}=vh.default,ru=class extends Xr{constructor(){super(...arguments),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"console_callback_handler"})}persistRun(e){return Promise.resolve()}getParents(e){let t=[],n=e;for(;n.parent_run_id;){let A=this.runMap.get(n.parent_run_id);if(A)t.push(A),n=A;else break}return t}getBreadcrumbs(e){let n=[...this.getParents(e).reverse(),e].map((A,s,i)=>{let a=`${A.execution_order}:${A.run_type}:${A.name}`;return s===i.length-1?ur(vh.default.bold,a):a}).join(" > ");return ur(vr.grey,n)}onChainStart(e){let t=this.getBreadcrumbs(e);console.log(`${ur(vr.green,"[chain/start]")} [${t}] Entering Chain run with input: ${Yr(e.inputs,"[inputs]")}`)}onChainEnd(e){let t=this.getBreadcrumbs(e);console.log(`${ur(vr.cyan,"[chain/end]")} [${t}] [${as(e)}] Exiting Chain run with output: ${Yr(e.outputs,"[outputs]")}`)}onChainError(e){let t=this.getBreadcrumbs(e);console.log(`${ur(vr.red,"[chain/error]")} [${t}] [${as(e)}] Chain run errored with error: ${Yr(e.error,"[error]")}`)}onLLMStart(e){let t=this.getBreadcrumbs(e),n="prompts"in e.inputs?{prompts:e.inputs.prompts.map(A=>A.trim())}:e.inputs;console.log(`${ur(vr.green,"[llm/start]")} [${t}] Entering LLM run with input: ${Yr(n,"[inputs]")}`)}onLLMEnd(e){let t=this.getBreadcrumbs(e);console.log(`${ur(vr.cyan,"[llm/end]")} [${t}] [${as(e)}] Exiting LLM run with output: ${Yr(e.outputs,"[response]")}`)}onLLMError(e){let t=this.getBreadcrumbs(e);console.log(`${ur(vr.red,"[llm/error]")} [${t}] [${as(e)}] LLM run errored with error: ${Yr(e.error,"[error]")}`)}onToolStart(e){let t=this.getBreadcrumbs(e);console.log(`${ur(vr.green,"[tool/start]")} [${t}] Entering Tool run with input: "${s0(e.inputs.input)}"`)}onToolEnd(e){let t=this.getBreadcrumbs(e);console.log(`${ur(vr.cyan,"[tool/end]")} [${t}] [${as(e)}] Exiting Tool run with output: "${s0(e.outputs?.output)}"`)}onToolError(e){let t=this.getBreadcrumbs(e);console.log(`${ur(vr.red,"[tool/error]")} [${t}] [${as(e)}] Tool run errored with error: ${Yr(e.error,"[error]")}`)}onRetrieverStart(e){let t=this.getBreadcrumbs(e);console.log(`${ur(vr.green,"[retriever/start]")} [${t}] Entering Retriever run with input: ${Yr(e.inputs,"[inputs]")}`)}onRetrieverEnd(e){let t=this.getBreadcrumbs(e);console.log(`${ur(vr.cyan,"[retriever/end]")} [${t}] [${as(e)}] Exiting Retriever run with output: ${Yr(e.outputs,"[outputs]")}`)}onRetrieverError(e){let t=this.getBreadcrumbs(e);console.log(`${ur(vr.red,"[retriever/error]")} [${t}] [${as(e)}] Retriever run errored with error: ${Yr(e.error,"[error]")}`)}onAgentAction(e){let t=e,n=this.getBreadcrumbs(e);console.log(`${ur(vr.blue,"[agent/action]")} [${n}] Agent selected action: ${Yr(t.actions[t.actions.length-1],"[action]")}`)}};var Ch,Eh=()=>{if(Ch===void 0){let r=pt("LANGCHAIN_CALLBACKS_BACKGROUND")==="false"?{blockOnRootRunFinalization:!0}:{};Ch=new di(r)}return Ch};var Pa=class r extends Xr{constructor(e={}){super(e),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"langchain_tracer"}),Object.defineProperty(this,"projectName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"exampleId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"replicas",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"usesRunTreeMap",{enumerable:!0,configurable:!0,writable:!0,value:!0});let{exampleId:t,projectName:n,client:A,replicas:s}=e;this.projectName=n??Go(),this.replicas=s,this.exampleId=t,this.client=A??Eh();let i=r.getTraceableRunTree();i&&this.updateFromRunTree(i)}async persistRun(e){}async onRunCreate(e){await this.getRunTreeWithTracingConfig(e.id)?.postRun()}async onRunUpdate(e){await this.getRunTreeWithTracingConfig(e.id)?.patchRun()}getRun(e){return this.runTreeMap.get(e)}updateFromRunTree(e){this.runTreeMap.set(e.id,e);let t=e,n=new Set;for(;t.parent_run&&!(n.has(t.id)||(n.add(t.id),!t.parent_run));)t=t.parent_run;n.clear();let A=[t];for(;A.length>0;){let s=A.shift();!s||n.has(s.id)||(n.add(s.id),this.runTreeMap.set(s.id,s),s.child_runs&&A.push(...s.child_runs))}this.client=e.client??this.client,this.replicas=e.replicas??this.replicas,this.projectName=e.project_name??this.projectName,this.exampleId=e.reference_example_id??this.exampleId}getRunTreeWithTracingConfig(e){let t=this.runTreeMap.get(e);if(t)return new cn({...t,client:this.client,project_name:this.projectName,replicas:this.replicas,reference_example_id:this.exampleId,tracingEnabled:!0})}static getTraceableRunTree(){try{return e_(!0)}catch{return}}};var Hl=Ur(wl(),1);var i0=Symbol.for("ls:tracing_async_local_storage"),mi=Symbol.for("lc:context_variables"),a0=r=>{globalThis[i0]=r},os=()=>globalThis[i0];var nu;function vk(){let r="default"in Hl.default?Hl.default.default:Hl.default;return new r({autoStart:!0,concurrency:1})}function Ck(){return typeof nu>"u"&&(nu=vk()),nu}async function ht(r,e){if(e===!0){let t=os();t!==void 0?await t.run(void 0,async()=>r()):await r()}else nu=Ck(),nu.add(async()=>{let t=os();t!==void 0?await t.run(void 0,async()=>r()):await r()})}var o0=r=>r!==void 0?r:!!["LANGSMITH_TRACING_V2","LANGCHAIN_TRACING_V2","LANGSMITH_TRACING","LANGCHAIN_TRACING"].find(t=>pt(t)==="true");function xh(r){let e=os();return e===void 0?void 0:e.getStore()?.[mi]?.[r]}var Ek=Symbol("lc:configure_hooks"),u0=()=>xh(Ek)||[];function c0(r){return r?Array.isArray(r)||"name"in r?{callbacks:r}:r:{}}var Ih=class{setHandler(e){return this.setHandlers([e])}},Ra=class{constructor(e,t,n,A,s,i,a,f){Object.defineProperty(this,"runId",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"handlers",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"inheritableHandlers",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:A}),Object.defineProperty(this,"inheritableTags",{enumerable:!0,configurable:!0,writable:!0,value:s}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(this,"inheritableMetadata",{enumerable:!0,configurable:!0,writable:!0,value:a}),Object.defineProperty(this,"_parentRunId",{enumerable:!0,configurable:!0,writable:!0,value:f})}get parentRunId(){return this._parentRunId}async handleText(e){await Promise.all(this.handlers.map(t=>ht(async()=>{try{await t.handleText?.(e,this.runId,this._parentRunId,this.tags)}catch(n){if((t.raiseError?console.error:console.warn)(`Error in handler ${t.constructor.name}, handleText: ${n}`),t.raiseError)throw n}},t.awaitHandlers)))}async handleCustomEvent(e,t,n,A,s){await Promise.all(this.handlers.map(i=>ht(async()=>{try{await i.handleCustomEvent?.(e,t,this.runId,this.tags,this.metadata)}catch(a){if((i.raiseError?console.error:console.warn)(`Error in handler ${i.constructor.name}, handleCustomEvent: ${a}`),i.raiseError)throw a}},i.awaitHandlers)))}},Uh=class extends Ra{getChild(e){let t=new jt(this.runId);return t.setHandlers(this.inheritableHandlers),t.addTags(this.inheritableTags),t.addMetadata(this.inheritableMetadata),e&&t.addTags([e],!1),t}async handleRetrieverEnd(e){await Promise.all(this.handlers.map(t=>ht(async()=>{if(!t.ignoreRetriever)try{await t.handleRetrieverEnd?.(e,this.runId,this._parentRunId,this.tags)}catch(n){if((t.raiseError?console.error:console.warn)(`Error in handler ${t.constructor.name}, handleRetriever`),t.raiseError)throw n}},t.awaitHandlers)))}async handleRetrieverError(e){await Promise.all(this.handlers.map(t=>ht(async()=>{if(!t.ignoreRetriever)try{await t.handleRetrieverError?.(e,this.runId,this._parentRunId,this.tags)}catch(n){if((t.raiseError?console.error:console.warn)(`Error in handler ${t.constructor.name}, handleRetrieverError: ${n}`),t.raiseError)throw e}},t.awaitHandlers)))}},Dl=class extends Ra{async handleLLMNewToken(e,t,n,A,s,i){await Promise.all(this.handlers.map(a=>ht(async()=>{if(!a.ignoreLLM)try{await a.handleLLMNewToken?.(e,t??{prompt:0,completion:0},this.runId,this._parentRunId,this.tags,i)}catch(f){if((a.raiseError?console.error:console.warn)(`Error in handler ${a.constructor.name}, handleLLMNewToken: ${f}`),a.raiseError)throw f}},a.awaitHandlers)))}async handleLLMError(e,t,n,A,s){await Promise.all(this.handlers.map(i=>ht(async()=>{if(!i.ignoreLLM)try{await i.handleLLMError?.(e,this.runId,this._parentRunId,this.tags,s)}catch(a){if((i.raiseError?console.error:console.warn)(`Error in handler ${i.constructor.name}, handleLLMError: ${a}`),i.raiseError)throw a}},i.awaitHandlers)))}async handleLLMEnd(e,t,n,A,s){await Promise.all(this.handlers.map(i=>ht(async()=>{if(!i.ignoreLLM)try{await i.handleLLMEnd?.(e,this.runId,this._parentRunId,this.tags,s)}catch(a){if((i.raiseError?console.error:console.warn)(`Error in handler ${i.constructor.name}, handleLLMEnd: ${a}`),i.raiseError)throw a}},i.awaitHandlers)))}},Fh=class extends Ra{getChild(e){let t=new jt(this.runId);return t.setHandlers(this.inheritableHandlers),t.addTags(this.inheritableTags),t.addMetadata(this.inheritableMetadata),e&&t.addTags([e],!1),t}async handleChainError(e,t,n,A,s){await Promise.all(this.handlers.map(i=>ht(async()=>{if(!i.ignoreChain)try{await i.handleChainError?.(e,this.runId,this._parentRunId,this.tags,s)}catch(a){if((i.raiseError?console.error:console.warn)(`Error in handler ${i.constructor.name}, handleChainError: ${a}`),i.raiseError)throw a}},i.awaitHandlers)))}async handleChainEnd(e,t,n,A,s){await Promise.all(this.handlers.map(i=>ht(async()=>{if(!i.ignoreChain)try{await i.handleChainEnd?.(e,this.runId,this._parentRunId,this.tags,s)}catch(a){if((i.raiseError?console.error:console.warn)(`Error in handler ${i.constructor.name}, handleChainEnd: ${a}`),i.raiseError)throw a}},i.awaitHandlers)))}async handleAgentAction(e){await Promise.all(this.handlers.map(t=>ht(async()=>{if(!t.ignoreAgent)try{await t.handleAgentAction?.(e,this.runId,this._parentRunId,this.tags)}catch(n){if((t.raiseError?console.error:console.warn)(`Error in handler ${t.constructor.name}, handleAgentAction: ${n}`),t.raiseError)throw n}},t.awaitHandlers)))}async handleAgentEnd(e){await Promise.all(this.handlers.map(t=>ht(async()=>{if(!t.ignoreAgent)try{await t.handleAgentEnd?.(e,this.runId,this._parentRunId,this.tags)}catch(n){if((t.raiseError?console.error:console.warn)(`Error in handler ${t.constructor.name}, handleAgentEnd: ${n}`),t.raiseError)throw n}},t.awaitHandlers)))}},Qh=class extends Ra{getChild(e){let t=new jt(this.runId);return t.setHandlers(this.inheritableHandlers),t.addTags(this.inheritableTags),t.addMetadata(this.inheritableMetadata),e&&t.addTags([e],!1),t}async handleToolError(e){await Promise.all(this.handlers.map(t=>ht(async()=>{if(!t.ignoreAgent)try{await t.handleToolError?.(e,this.runId,this._parentRunId,this.tags)}catch(n){if((t.raiseError?console.error:console.warn)(`Error in handler ${t.constructor.name}, handleToolError: ${n}`),t.raiseError)throw n}},t.awaitHandlers)))}async handleToolEnd(e){await Promise.all(this.handlers.map(t=>ht(async()=>{if(!t.ignoreAgent)try{await t.handleToolEnd?.(e,this.runId,this._parentRunId,this.tags)}catch(n){if((t.raiseError?console.error:console.warn)(`Error in handler ${t.constructor.name}, handleToolEnd: ${n}`),t.raiseError)throw n}},t.awaitHandlers)))}},jt=class r extends Ih{constructor(e,t){super(),Object.defineProperty(this,"handlers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"inheritableHandlers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"inheritableTags",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"inheritableMetadata",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"callback_manager"}),Object.defineProperty(this,"_parentRunId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.handlers=t?.handlers??this.handlers,this.inheritableHandlers=t?.inheritableHandlers??this.inheritableHandlers,this.tags=t?.tags??this.tags,this.inheritableTags=t?.inheritableTags??this.inheritableTags,this.metadata=t?.metadata??this.metadata,this.inheritableMetadata=t?.inheritableMetadata??this.inheritableMetadata,this._parentRunId=e}getParentRunId(){return this._parentRunId}async handleLLMStart(e,t,n=void 0,A=void 0,s=void 0,i=void 0,a=void 0,f=void 0){return Promise.all(t.map(async(d,h)=>{let m=h===0&&n?n:ut();return await Promise.all(this.handlers.map(y=>{if(!y.ignoreLLM)return Sa(y)&&y._createRunForLLMStart(e,[d],m,this._parentRunId,s,this.tags,this.metadata,f),ht(async()=>{try{await y.handleLLMStart?.(e,[d],m,this._parentRunId,s,this.tags,this.metadata,f)}catch(w){if((y.raiseError?console.error:console.warn)(`Error in handler ${y.constructor.name}, handleLLMStart: ${w}`),y.raiseError)throw w}},y.awaitHandlers)})),new Dl(m,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}))}async handleChatModelStart(e,t,n=void 0,A=void 0,s=void 0,i=void 0,a=void 0,f=void 0){return Promise.all(t.map(async(d,h)=>{let m=h===0&&n?n:ut();return await Promise.all(this.handlers.map(y=>{if(!y.ignoreLLM)return Sa(y)&&y._createRunForChatModelStart(e,[d],m,this._parentRunId,s,this.tags,this.metadata,f),ht(async()=>{try{if(y.handleChatModelStart)await y.handleChatModelStart?.(e,[d],m,this._parentRunId,s,this.tags,this.metadata,f);else if(y.handleLLMStart){let w=Do(d);await y.handleLLMStart?.(e,[w],m,this._parentRunId,s,this.tags,this.metadata,f)}}catch(w){if((y.raiseError?console.error:console.warn)(`Error in handler ${y.constructor.name}, handleLLMStart: ${w}`),y.raiseError)throw w}},y.awaitHandlers)})),new Dl(m,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}))}async handleChainStart(e,t,n=ut(),A=void 0,s=void 0,i=void 0,a=void 0){return await Promise.all(this.handlers.map(f=>{if(!f.ignoreChain)return Sa(f)&&f._createRunForChainStart(e,t,n,this._parentRunId,this.tags,this.metadata,A,a),ht(async()=>{try{await f.handleChainStart?.(e,t,n,this._parentRunId,this.tags,this.metadata,A,a)}catch(d){if((f.raiseError?console.error:console.warn)(`Error in handler ${f.constructor.name}, handleChainStart: ${d}`),f.raiseError)throw d}},f.awaitHandlers)})),new Fh(n,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}async handleToolStart(e,t,n=ut(),A=void 0,s=void 0,i=void 0,a=void 0){return await Promise.all(this.handlers.map(f=>{if(!f.ignoreAgent)return Sa(f)&&f._createRunForToolStart(e,t,n,this._parentRunId,this.tags,this.metadata,a),ht(async()=>{try{await f.handleToolStart?.(e,t,n,this._parentRunId,this.tags,this.metadata,a)}catch(d){if((f.raiseError?console.error:console.warn)(`Error in handler ${f.constructor.name}, handleToolStart: ${d}`),f.raiseError)throw d}},f.awaitHandlers)})),new Qh(n,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}async handleRetrieverStart(e,t,n=ut(),A=void 0,s=void 0,i=void 0,a=void 0){return await Promise.all(this.handlers.map(f=>{if(!f.ignoreRetriever)return Sa(f)&&f._createRunForRetrieverStart(e,t,n,this._parentRunId,this.tags,this.metadata,a),ht(async()=>{try{await f.handleRetrieverStart?.(e,t,n,this._parentRunId,this.tags,this.metadata,a)}catch(d){if((f.raiseError?console.error:console.warn)(`Error in handler ${f.constructor.name}, handleRetrieverStart: ${d}`),f.raiseError)throw d}},f.awaitHandlers)})),new Uh(n,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}async handleCustomEvent(e,t,n,A,s){await Promise.all(this.handlers.map(i=>ht(async()=>{if(!i.ignoreCustomEvent)try{await i.handleCustomEvent?.(e,t,n,this.tags,this.metadata)}catch(a){if((i.raiseError?console.error:console.warn)(`Error in handler ${i.constructor.name}, handleCustomEvent: ${a}`),i.raiseError)throw a}},i.awaitHandlers)))}addHandler(e,t=!0){this.handlers.push(e),t&&this.inheritableHandlers.push(e)}removeHandler(e){this.handlers=this.handlers.filter(t=>t!==e),this.inheritableHandlers=this.inheritableHandlers.filter(t=>t!==e)}setHandlers(e,t=!0){this.handlers=[],this.inheritableHandlers=[];for(let n of e)this.addHandler(n,t)}addTags(e,t=!0){this.removeTags(e),this.tags.push(...e),t&&this.inheritableTags.push(...e)}removeTags(e){this.tags=this.tags.filter(t=>!e.includes(t)),this.inheritableTags=this.inheritableTags.filter(t=>!e.includes(t))}addMetadata(e,t=!0){this.metadata={...this.metadata,...e},t&&(this.inheritableMetadata={...this.inheritableMetadata,...e})}removeMetadata(e){for(let t of Object.keys(e))delete this.metadata[t],delete this.inheritableMetadata[t]}copy(e=[],t=!0){let n=new r(this._parentRunId);for(let A of this.handlers){let s=this.inheritableHandlers.includes(A);n.addHandler(A,s)}for(let A of this.tags){let s=this.inheritableTags.includes(A);n.addTags([A],s)}for(let A of Object.keys(this.metadata)){let s=Object.keys(this.inheritableMetadata).includes(A);n.addMetadata({[A]:this.metadata[A]},s)}for(let A of e)n.handlers.filter(s=>s.name==="console_callback_handler").some(s=>s.name===A.name)||n.addHandler(A,t);return n}static fromHandlers(e){class t extends hi{constructor(){super(),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:ut()}),Object.assign(this,e)}}let n=new this;return n.addHandler(new t),n}static configure(e,t,n,A,s,i,a){return this._configureSync(e,t,n,A,s,i,a)}static _configureSync(e,t,n,A,s,i,a){let f;(e||t)&&(Array.isArray(e)||!e?(f=new r,f.setHandlers(e?.map(Au)??[],!0)):f=e,f=f.copy(Array.isArray(t)?t.map(Au):t?.handlers,!1));let d=pt("LANGCHAIN_VERBOSE")==="true"||a?.verbose,h=Pa.getTraceableRunTree()?.tracingEnabled||o0(),m=h||(pt("LANGCHAIN_TRACING")??!1);if(d||m){if(f||(f=new r),d&&!f.handlers.some(y=>y.name===ru.prototype.name)){let y=new ru;f.addHandler(y,!0)}if(m&&!f.handlers.some(y=>y.name==="langchain_tracer")&&h){let y=new Pa;f.addHandler(y,!0)}if(h){let y=Pa.getTraceableRunTree();y&&f._parentRunId===void 0&&(f._parentRunId=y.id,f.handlers.find(b=>b.name==="langchain_tracer")?.updateFromRunTree(y))}}for(let{contextVar:y,inheritable:w=!0,handlerClass:b,envVar:C}of u0()){let I=C&&pt(C)==="true"&&b,T,Q=y!==void 0?xh(y):void 0;Q&&e0(Q)?T=Q:I&&(T=new b({})),T!==void 0&&(f||(f=new r),f.handlers.some(P=>P.name===T.name)||f.addHandler(T,w))}return(n||A)&&f&&(f.addTags(n??[]),f.addTags(A??[],!1)),(s||i)&&f&&(f.addMetadata(s??{}),f.addMetadata(i??{},!1)),f}};function Au(r){return"name"in r?r:hi.fromMethods(r)}var Ml=class{getStore(){}run(e,t){return t()}enterWith(e){}},xk=new Ml,l0=Symbol.for("lc:child_config"),Th=class{getInstance(){return os()??xk}getRunnableConfig(){return this.getInstance().getStore()?.extra?.[l0]}runWithConfig(e,t,n){let A=jt._configureSync(e?.callbacks,void 0,e?.tags,void 0,e?.metadata),s=this.getInstance(),i=s.getStore(),a=A?.getParentRunId(),f=A?.handlers?.find(h=>h?.name==="langchain_tracer"),d;return f&&a?d=f.getRunTreeWithTracingConfig(a):n||(d=new cn({name:"<runnable_lambda>",tracingEnabled:!1})),d&&(d.extra={...d.extra,[l0]:e}),i!==void 0&&i[mi]!==void 0&&(d===void 0&&(d={}),d[mi]=i[mi]),s.run(d,t)}initializeGlobalInstance(e){os()===void 0&&a0(e)}},cr=new Th;var $l=25;async function Cr(r){return jt._configureSync(r?.callbacks,void 0,r?.tags,void 0,r?.metadata)}function ka(...r){let e={};for(let t of r.filter(n=>!!n))for(let n of Object.keys(t))if(n==="metadata")e[n]={...e[n],...t[n]};else if(n==="tags"){let A=e[n]??[];e[n]=[...new Set(A.concat(t[n]??[]))]}else if(n==="configurable")e[n]={...e[n],...t[n]};else if(n==="timeout")e.timeout===void 0?e.timeout=t.timeout:t.timeout!==void 0&&(e.timeout=Math.min(e.timeout,t.timeout));else if(n==="signal")e.signal===void 0?e.signal=t.signal:t.signal!==void 0&&("any"in AbortSignal?e.signal=AbortSignal.any([e.signal,t.signal]):e.signal=t.signal);else if(n==="callbacks"){let A=e.callbacks,s=t.callbacks;if(Array.isArray(s))if(!A)e.callbacks=s;else if(Array.isArray(A))e.callbacks=A.concat(s);else{let i=A.copy();for(let a of s)i.addHandler(Au(a),!0);e.callbacks=i}else if(s)if(!A)e.callbacks=s;else if(Array.isArray(A)){let i=s.copy();for(let a of A)i.addHandler(Au(a),!0);e.callbacks=i}else e.callbacks=new jt(s._parentRunId,{handlers:A.handlers.concat(s.handlers),inheritableHandlers:A.inheritableHandlers.concat(s.inheritableHandlers),tags:Array.from(new Set(A.tags.concat(s.tags))),inheritableTags:Array.from(new Set(A.inheritableTags.concat(s.inheritableTags))),metadata:{...A.metadata,...s.metadata}})}else{let A=n;e[A]=t[A]??e[A]}return e}var Ik=new Set(["string","number","boolean"]);function He(r){let e=cr.getRunnableConfig(),t={tags:[],metadata:{},recursionLimit:25,runId:void 0};if(e){let{runId:n,runName:A,...s}=e;t=Object.entries(s).reduce((i,[a,f])=>(f!==void 0&&(i[a]=f),i),t)}if(r&&(t=Object.entries(r).reduce((n,[A,s])=>(s!==void 0&&(n[A]=s),n),t)),t?.configurable)for(let n of Object.keys(t.configurable))Ik.has(typeof t.configurable[n])&&!t.metadata?.[n]&&(t.metadata||(t.metadata={}),t.metadata[n]=t.configurable[n]);if(t.timeout!==void 0){if(t.timeout<=0)throw new Error("Timeout must be a positive number");let n=AbortSignal.timeout(t.timeout);t.signal!==void 0?"any"in AbortSignal&&(t.signal=AbortSignal.any([t.signal,n])):t.signal=n,delete t.timeout}return t}function mt(r={},{callbacks:e,maxConcurrency:t,recursionLimit:n,runName:A,configurable:s,runId:i}={}){let a=He(r);return e!==void 0&&(delete a.runName,a.callbacks=e),n!==void 0&&(a.recursionLimit=n),t!==void 0&&(a.maxConcurrency=t),A!==void 0&&(a.runName=A),s!==void 0&&(a.configurable={...a.configurable,...s}),i!==void 0&&delete a.runId,a}function en(r){return r?{configurable:r.configurable,recursionLimit:r.recursionLimit,callbacks:r.callbacks,tags:r.tags,metadata:r.metadata,maxConcurrency:r.maxConcurrency,timeout:r.timeout,signal:r.signal}:void 0}async function Mn(r,e){if(e===void 0)return r;let t;return Promise.race([r.catch(n=>{if(!e?.aborted)throw n}),new Promise((n,A)=>{t=()=>{A(new Error("Aborted"))},e.addEventListener("abort",t),e.aborted&&A(new Error("Aborted"))})]).finally(()=>e.removeEventListener("abort",t))}var Yt=class r extends ReadableStream{constructor(){super(...arguments),Object.defineProperty(this,"reader",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}ensureReader(){this.reader||(this.reader=this.getReader())}async next(){this.ensureReader();try{let e=await this.reader.read();return e.done?(this.reader.releaseLock(),{done:!0,value:void 0}):{done:!1,value:e.value}}catch(e){throw this.reader.releaseLock(),e}}async return(){if(this.ensureReader(),this.locked){let e=this.reader.cancel();this.reader.releaseLock(),await e}return{done:!0,value:void 0}}async throw(e){if(this.ensureReader(),this.locked){let t=this.reader.cancel();this.reader.releaseLock(),await t}throw e}[Symbol.asyncIterator](){return this}async[Symbol.asyncDispose](){await this.return()}static fromReadableStream(e){let t=e.getReader();return new r({start(n){return A();function A(){return t.read().then(({done:s,value:i})=>{if(s){n.close();return}return n.enqueue(i),A()})}},cancel(){t.releaseLock()}})}static fromAsyncGenerator(e){return new r({async pull(t){let{value:n,done:A}=await e.next();A&&t.close(),t.enqueue(n)},async cancel(t){await e.return(t)}})}};function Oh(r,e=2){let t=Array.from({length:e},()=>[]);return t.map(async function*(A){for(;;)if(A.length===0){let s=await r.next();for(let i of t)i.push(s)}else{if(A[0].done)return;yield A.shift().value}})}function wA(r,e){if(Array.isArray(r)&&Array.isArray(e))return r.concat(e);if(typeof r=="string"&&typeof e=="string")return r+e;if(typeof r=="number"&&typeof e=="number")return r+e;if("concat"in r&&typeof r.concat=="function")return r.concat(e);if(typeof r=="object"&&typeof e=="object"){let t={...r};for(let[n,A]of Object.entries(e))n in t&&!Array.isArray(t[n])?t[n]=wA(t[n],A):t[n]=A;return t}else throw new Error(`Cannot concat ${typeof r} and ${typeof e}`)}var gA=class{constructor(e){Object.defineProperty(this,"generator",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"setup",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"config",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"signal",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"firstResult",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"firstResultUsed",{enumerable:!0,configurable:!0,writable:!0,value:!1}),this.generator=e.generator,this.config=e.config,this.signal=e.signal??this.config?.signal,this.setup=new Promise((t,n)=>{cr.runWithConfig(en(e.config),async()=>{this.firstResult=e.generator.next(),e.startSetup?this.firstResult.then(e.startSetup).then(t,n):this.firstResult.then(A=>t(void 0),n)},!0)})}async next(...e){return this.signal?.throwIfAborted(),this.firstResultUsed?cr.runWithConfig(en(this.config),this.signal?async()=>Mn(this.generator.next(...e),this.signal):async()=>this.generator.next(...e),!0):(this.firstResultUsed=!0,this.firstResult)}async return(e){return this.generator.return(e)}async throw(e){return this.generator.throw(e)}[Symbol.asyncIterator](){return this}async[Symbol.asyncDispose](){await this.return()}};async function f0(r,e,t,n,...A){let s=new gA({generator:e,startSetup:t,signal:n}),i=await s.setup;return{output:r(s,i,...A),setup:i}}var ln=class{constructor(e){Object.defineProperty(this,"ops",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.ops=e.ops??[]}concat(e){let t=this.ops.concat(e.ops),n=is({},t);return new su({ops:t,state:n[n.length-1].newDocument})}},su=class r extends ln{constructor(e){super(e),Object.defineProperty(this,"state",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.state=e.state}concat(e){let t=this.ops.concat(e.ops),n=is(this.state,e.ops);return new r({ops:t,state:n[n.length-1].newDocument})}static fromRunLogPatch(e){let t=is({},e.ops);return new r({ops:e.ops,state:t[t.length-1].newDocument})}},h0=r=>r.name==="log_stream_tracer";async function d0(r,e){if(e==="original")throw new Error("Do not assign inputs with original schema drop the key for now. When inputs are added to streamLog they should be added with standardized schema for streaming events.");let{inputs:t}=r;if(["retriever","llm","prompt"].includes(r.run_type))return t;if(!(Object.keys(t).length===1&&t?.input===""))return t.input}async function p0(r,e){let{outputs:t}=r;return e==="original"||["retriever","llm","prompt"].includes(r.run_type)?t:t!==void 0&&Object.keys(t).length===1&&t?.output!==void 0?t.output:t}function Uk(r){return r!==void 0&&r.message!==void 0}var iu=class extends Xr{constructor(e){super({_awaitHandler:!0,...e}),Object.defineProperty(this,"autoClose",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"includeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_schemaFormat",{enumerable:!0,configurable:!0,writable:!0,value:"original"}),Object.defineProperty(this,"rootId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"keyMapByRunId",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"counterMapByRunName",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"transformStream",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"writer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"receiveStream",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"log_stream_tracer"}),Object.defineProperty(this,"lc_prefer_streaming",{enumerable:!0,configurable:!0,writable:!0,value:!0}),this.autoClose=e?.autoClose??!0,this.includeNames=e?.includeNames,this.includeTypes=e?.includeTypes,this.includeTags=e?.includeTags,this.excludeNames=e?.excludeNames,this.excludeTypes=e?.excludeTypes,this.excludeTags=e?.excludeTags,this._schemaFormat=e?._schemaFormat??this._schemaFormat,this.transformStream=new TransformStream,this.writer=this.transformStream.writable.getWriter(),this.receiveStream=Yt.fromReadableStream(this.transformStream.readable)}[Symbol.asyncIterator](){return this.receiveStream}async persistRun(e){}_includeRun(e){if(e.id===this.rootId)return!1;let t=e.tags??[],n=this.includeNames===void 0&&this.includeTags===void 0&&this.includeTypes===void 0;return this.includeNames!==void 0&&(n=n||this.includeNames.includes(e.name)),this.includeTypes!==void 0&&(n=n||this.includeTypes.includes(e.run_type)),this.includeTags!==void 0&&(n=n||t.find(A=>this.includeTags?.includes(A))!==void 0),this.excludeNames!==void 0&&(n=n&&!this.excludeNames.includes(e.name)),this.excludeTypes!==void 0&&(n=n&&!this.excludeTypes.includes(e.run_type)),this.excludeTags!==void 0&&(n=n&&t.every(A=>!this.excludeTags?.includes(A))),n}async*tapOutputIterable(e,t){for await(let n of t){if(e!==this.rootId){let A=this.keyMapByRunId[e];A&&await this.writer.write(new ln({ops:[{op:"add",path:`/logs/${A}/streamed_output/-`,value:n}]}))}yield n}}async onRunCreate(e){if(this.rootId===void 0&&(this.rootId=e.id,await this.writer.write(new ln({ops:[{op:"replace",path:"",value:{id:e.id,name:e.name,type:e.run_type,streamed_output:[],final_output:void 0,logs:{}}}]}))),!this._includeRun(e))return;this.counterMapByRunName[e.name]===void 0&&(this.counterMapByRunName[e.name]=0),this.counterMapByRunName[e.name]+=1;let t=this.counterMapByRunName[e.name];this.keyMapByRunId[e.id]=t===1?e.name:`${e.name}:${t}`;let n={id:e.id,name:e.name,type:e.run_type,tags:e.tags??[],metadata:e.extra?.metadata??{},start_time:new Date(e.start_time).toISOString(),streamed_output:[],streamed_output_str:[],final_output:void 0,end_time:void 0};this._schemaFormat==="streaming_events"&&(n.inputs=await d0(e,this._schemaFormat)),await this.writer.write(new ln({ops:[{op:"add",path:`/logs/${this.keyMapByRunId[e.id]}`,value:n}]}))}async onRunUpdate(e){try{let t=this.keyMapByRunId[e.id];if(t===void 0)return;let n=[];this._schemaFormat==="streaming_events"&&n.push({op:"replace",path:`/logs/${t}/inputs`,value:await d0(e,this._schemaFormat)}),n.push({op:"add",path:`/logs/${t}/final_output`,value:await p0(e,this._schemaFormat)}),e.end_time!==void 0&&n.push({op:"add",path:`/logs/${t}/end_time`,value:new Date(e.end_time).toISOString()});let A=new ln({ops:n});await this.writer.write(A)}finally{if(e.id===this.rootId){let t=new ln({ops:[{op:"replace",path:"/final_output",value:await p0(e,this._schemaFormat)}]});await this.writer.write(t),this.autoClose&&await this.writer.close()}}}async onLLMNewToken(e,t,n){let A=this.keyMapByRunId[e.id];if(A===void 0)return;let s=e.inputs.messages!==void 0,i;s?Uk(n?.chunk)?i=n?.chunk:i=new Sr({id:`run-${e.id}`,content:t}):i=t;let a=new ln({ops:[{op:"add",path:`/logs/${A}/streamed_output_str/-`,value:t},{op:"add",path:`/logs/${A}/streamed_output/-`,value:i}]});await this.writer.write(a)}};var jl="__run",$n=class r{constructor(e){Object.defineProperty(this,"text",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"generationInfo",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.text=e.text,this.generationInfo=e.generationInfo}concat(e){return new r({text:this.text+e.text,generationInfo:{...this.generationInfo,...e.generationInfo}})}},yA=class r extends $n{constructor(e){super(e),Object.defineProperty(this,"message",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.message=e.message}concat(e){return new r({text:this.text+e.text,generationInfo:{...this.generationInfo,...e.generationInfo},message:this.message.concat(e.message)})}};function Kl({name:r,serialized:e}){return r!==void 0?r:e?.name!==void 0?e.name:e?.id!==void 0&&Array.isArray(e?.id)?e.id[e.id.length-1]:"Unnamed"}var m0=r=>r.name==="event_stream_tracer",zl=class extends Xr{constructor(e){super({_awaitHandler:!0,...e}),Object.defineProperty(this,"autoClose",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"includeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"runInfoMap",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"tappedPromises",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"transformStream",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"writer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"receiveStream",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"event_stream_tracer"}),Object.defineProperty(this,"lc_prefer_streaming",{enumerable:!0,configurable:!0,writable:!0,value:!0}),this.autoClose=e?.autoClose??!0,this.includeNames=e?.includeNames,this.includeTypes=e?.includeTypes,this.includeTags=e?.includeTags,this.excludeNames=e?.excludeNames,this.excludeTypes=e?.excludeTypes,this.excludeTags=e?.excludeTags,this.transformStream=new TransformStream,this.writer=this.transformStream.writable.getWriter(),this.receiveStream=Yt.fromReadableStream(this.transformStream.readable)}[Symbol.asyncIterator](){return this.receiveStream}async persistRun(e){}_includeRun(e){let t=e.tags??[],n=this.includeNames===void 0&&this.includeTags===void 0&&this.includeTypes===void 0;return this.includeNames!==void 0&&(n=n||this.includeNames.includes(e.name)),this.includeTypes!==void 0&&(n=n||this.includeTypes.includes(e.runType)),this.includeTags!==void 0&&(n=n||t.find(A=>this.includeTags?.includes(A))!==void 0),this.excludeNames!==void 0&&(n=n&&!this.excludeNames.includes(e.name)),this.excludeTypes!==void 0&&(n=n&&!this.excludeTypes.includes(e.runType)),this.excludeTags!==void 0&&(n=n&&t.every(A=>!this.excludeTags?.includes(A))),n}async*tapOutputIterable(e,t){let n=await t.next();if(n.done)return;let A=this.runInfoMap.get(e);if(A===void 0){yield n.value;return}function s(a,f){return a==="llm"&&typeof f=="string"?new $n({text:f}):f}let i=this.tappedPromises.get(e);if(i===void 0){let a;i=new Promise(f=>{a=f}),this.tappedPromises.set(e,i);try{let f={event:`on_${A.runType}_stream`,run_id:e,name:A.name,tags:A.tags,metadata:A.metadata,data:{}};await this.send({...f,data:{chunk:s(A.runType,n.value)}},A),yield n.value;for await(let d of t)A.runType!=="tool"&&A.runType!=="retriever"&&await this.send({...f,data:{chunk:s(A.runType,d)}},A),yield d}finally{a()}}else{yield n.value;for await(let a of t)yield a}}async send(e,t){this._includeRun(t)&&await this.writer.write(e)}async sendEndEvent(e,t){let n=this.tappedPromises.get(e.run_id);n!==void 0?n.then(()=>{this.send(e,t)}):await this.send(e,t)}async onLLMStart(e){let t=Kl(e),n=e.inputs.messages!==void 0?"chat_model":"llm",A={tags:e.tags??[],metadata:e.extra?.metadata??{},name:t,runType:n,inputs:e.inputs};this.runInfoMap.set(e.id,A);let s=`on_${n}_start`;await this.send({event:s,data:{input:e.inputs},name:t,tags:e.tags??[],run_id:e.id,metadata:e.extra?.metadata??{}},A)}async onLLMNewToken(e,t,n){let A=this.runInfoMap.get(e.id),s,i;if(A===void 0)throw new Error(`onLLMNewToken: Run ID ${e.id} not found in run map.`);if(this.runInfoMap.size!==1){if(A.runType==="chat_model")i="on_chat_model_stream",n?.chunk===void 0?s=new Sr({content:t,id:`run-${e.id}`}):s=n.chunk.message;else if(A.runType==="llm")i="on_llm_stream",n?.chunk===void 0?s=new $n({text:t}):s=n.chunk;else throw new Error(`Unexpected run type ${A.runType}`);await this.send({event:i,data:{chunk:s},run_id:e.id,name:A.name,tags:A.tags,metadata:A.metadata},A)}}async onLLMEnd(e){let t=this.runInfoMap.get(e.id);this.runInfoMap.delete(e.id);let n;if(t===void 0)throw new Error(`onLLMEnd: Run ID ${e.id} not found in run map.`);let A=e.outputs?.generations,s;if(t.runType==="chat_model"){for(let i of A??[]){if(s!==void 0)break;s=i[0]?.message}n="on_chat_model_end"}else if(t.runType==="llm")s={generations:A?.map(i=>i.map(a=>({text:a.text,generationInfo:a.generationInfo}))),llmOutput:e.outputs?.llmOutput??{}},n="on_llm_end";else throw new Error(`onLLMEnd: Unexpected run type: ${t.runType}`);await this.sendEndEvent({event:n,data:{output:s,input:t.inputs},run_id:e.id,name:t.name,tags:t.tags,metadata:t.metadata},t)}async onChainStart(e){let t=Kl(e),n=e.run_type??"chain",A={tags:e.tags??[],metadata:e.extra?.metadata??{},name:t,runType:e.run_type},s={};e.inputs.input===""&&Object.keys(e.inputs).length===1?(s={},A.inputs={}):e.inputs.input!==void 0?(s.input=e.inputs.input,A.inputs=e.inputs.input):(s.input=e.inputs,A.inputs=e.inputs),this.runInfoMap.set(e.id,A),await this.send({event:`on_${n}_start`,data:s,name:t,tags:e.tags??[],run_id:e.id,metadata:e.extra?.metadata??{}},A)}async onChainEnd(e){let t=this.runInfoMap.get(e.id);if(this.runInfoMap.delete(e.id),t===void 0)throw new Error(`onChainEnd: Run ID ${e.id} not found in run map.`);let n=`on_${e.run_type}_end`,A=e.inputs??t.inputs??{},i={output:e.outputs?.output??e.outputs,input:A};A.input&&Object.keys(A).length===1&&(i.input=A.input,t.inputs=A.input),await this.sendEndEvent({event:n,data:i,run_id:e.id,name:t.name,tags:t.tags,metadata:t.metadata??{}},t)}async onToolStart(e){let t=Kl(e),n={tags:e.tags??[],metadata:e.extra?.metadata??{},name:t,runType:"tool",inputs:e.inputs??{}};this.runInfoMap.set(e.id,n),await this.send({event:"on_tool_start",data:{input:e.inputs??{}},name:t,run_id:e.id,tags:e.tags??[],metadata:e.extra?.metadata??{}},n)}async onToolEnd(e){let t=this.runInfoMap.get(e.id);if(this.runInfoMap.delete(e.id),t===void 0)throw new Error(`onToolEnd: Run ID ${e.id} not found in run map.`);if(t.inputs===void 0)throw new Error(`onToolEnd: Run ID ${e.id} is a tool call, and is expected to have traced inputs.`);let n=e.outputs?.output===void 0?e.outputs:e.outputs.output;await this.sendEndEvent({event:"on_tool_end",data:{output:n,input:t.inputs},run_id:e.id,name:t.name,tags:t.tags,metadata:t.metadata},t)}async onRetrieverStart(e){let t=Kl(e),A={tags:e.tags??[],metadata:e.extra?.metadata??{},name:t,runType:"retriever",inputs:{query:e.inputs.query}};this.runInfoMap.set(e.id,A),await this.send({event:"on_retriever_start",data:{input:{query:e.inputs.query}},name:t,tags:e.tags??[],run_id:e.id,metadata:e.extra?.metadata??{}},A)}async onRetrieverEnd(e){let t=this.runInfoMap.get(e.id);if(this.runInfoMap.delete(e.id),t===void 0)throw new Error(`onRetrieverEnd: Run ID ${e.id} not found in run map.`);await this.sendEndEvent({event:"on_retriever_end",data:{output:e.outputs?.documents??e.outputs,input:t.inputs},run_id:e.id,name:t.name,tags:t.tags,metadata:t.metadata},t)}async handleCustomEvent(e,t,n){let A=this.runInfoMap.get(n);if(A===void 0)throw new Error(`handleCustomEvent: Run ID ${n} not found in run map.`);await this.send({event:"on_custom_event",run_id:n,name:e,tags:A.tags,metadata:A.metadata,data:t},A)}async finish(){let e=[...this.tappedPromises.values()];Promise.all(e).finally(()=>{this.writer.close()})}};var g0=Ur(Wc(),1),Gl=Ur(wl(),1),Fk=[400,401,402,403,404,405,406,407,409],Qk=r=>{if(r.message.startsWith("Cancel")||r.message.startsWith("AbortError")||r.name==="AbortError"||r?.code==="ECONNABORTED")throw r;let e=r?.response?.status??r?.status;if(e&&Fk.includes(+e))throw r;if(r?.error?.code==="insufficient_quota"){let t=new Error(r?.message);throw t.name="InsufficientQuotaError",t}},_A=class{constructor(e){Object.defineProperty(this,"maxConcurrency",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxRetries",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"onFailedAttempt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"queue",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxConcurrency=e.maxConcurrency??1/0,this.maxRetries=e.maxRetries??6,this.onFailedAttempt=e.onFailedAttempt??Qk;let t="default"in Gl.default?Gl.default.default:Gl.default;this.queue=new t({concurrency:this.maxConcurrency})}call(e,...t){return this.queue.add(()=>(0,g0.default)(()=>e(...t).catch(n=>{throw n instanceof Error?n:new Error(n)}),{onFailedAttempt:this.onFailedAttempt,retries:this.maxRetries,randomize:!0}),{throwOnTimeout:!0})}callWithOptions(e,t,...n){return e.signal?Promise.race([this.call(t,...n),new Promise((A,s)=>{e.signal?.addEventListener("abort",()=>{s(new Error("AbortError"))})})]):this.call(t,...n)}fetch(...e){return this.call(()=>fetch(...e).then(t=>t.ok?t:Promise.reject(t)))}};var au=class extends Xr{constructor({config:e,onStart:t,onEnd:n,onError:A}){super({_awaitHandler:!0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"RootListenersTracer"}),Object.defineProperty(this,"rootId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"config",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"argOnStart",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"argOnEnd",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"argOnError",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.config=e,this.argOnStart=t,this.argOnEnd=n,this.argOnError=A}persistRun(e){return Promise.resolve()}async onRunCreate(e){this.rootId||(this.rootId=e.id,this.argOnStart&&await this.argOnStart(e,this.config))}async onRunUpdate(e){e.id===this.rootId&&(e.error?this.argOnError&&await this.argOnError(e,this.config):this.argOnEnd&&await this.argOnEnd(e,this.config))}};function ou(r){return r?r.lc_runnable:!1}var Vl=class{constructor(e){Object.defineProperty(this,"includeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.includeNames=e.includeNames,this.includeTypes=e.includeTypes,this.includeTags=e.includeTags,this.excludeNames=e.excludeNames,this.excludeTypes=e.excludeTypes,this.excludeTags=e.excludeTags}includeEvent(e,t){let n=this.includeNames===void 0&&this.includeTypes===void 0&&this.includeTags===void 0,A=e.tags??[];return this.includeNames!==void 0&&(n=n||this.includeNames.includes(e.name)),this.includeTypes!==void 0&&(n=n||this.includeTypes.includes(t)),this.includeTags!==void 0&&(n=n||A.some(s=>this.includeTags?.includes(s))),this.excludeNames!==void 0&&(n=n&&!this.excludeNames.includes(e.name)),this.excludeTypes!==void 0&&(n=n&&!this.excludeTypes.includes(t)),this.excludeTags!==void 0&&(n=n&&A.every(s=>!this.excludeTags?.includes(s))),n}};function Sh(r){return r.replace(/[^a-zA-Z-_0-9]/g,"_")}var Tk=["*","_","`"];function Ok(r){let e="";for(let[t,n]of Object.entries(r))e+=`	classDef ${t} ${n};
`;return e}function w0(r,e,t){let{firstNode:n,lastNode:A,nodeColors:s,withStyles:i=!0,curveStyle:a="linear",wrapLabelNWords:f=9}=t??{},d=i?`%%{init: {'flowchart': {'curve': '${a}'}}}%%
graph TD;
`:`graph TD;
`;if(i){let w="default",b={[w]:"{0}({1})"};n!==void 0&&(b[n]="{0}([{1}]):::first"),A!==void 0&&(b[A]="{0}([{1}]):::last");for(let[C,I]of Object.entries(r)){let T=I.name.split(":").pop()??"",P=Tk.some(D=>T.startsWith(D)&&T.endsWith(D))?`<p>${T}</p>`:T;Object.keys(I.metadata??{}).length&&(P+=`<hr/><small><em>${Object.entries(I.metadata??{}).map(([D,ee])=>`${D} = ${ee}`).join(`
`)}</em></small>`);let R=(b[C]??b[w]).replace("{0}",Sh(C)).replace("{1}",P);d+=`	${R}
`}}let h={};for(let w of e){let b=w.source.split(":"),C=w.target.split(":"),I=b.filter((T,Q)=>T===C[Q]).join(":");h[I]||(h[I]=[]),h[I].push(w)}let m=new Set;function y(w,b){let C=w.length===1&&w[0].source===w[0].target;if(b&&!C){let I=b.split(":").pop();if(m.has(I))throw new Error(`Found duplicate subgraph '${I}' -- this likely means that you're reusing a subgraph node with the same name. Please adjust your graph to have subgraph nodes with unique names.`);m.add(I),d+=`	subgraph ${I}
`}for(let I of w){let{source:T,target:Q,data:P,conditional:R}=I,D="";if(P!==void 0){let ee=P,Y=ee.split(" ");Y.length>f&&(ee=Array.from({length:Math.ceil(Y.length/f)},(fe,ve)=>Y.slice(ve*f,(ve+1)*f).join(" ")).join("&nbsp;<br>&nbsp;")),D=R?` -. &nbsp;${ee}&nbsp; .-> `:` -- &nbsp;${ee}&nbsp; --> `}else D=R?" -.-> ":" --> ";d+=`	${Sh(T)}${D}${Sh(Q)};
`}for(let I in h)I.startsWith(`${b}:`)&&I!==b&&y(h[I],I);b&&!C&&(d+=`	end
`)}y(h[""]??[],"");for(let w in h)!w.includes(":")&&w!==""&&y(h[w],w);return i&&(d+=Ok(s??{})),d}async function y0(r,e){let{backgroundColor:t="white"}=e??{},n=btoa(r);t!==void 0&&(/^#(?:[0-9a-fA-F]{3}){1,2}$/.test(t)||(t=`!${t}`));let A=`https://mermaid.ink/img/${n}?bgColor=${t}`,s=await fetch(A);if(!s.ok)throw new Error(["Failed to render the graph using the Mermaid.INK API.",`Status code: ${s.status}`,`Status text: ${s.statusText}`].join(`
`));return await s.blob()}var C3=Object.freeze({status:"aborted"});function Na(r,e,t){function n(a,f){var d;Object.defineProperty(a,"_zod",{value:a._zod??{},enumerable:!1}),(d=a._zod).traits??(d.traits=new Set),a._zod.traits.add(r),e(a,f);for(let h in i.prototype)h in a||Object.defineProperty(a,h,{value:i.prototype[h].bind(a)});a._zod.constr=i,a._zod.def=f}let A=t?.Parent??Object;class s extends A{}Object.defineProperty(s,"name",{value:r});function i(a){var f;let d=t?.Parent?new s:this;n(d,a),(f=d._zod).deferred??(f.deferred=[]);for(let h of d._zod.deferred)h();return d}return Object.defineProperty(i,"init",{value:n}),Object.defineProperty(i,Symbol.hasInstance,{value:a=>t?.Parent&&a instanceof t.Parent?!0:a?._zod?.traits?.has(r)}),Object.defineProperty(i,"name",{value:r}),i}var E3=Symbol("zod_brand"),us=class extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}},Ph={};function La(r){return r&&Object.assign(Ph,r),Ph}function Rh(r){let e=Object.values(r).filter(n=>typeof n=="number");return Object.entries(r).filter(([n,A])=>e.indexOf(+n)===-1).map(([n,A])=>A)}function b0(r,e){return typeof e=="bigint"?e.toString():e}function B0(r){return{get value(){{let t=r();return Object.defineProperty(this,"value",{value:t}),t}throw new Error("cached value already set")}}}var kh=Error.captureStackTrace?Error.captureStackTrace:(...r)=>{};var Sk=B0(()=>{if(typeof navigator<"u"&&navigator?.userAgent?.includes("Cloudflare"))return!1;try{let r=Function;return new r(""),!0}catch{return!1}});function Ha(r,e,t){let n=new r._zod.constr(e??r._zod.def);return(!e||t?.parent)&&(n._zod.parent=r),n}function v0(r){let e=r;if(!e)return{};if(typeof e=="string")return{error:()=>e};if(e?.message!==void 0){if(e?.error!==void 0)throw new Error("Cannot specify both `message` and `error` params");e.error=e.message}return delete e.message,typeof e.error=="string"?{...e,error:()=>e.error}:e}var x3={safeint:[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],int32:[-2147483648,2147483647],uint32:[0,4294967295],float32:[-34028234663852886e22,34028234663852886e22],float64:[-Number.MAX_VALUE,Number.MAX_VALUE]};function Jl(r,e=0){for(let t=e;t<r.issues.length;t++)if(r.issues[t]?.continue!==!0)return!0;return!1}function Zl(r){return typeof r=="string"?r:r?.message}function Da(r,e,t){let n={...r,path:r.path??[]};if(!r.message){let A=Zl(r.inst?._zod.def?.error?.(r))??Zl(e?.error?.(r))??Zl(t.customError?.(r))??Zl(t.localeError?.(r))??"Invalid input";n.message=A}return delete n.inst,delete n.continue,e?.reportInput||delete n.input,n}var C0=(r,e)=>{r.name="$ZodError",Object.defineProperty(r,"_zod",{value:r._zod,enumerable:!1}),Object.defineProperty(r,"issues",{value:e,enumerable:!1}),Object.defineProperty(r,"message",{get(){return JSON.stringify(e,b0,2)},enumerable:!0}),Object.defineProperty(r,"toString",{value:()=>r.message,enumerable:!1})},E0=Na("$ZodError",C0),cu=Na("$ZodError",C0,{Parent:Error});var Rk=r=>(e,t,n,A)=>{let s=n?Object.assign(n,{async:!1}):{async:!1},i=e._zod.run({value:t,issues:[]},s);if(i instanceof Promise)throw new us;if(i.issues.length){let a=new(A?.Err??r)(i.issues.map(f=>Da(f,s,La())));throw kh(a,A?.callee),a}return i.value},Wl=Rk(cu),kk=r=>async(e,t,n,A)=>{let s=n?Object.assign(n,{async:!0}):{async:!0},i=e._zod.run({value:t,issues:[]},s);if(i instanceof Promise&&(i=await i),i.issues.length){let a=new(A?.Err??r)(i.issues.map(f=>Da(f,s,La())));throw kh(a,A?.callee),a}return i.value},x0=kk(cu),Nk=r=>(e,t,n)=>{let A=n?{...n,async:!1}:{async:!1},s=e._zod.run({value:t,issues:[]},A);if(s instanceof Promise)throw new us;return s.issues.length?{success:!1,error:new(r??E0)(s.issues.map(i=>Da(i,A,La())))}:{success:!0,data:s.value}},I0=Nk(cu),Lk=r=>async(e,t,n)=>{let A=n?Object.assign(n,{async:!0}):{async:!0},s=e._zod.run({value:t,issues:[]},A);return s instanceof Promise&&(s=await s),s.issues.length?{success:!1,error:new r(s.issues.map(i=>Da(i,A,La())))}:{success:!0,data:s.value}},U0=Lk(cu);var F0={major:4,minor:0,patch:0};var Hk=Na("$ZodType",(r,e)=>{var t;r??(r={}),r._zod.def=e,r._zod.bag=r._zod.bag||{},r._zod.version=F0;let n=[...r._zod.def.checks??[]];r._zod.traits.has("$ZodCheck")&&n.unshift(r);for(let A of n)for(let s of A._zod.onattach)s(r);if(n.length===0)(t=r._zod).deferred??(t.deferred=[]),r._zod.deferred?.push(()=>{r._zod.run=r._zod.parse});else{let A=(s,i,a)=>{let f=Jl(s),d;for(let h of i){if(h._zod.def.when){if(!h._zod.def.when(s))continue}else if(f)continue;let m=s.issues.length,y=h._zod.check(s);if(y instanceof Promise&&a?.async===!1)throw new us;if(d||y instanceof Promise)d=(d??Promise.resolve()).then(async()=>{await y,s.issues.length!==m&&(f||(f=Jl(s,m)))});else{if(s.issues.length===m)continue;f||(f=Jl(s,m))}}return d?d.then(()=>s):s};r._zod.run=(s,i)=>{let a=r._zod.parse(s,i);if(a instanceof Promise){if(i.async===!1)throw new us;return a.then(f=>A(f,n,i))}return A(a,n,i)}}r["~standard"]={validate:A=>{try{let s=I0(r,A);return s.success?{value:s.data}:{issues:s.error?.issues}}catch{return U0(r,A).then(i=>i.success?{value:i.data}:{issues:i.error?.issues})}},vendor:"zod",version:1}});var Q0=Na("$ZodNever",(r,e)=>{Hk.init(r,e),r._zod.parse=(t,n)=>(t.issues.push({expected:"never",code:"invalid_type",input:t.value,inst:r}),t)});var z3=Symbol("ZodOutput"),G3=Symbol("ZodInput"),lu=class{constructor(){this._map=new Map,this._idmap=new Map}add(e,...t){let n=t[0];if(this._map.set(e,n),n&&typeof n=="object"&&"id"in n){if(this._idmap.has(n.id))throw new Error(`ID ${n.id} already exists in the registry`);this._idmap.set(n.id,e)}return this}clear(){return this._map=new Map,this._idmap=new Map,this}remove(e){let t=this._map.get(e);return t&&typeof t=="object"&&"id"in t&&this._idmap.delete(t.id),this._map.delete(e),this}get(e){let t=e._zod.parent;if(t){let n={...this.get(t)??{}};return delete n.id,{...n,...this._map.get(e)}}return this._map.get(e)}has(e){return this._map.has(e)}};function Dk(){return new lu}var jn=Dk();function T0(r,e){return new r({type:"never",...v0(e)})}var ql=class{constructor(e){this.counter=0,this.metadataRegistry=e?.metadata??jn,this.target=e?.target??"draft-2020-12",this.unrepresentable=e?.unrepresentable??"throw",this.override=e?.override??(()=>{}),this.io=e?.io??"output",this.seen=new Map}process(e,t={path:[],schemaPath:[]}){var n;let A=e._zod.def,s={guid:"uuid",url:"uri",datetime:"date-time",json_string:"json-string",regex:""},i=this.seen.get(e);if(i)return i.count++,t.schemaPath.includes(e)&&(i.cycle=t.path),i.schema;let a={schema:{},count:1,cycle:void 0,path:t.path};this.seen.set(e,a);let f=e._zod.toJSONSchema?.();if(f)a.schema=f;else{let m={...t,schemaPath:[...t.schemaPath,e],path:t.path},y=e._zod.parent;if(y)a.ref=y,this.process(y,m),this.seen.get(y).isParent=!0;else{let w=a.schema;switch(A.type){case"string":{let b=w;b.type="string";let{minimum:C,maximum:I,format:T,patterns:Q,contentEncoding:P}=e._zod.bag;if(typeof C=="number"&&(b.minLength=C),typeof I=="number"&&(b.maxLength=I),T&&(b.format=s[T]??T,b.format===""&&delete b.format),P&&(b.contentEncoding=P),Q&&Q.size>0){let R=[...Q];R.length===1?b.pattern=R[0].source:R.length>1&&(a.schema.allOf=[...R.map(D=>({...this.target==="draft-7"?{type:"string"}:{},pattern:D.source}))])}break}case"number":{let b=w,{minimum:C,maximum:I,format:T,multipleOf:Q,exclusiveMaximum:P,exclusiveMinimum:R}=e._zod.bag;typeof T=="string"&&T.includes("int")?b.type="integer":b.type="number",typeof R=="number"&&(b.exclusiveMinimum=R),typeof C=="number"&&(b.minimum=C,typeof R=="number"&&(R>=C?delete b.minimum:delete b.exclusiveMinimum)),typeof P=="number"&&(b.exclusiveMaximum=P),typeof I=="number"&&(b.maximum=I,typeof P=="number"&&(P<=I?delete b.maximum:delete b.exclusiveMaximum)),typeof Q=="number"&&(b.multipleOf=Q);break}case"boolean":{let b=w;b.type="boolean";break}case"bigint":{if(this.unrepresentable==="throw")throw new Error("BigInt cannot be represented in JSON Schema");break}case"symbol":{if(this.unrepresentable==="throw")throw new Error("Symbols cannot be represented in JSON Schema");break}case"null":{w.type="null";break}case"any":break;case"unknown":break;case"undefined":{if(this.unrepresentable==="throw")throw new Error("Undefined cannot be represented in JSON Schema");break}case"void":{if(this.unrepresentable==="throw")throw new Error("Void cannot be represented in JSON Schema");break}case"never":{w.not={};break}case"date":{if(this.unrepresentable==="throw")throw new Error("Date cannot be represented in JSON Schema");break}case"array":{let b=w,{minimum:C,maximum:I}=e._zod.bag;typeof C=="number"&&(b.minItems=C),typeof I=="number"&&(b.maxItems=I),b.type="array",b.items=this.process(A.element,{...m,path:[...m.path,"items"]});break}case"object":{let b=w;b.type="object",b.properties={};let C=A.shape;for(let Q in C)b.properties[Q]=this.process(C[Q],{...m,path:[...m.path,"properties",Q]});let I=new Set(Object.keys(C)),T=new Set([...I].filter(Q=>{let P=A.shape[Q]._zod;return this.io==="input"?P.optin===void 0:P.optout===void 0}));T.size>0&&(b.required=Array.from(T)),A.catchall?._zod.def.type==="never"?b.additionalProperties=!1:A.catchall?A.catchall&&(b.additionalProperties=this.process(A.catchall,{...m,path:[...m.path,"additionalProperties"]})):this.io==="output"&&(b.additionalProperties=!1);break}case"union":{let b=w;b.anyOf=A.options.map((C,I)=>this.process(C,{...m,path:[...m.path,"anyOf",I]}));break}case"intersection":{let b=w,C=this.process(A.left,{...m,path:[...m.path,"allOf",0]}),I=this.process(A.right,{...m,path:[...m.path,"allOf",1]}),T=P=>"allOf"in P&&Object.keys(P).length===1,Q=[...T(C)?C.allOf:[C],...T(I)?I.allOf:[I]];b.allOf=Q;break}case"tuple":{let b=w;b.type="array";let C=A.items.map((Q,P)=>this.process(Q,{...m,path:[...m.path,"prefixItems",P]}));if(this.target==="draft-2020-12"?b.prefixItems=C:b.items=C,A.rest){let Q=this.process(A.rest,{...m,path:[...m.path,"items"]});this.target==="draft-2020-12"?b.items=Q:b.additionalItems=Q}A.rest&&(b.items=this.process(A.rest,{...m,path:[...m.path,"items"]}));let{minimum:I,maximum:T}=e._zod.bag;typeof I=="number"&&(b.minItems=I),typeof T=="number"&&(b.maxItems=T);break}case"record":{let b=w;b.type="object",b.propertyNames=this.process(A.keyType,{...m,path:[...m.path,"propertyNames"]}),b.additionalProperties=this.process(A.valueType,{...m,path:[...m.path,"additionalProperties"]});break}case"map":{if(this.unrepresentable==="throw")throw new Error("Map cannot be represented in JSON Schema");break}case"set":{if(this.unrepresentable==="throw")throw new Error("Set cannot be represented in JSON Schema");break}case"enum":{let b=w,C=Rh(A.entries);C.every(I=>typeof I=="number")&&(b.type="number"),C.every(I=>typeof I=="string")&&(b.type="string"),b.enum=C;break}case"literal":{let b=w,C=[];for(let I of A.values)if(I===void 0){if(this.unrepresentable==="throw")throw new Error("Literal `undefined` cannot be represented in JSON Schema")}else if(typeof I=="bigint"){if(this.unrepresentable==="throw")throw new Error("BigInt literals cannot be represented in JSON Schema");C.push(Number(I))}else C.push(I);if(C.length!==0)if(C.length===1){let I=C[0];b.type=I===null?"null":typeof I,b.const=I}else C.every(I=>typeof I=="number")&&(b.type="number"),C.every(I=>typeof I=="string")&&(b.type="string"),C.every(I=>typeof I=="boolean")&&(b.type="string"),C.every(I=>I===null)&&(b.type="null"),b.enum=C;break}case"file":{let b=w,C={type:"string",format:"binary",contentEncoding:"binary"},{minimum:I,maximum:T,mime:Q}=e._zod.bag;I!==void 0&&(C.minLength=I),T!==void 0&&(C.maxLength=T),Q?Q.length===1?(C.contentMediaType=Q[0],Object.assign(b,C)):b.anyOf=Q.map(P=>({...C,contentMediaType:P})):Object.assign(b,C);break}case"transform":{if(this.unrepresentable==="throw")throw new Error("Transforms cannot be represented in JSON Schema");break}case"nullable":{let b=this.process(A.innerType,m);w.anyOf=[b,{type:"null"}];break}case"nonoptional":{this.process(A.innerType,m),a.ref=A.innerType;break}case"success":{let b=w;b.type="boolean";break}case"default":{this.process(A.innerType,m),a.ref=A.innerType,w.default=JSON.parse(JSON.stringify(A.defaultValue));break}case"prefault":{this.process(A.innerType,m),a.ref=A.innerType,this.io==="input"&&(w._prefault=JSON.parse(JSON.stringify(A.defaultValue)));break}case"catch":{this.process(A.innerType,m),a.ref=A.innerType;let b;try{b=A.catchValue(void 0)}catch{throw new Error("Dynamic catch values are not supported in JSON Schema")}w.default=b;break}case"nan":{if(this.unrepresentable==="throw")throw new Error("NaN cannot be represented in JSON Schema");break}case"template_literal":{let b=w,C=e._zod.pattern;if(!C)throw new Error("Pattern not found in template literal");b.type="string",b.pattern=C.source;break}case"pipe":{let b=this.io==="input"?A.in._zod.def.type==="transform"?A.out:A.in:A.out;this.process(b,m),a.ref=b;break}case"readonly":{this.process(A.innerType,m),a.ref=A.innerType,w.readOnly=!0;break}case"promise":{this.process(A.innerType,m),a.ref=A.innerType;break}case"optional":{this.process(A.innerType,m),a.ref=A.innerType;break}case"lazy":{let b=e._zod.innerType;this.process(b,m),a.ref=b;break}case"custom":{if(this.unrepresentable==="throw")throw new Error("Custom types cannot be represented in JSON Schema");break}default:}}}let d=this.metadataRegistry.get(e);return d&&Object.assign(a.schema,d),this.io==="input"&&Et(e)&&(delete a.schema.examples,delete a.schema.default),this.io==="input"&&a.schema._prefault&&((n=a.schema).default??(n.default=a.schema._prefault)),delete a.schema._prefault,this.seen.get(e).schema}emit(e,t){let n={cycles:t?.cycles??"ref",reused:t?.reused??"inline",external:t?.external??void 0},A=this.seen.get(e);if(!A)throw new Error("Unprocessed schema. This is a bug in Zod.");let s=h=>{let m=this.target==="draft-2020-12"?"$defs":"definitions";if(n.external){let C=n.external.registry.get(h[0])?.id,I=n.external.uri??(Q=>Q);if(C)return{ref:I(C)};let T=h[1].defId??h[1].schema.id??`schema${this.counter++}`;return h[1].defId=T,{defId:T,ref:`${I("__shared")}#/${m}/${T}`}}if(h[1]===A)return{ref:"#"};let w=`#/${m}/`,b=h[1].schema.id??`__schema${this.counter++}`;return{defId:b,ref:w+b}},i=h=>{if(h[1].schema.$ref)return;let m=h[1],{ref:y,defId:w}=s(h);m.def={...m.schema},w&&(m.defId=w);let b=m.schema;for(let C in b)delete b[C];b.$ref=y};if(n.cycles==="throw")for(let h of this.seen.entries()){let m=h[1];if(m.cycle)throw new Error(`Cycle detected: #/${m.cycle?.join("/")}/<root>

Set the \`cycles\` parameter to \`"ref"\` to resolve cyclical schemas with defs.`)}for(let h of this.seen.entries()){let m=h[1];if(e===h[0]){i(h);continue}if(n.external){let w=n.external.registry.get(h[0])?.id;if(e!==h[0]&&w){i(h);continue}}if(this.metadataRegistry.get(h[0])?.id){i(h);continue}if(m.cycle){i(h);continue}if(m.count>1&&n.reused==="ref"){i(h);continue}}let a=(h,m)=>{let y=this.seen.get(h),w=y.def??y.schema,b={...w};if(y.ref===null)return;let C=y.ref;if(y.ref=null,C){a(C,m);let I=this.seen.get(C).schema;I.$ref&&m.target==="draft-7"?(w.allOf=w.allOf??[],w.allOf.push(I)):(Object.assign(w,I),Object.assign(w,b))}y.isParent||this.override({zodSchema:h,jsonSchema:w,path:y.path??[]})};for(let h of[...this.seen.entries()].reverse())a(h[0],{target:this.target});let f={};if(this.target==="draft-2020-12"?f.$schema="https://json-schema.org/draft/2020-12/schema":this.target==="draft-7"?f.$schema="http://json-schema.org/draft-07/schema#":console.warn(`Invalid target: ${this.target}`),n.external?.uri){let h=n.external.registry.get(e)?.id;if(!h)throw new Error("Schema is missing an `id` property");f.$id=n.external.uri(h)}Object.assign(f,A.def);let d=n.external?.defs??{};for(let h of this.seen.entries()){let m=h[1];m.def&&m.defId&&(d[m.defId]=m.def)}n.external||Object.keys(d).length>0&&(this.target==="draft-2020-12"?f.$defs=d:f.definitions=d);try{return JSON.parse(JSON.stringify(f))}catch{throw new Error("Error converting schema to JSON.")}}};function fu(r,e){if(r instanceof lu){let n=new ql(e),A={};for(let a of r._idmap.entries()){let[f,d]=a;n.process(d)}let s={},i={registry:r,uri:e?.uri,defs:A};for(let a of r._idmap.entries()){let[f,d]=a;s[f]=n.emit(d,{...e,external:i})}if(Object.keys(A).length>0){let a=n.target==="draft-2020-12"?"$defs":"definitions";s.__shared={[a]:A}}return{schemas:s}}let t=new ql(e);return t.process(r),t.emit(r,e)}function Et(r,e){let t=e??{seen:new Set};if(t.seen.has(r))return!1;t.seen.add(r);let A=r._zod.def;switch(A.type){case"string":case"number":case"bigint":case"boolean":case"date":case"symbol":case"undefined":case"null":case"any":case"unknown":case"never":case"void":case"literal":case"enum":case"nan":case"file":case"template_literal":return!1;case"array":return Et(A.element,t);case"object":{for(let s in A.shape)if(Et(A.shape[s],t))return!0;return!1}case"union":{for(let s of A.options)if(Et(s,t))return!0;return!1}case"intersection":return Et(A.left,t)||Et(A.right,t);case"tuple":{for(let s of A.items)if(Et(s,t))return!0;return!!(A.rest&&Et(A.rest,t))}case"record":return Et(A.keyType,t)||Et(A.valueType,t);case"map":return Et(A.keyType,t)||Et(A.valueType,t);case"set":return Et(A.valueType,t);case"promise":case"optional":case"nonoptional":case"nullable":case"readonly":return Et(A.innerType,t);case"lazy":return Et(A.getter(),t);case"default":return Et(A.innerType,t);case"prefault":return Et(A.innerType,t);case"custom":return!1;case"transform":return!0;case"pipe":return Et(A.in,t)||Et(A.out,t);case"success":return!1;case"catch":return!1;default:}throw new Error(`Unknown schema type: ${A.type}`)}var S0=Symbol("Let zodToJsonSchema decide on which parser to use");var O0={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",removeAdditionalStrategy:"passthrough",allowedAdditionalProperties:!0,rejectedAdditionalProperties:!1,definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,definitions:{},errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref",openAiAnyTypeName:"OpenAiAnyType"},P0=r=>typeof r=="string"?{...O0,name:r}:{...O0,...r};var R0=r=>{let e=P0(r),t=e.name!==void 0?[...e.basePath,e.definitionPath,e.name]:e.basePath;return{...e,flags:{hasReferencedOpenAiAnyType:!1},currentPath:t,propertyPath:void 0,seen:new Map(Object.entries(e.definitions).map(([n,A])=>[A._def,{def:A._def,path:[...e.basePath,e.definitionPath,n],jsonSchema:void 0}]))}};function Nh(r,e,t,n){n?.errorMessages&&t&&(r.errorMessage={...r.errorMessage,[e]:t})}function De(r,e,t,n,A){r[e]=t,Nh(r,e,n,A)}var Xl=(r,e)=>{let t=0;for(;t<r.length&&t<e.length&&r[t]===e[t];t++);return[(r.length-t).toString(),...e.slice(t)].join("/")};function nt(r){if(r.target!=="openAi")return{};let e=[...r.basePath,r.definitionPath,r.openAiAnyTypeName];return r.flags.hasReferencedOpenAiAnyType=!0,{$ref:r.$refStrategy==="relative"?Xl(e,r.currentPath):e.join("/")}}function k0(r,e){let t={type:"array"};return r.type?._def&&r.type?._def?.typeName!==O.ZodAny&&(t.items=Be(r.type._def,{...e,currentPath:[...e.currentPath,"items"]})),r.minLength&&De(t,"minItems",r.minLength.value,r.minLength.message,e),r.maxLength&&De(t,"maxItems",r.maxLength.value,r.maxLength.message,e),r.exactLength&&(De(t,"minItems",r.exactLength.value,r.exactLength.message,e),De(t,"maxItems",r.exactLength.value,r.exactLength.message,e)),t}function N0(r,e){let t={type:"integer",format:"int64"};if(!r.checks)return t;for(let n of r.checks)switch(n.kind){case"min":e.target==="jsonSchema7"?n.inclusive?De(t,"minimum",n.value,n.message,e):De(t,"exclusiveMinimum",n.value,n.message,e):(n.inclusive||(t.exclusiveMinimum=!0),De(t,"minimum",n.value,n.message,e));break;case"max":e.target==="jsonSchema7"?n.inclusive?De(t,"maximum",n.value,n.message,e):De(t,"exclusiveMaximum",n.value,n.message,e):(n.inclusive||(t.exclusiveMaximum=!0),De(t,"maximum",n.value,n.message,e));break;case"multipleOf":De(t,"multipleOf",n.value,n.message,e);break}return t}function L0(){return{type:"boolean"}}function Yl(r,e){return Be(r.type._def,e)}var H0=(r,e)=>Be(r.innerType._def,e);function Lh(r,e,t){let n=t??e.dateStrategy;if(Array.isArray(n))return{anyOf:n.map((A,s)=>Lh(r,e,A))};switch(n){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return Mk(r,e)}}var Mk=(r,e)=>{let t={type:"integer",format:"unix-time"};if(e.target==="openApi3")return t;for(let n of r.checks)switch(n.kind){case"min":De(t,"minimum",n.value,n.message,e);break;case"max":De(t,"maximum",n.value,n.message,e);break}return t};function D0(r,e){return{...Be(r.innerType._def,e),default:r.defaultValue()}}function M0(r,e){return e.effectStrategy==="input"?Be(r.schema._def,e):nt(e)}function $0(r){return{type:"string",enum:Array.from(r.values)}}var $k=r=>"type"in r&&r.type==="string"?!1:"allOf"in r;function j0(r,e){let t=[Be(r.left._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),Be(r.right._def,{...e,currentPath:[...e.currentPath,"allOf","1"]})].filter(s=>!!s),n=e.target==="jsonSchema2019-09"?{unevaluatedProperties:!1}:void 0,A=[];return t.forEach(s=>{if($k(s))A.push(...s.allOf),s.unevaluatedProperties===void 0&&(n=void 0);else{let i=s;if("additionalProperties"in s&&s.additionalProperties===!1){let{additionalProperties:a,...f}=s;i=f}else n=void 0;A.push(i)}}),A.length?{allOf:A,...n}:void 0}function K0(r,e){let t=typeof r.value;return t!=="bigint"&&t!=="number"&&t!=="boolean"&&t!=="string"?{type:Array.isArray(r.value)?"array":"object"}:e.target==="openApi3"?{type:t==="bigint"?"integer":t,enum:[r.value]}:{type:t==="bigint"?"integer":t,const:r.value}}var Hh,fn={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(Hh===void 0&&(Hh=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),Hh),uuid:/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/,ipv4:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv4Cidr:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,ipv6:/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,ipv6Cidr:/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,base64url:/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/,jwt:/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/};function ef(r,e){let t={type:"string"};if(r.checks)for(let n of r.checks)switch(n.kind){case"min":De(t,"minLength",typeof t.minLength=="number"?Math.max(t.minLength,n.value):n.value,n.message,e);break;case"max":De(t,"maxLength",typeof t.maxLength=="number"?Math.min(t.maxLength,n.value):n.value,n.message,e);break;case"email":switch(e.emailStrategy){case"format:email":dn(t,"email",n.message,e);break;case"format:idn-email":dn(t,"idn-email",n.message,e);break;case"pattern:zod":lr(t,fn.email,n.message,e);break}break;case"url":dn(t,"uri",n.message,e);break;case"uuid":dn(t,"uuid",n.message,e);break;case"regex":lr(t,n.regex,n.message,e);break;case"cuid":lr(t,fn.cuid,n.message,e);break;case"cuid2":lr(t,fn.cuid2,n.message,e);break;case"startsWith":lr(t,RegExp(`^${Dh(n.value,e)}`),n.message,e);break;case"endsWith":lr(t,RegExp(`${Dh(n.value,e)}$`),n.message,e);break;case"datetime":dn(t,"date-time",n.message,e);break;case"date":dn(t,"date",n.message,e);break;case"time":dn(t,"time",n.message,e);break;case"duration":dn(t,"duration",n.message,e);break;case"length":De(t,"minLength",typeof t.minLength=="number"?Math.max(t.minLength,n.value):n.value,n.message,e),De(t,"maxLength",typeof t.maxLength=="number"?Math.min(t.maxLength,n.value):n.value,n.message,e);break;case"includes":{lr(t,RegExp(Dh(n.value,e)),n.message,e);break}case"ip":{n.version!=="v6"&&dn(t,"ipv4",n.message,e),n.version!=="v4"&&dn(t,"ipv6",n.message,e);break}case"base64url":lr(t,fn.base64url,n.message,e);break;case"jwt":lr(t,fn.jwt,n.message,e);break;case"cidr":{n.version!=="v6"&&lr(t,fn.ipv4Cidr,n.message,e),n.version!=="v4"&&lr(t,fn.ipv6Cidr,n.message,e);break}case"emoji":lr(t,fn.emoji(),n.message,e);break;case"ulid":{lr(t,fn.ulid,n.message,e);break}case"base64":{switch(e.base64Strategy){case"format:binary":{dn(t,"binary",n.message,e);break}case"contentEncoding:base64":{De(t,"contentEncoding","base64",n.message,e);break}case"pattern:zod":{lr(t,fn.base64,n.message,e);break}}break}case"nanoid":lr(t,fn.nanoid,n.message,e);case"toLowerCase":case"toUpperCase":case"trim":break;default:}return t}function Dh(r,e){return e.patternStrategy==="escape"?Kk(r):r}var jk=new Set("ABCDEFGHIJKLMNOPQRSTUVXYZabcdefghijklmnopqrstuvxyz0123456789");function Kk(r){let e="";for(let t=0;t<r.length;t++)jk.has(r[t])||(e+="\\"),e+=r[t];return e}function dn(r,e,t,n){r.format||r.anyOf?.some(A=>A.format)?(r.anyOf||(r.anyOf=[]),r.format&&(r.anyOf.push({format:r.format,...r.errorMessage&&n.errorMessages&&{errorMessage:{format:r.errorMessage.format}}}),delete r.format,r.errorMessage&&(delete r.errorMessage.format,Object.keys(r.errorMessage).length===0&&delete r.errorMessage)),r.anyOf.push({format:e,...t&&n.errorMessages&&{errorMessage:{format:t}}})):De(r,"format",e,t,n)}function lr(r,e,t,n){r.pattern||r.allOf?.some(A=>A.pattern)?(r.allOf||(r.allOf=[]),r.pattern&&(r.allOf.push({pattern:r.pattern,...r.errorMessage&&n.errorMessages&&{errorMessage:{pattern:r.errorMessage.pattern}}}),delete r.pattern,r.errorMessage&&(delete r.errorMessage.pattern,Object.keys(r.errorMessage).length===0&&delete r.errorMessage)),r.allOf.push({pattern:z0(e,n),...t&&n.errorMessages&&{errorMessage:{pattern:t}}})):De(r,"pattern",z0(e,n),t,n)}function z0(r,e){if(!e.applyRegexFlags||!r.flags)return r.source;let t={i:r.flags.includes("i"),m:r.flags.includes("m"),s:r.flags.includes("s")},n=t.i?r.source.toLowerCase():r.source,A="",s=!1,i=!1,a=!1;for(let f=0;f<n.length;f++){if(s){A+=n[f],s=!1;continue}if(t.i){if(i){if(n[f].match(/[a-z]/)){a?(A+=n[f],A+=`${n[f-2]}-${n[f]}`.toUpperCase(),a=!1):n[f+1]==="-"&&n[f+2]?.match(/[a-z]/)?(A+=n[f],a=!0):A+=`${n[f]}${n[f].toUpperCase()}`;continue}}else if(n[f].match(/[a-z]/)){A+=`[${n[f]}${n[f].toUpperCase()}]`;continue}}if(t.m){if(n[f]==="^"){A+=`(^|(?<=[\r
]))`;continue}else if(n[f]==="$"){A+=`($|(?=[\r
]))`;continue}}if(t.s&&n[f]==="."){A+=i?`${n[f]}\r
`:`[${n[f]}\r
]`;continue}A+=n[f],n[f]==="\\"?s=!0:i&&n[f]==="]"?i=!1:!i&&n[f]==="["&&(i=!0)}try{new RegExp(A)}catch{return console.warn(`Could not convert regex pattern at ${e.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),r.source}return A}function tf(r,e){if(e.target==="openAi"&&console.warn("Warning: OpenAI may not support records in schemas! Try an array of key-value pairs instead."),e.target==="openApi3"&&r.keyType?._def.typeName===O.ZodEnum)return{type:"object",required:r.keyType._def.values,properties:r.keyType._def.values.reduce((n,A)=>({...n,[A]:Be(r.valueType._def,{...e,currentPath:[...e.currentPath,"properties",A]})??nt(e)}),{}),additionalProperties:e.rejectedAdditionalProperties};let t={type:"object",additionalProperties:Be(r.valueType._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??e.allowedAdditionalProperties};if(e.target==="openApi3")return t;if(r.keyType?._def.typeName===O.ZodString&&r.keyType._def.checks?.length){let{type:n,...A}=ef(r.keyType._def,e);return{...t,propertyNames:A}}else{if(r.keyType?._def.typeName===O.ZodEnum)return{...t,propertyNames:{enum:r.keyType._def.values}};if(r.keyType?._def.typeName===O.ZodBranded&&r.keyType._def.type._def.typeName===O.ZodString&&r.keyType._def.type._def.checks?.length){let{type:n,...A}=Yl(r.keyType._def,e);return{...t,propertyNames:A}}}return t}function G0(r,e){if(e.mapStrategy==="record")return tf(r,e);let t=Be(r.keyType._def,{...e,currentPath:[...e.currentPath,"items","items","0"]})||nt(e),n=Be(r.valueType._def,{...e,currentPath:[...e.currentPath,"items","items","1"]})||nt(e);return{type:"array",maxItems:125,items:{type:"array",items:[t,n],minItems:2,maxItems:2}}}function V0(r){let e=r.values,n=Object.keys(r.values).filter(s=>typeof e[e[s]]!="number").map(s=>e[s]),A=Array.from(new Set(n.map(s=>typeof s)));return{type:A.length===1?A[0]==="string"?"string":"number":["string","number"],enum:n}}function Z0(r){return r.target==="openAi"?void 0:{not:nt({...r,currentPath:[...r.currentPath,"not"]})}}function J0(r){return r.target==="openApi3"?{enum:["null"],nullable:!0}:{type:"null"}}var du={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function q0(r,e){if(e.target==="openApi3")return W0(r,e);let t=r.options instanceof Map?Array.from(r.options.values()):r.options;if(t.every(n=>n._def.typeName in du&&(!n._def.checks||!n._def.checks.length))){let n=t.reduce((A,s)=>{let i=du[s._def.typeName];return i&&!A.includes(i)?[...A,i]:A},[]);return{type:n.length>1?n:n[0]}}else if(t.every(n=>n._def.typeName==="ZodLiteral"&&!n.description)){let n=t.reduce((A,s)=>{let i=typeof s._def.value;switch(i){case"string":case"number":case"boolean":return[...A,i];case"bigint":return[...A,"integer"];case"object":if(s._def.value===null)return[...A,"null"];case"symbol":case"undefined":case"function":default:return A}},[]);if(n.length===t.length){let A=n.filter((s,i,a)=>a.indexOf(s)===i);return{type:A.length>1?A:A[0],enum:t.reduce((s,i)=>s.includes(i._def.value)?s:[...s,i._def.value],[])}}}else if(t.every(n=>n._def.typeName==="ZodEnum"))return{type:"string",enum:t.reduce((n,A)=>[...n,...A._def.values.filter(s=>!n.includes(s))],[])};return W0(r,e)}var W0=(r,e)=>{let t=(r.options instanceof Map?Array.from(r.options.values()):r.options).map((n,A)=>Be(n._def,{...e,currentPath:[...e.currentPath,"anyOf",`${A}`]})).filter(n=>!!n&&(!e.strictUnions||typeof n=="object"&&Object.keys(n).length>0));return t.length?{anyOf:t}:void 0};function X0(r,e){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(r.innerType._def.typeName)&&(!r.innerType._def.checks||!r.innerType._def.checks.length))return e.target==="openApi3"?{type:du[r.innerType._def.typeName],nullable:!0}:{type:[du[r.innerType._def.typeName],"null"]};if(e.target==="openApi3"){let n=Be(r.innerType._def,{...e,currentPath:[...e.currentPath]});return n&&"$ref"in n?{allOf:[n],nullable:!0}:n&&{...n,nullable:!0}}let t=Be(r.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","0"]});return t&&{anyOf:[t,{type:"null"}]}}function Y0(r,e){let t={type:"number"};if(!r.checks)return t;for(let n of r.checks)switch(n.kind){case"int":t.type="integer",Nh(t,"type",n.message,e);break;case"min":e.target==="jsonSchema7"?n.inclusive?De(t,"minimum",n.value,n.message,e):De(t,"exclusiveMinimum",n.value,n.message,e):(n.inclusive||(t.exclusiveMinimum=!0),De(t,"minimum",n.value,n.message,e));break;case"max":e.target==="jsonSchema7"?n.inclusive?De(t,"maximum",n.value,n.message,e):De(t,"exclusiveMaximum",n.value,n.message,e):(n.inclusive||(t.exclusiveMaximum=!0),De(t,"maximum",n.value,n.message,e));break;case"multipleOf":De(t,"multipleOf",n.value,n.message,e);break}return t}function ev(r,e){let t=e.target==="openAi",n={type:"object",properties:{}},A=[],s=r.shape();for(let a in s){let f=s[a];if(f===void 0||f._def===void 0)continue;let d=Gk(f);d&&t&&(f._def.typeName==="ZodOptional"&&(f=f._def.innerType),f.isNullable()||(f=f.nullable()),d=!1);let h=Be(f._def,{...e,currentPath:[...e.currentPath,"properties",a],propertyPath:[...e.currentPath,"properties",a]});h!==void 0&&(n.properties[a]=h,d||A.push(a))}A.length&&(n.required=A);let i=zk(r,e);return i!==void 0&&(n.additionalProperties=i),n}function zk(r,e){if(r.catchall._def.typeName!=="ZodNever")return Be(r.catchall._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]});switch(r.unknownKeys){case"passthrough":return e.allowedAdditionalProperties;case"strict":return e.rejectedAdditionalProperties;case"strip":return e.removeAdditionalStrategy==="strict"?e.allowedAdditionalProperties:e.rejectedAdditionalProperties}}function Gk(r){try{return r.isOptional()}catch{return!0}}var tv=(r,e)=>{if(e.currentPath.toString()===e.propertyPath?.toString())return Be(r.innerType._def,e);let t=Be(r.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","1"]});return t?{anyOf:[{not:nt(e)},t]}:nt(e)};var rv=(r,e)=>{if(e.pipeStrategy==="input")return Be(r.in._def,e);if(e.pipeStrategy==="output")return Be(r.out._def,e);let t=Be(r.in._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),n=Be(r.out._def,{...e,currentPath:[...e.currentPath,"allOf",t?"1":"0"]});return{allOf:[t,n].filter(A=>A!==void 0)}};function nv(r,e){return Be(r.type._def,e)}function Av(r,e){let n={type:"array",uniqueItems:!0,items:Be(r.valueType._def,{...e,currentPath:[...e.currentPath,"items"]})};return r.minSize&&De(n,"minItems",r.minSize.value,r.minSize.message,e),r.maxSize&&De(n,"maxItems",r.maxSize.value,r.maxSize.message,e),n}function sv(r,e){return r.rest?{type:"array",minItems:r.items.length,items:r.items.map((t,n)=>Be(t._def,{...e,currentPath:[...e.currentPath,"items",`${n}`]})).reduce((t,n)=>n===void 0?t:[...t,n],[]),additionalItems:Be(r.rest._def,{...e,currentPath:[...e.currentPath,"additionalItems"]})}:{type:"array",minItems:r.items.length,maxItems:r.items.length,items:r.items.map((t,n)=>Be(t._def,{...e,currentPath:[...e.currentPath,"items",`${n}`]})).reduce((t,n)=>n===void 0?t:[...t,n],[])}}function iv(r){return{not:nt(r)}}function av(r){return nt(r)}var ov=(r,e)=>Be(r.innerType._def,e);var uv=(r,e,t)=>{switch(e){case O.ZodString:return ef(r,t);case O.ZodNumber:return Y0(r,t);case O.ZodObject:return ev(r,t);case O.ZodBigInt:return N0(r,t);case O.ZodBoolean:return L0();case O.ZodDate:return Lh(r,t);case O.ZodUndefined:return iv(t);case O.ZodNull:return J0(t);case O.ZodArray:return k0(r,t);case O.ZodUnion:case O.ZodDiscriminatedUnion:return q0(r,t);case O.ZodIntersection:return j0(r,t);case O.ZodTuple:return sv(r,t);case O.ZodRecord:return tf(r,t);case O.ZodLiteral:return K0(r,t);case O.ZodEnum:return $0(r);case O.ZodNativeEnum:return V0(r);case O.ZodNullable:return X0(r,t);case O.ZodOptional:return tv(r,t);case O.ZodMap:return G0(r,t);case O.ZodSet:return Av(r,t);case O.ZodLazy:return()=>r.getter()._def;case O.ZodPromise:return nv(r,t);case O.ZodNaN:case O.ZodNever:return Z0(t);case O.ZodEffects:return M0(r,t);case O.ZodAny:return nt(t);case O.ZodUnknown:return av(t);case O.ZodDefault:return D0(r,t);case O.ZodBranded:return Yl(r,t);case O.ZodReadonly:return ov(r,t);case O.ZodCatch:return H0(r,t);case O.ZodPipeline:return rv(r,t);case O.ZodFunction:case O.ZodVoid:case O.ZodSymbol:return;default:return(n=>{})(e)}};function Be(r,e,t=!1){let n=e.seen.get(r);if(e.override){let a=e.override?.(r,e,n,t);if(a!==S0)return a}if(n&&!t){let a=Vk(n,e);if(a!==void 0)return a}let A={def:r,path:e.currentPath,jsonSchema:void 0};e.seen.set(r,A);let s=uv(r,r.typeName,e),i=typeof s=="function"?Be(s(),e):s;if(i&&Zk(r,e,i),e.postProcess){let a=e.postProcess(i,r,e);return A.jsonSchema=i,a}return A.jsonSchema=i,i}var Vk=(r,e)=>{switch(e.$refStrategy){case"root":return{$ref:r.path.join("/")};case"relative":return{$ref:Xl(e.currentPath,r.path)};case"none":case"seen":return r.path.length<e.currentPath.length&&r.path.every((t,n)=>e.currentPath[n]===t)?(console.warn(`Recursive reference detected at ${e.currentPath.join("/")}! Defaulting to any`),nt(e)):e.$refStrategy==="seen"?nt(e):void 0}},Zk=(r,e,t)=>(r.description&&(t.description=r.description,e.markdownDescription&&(t.markdownDescription=r.description)),t);var Mh=(r,e)=>{let t=R0(e),n=typeof e=="object"&&e.definitions?Object.entries(e.definitions).reduce((f,[d,h])=>({...f,[d]:Be(h._def,{...t,currentPath:[...t.basePath,t.definitionPath,d]},!0)??nt(t)}),{}):void 0,A=typeof e=="string"?e:e?.nameStrategy==="title"?void 0:e?.name,s=Be(r._def,A===void 0?t:{...t,currentPath:[...t.basePath,t.definitionPath,A]},!1)??nt(t),i=typeof e=="object"&&e.name!==void 0&&e.nameStrategy==="title"?e.name:void 0;i!==void 0&&(s.title=i),t.flags.hasReferencedOpenAiAnyType&&(n||(n={}),n[t.openAiAnyTypeName]||(n[t.openAiAnyTypeName]={type:["string","number","integer","boolean","array","null"],items:{$ref:t.$refStrategy==="relative"?"1":[...t.basePath,t.definitionPath,t.openAiAnyTypeName].join("/")}}));let a=A===void 0?n?{...s,[t.definitionPath]:n}:s:{$ref:[...t.$refStrategy==="relative"?[]:t.basePath,t.definitionPath,A].join("/"),[t.definitionPath]:{...n,[A]:s}};return t.target==="jsonSchema7"?a.$schema="http://json-schema.org/draft-07/schema#":(t.target==="jsonSchema2019-09"||t.target==="openAi")&&(a.$schema="https://json-schema.org/draft/2019-09/schema#"),t.target==="openAi"&&("anyOf"in a||"oneOf"in a||"allOf"in a||"type"in a&&Array.isArray(a.type))&&console.warn("Warning: OpenAI may not support schemas with unions as roots! Try wrapping it in an object property."),a};function bA(r,e){let t=typeof r;if(t!==typeof e)return!1;if(Array.isArray(r)){if(!Array.isArray(e))return!1;let n=r.length;if(n!==e.length)return!1;for(let A=0;A<n;A++)if(!bA(r[A],e[A]))return!1;return!0}if(t==="object"){if(!r||!e)return r===e;let n=Object.keys(r),A=Object.keys(e);if(n.length!==A.length)return!1;for(let i of n)if(!bA(r[i],e[i]))return!1;return!0}return r===e}function kr(r){return encodeURI(Jk(r))}function Jk(r){return r.replace(/~/g,"~0").replace(/\//g,"~1")}var Wk={prefixItems:!0,items:!0,allOf:!0,anyOf:!0,oneOf:!0},qk={$defs:!0,definitions:!0,properties:!0,patternProperties:!0,dependentSchemas:!0},Xk={id:!0,$id:!0,$ref:!0,$schema:!0,$anchor:!0,$vocabulary:!0,$comment:!0,default:!0,enum:!0,const:!0,required:!0,type:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0},Yk=typeof self<"u"&&self.location&&self.location.origin!=="null"?new URL(self.location.origin+self.location.pathname+location.search):new URL("https://github.com/cfworker");function cs(r,e=Object.create(null),t=Yk,n=""){if(r&&typeof r=="object"&&!Array.isArray(r)){let s=r.$id||r.id;if(s){let i=new URL(s,t.href);i.hash.length>1?e[i.href]=r:(i.hash="",n===""?t=i:cs(r,e,t))}}else if(r!==!0&&r!==!1)return e;let A=t.href+(n?"#"+n:"");if(e[A]!==void 0)throw new Error(`Duplicate schema URI "${A}".`);if(e[A]=r,r===!0||r===!1)return e;if(r.__absolute_uri__===void 0&&Object.defineProperty(r,"__absolute_uri__",{enumerable:!1,value:A}),r.$ref&&r.__absolute_ref__===void 0){let s=new URL(r.$ref,t.href);s.hash=s.hash,Object.defineProperty(r,"__absolute_ref__",{enumerable:!1,value:s.href})}if(r.$recursiveRef&&r.__absolute_recursive_ref__===void 0){let s=new URL(r.$recursiveRef,t.href);s.hash=s.hash,Object.defineProperty(r,"__absolute_recursive_ref__",{enumerable:!1,value:s.href})}if(r.$anchor){let s=new URL("#"+r.$anchor,t.href);e[s.href]=r}for(let s in r){if(Xk[s])continue;let i=`${n}/${kr(s)}`,a=r[s];if(Array.isArray(a)){if(Wk[s]){let f=a.length;for(let d=0;d<f;d++)cs(a[d],e,t,`${i}/${d}`)}}else if(qk[s])for(let f in a)cs(a[f],e,t,`${i}/${kr(f)}`);else cs(a,e,t,i)}return e}var e1=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,t1=[0,31,28,31,30,31,30,31,31,30,31,30,31],r1=/^(\d\d):(\d\d):(\d\d)(\.\d+)?(z|[+-]\d\d(?::?\d\d)?)?$/i,n1=/^(?=.{1,253}\.?$)[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*\.?$/i,A1=/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'"()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,s1=/^(?:(?:[^\x00-\x20"'<>%\\^`{|}]|%[0-9a-f]{2})|\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$/i,i1=/^(?:(?:https?|ftp):\/\/)(?:\S+(?::\S*)?@)?(?:(?!10(?:\.\d{1,3}){3})(?!127(?:\.\d{1,3}){3})(?!169\.254(?:\.\d{1,3}){2})(?!192\.168(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u{00a1}-\u{ffff}0-9]+-?)*[a-z\u{00a1}-\u{ffff}0-9]+)(?:\.(?:[a-z\u{00a1}-\u{ffff}0-9]+-?)*[a-z\u{00a1}-\u{ffff}0-9]+)*(?:\.(?:[a-z\u{00a1}-\u{ffff}]{2,})))(?::\d{2,5})?(?:\/[^\s]*)?$/iu,a1=/^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i,o1=/^(?:\/(?:[^~/]|~0|~1)*)*$/,u1=/^#(?:\/(?:[a-z0-9_\-.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i,c1=/^(?:0|[1-9][0-9]*)(?:#|(?:\/(?:[^~/]|~0|~1)*)*)$/,l1=r=>{if(r[0]==='"')return!1;let[e,t,...n]=r.split("@");return!e||!t||n.length!==0||e.length>64||t.length>253||e[0]==="."||e.endsWith(".")||e.includes("..")||!/^[a-z0-9.-]+$/i.test(t)||!/^[a-z0-9.!#$%&'*+/=?^_`{|}~-]+$/i.test(e)?!1:t.split(".").every(A=>/^[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?$/i.test(A))},f1=/^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/,d1=/^((([0-9a-f]{1,4}:){7}([0-9a-f]{1,4}|:))|(([0-9a-f]{1,4}:){6}(:[0-9a-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){5}(((:[0-9a-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){4}(((:[0-9a-f]{1,4}){1,3})|((:[0-9a-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){3}(((:[0-9a-f]{1,4}){1,4})|((:[0-9a-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){2}(((:[0-9a-f]{1,4}){1,5})|((:[0-9a-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){1}(((:[0-9a-f]{1,4}){1,6})|((:[0-9a-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9a-f]{1,4}){1,7})|((:[0-9a-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))$/i,p1=r=>r.length>1&&r.length<80&&(/^P\d+([.,]\d+)?W$/.test(r)||/^P[\dYMDTHS]*(\d[.,]\d+)?[YMDHS]$/.test(r)&&/^P([.,\d]+Y)?([.,\d]+M)?([.,\d]+D)?(T([.,\d]+H)?([.,\d]+M)?([.,\d]+S)?)?$/.test(r));function Kn(r){return r.test.bind(r)}var $h={date:cv,time:lv.bind(void 0,!1),"date-time":g1,duration:p1,uri:_1,"uri-reference":Kn(A1),"uri-template":Kn(s1),url:Kn(i1),email:l1,hostname:Kn(n1),ipv4:Kn(f1),ipv6:Kn(d1),regex:B1,uuid:Kn(a1),"json-pointer":Kn(o1),"json-pointer-uri-fragment":Kn(u1),"relative-json-pointer":Kn(c1)};function h1(r){return r%4===0&&(r%100!==0||r%400===0)}function cv(r){let e=r.match(e1);if(!e)return!1;let t=+e[1],n=+e[2],A=+e[3];return n>=1&&n<=12&&A>=1&&A<=(n==2&&h1(t)?29:t1[n])}function lv(r,e){let t=e.match(r1);if(!t)return!1;let n=+t[1],A=+t[2],s=+t[3],i=!!t[5];return(n<=23&&A<=59&&s<=59||n==23&&A==59&&s==60)&&(!r||i)}var m1=/t|\s/i;function g1(r){let e=r.split(m1);return e.length==2&&cv(e[0])&&lv(!0,e[1])}var w1=/\/|:/,y1=/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i;function _1(r){return w1.test(r)&&y1.test(r)}var b1=/[^\\]\\Z/;function B1(r){if(b1.test(r))return!1;try{return new RegExp(r,"u"),!0}catch{return!1}}var fv;(function(r){r[r.Flag=1]="Flag",r[r.Basic=2]="Basic",r[r.Detailed=4]="Detailed"})(fv||(fv={}));function dv(r){let e=0,t=r.length,n=0,A;for(;n<t;)e++,A=r.charCodeAt(n++),A>=55296&&A<=56319&&n<t&&(A=r.charCodeAt(n),(A&64512)==56320&&n++);return e}function tt(r,e,t="2019-09",n=cs(e),A=!0,s=null,i="#",a="#",f=Object.create(null)){if(e===!0)return{valid:!0,errors:[]};if(e===!1)return{valid:!1,errors:[{instanceLocation:i,keyword:"false",keywordLocation:i,error:"False boolean schema."}]};let d=typeof r,h;switch(d){case"boolean":case"number":case"string":h=d;break;case"object":r===null?h="null":Array.isArray(r)?h="array":h="object";break;default:throw new Error(`Instances of "${d}" type are not supported.`)}let{$ref:m,$recursiveRef:y,$recursiveAnchor:w,type:b,const:C,enum:I,required:T,not:Q,anyOf:P,allOf:R,oneOf:D,if:ee,then:Y,else:fe,format:ve,properties:Ie,patternProperties:Te,additionalProperties:_t,unevaluatedProperties:$e,minProperties:Ye,maxProperties:At,propertyNames:Ut,dependentRequired:Ft,dependentSchemas:Qt,dependencies:st,prefixItems:de,items:we,additionalItems:ue,unevaluatedItems:ye,contains:Ze,minContains:Ge,maxContains:Tt,minItems:Zn,maxItems:Jn,uniqueItems:Bi,minimum:at,maximum:er,exclusiveMinimum:xr,exclusiveMaximum:tr,multipleOf:Hr,minLength:fr,maxLength:Kt,pattern:rr,__absolute_ref__:Dr,__absolute_recursive_ref__:qa}=e,J=[];if(w===!0&&s===null&&(s=e),y==="#"){let he=s===null?n[qa]:s,ae=`${a}/$recursiveRef`,me=tt(r,s===null?e:s,t,n,A,he,i,ae,f);me.valid||J.push({instanceLocation:i,keyword:"$recursiveRef",keywordLocation:ae,error:"A subschema had errors."},...me.errors)}if(m!==void 0){let ae=n[Dr||m];if(ae===void 0){let M=`Unresolved $ref "${m}".`;throw Dr&&Dr!==m&&(M+=`  Absolute URI "${Dr}".`),M+=`
Known schemas:
- ${Object.keys(n).join(`
- `)}`,new Error(M)}let me=`${a}/$ref`,te=tt(r,ae,t,n,A,s,i,me,f);if(te.valid||J.push({instanceLocation:i,keyword:"$ref",keywordLocation:me,error:"A subschema had errors."},...te.errors),t==="4"||t==="7")return{valid:J.length===0,errors:J}}if(Array.isArray(b)){let he=b.length,ae=!1;for(let me=0;me<he;me++)if(h===b[me]||b[me]==="integer"&&h==="number"&&r%1===0&&r===r){ae=!0;break}ae||J.push({instanceLocation:i,keyword:"type",keywordLocation:`${a}/type`,error:`Instance type "${h}" is invalid. Expected "${b.join('", "')}".`})}else b==="integer"?(h!=="number"||r%1||r!==r)&&J.push({instanceLocation:i,keyword:"type",keywordLocation:`${a}/type`,error:`Instance type "${h}" is invalid. Expected "${b}".`}):b!==void 0&&h!==b&&J.push({instanceLocation:i,keyword:"type",keywordLocation:`${a}/type`,error:`Instance type "${h}" is invalid. Expected "${b}".`});if(C!==void 0&&(h==="object"||h==="array"?bA(r,C)||J.push({instanceLocation:i,keyword:"const",keywordLocation:`${a}/const`,error:`Instance does not match ${JSON.stringify(C)}.`}):r!==C&&J.push({instanceLocation:i,keyword:"const",keywordLocation:`${a}/const`,error:`Instance does not match ${JSON.stringify(C)}.`})),I!==void 0&&(h==="object"||h==="array"?I.some(he=>bA(r,he))||J.push({instanceLocation:i,keyword:"enum",keywordLocation:`${a}/enum`,error:`Instance does not match any of ${JSON.stringify(I)}.`}):I.some(he=>r===he)||J.push({instanceLocation:i,keyword:"enum",keywordLocation:`${a}/enum`,error:`Instance does not match any of ${JSON.stringify(I)}.`})),Q!==void 0){let he=`${a}/not`;tt(r,Q,t,n,A,s,i,he).valid&&J.push({instanceLocation:i,keyword:"not",keywordLocation:he,error:'Instance matched "not" schema.'})}let _n=[];if(P!==void 0){let he=`${a}/anyOf`,ae=J.length,me=!1;for(let te=0;te<P.length;te++){let M=P[te],_e=Object.create(f),pe=tt(r,M,t,n,A,w===!0?s:null,i,`${he}/${te}`,_e);J.push(...pe.errors),me=me||pe.valid,pe.valid&&_n.push(_e)}me?J.length=ae:J.splice(ae,0,{instanceLocation:i,keyword:"anyOf",keywordLocation:he,error:"Instance does not match any subschemas."})}if(R!==void 0){let he=`${a}/allOf`,ae=J.length,me=!0;for(let te=0;te<R.length;te++){let M=R[te],_e=Object.create(f),pe=tt(r,M,t,n,A,w===!0?s:null,i,`${he}/${te}`,_e);J.push(...pe.errors),me=me&&pe.valid,pe.valid&&_n.push(_e)}me?J.length=ae:J.splice(ae,0,{instanceLocation:i,keyword:"allOf",keywordLocation:he,error:"Instance does not match every subschema."})}if(D!==void 0){let he=`${a}/oneOf`,ae=J.length,me=D.filter((te,M)=>{let _e=Object.create(f),pe=tt(r,te,t,n,A,w===!0?s:null,i,`${he}/${M}`,_e);return J.push(...pe.errors),pe.valid&&_n.push(_e),pe.valid}).length;me===1?J.length=ae:J.splice(ae,0,{instanceLocation:i,keyword:"oneOf",keywordLocation:he,error:`Instance does not match exactly one subschema (${me} matches).`})}if((h==="object"||h==="array")&&Object.assign(f,..._n),ee!==void 0){let he=`${a}/if`;if(tt(r,ee,t,n,A,s,i,he,f).valid){if(Y!==void 0){let me=tt(r,Y,t,n,A,s,i,`${a}/then`,f);me.valid||J.push({instanceLocation:i,keyword:"if",keywordLocation:he,error:'Instance does not match "then" schema.'},...me.errors)}}else if(fe!==void 0){let me=tt(r,fe,t,n,A,s,i,`${a}/else`,f);me.valid||J.push({instanceLocation:i,keyword:"if",keywordLocation:he,error:'Instance does not match "else" schema.'},...me.errors)}}if(h==="object"){if(T!==void 0)for(let te of T)te in r||J.push({instanceLocation:i,keyword:"required",keywordLocation:`${a}/required`,error:`Instance does not have required property "${te}".`});let he=Object.keys(r);if(Ye!==void 0&&he.length<Ye&&J.push({instanceLocation:i,keyword:"minProperties",keywordLocation:`${a}/minProperties`,error:`Instance does not have at least ${Ye} properties.`}),At!==void 0&&he.length>At&&J.push({instanceLocation:i,keyword:"maxProperties",keywordLocation:`${a}/maxProperties`,error:`Instance does not have at least ${At} properties.`}),Ut!==void 0){let te=`${a}/propertyNames`;for(let M in r){let _e=`${i}/${kr(M)}`,pe=tt(M,Ut,t,n,A,s,_e,te);pe.valid||J.push({instanceLocation:i,keyword:"propertyNames",keywordLocation:te,error:`Property name "${M}" does not match schema.`},...pe.errors)}}if(Ft!==void 0){let te=`${a}/dependantRequired`;for(let M in Ft)if(M in r){let _e=Ft[M];for(let pe of _e)pe in r||J.push({instanceLocation:i,keyword:"dependentRequired",keywordLocation:te,error:`Instance has "${M}" but does not have "${pe}".`})}}if(Qt!==void 0)for(let te in Qt){let M=`${a}/dependentSchemas`;if(te in r){let _e=tt(r,Qt[te],t,n,A,s,i,`${M}/${kr(te)}`,f);_e.valid||J.push({instanceLocation:i,keyword:"dependentSchemas",keywordLocation:M,error:`Instance has "${te}" but does not match dependant schema.`},..._e.errors)}}if(st!==void 0){let te=`${a}/dependencies`;for(let M in st)if(M in r){let _e=st[M];if(Array.isArray(_e))for(let pe of _e)pe in r||J.push({instanceLocation:i,keyword:"dependencies",keywordLocation:te,error:`Instance has "${M}" but does not have "${pe}".`});else{let pe=tt(r,_e,t,n,A,s,i,`${te}/${kr(M)}`);pe.valid||J.push({instanceLocation:i,keyword:"dependencies",keywordLocation:te,error:`Instance has "${M}" but does not match dependant schema.`},...pe.errors)}}}let ae=Object.create(null),me=!1;if(Ie!==void 0){let te=`${a}/properties`;for(let M in Ie){if(!(M in r))continue;let _e=`${i}/${kr(M)}`,pe=tt(r[M],Ie[M],t,n,A,s,_e,`${te}/${kr(M)}`);if(pe.valid)f[M]=ae[M]=!0;else if(me=A,J.push({instanceLocation:i,keyword:"properties",keywordLocation:te,error:`Property "${M}" does not match schema.`},...pe.errors),me)break}}if(!me&&Te!==void 0){let te=`${a}/patternProperties`;for(let M in Te){let _e=new RegExp(M,"u"),pe=Te[M];for(let Ot in r){if(!_e.test(Ot))continue;let Wn=`${i}/${kr(Ot)}`,zt=tt(r[Ot],pe,t,n,A,s,Wn,`${te}/${kr(M)}`);zt.valid?f[Ot]=ae[Ot]=!0:(me=A,J.push({instanceLocation:i,keyword:"patternProperties",keywordLocation:te,error:`Property "${Ot}" matches pattern "${M}" but does not match associated schema.`},...zt.errors))}}}if(!me&&_t!==void 0){let te=`${a}/additionalProperties`;for(let M in r){if(ae[M])continue;let _e=`${i}/${kr(M)}`,pe=tt(r[M],_t,t,n,A,s,_e,te);pe.valid?f[M]=!0:(me=A,J.push({instanceLocation:i,keyword:"additionalProperties",keywordLocation:te,error:`Property "${M}" does not match additional properties schema.`},...pe.errors))}}else if(!me&&$e!==void 0){let te=`${a}/unevaluatedProperties`;for(let M in r)if(!f[M]){let _e=`${i}/${kr(M)}`,pe=tt(r[M],$e,t,n,A,s,_e,te);pe.valid?f[M]=!0:J.push({instanceLocation:i,keyword:"unevaluatedProperties",keywordLocation:te,error:`Property "${M}" does not match unevaluated properties schema.`},...pe.errors)}}}else if(h==="array"){Jn!==void 0&&r.length>Jn&&J.push({instanceLocation:i,keyword:"maxItems",keywordLocation:`${a}/maxItems`,error:`Array has too many items (${r.length} > ${Jn}).`}),Zn!==void 0&&r.length<Zn&&J.push({instanceLocation:i,keyword:"minItems",keywordLocation:`${a}/minItems`,error:`Array has too few items (${r.length} < ${Zn}).`});let he=r.length,ae=0,me=!1;if(de!==void 0){let te=`${a}/prefixItems`,M=Math.min(de.length,he);for(;ae<M;ae++){let _e=tt(r[ae],de[ae],t,n,A,s,`${i}/${ae}`,`${te}/${ae}`);if(f[ae]=!0,!_e.valid&&(me=A,J.push({instanceLocation:i,keyword:"prefixItems",keywordLocation:te,error:"Items did not match schema."},..._e.errors),me))break}}if(we!==void 0){let te=`${a}/items`;if(Array.isArray(we)){let M=Math.min(we.length,he);for(;ae<M;ae++){let _e=tt(r[ae],we[ae],t,n,A,s,`${i}/${ae}`,`${te}/${ae}`);if(f[ae]=!0,!_e.valid&&(me=A,J.push({instanceLocation:i,keyword:"items",keywordLocation:te,error:"Items did not match schema."},..._e.errors),me))break}}else for(;ae<he;ae++){let M=tt(r[ae],we,t,n,A,s,`${i}/${ae}`,te);if(f[ae]=!0,!M.valid&&(me=A,J.push({instanceLocation:i,keyword:"items",keywordLocation:te,error:"Items did not match schema."},...M.errors),me))break}if(!me&&ue!==void 0){let M=`${a}/additionalItems`;for(;ae<he;ae++){let _e=tt(r[ae],ue,t,n,A,s,`${i}/${ae}`,M);f[ae]=!0,_e.valid||(me=A,J.push({instanceLocation:i,keyword:"additionalItems",keywordLocation:M,error:"Items did not match additional items schema."},..._e.errors))}}}if(Ze!==void 0)if(he===0&&Ge===void 0)J.push({instanceLocation:i,keyword:"contains",keywordLocation:`${a}/contains`,error:"Array is empty. It must contain at least one item matching the schema."});else if(Ge!==void 0&&he<Ge)J.push({instanceLocation:i,keyword:"minContains",keywordLocation:`${a}/minContains`,error:`Array has less items (${he}) than minContains (${Ge}).`});else{let te=`${a}/contains`,M=J.length,_e=0;for(let pe=0;pe<he;pe++){let Ot=tt(r[pe],Ze,t,n,A,s,`${i}/${pe}`,te);Ot.valid?(f[pe]=!0,_e++):J.push(...Ot.errors)}_e>=(Ge||0)&&(J.length=M),Ge===void 0&&Tt===void 0&&_e===0?J.splice(M,0,{instanceLocation:i,keyword:"contains",keywordLocation:te,error:"Array does not contain item matching schema."}):Ge!==void 0&&_e<Ge?J.push({instanceLocation:i,keyword:"minContains",keywordLocation:`${a}/minContains`,error:`Array must contain at least ${Ge} items matching schema. Only ${_e} items were found.`}):Tt!==void 0&&_e>Tt&&J.push({instanceLocation:i,keyword:"maxContains",keywordLocation:`${a}/maxContains`,error:`Array may contain at most ${Tt} items matching schema. ${_e} items were found.`})}if(!me&&ye!==void 0){let te=`${a}/unevaluatedItems`;for(ae;ae<he;ae++){if(f[ae])continue;let M=tt(r[ae],ye,t,n,A,s,`${i}/${ae}`,te);f[ae]=!0,M.valid||J.push({instanceLocation:i,keyword:"unevaluatedItems",keywordLocation:te,error:"Items did not match unevaluated items schema."},...M.errors)}}if(Bi)for(let te=0;te<he;te++){let M=r[te],_e=typeof M=="object"&&M!==null;for(let pe=0;pe<he;pe++){if(te===pe)continue;let Ot=r[pe];(M===Ot||_e&&(typeof Ot=="object"&&Ot!==null)&&bA(M,Ot))&&(J.push({instanceLocation:i,keyword:"uniqueItems",keywordLocation:`${a}/uniqueItems`,error:`Duplicate items at indexes ${te} and ${pe}.`}),te=Number.MAX_SAFE_INTEGER,pe=Number.MAX_SAFE_INTEGER)}}}else if(h==="number"){if(t==="4"?(at!==void 0&&(xr===!0&&r<=at||r<at)&&J.push({instanceLocation:i,keyword:"minimum",keywordLocation:`${a}/minimum`,error:`${r} is less than ${xr?"or equal to ":""} ${at}.`}),er!==void 0&&(tr===!0&&r>=er||r>er)&&J.push({instanceLocation:i,keyword:"maximum",keywordLocation:`${a}/maximum`,error:`${r} is greater than ${tr?"or equal to ":""} ${er}.`})):(at!==void 0&&r<at&&J.push({instanceLocation:i,keyword:"minimum",keywordLocation:`${a}/minimum`,error:`${r} is less than ${at}.`}),er!==void 0&&r>er&&J.push({instanceLocation:i,keyword:"maximum",keywordLocation:`${a}/maximum`,error:`${r} is greater than ${er}.`}),xr!==void 0&&r<=xr&&J.push({instanceLocation:i,keyword:"exclusiveMinimum",keywordLocation:`${a}/exclusiveMinimum`,error:`${r} is less than ${xr}.`}),tr!==void 0&&r>=tr&&J.push({instanceLocation:i,keyword:"exclusiveMaximum",keywordLocation:`${a}/exclusiveMaximum`,error:`${r} is greater than or equal to ${tr}.`})),Hr!==void 0){let he=r%Hr;Math.abs(0-he)>=11920929e-14&&Math.abs(Hr-he)>=11920929e-14&&J.push({instanceLocation:i,keyword:"multipleOf",keywordLocation:`${a}/multipleOf`,error:`${r} is not a multiple of ${Hr}.`})}}else if(h==="string"){let he=fr===void 0&&Kt===void 0?0:dv(r);fr!==void 0&&he<fr&&J.push({instanceLocation:i,keyword:"minLength",keywordLocation:`${a}/minLength`,error:`String is too short (${he} < ${fr}).`}),Kt!==void 0&&he>Kt&&J.push({instanceLocation:i,keyword:"maxLength",keywordLocation:`${a}/maxLength`,error:`String is too long (${he} > ${Kt}).`}),rr!==void 0&&!new RegExp(rr,"u").test(r)&&J.push({instanceLocation:i,keyword:"pattern",keywordLocation:`${a}/pattern`,error:"String does not match pattern."}),ve!==void 0&&$h[ve]&&!$h[ve](r)&&J.push({instanceLocation:i,keyword:"format",keywordLocation:`${a}/format`,error:`String does not match format "${ve}".`})}return{valid:J.length===0,errors:J}}function Nr(r){if(typeof r!="object"||r===null)return!1;let e=r;if(!("_zod"in e))return!1;let t=e._zod;return typeof t=="object"&&t!==null&&"def"in t}function tn(r){if(typeof r!="object"||r===null)return!1;let e=r;if(!("_def"in e)||"_zod"in e)return!1;let t=e._def;return typeof t=="object"&&t!=null&&"typeName"in t}function Lr(r){return!r||typeof r!="object"||Array.isArray(r)?!1:!!(Nr(r)||tn(r))}async function pv(r,e){if(Nr(r))try{return{success:!0,data:await x0(r,e)}}catch(t){return{success:!1,error:t}}if(tn(r))return r.safeParse(e);throw new Error("Schema must be an instance of z3.ZodType or z4.$ZodType")}async function ja(r,e){if(Nr(r))return Wl(r,e);if(tn(r))return r.parse(e);throw new Error("Schema must be an instance of z3.ZodType or z4.$ZodType")}function gi(r){if(Nr(r))return jn.get(r)?.description;if(tn(r)||"description"in r&&typeof r.description=="string")return r.description}function jh(r){return Lr(r)?tn(r)?r._def.typeName==="ZodString":Nr(r)?r._zod.def.type==="string":!1:!1}function $a(r){return Nr(r)?typeof r=="object"&&r!==null&&"_zod"in r&&typeof r._zod=="object"&&r._zod!==null&&"def"in r._zod&&typeof r._zod.def=="object"&&r._zod.def!==null&&"type"in r._zod.def&&r._zod.def.type==="object":!1}function hv(r){return Nr(r)?typeof r=="object"&&r!==null&&"_zod"in r&&typeof r._zod=="object"&&r._zod!==null&&"def"in r._zod&&typeof r._zod.def=="object"&&r._zod.def!==null&&"type"in r._zod.def&&r._zod.def.type==="array":!1}function rf(r,e=!1){if(tn(r))return r.strict();if($a(r)){let t=r._zod.def.shape;if(e)for(let[s,i]of Object.entries(r._zod.def.shape)){if($a(i)){let f=rf(i,e);t[s]=f}else if(hv(i)){let f=i._zod.def.element;$a(f)&&(f=rf(f,e)),t[s]=Ha(i,{...i._zod.def,element:f})}else t[s]=i;let a=jn.get(i);a&&jn.add(t[s],a)}let n=Ha(r,{...r._zod.def,shape:t,catchall:T0(Q0)}),A=jn.get(r);return A&&jn.add(n,A),n}throw new Error("Schema must be an instance of z3.ZodObject or z4.$ZodObject")}function v1(r){return tn(r)&&"typeName"in r._def&&r._def.typeName==="ZodEffects"}function C1(r){return Nr(r)&&r._zod.def.type==="pipe"}function Ma(r,e=!1){if(tn(r))return v1(r)?Ma(r._def.schema,e):r;if(Nr(r)){let t=r;if(C1(r)&&(t=Ma(r._zod.def.in,e)),e){if($a(t)){let A=t._zod.def.shape;for(let[s,i]of Object.entries(t._zod.def.shape))A[s]=Ma(i,e);t=Ha(t,{...t._zod.def,shape:A})}else if(hv(t)){let A=Ma(t._zod.def.element,e);t=Ha(t,{...t._zod.def,element:A})}}let n=jn.get(r);return n&&jn.add(t,n),t}throw new Error("Schema must be an instance of z3.ZodType or z4.$ZodType")}function Er(r){if(Nr(r)){let e=Ma(r,!0);if($a(e)){let t=rf(e,!0);return fu(t)}else return fu(r)}return tn(r)?Mh(r):r}function E1(r,e){if(r!==void 0&&!ss(r))return r;if(ou(e))try{let t=e.getName();return t=t.startsWith("Runnable")?t.slice(8):t,t}catch{return e.getName()}else return e.name??"UnknownSchema"}function x1(r){return ou(r.data)?{type:"runnable",data:{id:r.data.lc_id,name:r.data.getName()}}:{type:"schema",data:{...Er(r.data.schema),title:r.data.name}}}var pu=class r{constructor(e){Object.defineProperty(this,"nodes",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"edges",{enumerable:!0,configurable:!0,writable:!0,value:[]}),this.nodes=e?.nodes??this.nodes,this.edges=e?.edges??this.edges}toJSON(){let e={};return Object.values(this.nodes).forEach((t,n)=>{e[t.id]=ss(t.id)?n:t.id}),{nodes:Object.values(this.nodes).map(t=>({id:e[t.id],...x1(t)})),edges:this.edges.map(t=>{let n={source:e[t.source],target:e[t.target]};return typeof t.data<"u"&&(n.data=t.data),typeof t.conditional<"u"&&(n.conditional=t.conditional),n})}}addNode(e,t,n){if(t!==void 0&&this.nodes[t]!==void 0)throw new Error(`Node with id ${t} already exists`);let A=t??ut(),s={id:A,data:e,name:E1(t,e),metadata:n};return this.nodes[A]=s,s}removeNode(e){delete this.nodes[e.id],this.edges=this.edges.filter(t=>t.source!==e.id&&t.target!==e.id)}addEdge(e,t,n,A){if(this.nodes[e.id]===void 0)throw new Error(`Source node ${e.id} not in graph`);if(this.nodes[t.id]===void 0)throw new Error(`Target node ${t.id} not in graph`);let s={source:e.id,target:t.id,data:n,conditional:A};return this.edges.push(s),s}firstNode(){return mv(this)}lastNode(){return gv(this)}extend(e,t=""){let n=t;Object.values(e.nodes).map(d=>d.id).every(ss)&&(n="");let s=d=>n?`${n}:${d}`:d;Object.entries(e.nodes).forEach(([d,h])=>{this.nodes[s(d)]={...h,id:s(d)}});let i=e.edges.map(d=>({...d,source:s(d.source),target:s(d.target)}));this.edges=[...this.edges,...i];let a=e.firstNode(),f=e.lastNode();return[a?{id:s(a.id),data:a.data}:void 0,f?{id:s(f.id),data:f.data}:void 0]}trimFirstNode(){let e=this.firstNode();e&&mv(this,[e.id])&&this.removeNode(e)}trimLastNode(){let e=this.lastNode();e&&gv(this,[e.id])&&this.removeNode(e)}reid(){let e=Object.fromEntries(Object.values(this.nodes).map(A=>[A.id,A.name])),t=new Map;Object.values(e).forEach(A=>{t.set(A,(t.get(A)||0)+1)});let n=A=>{let s=e[A];return ss(A)&&t.get(s)===1?s:A};return new r({nodes:Object.fromEntries(Object.entries(this.nodes).map(([A,s])=>[n(A),{...s,id:n(A)}])),edges:this.edges.map(A=>({...A,source:n(A.source),target:n(A.target)}))})}drawMermaid(e){let{withStyles:t,curveStyle:n,nodeColors:A={default:"fill:#f2f0ff,line-height:1.2",first:"fill-opacity:0",last:"fill:#bfb6fc"},wrapLabelNWords:s}=e??{},i=this.reid(),a=i.firstNode(),f=i.lastNode();return w0(i.nodes,i.edges,{firstNode:a?.id,lastNode:f?.id,withStyles:t,curveStyle:n,nodeColors:A,wrapLabelNWords:s})}async drawMermaidPng(e){let t=this.drawMermaid(e);return y0(t,{backgroundColor:e?.backgroundColor})}};function mv(r,e=[]){let t=new Set(r.edges.filter(A=>!e.includes(A.source)).map(A=>A.target)),n=[];for(let A of Object.values(r.nodes))!e.includes(A.id)&&!t.has(A.id)&&n.push(A);return n.length===1?n[0]:void 0}function gv(r,e=[]){let t=new Set(r.edges.filter(A=>!e.includes(A.target)).map(A=>A.source)),n=[];for(let A of Object.values(r.nodes))!e.includes(A.id)&&!t.has(A.id)&&n.push(A);return n.length===1?n[0]:void 0}function wv(r){let e=new TextEncoder,t=new ReadableStream({async start(n){for await(let A of r)n.enqueue(e.encode(`event: data
data: ${JSON.stringify(A)}

`));n.enqueue(e.encode(`event: end

`)),n.close()}});return Yt.fromReadableStream(t)}function Kh(r){return typeof r=="object"&&r!==null&&typeof r[Symbol.iterator]=="function"&&typeof r.next=="function"}var yv=r=>r!=null&&typeof r=="object"&&"next"in r&&typeof r.next=="function";function nf(r){return typeof r=="object"&&r!==null&&typeof r[Symbol.asyncIterator]=="function"}function*zh(r,e){for(;;){let{value:t,done:n}=cr.runWithConfig(en(r),e.next.bind(e),!0);if(n)break;yield t}}async function*Af(r,e){let t=e[Symbol.asyncIterator]();for(;;){let{value:n,done:A}=await cr.runWithConfig(en(r),t.next.bind(e),!0);if(A)break;yield n}}function xt(r,e){return r&&!Array.isArray(r)&&!(r instanceof Date)&&typeof r=="object"?r:{[e]:r}}var qe=class extends an{constructor(){super(...arguments),Object.defineProperty(this,"lc_runnable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}getName(e){let t=this.name??this.constructor.lc_name()??this.constructor.name;return e?`${t}${e}`:t}bind(e){return new vA({bound:this,kwargs:e,config:{}})}map(){return new sf({bound:this})}withRetry(e){return new hu({bound:this,kwargs:{},config:{},maxAttemptNumber:e?.stopAfterAttempt,...e})}withConfig(e){return new vA({bound:this,config:e,kwargs:{}})}withFallbacks(e){let t=Array.isArray(e)?e:e.fallbacks;return new af({runnable:this,fallbacks:t})}_getOptionsList(e,t=0){if(Array.isArray(e)&&e.length!==t)throw new Error(`Passed "options" must be an array with the same length as the inputs, but got ${e.length} options for ${t} inputs`);if(Array.isArray(e))return e.map(He);if(t>1&&!Array.isArray(e)&&e.runId){console.warn("Provided runId will be used only for the first element of the batch.");let n=Object.fromEntries(Object.entries(e).filter(([A])=>A!=="runId"));return Array.from({length:t},(A,s)=>He(s===0?e:n))}return Array.from({length:t},()=>He(e))}async batch(e,t,n){let A=this._getOptionsList(t??{},e.length),s=A[0]?.maxConcurrency??n?.maxConcurrency,i=new _A({maxConcurrency:s,onFailedAttempt:f=>{throw f}}),a=e.map((f,d)=>i.call(async()=>{try{return await this.invoke(f,A[d])}catch(h){if(n?.returnExceptions)return h;throw h}}));return Promise.all(a)}async*_streamIterator(e,t){yield this.invoke(e,t)}async stream(e,t){let n=He(t),A=new gA({generator:this._streamIterator(e,n),config:n});return await A.setup,Yt.fromAsyncGenerator(A)}_separateRunnableConfigFromCallOptions(e){let t;e===void 0?t=He(e):t=He({callbacks:e.callbacks,tags:e.tags,metadata:e.metadata,runName:e.runName,configurable:e.configurable,recursionLimit:e.recursionLimit,maxConcurrency:e.maxConcurrency,runId:e.runId,timeout:e.timeout,signal:e.signal});let n={...e};return delete n.callbacks,delete n.tags,delete n.metadata,delete n.runName,delete n.configurable,delete n.recursionLimit,delete n.maxConcurrency,delete n.runId,delete n.timeout,delete n.signal,[t,n]}async _callWithConfig(e,t,n){let A=He(n),i=await(await Cr(A))?.handleChainStart(this.toJSON(),xt(t,"input"),A.runId,A?.runType,void 0,void 0,A?.runName??this.getName());delete A.runId;let a;try{let f=e.call(this,t,A,i);a=await Mn(f,n?.signal)}catch(f){throw await i?.handleChainError(f),f}return await i?.handleChainEnd(xt(a,"output")),a}async _batchWithConfig(e,t,n,A){let s=this._getOptionsList(n??{},t.length),i=await Promise.all(s.map(Cr)),a=await Promise.all(i.map(async(d,h)=>{let m=await d?.handleChainStart(this.toJSON(),xt(t[h],"input"),s[h].runId,s[h].runType,void 0,void 0,s[h].runName??this.getName());return delete s[h].runId,m})),f;try{let d=e.call(this,t,s,a,A);f=await Mn(d,s?.[0]?.signal)}catch(d){throw await Promise.all(a.map(h=>h?.handleChainError(d))),d}return await Promise.all(a.map(d=>d?.handleChainEnd(xt(f,"output")))),f}_concatOutputChunks(e,t){return wA(e,t)}async*_transformStreamWithConfig(e,t,n){let A,s=!0,i,a=!0,f=He(n),d=await Cr(f),h=this;async function*m(){for await(let w of e){if(s)if(A===void 0)A=w;else try{A=h._concatOutputChunks(A,w)}catch{A=void 0,s=!1}yield w}}let y;try{let w=await f0(t.bind(this),m(),async()=>d?.handleChainStart(this.toJSON(),{input:""},f.runId,f.runType,void 0,void 0,f.runName??this.getName()),n?.signal,f);delete f.runId,y=w.setup;let b=y?.handlers.find(m0),C=w.output;b!==void 0&&y!==void 0&&(C=b.tapOutputIterable(y.runId,C));let I=y?.handlers.find(h0);I!==void 0&&y!==void 0&&(C=I.tapOutputIterable(y.runId,C));for await(let T of C)if(yield T,a)if(i===void 0)i=T;else try{i=this._concatOutputChunks(i,T)}catch{i=void 0,a=!1}}catch(w){throw await y?.handleChainError(w,void 0,void 0,void 0,{inputs:xt(A,"input")}),w}await y?.handleChainEnd(i??{},void 0,void 0,void 0,{inputs:xt(A,"input")})}getGraph(e){let t=new pu,n=t.addNode({name:`${this.getName()}Input`,schema:Pr.any()}),A=t.addNode(this),s=t.addNode({name:`${this.getName()}Output`,schema:Pr.any()});return t.addEdge(n,A),t.addEdge(A,s),t}pipe(e){return new CA({first:this,last:BA(e)})}pick(e){return this.pipe(new of(e))}assign(e){return this.pipe(new Ka(new ls({steps:e})))}async*transform(e,t){let n;for await(let A of e)n===void 0?n=A:n=this._concatOutputChunks(n,A);yield*this._streamIterator(n,He(t))}async*streamLog(e,t,n){let A=new iu({...n,autoClose:!1,_schemaFormat:"original"}),s=He(t);yield*this._streamLog(e,A,s)}async*_streamLog(e,t,n){let{callbacks:A}=n;if(A===void 0)n.callbacks=[t];else if(Array.isArray(A))n.callbacks=A.concat([t]);else{let f=A.copy();f.addHandler(t,!0),n.callbacks=f}let s=this.stream(e,n);async function i(){try{let f=await s;for await(let d of f){let h=new ln({ops:[{op:"add",path:"/streamed_output/-",value:d}]});await t.writer.write(h)}}finally{await t.writer.close()}}let a=i();try{for await(let f of t)yield f}finally{await a}}streamEvents(e,t,n){let A;if(t.version==="v1")A=this._streamEventsV1(e,t,n);else if(t.version==="v2")A=this._streamEventsV2(e,t,n);else throw new Error('Only versions "v1" and "v2" of the schema are currently supported.');return t.encoding==="text/event-stream"?wv(A):Yt.fromAsyncGenerator(A)}async*_streamEventsV2(e,t,n){let A=new zl({...n,autoClose:!1}),s=He(t),i=s.runId??ut();s.runId=i;let a=s.callbacks;if(a===void 0)s.callbacks=[A];else if(Array.isArray(a))s.callbacks=a.concat(A);else{let b=a.copy();b.addHandler(A,!0),s.callbacks=b}let f=new AbortController,d=this;async function h(){let b,C=null;try{t?.signal?"any"in AbortSignal?b=AbortSignal.any([f.signal,t.signal]):(b=t.signal,C=()=>{f.abort()},t.signal.addEventListener("abort",C,{once:!0})):b=f.signal;let I=await d.stream(e,{...s,signal:b}),T=A.tapOutputIterable(i,I);for await(let Q of T)if(f.signal.aborted)break}finally{await A.finish(),b&&C&&b.removeEventListener("abort",C)}}let m=h(),y=!1,w;try{for await(let b of A){if(!y){b.data.input=e,y=!0,w=b.run_id,yield b;continue}b.run_id===w&&b.event.endsWith("_end")&&b.data?.input&&delete b.data.input,yield b}}finally{f.abort(),await m}}async*_streamEventsV1(e,t,n){let A,s=!1,i=He(t),a=i.tags??[],f=i.metadata??{},d=i.runName??this.getName(),h=new iu({...n,autoClose:!1,_schemaFormat:"streaming_events"}),m=new Vl({...n}),y=this._streamLog(e,h,i);for await(let b of y){if(A?A=A.concat(b):A=su.fromRunLogPatch(b),A.state===void 0)throw new Error('Internal error: "streamEvents" state is missing. Please open a bug report.');if(!s){s=!0;let Q={...A.state},P={run_id:Q.id,event:`on_${Q.type}_start`,name:d,tags:a,metadata:f,data:{input:e}};m.includeEvent(P,Q.type)&&(yield P)}let C=b.ops.filter(Q=>Q.path.startsWith("/logs/")).map(Q=>Q.path.split("/")[2]),I=[...new Set(C)];for(let Q of I){let P,R={},D=A.state.logs[Q];if(D.end_time===void 0?D.streamed_output.length>0?P="stream":P="start":P="end",P==="start")D.inputs!==void 0&&(R.input=D.inputs);else if(P==="end")D.inputs!==void 0&&(R.input=D.inputs),R.output=D.final_output;else if(P==="stream"){let ee=D.streamed_output.length;if(ee!==1)throw new Error(`Expected exactly one chunk of streamed output, got ${ee} instead. Encountered in: "${D.name}"`);R={chunk:D.streamed_output[0]},D.streamed_output=[]}yield{event:`on_${D.type}_${P}`,name:D.name,run_id:D.id,tags:D.tags,metadata:D.metadata,data:R}}let{state:T}=A;if(T.streamed_output.length>0){let Q=T.streamed_output.length;if(Q!==1)throw new Error(`Expected exactly one chunk of streamed output, got ${Q} instead. Encountered in: "${T.name}"`);let P={chunk:T.streamed_output[0]};T.streamed_output=[];let R={event:`on_${T.type}_stream`,run_id:T.id,tags:a,metadata:f,name:d,data:P};m.includeEvent(R,T.type)&&(yield R)}}let w=A?.state;if(w!==void 0){let b={event:`on_${w.type}_end`,name:d,run_id:w.id,tags:a,metadata:f,data:{output:w.final_output}};m.includeEvent(b,w.type)&&(yield b)}}static isRunnable(e){return ou(e)}withListeners({onStart:e,onEnd:t,onError:n}){return new vA({bound:this,config:{},configFactories:[A=>({callbacks:[new au({config:A,onStart:e,onEnd:t,onError:n})]})]})}asTool(e){return U1(this,e)}},vA=class r extends qe{static lc_name(){return"RunnableBinding"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"bound",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"config",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"configFactories",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.bound=e.bound,this.kwargs=e.kwargs,this.config=e.config,this.configFactories=e.configFactories}getName(e){return this.bound.getName(e)}async _mergeConfig(...e){let t=ka(this.config,...e);return ka(t,...this.configFactories?await Promise.all(this.configFactories.map(async n=>await n(t))):[])}bind(e){return new this.constructor({bound:this.bound,kwargs:{...this.kwargs,...e},config:this.config})}withConfig(e){return new this.constructor({bound:this.bound,kwargs:this.kwargs,config:{...this.config,...e}})}withRetry(e){return new hu({bound:this.bound,kwargs:this.kwargs,config:this.config,maxAttemptNumber:e?.stopAfterAttempt,...e})}async invoke(e,t){return this.bound.invoke(e,await this._mergeConfig(He(t),this.kwargs))}async batch(e,t,n){let A=Array.isArray(t)?await Promise.all(t.map(async s=>this._mergeConfig(He(s),this.kwargs))):await this._mergeConfig(He(t),this.kwargs);return this.bound.batch(e,A,n)}_concatOutputChunks(e,t){return this.bound._concatOutputChunks(e,t)}async*_streamIterator(e,t){yield*this.bound._streamIterator(e,await this._mergeConfig(He(t),this.kwargs))}async stream(e,t){return this.bound.stream(e,await this._mergeConfig(He(t),this.kwargs))}async*transform(e,t){yield*this.bound.transform(e,await this._mergeConfig(He(t),this.kwargs))}streamEvents(e,t,n){let A=this,s=async function*(){yield*A.bound.streamEvents(e,{...await A._mergeConfig(He(t),A.kwargs),version:t.version},n)};return Yt.fromAsyncGenerator(s())}static isRunnableBinding(e){return e.bound&&qe.isRunnable(e.bound)}withListeners({onStart:e,onEnd:t,onError:n}){return new r({bound:this.bound,kwargs:this.kwargs,config:this.config,configFactories:[A=>({callbacks:[new au({config:A,onStart:e,onEnd:t,onError:n})]})]})}},sf=class r extends qe{static lc_name(){return"RunnableEach"}constructor(e){super(e),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"bound",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.bound=e.bound}bind(e){return new r({bound:this.bound.bind(e)})}async invoke(e,t){return this._callWithConfig(this._invoke.bind(this),e,t)}async _invoke(e,t,n){return this.bound.batch(e,mt(t,{callbacks:n?.getChild()}))}withListeners({onStart:e,onEnd:t,onError:n}){return new r({bound:this.bound.withListeners({onStart:e,onEnd:t,onError:n})})}},hu=class extends vA{static lc_name(){return"RunnableRetry"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"maxAttemptNumber",{enumerable:!0,configurable:!0,writable:!0,value:3}),Object.defineProperty(this,"onFailedAttempt",{enumerable:!0,configurable:!0,writable:!0,value:()=>{}}),this.maxAttemptNumber=e.maxAttemptNumber??this.maxAttemptNumber,this.onFailedAttempt=e.onFailedAttempt??this.onFailedAttempt}_patchConfigForRetry(e,t,n){let A=e>1?`retry:attempt:${e}`:void 0;return mt(t,{callbacks:n?.getChild(A)})}async _invoke(e,t,n){return(0,Gh.default)(A=>super.invoke(e,this._patchConfigForRetry(A,t,n)),{onFailedAttempt:A=>this.onFailedAttempt(A,e),retries:Math.max(this.maxAttemptNumber-1,0),randomize:!0})}async invoke(e,t){return this._callWithConfig(this._invoke.bind(this),e,t)}async _batch(e,t,n,A){let s={};try{await(0,Gh.default)(async i=>{let a=e.map((y,w)=>w).filter(y=>s[y.toString()]===void 0||s[y.toString()]instanceof Error),f=a.map(y=>e[y]),d=a.map(y=>this._patchConfigForRetry(i,t?.[y],n?.[y])),h=await super.batch(f,d,{...A,returnExceptions:!0}),m;for(let y=0;y<h.length;y+=1){let w=h[y],b=a[y];w instanceof Error&&m===void 0&&(m=w,m.input=f[y]),s[b.toString()]=w}if(m)throw m;return h},{onFailedAttempt:i=>this.onFailedAttempt(i,i.input),retries:Math.max(this.maxAttemptNumber-1,0),randomize:!0})}catch(i){if(A?.returnExceptions!==!0)throw i}return Object.keys(s).sort((i,a)=>parseInt(i,10)-parseInt(a,10)).map(i=>s[parseInt(i,10)])}async batch(e,t,n){return this._batchWithConfig(this._batch.bind(this),e,t,n)}},CA=class r extends qe{static lc_name(){return"RunnableSequence"}constructor(e){super(e),Object.defineProperty(this,"first",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"middle",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"last",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"omitSequenceTags",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),this.first=e.first,this.middle=e.middle??this.middle,this.last=e.last,this.name=e.name,this.omitSequenceTags=e.omitSequenceTags??this.omitSequenceTags}get steps(){return[this.first,...this.middle,this.last]}async invoke(e,t){let n=He(t),s=await(await Cr(n))?.handleChainStart(this.toJSON(),xt(e,"input"),n.runId,void 0,void 0,void 0,n?.runName);delete n.runId;let i=e,a;try{let f=[this.first,...this.middle];for(let d=0;d<f.length;d+=1){let m=f[d].invoke(i,mt(n,{callbacks:s?.getChild(this.omitSequenceTags?void 0:`seq:step:${d+1}`)}));i=await Mn(m,t?.signal)}if(t?.signal?.aborted)throw new Error("Aborted");a=await this.last.invoke(i,mt(n,{callbacks:s?.getChild(this.omitSequenceTags?void 0:`seq:step:${this.steps.length}`)}))}catch(f){throw await s?.handleChainError(f),f}return await s?.handleChainEnd(xt(a,"output")),a}async batch(e,t,n){let A=this._getOptionsList(t??{},e.length),s=await Promise.all(A.map(Cr)),i=await Promise.all(s.map(async(f,d)=>{let h=await f?.handleChainStart(this.toJSON(),xt(e[d],"input"),A[d].runId,void 0,void 0,void 0,A[d].runName);return delete A[d].runId,h})),a=e;try{for(let f=0;f<this.steps.length;f+=1){let h=this.steps[f].batch(a,i.map((m,y)=>{let w=m?.getChild(this.omitSequenceTags?void 0:`seq:step:${f+1}`);return mt(A[y],{callbacks:w})}),n);a=await Mn(h,A[0]?.signal)}}catch(f){throw await Promise.all(i.map(d=>d?.handleChainError(f))),f}return await Promise.all(i.map(f=>f?.handleChainEnd(xt(a,"output")))),a}_concatOutputChunks(e,t){return this.last._concatOutputChunks(e,t)}async*_streamIterator(e,t){let n=await Cr(t),{runId:A,...s}=t??{},i=await n?.handleChainStart(this.toJSON(),xt(e,"input"),A,void 0,void 0,void 0,s?.runName),a=[this.first,...this.middle,this.last],f=!0,d;async function*h(){yield e}try{let m=a[0].transform(h(),mt(s,{callbacks:i?.getChild(this.omitSequenceTags?void 0:"seq:step:1")}));for(let y=1;y<a.length;y+=1)m=await a[y].transform(m,mt(s,{callbacks:i?.getChild(this.omitSequenceTags?void 0:`seq:step:${y+1}`)}));for await(let y of m)if(t?.signal?.throwIfAborted(),yield y,f)if(d===void 0)d=y;else try{d=this._concatOutputChunks(d,y)}catch{d=void 0,f=!1}}catch(m){throw await i?.handleChainError(m),m}await i?.handleChainEnd(xt(d,"output"))}getGraph(e){let t=new pu,n=null;return this.steps.forEach((A,s)=>{let i=A.getGraph(e);s!==0&&i.trimFirstNode(),s!==this.steps.length-1&&i.trimLastNode(),t.extend(i);let a=i.firstNode();if(!a)throw new Error(`Runnable ${A} has no first node`);n&&t.addEdge(n,a),n=i.lastNode()}),t}pipe(e){return r.isRunnableSequence(e)?new r({first:this.first,middle:this.middle.concat([this.last,e.first,...e.middle]),last:e.last,name:this.name??e.name}):new r({first:this.first,middle:[...this.middle,this.last],last:BA(e),name:this.name})}static isRunnableSequence(e){return Array.isArray(e.middle)&&qe.isRunnable(e)}static from([e,...t],n){let A={};return typeof n=="string"?A.name=n:n!==void 0&&(A=n),new r({...A,first:BA(e),middle:t.slice(0,-1).map(BA),last:BA(t[t.length-1])})}},ls=class r extends qe{static lc_name(){return"RunnableMap"}getStepsKeys(){return Object.keys(this.steps)}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"steps",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.steps={};for(let[t,n]of Object.entries(e.steps))this.steps[t]=BA(n)}static from(e){return new r({steps:e})}async invoke(e,t){let n=He(t),s=await(await Cr(n))?.handleChainStart(this.toJSON(),{input:e},n.runId,void 0,void 0,void 0,n?.runName);delete n.runId;let i={};try{let a=Object.entries(this.steps).map(async([f,d])=>{i[f]=await d.invoke(e,mt(n,{callbacks:s?.getChild(`map:key:${f}`)}))});await Mn(Promise.all(a),t?.signal)}catch(a){throw await s?.handleChainError(a),a}return await s?.handleChainEnd(i),i}async*_transform(e,t,n){let A={...this.steps},s=Oh(e,Object.keys(A).length),i=new Map(Object.entries(A).map(([a,f],d)=>{let h=f.transform(s[d],mt(n,{callbacks:t?.getChild(`map:key:${a}`)}));return[a,h.next().then(m=>({key:a,gen:h,result:m}))]}));for(;i.size;){let a=Promise.race(i.values()),{key:f,result:d,gen:h}=await Mn(a,n?.signal);i.delete(f),d.done||(yield{[f]:d.value},i.set(f,h.next().then(m=>({key:f,gen:h,result:m}))))}}transform(e,t){return this._transformStreamWithConfig(e,this._transform.bind(this),t)}async stream(e,t){async function*n(){yield e}let A=He(t),s=new gA({generator:this.transform(n(),A),config:A});return await s.setup,Yt.fromAsyncGenerator(s)}},Vh=class r extends qe{constructor(e){if(super(e),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"func",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),!tl(e.func))throw new Error("RunnableTraceable requires a function that is wrapped in traceable higher-order function");this.func=e.func}async invoke(e,t){let[n]=this._getOptionsList(t??{},1),A=await Cr(n),s=this.func(mt(n,{callbacks:A}),e);return Mn(s,n?.signal)}async*_streamIterator(e,t){let[n]=this._getOptionsList(t??{},1),A=await this.invoke(e,t);if(nf(A)){for await(let s of A)n?.signal?.throwIfAborted(),yield s;return}if(yv(A)){for(;;){n?.signal?.throwIfAborted();let s=A.next();if(s.done)break;yield s.value}return}yield A}static from(e){return new r({func:e})}};function I1(r){if(tl(r))throw new Error("RunnableLambda requires a function that is not wrapped in traceable higher-order function. This shouldn't happen.")}var pn=class r extends qe{static lc_name(){return"RunnableLambda"}constructor(e){if(tl(e.func))return Vh.from(e.func);super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"func",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),I1(e.func),this.func=e.func}static from(e){return new r({func:e})}async _invoke(e,t,n){return new Promise((A,s)=>{let i=mt(t,{callbacks:n?.getChild(),recursionLimit:(t?.recursionLimit??$l)-1});cr.runWithConfig(en(i),async()=>{try{let a=await this.func(e,{...i});if(a&&qe.isRunnable(a)){if(t?.recursionLimit===0)throw new Error("Recursion limit reached.");a=await a.invoke(e,{...i,recursionLimit:(i.recursionLimit??$l)-1})}else if(nf(a)){let f;for await(let d of Af(i,a))if(t?.signal?.throwIfAborted(),f===void 0)f=d;else try{f=this._concatOutputChunks(f,d)}catch{f=d}a=f}else if(Kh(a)){let f;for(let d of zh(i,a))if(t?.signal?.throwIfAborted(),f===void 0)f=d;else try{f=this._concatOutputChunks(f,d)}catch{f=d}a=f}A(a)}catch(a){s(a)}})})}async invoke(e,t){return this._callWithConfig(this._invoke.bind(this),e,t)}async*_transform(e,t,n){let A;for await(let a of e)if(A===void 0)A=a;else try{A=this._concatOutputChunks(A,a)}catch{A=a}let s=mt(n,{callbacks:t?.getChild(),recursionLimit:(n?.recursionLimit??$l)-1}),i=await new Promise((a,f)=>{cr.runWithConfig(en(s),async()=>{try{let d=await this.func(A,{...s,config:s});a(d)}catch(d){f(d)}})});if(i&&qe.isRunnable(i)){if(n?.recursionLimit===0)throw new Error("Recursion limit reached.");let a=await i.stream(A,s);for await(let f of a)yield f}else if(nf(i))for await(let a of Af(s,i))n?.signal?.throwIfAborted(),yield a;else if(Kh(i))for(let a of zh(s,i))n?.signal?.throwIfAborted(),yield a;else yield i}transform(e,t){return this._transformStreamWithConfig(e,this._transform.bind(this),t)}async stream(e,t){async function*n(){yield e}let A=He(t),s=new gA({generator:this.transform(n(),A),config:A});return await s.setup,Yt.fromAsyncGenerator(s)}};var af=class extends qe{static lc_name(){return"RunnableWithFallbacks"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"runnable",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fallbacks",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.runnable=e.runnable,this.fallbacks=e.fallbacks}*runnables(){yield this.runnable;for(let e of this.fallbacks)yield e}async invoke(e,t){let n=He(t),A=await Cr(n),{runId:s,...i}=n,a=await A?.handleChainStart(this.toJSON(),xt(e,"input"),s,void 0,void 0,void 0,i?.runName),f=mt(i,{callbacks:a?.getChild()});return await cr.runWithConfig(f,async()=>{let h;for(let m of this.runnables()){n?.signal?.throwIfAborted();try{let y=await m.invoke(e,f);return await a?.handleChainEnd(xt(y,"output")),y}catch(y){h===void 0&&(h=y)}}throw h===void 0?new Error("No error stored at end of fallback."):(await a?.handleChainError(h),h)})}async*_streamIterator(e,t){let n=He(t),A=await Cr(n),{runId:s,...i}=n,a=await A?.handleChainStart(this.toJSON(),xt(e,"input"),s,void 0,void 0,void 0,i?.runName),f,d;for(let m of this.runnables()){n?.signal?.throwIfAborted();let y=mt(i,{callbacks:a?.getChild()});try{let w=await m.stream(e,y);d=Af(y,w);break}catch(w){f===void 0&&(f=w)}}if(d===void 0){let m=f??new Error("No error stored at end of fallback.");throw await a?.handleChainError(m),m}let h;try{for await(let m of d){yield m;try{h=h===void 0?h:this._concatOutputChunks(h,m)}catch{h=void 0}}}catch(m){throw await a?.handleChainError(m),m}await a?.handleChainEnd(xt(h,"output"))}async batch(e,t,n){if(n?.returnExceptions)throw new Error("Not implemented.");let A=this._getOptionsList(t??{},e.length),s=await Promise.all(A.map(f=>Cr(f))),i=await Promise.all(s.map(async(f,d)=>{let h=await f?.handleChainStart(this.toJSON(),xt(e[d],"input"),A[d].runId,void 0,void 0,void 0,A[d].runName);return delete A[d].runId,h})),a;for(let f of this.runnables()){A[0].signal?.throwIfAborted();try{let d=await f.batch(e,i.map((h,m)=>mt(A[m],{callbacks:h?.getChild()})),n);return await Promise.all(i.map((h,m)=>h?.handleChainEnd(xt(d[m],"output")))),d}catch(d){a===void 0&&(a=d)}}throw a?(await Promise.all(i.map(f=>f?.handleChainError(a))),a):new Error("No error stored at end of fallbacks.")}};function BA(r){if(typeof r=="function")return new pn({func:r});if(qe.isRunnable(r))return r;if(!Array.isArray(r)&&typeof r=="object"){let e={};for(let[t,n]of Object.entries(r))e[t]=BA(n);return new ls({steps:e})}else throw new Error(`Expected a Runnable, function or object.
Instead got an unsupported type.`)}var Ka=class extends qe{static lc_name(){return"RunnableAssign"}constructor(e){e instanceof ls&&(e={mapper:e}),super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"mapper",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.mapper=e.mapper}async invoke(e,t){let n=await this.mapper.invoke(e,t);return{...e,...n}}async*_transform(e,t,n){let A=this.mapper.getStepsKeys(),[s,i]=Oh(e),a=this.mapper.transform(i,mt(n,{callbacks:t?.getChild()})),f=a.next();for await(let d of s){if(typeof d!="object"||Array.isArray(d))throw new Error(`RunnableAssign can only be used with objects as input, got ${typeof d}`);let h=Object.fromEntries(Object.entries(d).filter(([m])=>!A.includes(m)));Object.keys(h).length>0&&(yield h)}yield(await f).value;for await(let d of a)yield d}transform(e,t){return this._transformStreamWithConfig(e,this._transform.bind(this),t)}async stream(e,t){async function*n(){yield e}let A=He(t),s=new gA({generator:this.transform(n(),A),config:A});return await s.setup,Yt.fromAsyncGenerator(s)}},of=class extends qe{static lc_name(){return"RunnablePick"}constructor(e){(typeof e=="string"||Array.isArray(e))&&(e={keys:e}),super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"keys",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.keys=e.keys}async _pick(e){if(typeof this.keys=="string")return e[this.keys];{let t=this.keys.map(n=>[n,e[n]]).filter(n=>n[1]!==void 0);return t.length===0?void 0:Object.fromEntries(t)}}async invoke(e,t){return this._callWithConfig(this._pick.bind(this),e,t)}async*_transform(e){for await(let t of e){let n=await this._pick(t);n!==void 0&&(yield n)}}transform(e,t){return this._transformStreamWithConfig(e,this._transform.bind(this),t)}async stream(e,t){async function*n(){yield e}let A=He(t),s=new gA({generator:this.transform(n(),A),config:A});return await s.setup,Yt.fromAsyncGenerator(s)}},mu=class extends vA{constructor(e){let t=CA.from([pn.from(async n=>{let A;if(es(n))try{A=await ja(this.schema,n.args)}catch{throw new Gs("Received tool input did not match expected schema",JSON.stringify(n.args))}else A=n;return A}).withConfig({runName:`${e.name}:parse_input`}),e.bound]).withConfig({runName:e.name});super({bound:t,config:e.config??{}}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"description",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"schema",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name=e.name,this.description=e.description,this.schema=e.schema}static lc_name(){return"RunnableToolLike"}};function U1(r,e){let t=e.name??r.getName(),n=e.description??gi(e.schema);return jh(e.schema)?new mu({name:t,description:n,schema:Pr.object({input:Pr.string()}).transform(A=>A.input),bound:r}):new mu({name:t,description:n,schema:e.schema,bound:r})}var F1=typeof window=="object"?window:{},ke="0123456789abcdef".split(""),Q1=[-2147483648,8388608,32768,128],hn=[24,16,8,0];var Rt=[];function mn(r){r?(Rt[0]=Rt[16]=Rt[1]=Rt[2]=Rt[3]=Rt[4]=Rt[5]=Rt[6]=Rt[7]=Rt[8]=Rt[9]=Rt[10]=Rt[11]=Rt[12]=Rt[13]=Rt[14]=Rt[15]=0,this.blocks=Rt):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.h0=1732584193,this.h1=4023233417,this.h2=2562383102,this.h3=271733878,this.h4=3285377520,this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0}mn.prototype.update=function(r){if(!this.finalized){var e=typeof r!="string";e&&r.constructor===F1.ArrayBuffer&&(r=new Uint8Array(r));for(var t,n=0,A,s=r.length||0,i=this.blocks;n<s;){if(this.hashed&&(this.hashed=!1,i[0]=this.block,i[16]=i[1]=i[2]=i[3]=i[4]=i[5]=i[6]=i[7]=i[8]=i[9]=i[10]=i[11]=i[12]=i[13]=i[14]=i[15]=0),e)for(A=this.start;n<s&&A<64;++n)i[A>>2]|=r[n]<<hn[A++&3];else for(A=this.start;n<s&&A<64;++n)t=r.charCodeAt(n),t<128?i[A>>2]|=t<<hn[A++&3]:t<2048?(i[A>>2]|=(192|t>>6)<<hn[A++&3],i[A>>2]|=(128|t&63)<<hn[A++&3]):t<55296||t>=57344?(i[A>>2]|=(224|t>>12)<<hn[A++&3],i[A>>2]|=(128|t>>6&63)<<hn[A++&3],i[A>>2]|=(128|t&63)<<hn[A++&3]):(t=65536+((t&1023)<<10|r.charCodeAt(++n)&1023),i[A>>2]|=(240|t>>18)<<hn[A++&3],i[A>>2]|=(128|t>>12&63)<<hn[A++&3],i[A>>2]|=(128|t>>6&63)<<hn[A++&3],i[A>>2]|=(128|t&63)<<hn[A++&3]);this.lastByteIndex=A,this.bytes+=A-this.start,A>=64?(this.block=i[16],this.start=A-64,this.hash(),this.hashed=!0):this.start=A}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}};mn.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var r=this.blocks,e=this.lastByteIndex;r[16]=this.block,r[e>>2]|=Q1[e&3],this.block=r[16],e>=56&&(this.hashed||this.hash(),r[0]=this.block,r[16]=r[1]=r[2]=r[3]=r[4]=r[5]=r[6]=r[7]=r[8]=r[9]=r[10]=r[11]=r[12]=r[13]=r[14]=r[15]=0),r[14]=this.hBytes<<3|this.bytes>>>29,r[15]=this.bytes<<3,this.hash()}};mn.prototype.hash=function(){var r=this.h0,e=this.h1,t=this.h2,n=this.h3,A=this.h4,s,i,a,f=this.blocks;for(i=16;i<80;++i)a=f[i-3]^f[i-8]^f[i-14]^f[i-16],f[i]=a<<1|a>>>31;for(i=0;i<20;i+=5)s=e&t|~e&n,a=r<<5|r>>>27,A=a+s+A+1518500249+f[i]<<0,e=e<<30|e>>>2,s=r&e|~r&t,a=A<<5|A>>>27,n=a+s+n+1518500249+f[i+1]<<0,r=r<<30|r>>>2,s=A&r|~A&e,a=n<<5|n>>>27,t=a+s+t+1518500249+f[i+2]<<0,A=A<<30|A>>>2,s=n&A|~n&r,a=t<<5|t>>>27,e=a+s+e+1518500249+f[i+3]<<0,n=n<<30|n>>>2,s=t&n|~t&A,a=e<<5|e>>>27,r=a+s+r+1518500249+f[i+4]<<0,t=t<<30|t>>>2;for(;i<40;i+=5)s=e^t^n,a=r<<5|r>>>27,A=a+s+A+1859775393+f[i]<<0,e=e<<30|e>>>2,s=r^e^t,a=A<<5|A>>>27,n=a+s+n+1859775393+f[i+1]<<0,r=r<<30|r>>>2,s=A^r^e,a=n<<5|n>>>27,t=a+s+t+1859775393+f[i+2]<<0,A=A<<30|A>>>2,s=n^A^r,a=t<<5|t>>>27,e=a+s+e+1859775393+f[i+3]<<0,n=n<<30|n>>>2,s=t^n^A,a=e<<5|e>>>27,r=a+s+r+1859775393+f[i+4]<<0,t=t<<30|t>>>2;for(;i<60;i+=5)s=e&t|e&n|t&n,a=r<<5|r>>>27,A=a+s+A-1894007588+f[i]<<0,e=e<<30|e>>>2,s=r&e|r&t|e&t,a=A<<5|A>>>27,n=a+s+n-1894007588+f[i+1]<<0,r=r<<30|r>>>2,s=A&r|A&e|r&e,a=n<<5|n>>>27,t=a+s+t-1894007588+f[i+2]<<0,A=A<<30|A>>>2,s=n&A|n&r|A&r,a=t<<5|t>>>27,e=a+s+e-1894007588+f[i+3]<<0,n=n<<30|n>>>2,s=t&n|t&A|n&A,a=e<<5|e>>>27,r=a+s+r-1894007588+f[i+4]<<0,t=t<<30|t>>>2;for(;i<80;i+=5)s=e^t^n,a=r<<5|r>>>27,A=a+s+A-899497514+f[i]<<0,e=e<<30|e>>>2,s=r^e^t,a=A<<5|A>>>27,n=a+s+n-899497514+f[i+1]<<0,r=r<<30|r>>>2,s=A^r^e,a=n<<5|n>>>27,t=a+s+t-899497514+f[i+2]<<0,A=A<<30|A>>>2,s=n^A^r,a=t<<5|t>>>27,e=a+s+e-899497514+f[i+3]<<0,n=n<<30|n>>>2,s=t^n^A,a=e<<5|e>>>27,r=a+s+r-899497514+f[i+4]<<0,t=t<<30|t>>>2;this.h0=this.h0+r<<0,this.h1=this.h1+e<<0,this.h2=this.h2+t<<0,this.h3=this.h3+n<<0,this.h4=this.h4+A<<0};mn.prototype.hex=function(){this.finalize();var r=this.h0,e=this.h1,t=this.h2,n=this.h3,A=this.h4;return ke[r>>28&15]+ke[r>>24&15]+ke[r>>20&15]+ke[r>>16&15]+ke[r>>12&15]+ke[r>>8&15]+ke[r>>4&15]+ke[r&15]+ke[e>>28&15]+ke[e>>24&15]+ke[e>>20&15]+ke[e>>16&15]+ke[e>>12&15]+ke[e>>8&15]+ke[e>>4&15]+ke[e&15]+ke[t>>28&15]+ke[t>>24&15]+ke[t>>20&15]+ke[t>>16&15]+ke[t>>12&15]+ke[t>>8&15]+ke[t>>4&15]+ke[t&15]+ke[n>>28&15]+ke[n>>24&15]+ke[n>>20&15]+ke[n>>16&15]+ke[n>>12&15]+ke[n>>8&15]+ke[n>>4&15]+ke[n&15]+ke[A>>28&15]+ke[A>>24&15]+ke[A>>20&15]+ke[A>>16&15]+ke[A>>12&15]+ke[A>>8&15]+ke[A>>4&15]+ke[A&15]};mn.prototype.toString=mn.prototype.hex;mn.prototype.digest=function(){this.finalize();var r=this.h0,e=this.h1,t=this.h2,n=this.h3,A=this.h4;return[r>>24&255,r>>16&255,r>>8&255,r&255,e>>24&255,e>>16&255,e>>8&255,e&255,t>>24&255,t>>16&255,t>>8&255,t&255,n>>24&255,n>>16&255,n>>8&255,n&255,A>>24&255,A>>16&255,A>>8&255,A&255]};mn.prototype.array=mn.prototype.digest;mn.prototype.arrayBuffer=function(){this.finalize();var r=new ArrayBuffer(20),e=new DataView(r);return e.setUint32(0,this.h0),e.setUint32(4,this.h1),e.setUint32(8,this.h2),e.setUint32(12,this.h3),e.setUint32(16,this.h4),r};var _v=!1,Zh=r=>(_v||(console.warn(["The default method for hashing keys is insecure and will be replaced in a future version,","but hasn't been replaced yet as to not break existing caches. It's recommended that you use","a more secure hashing algorithm to avoid cache poisoning.","","See this page for more information:","|","\u2514> https://js.langchain.com/docs/troubleshooting/warnings/insecure-cache-algorithm"].join(`
`)),_v=!0),new mn(!0).update(r).hex());var Ae="0123456789abcdef".split(""),T1=[-2147483648,8388608,32768,128],gn=[24,16,8,0],uf=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];var kt=[];function zn(r,e){e?(kt[0]=kt[16]=kt[1]=kt[2]=kt[3]=kt[4]=kt[5]=kt[6]=kt[7]=kt[8]=kt[9]=kt[10]=kt[11]=kt[12]=kt[13]=kt[14]=kt[15]=0,this.blocks=kt):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],r?(this.h0=3238371032,this.h1=914150663,this.h2=812702999,this.h3=4144912697,this.h4=4290775857,this.h5=1750603025,this.h6=1694076839,this.h7=3204075428):(this.h0=1779033703,this.h1=3144134277,this.h2=1013904242,this.h3=2773480762,this.h4=1359893119,this.h5=2600822924,this.h6=528734635,this.h7=1541459225),this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0,this.is224=r}zn.prototype.update=function(r){if(!this.finalized){var e,t=typeof r;if(t!=="string"){if(t==="object"){if(r===null)throw new Error(ERROR);if(ARRAY_BUFFER&&r.constructor===ArrayBuffer)r=new Uint8Array(r);else if(!Array.isArray(r)&&(!ARRAY_BUFFER||!ArrayBuffer.isView(r)))throw new Error(ERROR)}else throw new Error(ERROR);e=!0}for(var n,A=0,s,i=r.length,a=this.blocks;A<i;){if(this.hashed&&(this.hashed=!1,a[0]=this.block,this.block=a[16]=a[1]=a[2]=a[3]=a[4]=a[5]=a[6]=a[7]=a[8]=a[9]=a[10]=a[11]=a[12]=a[13]=a[14]=a[15]=0),e)for(s=this.start;A<i&&s<64;++A)a[s>>>2]|=r[A]<<gn[s++&3];else for(s=this.start;A<i&&s<64;++A)n=r.charCodeAt(A),n<128?a[s>>>2]|=n<<gn[s++&3]:n<2048?(a[s>>>2]|=(192|n>>>6)<<gn[s++&3],a[s>>>2]|=(128|n&63)<<gn[s++&3]):n<55296||n>=57344?(a[s>>>2]|=(224|n>>>12)<<gn[s++&3],a[s>>>2]|=(128|n>>>6&63)<<gn[s++&3],a[s>>>2]|=(128|n&63)<<gn[s++&3]):(n=65536+((n&1023)<<10|r.charCodeAt(++A)&1023),a[s>>>2]|=(240|n>>>18)<<gn[s++&3],a[s>>>2]|=(128|n>>>12&63)<<gn[s++&3],a[s>>>2]|=(128|n>>>6&63)<<gn[s++&3],a[s>>>2]|=(128|n&63)<<gn[s++&3]);this.lastByteIndex=s,this.bytes+=s-this.start,s>=64?(this.block=a[16],this.start=s-64,this.hash(),this.hashed=!0):this.start=s}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}};zn.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var r=this.blocks,e=this.lastByteIndex;r[16]=this.block,r[e>>>2]|=T1[e&3],this.block=r[16],e>=56&&(this.hashed||this.hash(),r[0]=this.block,r[16]=r[1]=r[2]=r[3]=r[4]=r[5]=r[6]=r[7]=r[8]=r[9]=r[10]=r[11]=r[12]=r[13]=r[14]=r[15]=0),r[14]=this.hBytes<<3|this.bytes>>>29,r[15]=this.bytes<<3,this.hash()}};zn.prototype.hash=function(){var r=this.h0,e=this.h1,t=this.h2,n=this.h3,A=this.h4,s=this.h5,i=this.h6,a=this.h7,f=this.blocks,d,h,m,y,w,b,C,I,T,Q,P;for(d=16;d<64;++d)w=f[d-15],h=(w>>>7|w<<25)^(w>>>18|w<<14)^w>>>3,w=f[d-2],m=(w>>>17|w<<15)^(w>>>19|w<<13)^w>>>10,f[d]=f[d-16]+h+f[d-7]+m<<0;for(P=e&t,d=0;d<64;d+=4)this.first?(this.is224?(I=300032,w=f[0]-1413257819,a=w-150054599<<0,n=w+24177077<<0):(I=704751109,w=f[0]-210244248,a=w-1521486534<<0,n=w+143694565<<0),this.first=!1):(h=(r>>>2|r<<30)^(r>>>13|r<<19)^(r>>>22|r<<10),m=(A>>>6|A<<26)^(A>>>11|A<<21)^(A>>>25|A<<7),I=r&e,y=I^r&t^P,C=A&s^~A&i,w=a+m+C+uf[d]+f[d],b=h+y,a=n+w<<0,n=w+b<<0),h=(n>>>2|n<<30)^(n>>>13|n<<19)^(n>>>22|n<<10),m=(a>>>6|a<<26)^(a>>>11|a<<21)^(a>>>25|a<<7),T=n&r,y=T^n&e^I,C=i&a^~i&A,w=s+m+C+uf[d+1]+f[d+1],b=h+y,i=t+w<<0,t=w+b<<0,h=(t>>>2|t<<30)^(t>>>13|t<<19)^(t>>>22|t<<10),m=(i>>>6|i<<26)^(i>>>11|i<<21)^(i>>>25|i<<7),Q=t&n,y=Q^t&r^T,C=s&i^~s&a,w=A+m+C+uf[d+2]+f[d+2],b=h+y,s=e+w<<0,e=w+b<<0,h=(e>>>2|e<<30)^(e>>>13|e<<19)^(e>>>22|e<<10),m=(s>>>6|s<<26)^(s>>>11|s<<21)^(s>>>25|s<<7),P=e&t,y=P^e&n^Q,C=s&i^~s&a,w=A+m+C+uf[d+3]+f[d+3],b=h+y,A=r+w<<0,r=w+b<<0,this.chromeBugWorkAround=!0;this.h0=this.h0+r<<0,this.h1=this.h1+e<<0,this.h2=this.h2+t<<0,this.h3=this.h3+n<<0,this.h4=this.h4+A<<0,this.h5=this.h5+s<<0,this.h6=this.h6+i<<0,this.h7=this.h7+a<<0};zn.prototype.hex=function(){this.finalize();var r=this.h0,e=this.h1,t=this.h2,n=this.h3,A=this.h4,s=this.h5,i=this.h6,a=this.h7,f=Ae[r>>>28&15]+Ae[r>>>24&15]+Ae[r>>>20&15]+Ae[r>>>16&15]+Ae[r>>>12&15]+Ae[r>>>8&15]+Ae[r>>>4&15]+Ae[r&15]+Ae[e>>>28&15]+Ae[e>>>24&15]+Ae[e>>>20&15]+Ae[e>>>16&15]+Ae[e>>>12&15]+Ae[e>>>8&15]+Ae[e>>>4&15]+Ae[e&15]+Ae[t>>>28&15]+Ae[t>>>24&15]+Ae[t>>>20&15]+Ae[t>>>16&15]+Ae[t>>>12&15]+Ae[t>>>8&15]+Ae[t>>>4&15]+Ae[t&15]+Ae[n>>>28&15]+Ae[n>>>24&15]+Ae[n>>>20&15]+Ae[n>>>16&15]+Ae[n>>>12&15]+Ae[n>>>8&15]+Ae[n>>>4&15]+Ae[n&15]+Ae[A>>>28&15]+Ae[A>>>24&15]+Ae[A>>>20&15]+Ae[A>>>16&15]+Ae[A>>>12&15]+Ae[A>>>8&15]+Ae[A>>>4&15]+Ae[A&15]+Ae[s>>>28&15]+Ae[s>>>24&15]+Ae[s>>>20&15]+Ae[s>>>16&15]+Ae[s>>>12&15]+Ae[s>>>8&15]+Ae[s>>>4&15]+Ae[s&15]+Ae[i>>>28&15]+Ae[i>>>24&15]+Ae[i>>>20&15]+Ae[i>>>16&15]+Ae[i>>>12&15]+Ae[i>>>8&15]+Ae[i>>>4&15]+Ae[i&15];return this.is224||(f+=Ae[a>>>28&15]+Ae[a>>>24&15]+Ae[a>>>20&15]+Ae[a>>>16&15]+Ae[a>>>12&15]+Ae[a>>>8&15]+Ae[a>>>4&15]+Ae[a&15]),f};zn.prototype.toString=zn.prototype.hex;zn.prototype.digest=function(){this.finalize();var r=this.h0,e=this.h1,t=this.h2,n=this.h3,A=this.h4,s=this.h5,i=this.h6,a=this.h7,f=[r>>>24&255,r>>>16&255,r>>>8&255,r&255,e>>>24&255,e>>>16&255,e>>>8&255,e&255,t>>>24&255,t>>>16&255,t>>>8&255,t&255,n>>>24&255,n>>>16&255,n>>>8&255,n&255,A>>>24&255,A>>>16&255,A>>>8&255,A&255,s>>>24&255,s>>>16&255,s>>>8&255,s&255,i>>>24&255,i>>>16&255,i>>>8&255,i&255];return this.is224||f.push(a>>>24&255,a>>>16&255,a>>>8&255,a&255),f};zn.prototype.array=zn.prototype.digest;zn.prototype.arrayBuffer=function(){this.finalize();var r=new ArrayBuffer(this.is224?28:32),e=new DataView(r);return e.setUint32(0,this.h0),e.setUint32(4,this.h1),e.setUint32(8,this.h2),e.setUint32(12,this.h3),e.setUint32(16,this.h4),e.setUint32(20,this.h5),e.setUint32(24,this.h6),this.is224||e.setUint32(28,this.h7),r};var O1=(...r)=>Zh(r.join("_"));var Jh=class{constructor(){Object.defineProperty(this,"keyEncoder",{enumerable:!0,configurable:!0,writable:!0,value:O1})}makeDefaultKeyEncoder(e){this.keyEncoder=e}},S1=new Map,cf=class r extends Jh{constructor(e){super(),Object.defineProperty(this,"cache",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.cache=e??new Map}lookup(e,t){return Promise.resolve(this.cache.get(this.keyEncoder(e,t))??null)}async update(e,t,n){this.cache.set(this.keyEncoder(e,t),n)}static global(){return new r(S1)}};var lf=class extends an{},ff=class extends lf{static lc_name(){return"StringPromptValue"}constructor(e){super({value:e}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompt_values"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.value=e}toString(){return this.value}toChatMessages(){return[new wr(this.value)]}},df=class extends lf{static lc_name(){return"ChatPromptValue"}constructor(e){Array.isArray(e)&&(e={messages:e}),super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompt_values"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"messages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.messages=e.messages}toString(){return Do(this.messages)}toChatMessages(){return this.messages}};var Cv=Ur(vv(),1);var M1=Object.defineProperty,$1=(r,e,t)=>e in r?M1(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,j1=(r,e,t)=>($1(r,typeof e!="symbol"?e+"":e,t),t);function K1(r,e){let t=Array.from({length:r.length},(n,A)=>({start:A,end:A+1}));for(;t.length>1;){let n=null;for(let A=0;A<t.length-1;A++){let s=r.slice(t[A].start,t[A+1].end),i=e.get(s.join(","));i!=null&&(n==null||i<n[0])&&(n=[i,A])}if(n!=null){let A=n[1];t[A]={start:t[A].start,end:t[A+1].end},t.splice(A+1,1)}else break}return t}function z1(r,e){return r.length===1?[e.get(r.join(","))]:K1(r,e).map(t=>e.get(r.slice(t.start,t.end).join(","))).filter(t=>t!=null)}function G1(r){return r.replace(/[\\^$*+?.()|[\]{}]/g,"\\$&")}var qh=class{constructor(r,e){rA(this,"specialTokens");rA(this,"inverseSpecialTokens");rA(this,"patStr");rA(this,"textEncoder",new TextEncoder);rA(this,"textDecoder",new TextDecoder("utf-8"));rA(this,"rankMap",new Map);rA(this,"textMap",new Map);this.patStr=r.pat_str;let t=r.bpe_ranks.split(`
`).filter(Boolean).reduce((n,A)=>{let[s,i,...a]=A.split(" "),f=Number.parseInt(i,10);return a.forEach((d,h)=>n[d]=f+h),n},{});for(let[n,A]of Object.entries(t)){let s=Cv.default.toByteArray(n);this.rankMap.set(s.join(","),A),this.textMap.set(A,s)}this.specialTokens={...r.special_tokens,...e},this.inverseSpecialTokens=Object.entries(this.specialTokens).reduce((n,[A,s])=>(n[s]=this.textEncoder.encode(A),n),{})}encode(r,e=[],t="all"){let n=new RegExp(this.patStr,"ug"),A=qh.specialTokenRegex(Object.keys(this.specialTokens)),s=[],i=new Set(e==="all"?Object.keys(this.specialTokens):e),a=new Set(t==="all"?Object.keys(this.specialTokens).filter(d=>!i.has(d)):t);if(a.size>0){let d=qh.specialTokenRegex([...a]),h=r.match(d);if(h!=null)throw new Error(`The text contains a special token that is not allowed: ${h[0]}`)}let f=0;for(;;){let d=null,h=f;for(;A.lastIndex=h,d=A.exec(r),!(d==null||i.has(d[0]));)h=d.index+1;let m=d?.index??r.length;for(let w of r.substring(f,m).matchAll(n)){let b=this.textEncoder.encode(w[0]),C=this.rankMap.get(b.join(","));if(C!=null){s.push(C);continue}s.push(...z1(b,this.rankMap))}if(d==null)break;let y=this.specialTokens[d[0]];s.push(y),f=d.index+d[0].length}return s}decode(r){let e=[],t=0;for(let s=0;s<r.length;++s){let i=r[s],a=this.textMap.get(i)??this.inverseSpecialTokens[i];a!=null&&(e.push(a),t+=a.length)}let n=new Uint8Array(t),A=0;for(let s of e)n.set(s,A),A+=s.length;return this.textDecoder.decode(n)}},hf=qh;j1(hf,"specialTokenRegex",r=>new RegExp(r.map(e=>G1(e)).join("|"),"g"));function Xh(r){switch(r){case"gpt2":return"gpt2";case"code-cushman-001":case"code-cushman-002":case"code-davinci-001":case"code-davinci-002":case"cushman-codex":case"davinci-codex":case"davinci-002":case"text-davinci-002":case"text-davinci-003":return"p50k_base";case"code-davinci-edit-001":case"text-davinci-edit-001":return"p50k_edit";case"ada":case"babbage":case"babbage-002":case"code-search-ada-code-001":case"code-search-babbage-code-001":case"curie":case"davinci":case"text-ada-001":case"text-babbage-001":case"text-curie-001":case"text-davinci-001":case"text-search-ada-doc-001":case"text-search-babbage-doc-001":case"text-search-curie-doc-001":case"text-search-davinci-doc-001":case"text-similarity-ada-001":case"text-similarity-babbage-001":case"text-similarity-curie-001":case"text-similarity-davinci-001":return"r50k_base";case"gpt-3.5-turbo-instruct-0914":case"gpt-3.5-turbo-instruct":case"gpt-3.5-turbo-16k-0613":case"gpt-3.5-turbo-16k":case"gpt-3.5-turbo-0613":case"gpt-3.5-turbo-0301":case"gpt-3.5-turbo":case"gpt-4-32k-0613":case"gpt-4-32k-0314":case"gpt-4-32k":case"gpt-4-0613":case"gpt-4-0314":case"gpt-4":case"gpt-3.5-turbo-1106":case"gpt-35-turbo":case"gpt-4-1106-preview":case"gpt-4-vision-preview":case"gpt-3.5-turbo-0125":case"gpt-4-turbo":case"gpt-4-turbo-2024-04-09":case"gpt-4-turbo-preview":case"gpt-4-0125-preview":case"text-embedding-ada-002":case"text-embedding-3-small":case"text-embedding-3-large":return"cl100k_base";case"gpt-4o":case"gpt-4o-2024-05-13":case"gpt-4o-2024-08-06":case"gpt-4o-2024-11-20":case"gpt-4o-mini-2024-07-18":case"gpt-4o-mini":case"gpt-4o-search-preview":case"gpt-4o-search-preview-2025-03-11":case"gpt-4o-mini-search-preview":case"gpt-4o-mini-search-preview-2025-03-11":case"gpt-4o-audio-preview":case"gpt-4o-audio-preview-2024-12-17":case"gpt-4o-audio-preview-2024-10-01":case"gpt-4o-mini-audio-preview":case"gpt-4o-mini-audio-preview-2024-12-17":case"o1":case"o1-2024-12-17":case"o1-mini":case"o1-mini-2024-09-12":case"o1-preview":case"o1-preview-2024-09-12":case"o1-pro":case"o1-pro-2025-03-19":case"o3":case"o3-2025-04-16":case"o3-mini":case"o3-mini-2025-01-31":case"o4-mini":case"o4-mini-2025-04-16":case"chatgpt-4o-latest":case"gpt-4o-realtime":case"gpt-4o-realtime-preview-2024-10-01":case"gpt-4o-realtime-preview-2024-12-17":case"gpt-4o-mini-realtime-preview":case"gpt-4o-mini-realtime-preview-2024-12-17":case"gpt-4.1":case"gpt-4.1-2025-04-14":case"gpt-4.1-mini":case"gpt-4.1-mini-2025-04-14":case"gpt-4.1-nano":case"gpt-4.1-nano-2025-04-14":case"gpt-4.5-preview":case"gpt-4.5-preview-2025-02-27":case"gpt-5":case"gpt-5-2025-08-07":case"gpt-5-nano":case"gpt-5-nano-2025-08-07":case"gpt-5-mini":case"gpt-5-mini-2025-08-07":case"gpt-5-chat-latest":return"o200k_base";default:throw new Error("Unknown model")}}var mf={},V1=new _A({});async function Z1(r){return r in mf||(mf[r]=V1.fetch(`https://tiktoken.pages.dev/js/${r}.json`).then(e=>e.json()).then(e=>new hf(e)).catch(e=>{throw delete mf[r],e})),await mf[r]}async function Ev(r){return Z1(Xh(r))}var J1=r=>r.startsWith("gpt-3.5-turbo-16k")?"gpt-3.5-turbo-16k":r.startsWith("gpt-3.5-turbo-")?"gpt-3.5-turbo":r.startsWith("gpt-4-32k")?"gpt-4-32k":r.startsWith("gpt-4-")?"gpt-4":r.startsWith("gpt-4o")?"gpt-4o":r;function Yh(r){return typeof r!="object"||!r?!1:!!("type"in r&&r.type==="function"&&"function"in r&&typeof r.function=="object"&&r.function&&"name"in r.function&&"parameters"in r.function)}var W1=()=>!1,gu=class extends qe{get lc_attributes(){return{callbacks:void 0,verbose:void 0}}constructor(e){super(e),Object.defineProperty(this,"verbose",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"callbacks",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.verbose=e.verbose??W1(),this.callbacks=e.callbacks,this.tags=e.tags??[],this.metadata=e.metadata??{}}},wu=class extends gu{get callKeys(){return["stop","timeout","signal","tags","metadata","callbacks"]}constructor({callbacks:e,callbackManager:t,...n}){let{cache:A,...s}=n;super({callbacks:e??t,...s}),Object.defineProperty(this,"caller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"cache",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_encoding",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),typeof A=="object"?this.cache=A:A?this.cache=cf.global():this.cache=void 0,this.caller=new _A(n??{})}async getNumTokens(e){let t;typeof e=="string"?t=e:t=e.map(A=>typeof A=="string"?A:A.type==="text"&&"text"in A?A.text:"").join("");let n=Math.ceil(t.length/4);if(!this._encoding)try{this._encoding=await Ev("modelName"in this?J1(this.modelName):"gpt2")}catch(A){console.warn("Failed to calculate number of tokens, falling back to approximate count",A)}if(this._encoding)try{n=this._encoding.encode(t).length}catch(A){console.warn("Failed to calculate number of tokens, falling back to approximate count",A)}return n}static _convertInputToPromptValue(e){return typeof e=="string"?new ff(e):Array.isArray(e)?new df(e.map(Vs)):e}_identifyingParams(){return{}}_getSerializedCacheKeyParametersForCall({config:e,...t}){let n={...this._identifyingParams(),...t,_type:this._llmType(),_model:this._modelType()};return Object.entries(n).filter(([i,a])=>a!==void 0).map(([i,a])=>`${i}:${JSON.stringify(a)}`).sort().join(",")}serialize(){return{...this._identifyingParams(),_type:this._llmType(),_model:this._modelType()}}static async deserialize(e){throw new Error("Use .toJSON() instead")}};var Vn=class extends qe{static lc_name(){return"RunnablePassthrough"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"func",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),e&&(this.func=e.func)}async invoke(e,t){let n=He(t);return this.func&&await this.func(e,n),this._callWithConfig(A=>Promise.resolve(A),e,n)}async*transform(e,t){let n=He(t),A,s=!0;for await(let i of this._transformStreamWithConfig(e,a=>a,n))if(yield i,s)if(A===void 0)A=i;else try{A=wA(A,i)}catch{A=void 0,s=!1}this.func&&A!==void 0&&await this.func(A,n)}static assign(e){return new Ka(new ls({steps:e}))}};function em(r){let e=[];for(let t of r){let n=t;if(Array.isArray(t.content))for(let A=0;A<t.content.length;A++){let s=t.content[A];(Ey(s)||xy(s))&&n===t&&(n=new t.constructor({...n,content:[...t.content.slice(0,A),Iy(s),...t.content.slice(A+1)]}))}e.push(n)}return e}var gf=class r extends wu{constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","chat_models",this._llmType()]}),Object.defineProperty(this,"disableStreaming",{enumerable:!0,configurable:!0,writable:!0,value:!1})}_separateRunnableConfigFromCallOptionsCompat(e){let[t,n]=super._separateRunnableConfigFromCallOptions(e);return n.signal=t.signal,[t,n]}async invoke(e,t){let n=r._convertInputToPromptValue(e);return(await this.generatePrompt([n],t,t?.callbacks)).generations[0][0].message}async*_streamResponseChunks(e,t,n){throw new Error("Not implemented.")}async*_streamIterator(e,t){if(this._streamResponseChunks===r.prototype._streamResponseChunks||this.disableStreaming)yield this.invoke(e,t);else{let A=r._convertInputToPromptValue(e).toChatMessages(),[s,i]=this._separateRunnableConfigFromCallOptionsCompat(t),a={...s.metadata,...this.getLsParams(i)},f=await jt.configure(s.callbacks,this.callbacks,s.tags,this.tags,a,this.metadata,{verbose:this.verbose}),d={options:i,invocation_params:this?.invocationParams(i),batch_size:1},h=await f?.handleChatModelStart(this.toJSON(),[em(A)],s.runId,void 0,d,void 0,void 0,s.runName),m,y;try{for await(let w of this._streamResponseChunks(A,i,h?.[0])){if(w.message.id==null){let b=h?.at(0)?.runId;b!=null&&w.message._updateId(`run-${b}`)}w.message.response_metadata={...w.generationInfo,...w.message.response_metadata},yield w.message,m?m=m.concat(w):m=w,cp(w.message)&&w.message.usage_metadata!==void 0&&(y={tokenUsage:{promptTokens:w.message.usage_metadata.input_tokens,completionTokens:w.message.usage_metadata.output_tokens,totalTokens:w.message.usage_metadata.total_tokens}})}}catch(w){throw await Promise.all((h??[]).map(b=>b?.handleLLMError(w))),w}await Promise.all((h??[]).map(w=>w?.handleLLMEnd({generations:[[m]],llmOutput:y})))}}getLsParams(e){let t=this.getName().startsWith("Chat")?this.getName().replace("Chat",""):this.getName();return{ls_model_type:"chat",ls_stop:e.stop,ls_provider:t}}async _generateUncached(e,t,n,A){let s=e.map(m=>m.map(Vs)),i;if(A!==void 0&&A.length===s.length)i=A;else{let m={...n.metadata,...this.getLsParams(t)},y=await jt.configure(n.callbacks,this.callbacks,n.tags,this.tags,m,this.metadata,{verbose:this.verbose}),w={options:t,invocation_params:this?.invocationParams(t),batch_size:1};i=await y?.handleChatModelStart(this.toJSON(),s.map(em),n.runId,void 0,w,void 0,void 0,n.runName)}let a=[],f=[];if(!!i?.[0].handlers.find(_h)&&!this.disableStreaming&&s.length===1&&this._streamResponseChunks!==r.prototype._streamResponseChunks)try{let m=await this._streamResponseChunks(s[0],t,i?.[0]),y,w;for await(let b of m){if(b.message.id==null){let C=i?.at(0)?.runId;C!=null&&b.message._updateId(`run-${C}`)}y===void 0?y=b:y=wA(y,b),cp(b.message)&&b.message.usage_metadata!==void 0&&(w={tokenUsage:{promptTokens:b.message.usage_metadata.input_tokens,completionTokens:b.message.usage_metadata.output_tokens,totalTokens:b.message.usage_metadata.total_tokens}})}if(y===void 0)throw new Error("Received empty response from chat model call.");a.push([y]),await i?.[0].handleLLMEnd({generations:a,llmOutput:w})}catch(m){throw await i?.[0].handleLLMError(m),m}else{let m=await Promise.allSettled(s.map((y,w)=>this._generate(y,{...t,promptIndex:w},i?.[w])));await Promise.all(m.map(async(y,w)=>{if(y.status==="fulfilled"){let b=y.value;for(let C of b.generations){if(C.message.id==null){let I=i?.at(0)?.runId;I!=null&&C.message._updateId(`run-${I}`)}C.message.response_metadata={...C.generationInfo,...C.message.response_metadata}}return b.generations.length===1&&(b.generations[0].message.response_metadata={...b.llmOutput,...b.generations[0].message.response_metadata}),a[w]=b.generations,f[w]=b.llmOutput,i?.[w]?.handleLLMEnd({generations:[b.generations],llmOutput:b.llmOutput})}else return await i?.[w]?.handleLLMError(y.reason),Promise.reject(y.reason)}))}let h={generations:a,llmOutput:f.length?this._combineLLMOutput?.(...f):void 0};return Object.defineProperty(h,jl,{value:i?{runIds:i?.map(m=>m.runId)}:void 0,configurable:!0}),h}async _generateCached({messages:e,cache:t,llmStringKey:n,parsedOptions:A,handledOptions:s}){let i=e.map(I=>I.map(Vs)),a={...s.metadata,...this.getLsParams(A)},f=await jt.configure(s.callbacks,this.callbacks,s.tags,this.tags,a,this.metadata,{verbose:this.verbose}),d={options:A,invocation_params:this?.invocationParams(A),batch_size:1},h=await f?.handleChatModelStart(this.toJSON(),i.map(em),s.runId,void 0,d,void 0,void 0,s.runName),m=[],w=(await Promise.allSettled(i.map(async(I,T)=>{let Q=r._convertInputToPromptValue(I).toString(),P=await t.lookup(Q,n);return P==null&&m.push(T),P}))).map((I,T)=>({result:I,runManager:h?.[T]})).filter(({result:I})=>I.status==="fulfilled"&&I.value!=null||I.status==="rejected"),b=[];await Promise.all(w.map(async({result:I,runManager:T},Q)=>{if(I.status==="fulfilled"){let P=I.value;return b[Q]=P.map(R=>("message"in R&&JA(R.message)&&WA(R.message)&&(R.message.usage_metadata={input_tokens:0,output_tokens:0,total_tokens:0}),R.generationInfo={...R.generationInfo,tokenUsage:{}},R)),P.length&&await T?.handleLLMNewToken(P[0].text),T?.handleLLMEnd({generations:[P]},void 0,void 0,void 0,{cached:!0})}else return await T?.handleLLMError(I.reason,void 0,void 0,void 0,{cached:!0}),Promise.reject(I.reason)}));let C={generations:b,missingPromptIndices:m,startedRunManagers:h};return Object.defineProperty(C,jl,{value:h?{runIds:h?.map(I=>I.runId)}:void 0,configurable:!0}),C}async generate(e,t,n){let A;Array.isArray(t)?A={stop:t}:A=t;let s=e.map(b=>b.map(Vs)),[i,a]=this._separateRunnableConfigFromCallOptionsCompat(A);if(i.callbacks=i.callbacks??n,!this.cache)return this._generateUncached(s,a,i);let{cache:f}=this,d=this._getSerializedCacheKeyParametersForCall(a),{generations:h,missingPromptIndices:m,startedRunManagers:y}=await this._generateCached({messages:s,cache:f,llmStringKey:d,parsedOptions:a,handledOptions:i}),w={};if(m.length>0){let b=await this._generateUncached(m.map(C=>s[C]),a,i,y!==void 0?m.map(C=>y?.[C]):void 0);await Promise.all(b.generations.map(async(C,I)=>{let T=m[I];h[T]=C;let Q=r._convertInputToPromptValue(s[T]).toString();return f.update(Q,d,C)})),w=b.llmOutput??{}}return{generations:h,llmOutput:w}}invocationParams(e){return{}}_modelType(){return"base_chat_model"}serialize(){return{...this.invocationParams(),_type:this._llmType(),_model:this._modelType()}}async generatePrompt(e,t,n){let A=e.map(s=>s.toChatMessages());return this.generate(A,t,n)}async call(e,t,n){return(await this.generate([e.map(Vs)],t,n)).generations[0][0].message}async callPrompt(e,t,n){let A=e.toChatMessages();return this.call(A,t,n)}async predictMessages(e,t,n){return this.call(e,t,n)}async predict(e,t,n){let A=new wr(e),s=await this.call([A],t,n);if(typeof s.content!="string")throw new Error("Cannot use predict when output is not a string.");return s.content}withStructuredOutput(e,t){if(typeof this.bindTools!="function")throw new Error('Chat model must implement ".bindTools()" to use withStructuredOutput.');if(t?.strict)throw new Error('"strict" mode is not supported for this model by default.');let n=e,A=t?.name,s=gi(n)??"A function available to call.",i=t?.method,a=t?.includeRaw;if(i==="jsonMode")throw new Error('Base withStructuredOutput implementation only supports "functionCalling" as a method.');let f=A??"extract",d;Lr(n)?d=[{type:"function",function:{name:f,description:s,parameters:Er(n)}}]:("name"in n&&(f=n.name),d=[{type:"function",function:{name:f,description:s,parameters:n}}]);let h=this.bindTools(d),m=pn.from(C=>{if(!C.tool_calls||C.tool_calls.length===0)throw new Error("No tool calls found in the response.");let I=C.tool_calls.find(T=>T.name===f);if(!I)throw new Error(`No tool call found with name ${f}.`);return I.args});if(!a)return h.pipe(m).withConfig({runName:"StructuredOutput"});let y=Vn.assign({parsed:(C,I)=>m.invoke(C.raw,I)}),w=Vn.assign({parsed:()=>null}),b=y.withFallbacks({fallbacks:[w]});return CA.from([{raw:h},b]).withConfig({runName:"StructuredOutputRunnable"})}};var tm=class extends qe{parseResultWithPrompt(e,t,n){return this.parseResult(e,n)}_baseMessageToString(e){return typeof e.content=="string"?e.content:this._baseMessageContentToString(e.content)}_baseMessageContentToString(e){return JSON.stringify(e)}async invoke(e,t){return typeof e=="string"?this._callWithConfig(async(n,A)=>this.parseResult([{text:n}],A?.callbacks),e,{...t,runType:"parser"}):this._callWithConfig(async(n,A)=>this.parseResult([{message:n,text:this._baseMessageToString(n)}],A?.callbacks),e,{...t,runType:"parser"})}},za=class extends tm{parseResult(e,t){return this.parse(e[0].text,t)}async parseWithPrompt(e,t,n){return this.parse(e,n)}_type(){throw new Error("_type not implemented")}},fs=class extends Error{constructor(e,t,n,A=!1){if(super(e),Object.defineProperty(this,"llmOutput",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"observation",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"sendToLLM",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.llmOutput=t,this.observation=n,this.sendToLLM=A,A&&(n===void 0||t===void 0))throw new Error("Arguments 'observation' & 'llmOutput' are required if 'sendToLlm' is true");$c(this,"OUTPUT_PARSING_FAILURE")}};var Ga=class extends za{async*_transform(e){for await(let t of e)typeof t=="string"?yield this.parseResult([{text:t}]):yield this.parseResult([{message:t,text:this._baseMessageToString(t)}])}async*transform(e,t){yield*this._transformStreamWithConfig(e,this._transform.bind(this),{...t,runType:"parser"})}},yi=class extends Ga{constructor(e){super(e),Object.defineProperty(this,"diff",{enumerable:!0,configurable:!0,writable:!0,value:!1}),this.diff=e?.diff??this.diff}async*_transform(e){let t,n;for await(let A of e){if(typeof A!="string"&&typeof A.content!="string")throw new Error("Cannot handle non-string output.");let s;if(up(A)){if(typeof A.content!="string")throw new Error("Cannot handle non-string message output.");s=new yA({message:A,text:A.content})}else if(JA(A)){if(typeof A.content!="string")throw new Error("Cannot handle non-string message output.");s=new yA({message:fp(A),text:A.content})}else s=new $n({text:A});n===void 0?n=s:n=n.concat(s);let i=await this.parsePartialResult([n]);i!=null&&!bA(i,t)&&(this.diff?yield this._diff(t,i):yield i,t=i)}}getFormatInstructions(){return""}};var yu=class extends za{static lc_name(){return"StructuredOutputParser"}toJSON(){return this.toJSONNotImplemented()}constructor(e){super(e),Object.defineProperty(this,"schema",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","output_parsers","structured"]})}static fromZodSchema(e){return new this(e)}static fromNamesAndDescriptions(e){let t=Pr.object(Object.fromEntries(Object.entries(e).map(([n,A])=>[n,Pr.string().describe(A)])));return new this(t)}getFormatInstructions(){return`You must format your output as a JSON value that adheres to a given "JSON Schema" instance.

"JSON Schema" is a declarative language that allows you to annotate and validate JSON documents.

For example, the example "JSON Schema" instance {{"properties": {{"foo": {{"description": "a list of test words", "type": "array", "items": {{"type": "string"}}}}}}, "required": ["foo"]}}
would match an object with one required property, "foo". The "type" property specifies "foo" must be an "array", and the "description" property semantically describes it as "a list of test words". The items within "foo" must be strings.
Thus, the object {{"foo": ["bar", "baz"]}} is a well-formatted instance of this example "JSON Schema". The object {{"properties": {{"foo": ["bar", "baz"]}}}} is not well-formatted.

Your output will be parsed and type-checked according to the provided schema instance, so make sure all fields in your output match the schema exactly and there are no trailing commas!

Here is the JSON Schema instance your output must adhere to. Include the enclosing markdown codeblock:
\`\`\`json
${JSON.stringify(Er(this.schema))}
\`\`\`
`}async parse(e){try{let n=(e.includes("```")?e.trim().split(/```(?:json)?/)[1]:e.trim()).replace(/"([^"\\]*(\\.[^"\\]*)*)"/g,(A,s)=>`"${s.replace(/\n/g,"\\n")}"`).replace(/\n/g,"");return await ja(this.schema,JSON.parse(n))}catch(t){throw new fs(`Failed to parse. Text: "${e}". Error: ${t}`,e)}}};var _u=class extends yi{constructor(){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","output_parsers"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0})}static lc_name(){return"JsonOutputParser"}_concatOutputChunks(e,t){return this.diff?super._concatOutputChunks(e,t):t}_diff(e,t){if(t)return e?ol(e,t):[{op:"replace",path:"",value:t}]}async parsePartialResult(e){return np(e[0].text)}async parse(e){return np(e,JSON.parse)}getFormatInstructions(){return""}};function wf(r,e){if(r.function===void 0)return;let t;if(e?.partial)try{t=ya(r.function.arguments??"{}")}catch{return}else try{t=JSON.parse(r.function.arguments)}catch(A){throw new fs([`Function "${r.function.name}" arguments:`,"",r.function.arguments,"","are not valid JSON.",`Error: ${A.message}`].join(`
`))}let n={name:r.function.name,args:t,type:"tool_call"};return e?.returnId&&(n.id=r.id),n}function xv(r){if(r.id===void 0)throw new Error('All OpenAI tool calls must have an "id" field.');return{id:r.id,type:"function",function:{name:r.name,arguments:JSON.stringify(r.args)}}}function yf(r,e){return{name:r.function?.name,args:r.function?.arguments,id:r.id,error:e,type:"invalid_tool_call"}}var rm=class extends yi{static lc_name(){return"JsonOutputToolsParser"}constructor(e){super(e),Object.defineProperty(this,"returnId",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","output_parsers","openai_tools"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),this.returnId=e?.returnId??this.returnId}_diff(){throw new Error("Not supported.")}async parse(){throw new Error("Not implemented.")}async parseResult(e){return await this.parsePartialResult(e,!1)}async parsePartialResult(e,t=!0){let n=e[0].message,A;if(WA(n)&&n.tool_calls?.length?A=n.tool_calls.map(i=>{let{id:a,...f}=i;return this.returnId?{id:a,...f}:f}):n.additional_kwargs.tool_calls!==void 0&&(A=JSON.parse(JSON.stringify(n.additional_kwargs.tool_calls)).map(a=>wf(a,{returnId:this.returnId,partial:t}))),!A)return[];let s=[];for(let i of A)if(i!==void 0){let a={type:i.name,args:i.args,id:i.id};s.push(a)}return s}},bu=class extends rm{static lc_name(){return"JsonOutputKeyToolsParser"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","output_parsers","openai_tools"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"returnId",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"keyName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"returnSingle",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"zodSchema",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.keyName=e.keyName,this.returnSingle=e.returnSingle??this.returnSingle,this.zodSchema=e.zodSchema}async _validateResult(e){if(this.zodSchema===void 0)return e;let t=await pv(this.zodSchema,e);if(t.success)return t.data;throw new fs(`Failed to parse. Text: "${JSON.stringify(e,null,2)}". Error: ${JSON.stringify(t.error?.issues)}`,JSON.stringify(e,null,2))}async parsePartialResult(e){let n=(await super.parsePartialResult(e)).filter(s=>s.type===this.keyName),A=n;if(n.length)return this.returnId||(A=n.map(s=>s.args)),this.returnSingle?A[0]:A}async parseResult(e){let n=(await super.parsePartialResult(e,!1)).filter(i=>i.type===this.keyName),A=n;return n.length?(this.returnId||(A=n.map(i=>i.args)),this.returnSingle?this._validateResult(A[0]):await Promise.all(A.map(i=>this._validateResult(i)))):void 0}};function _i(r){let{azureOpenAIApiDeploymentName:e,azureOpenAIApiInstanceName:t,azureOpenAIApiKey:n,azureOpenAIBasePath:A,baseURL:s,azureADTokenProvider:i,azureOpenAIEndpoint:a}=r;if((n||i)&&A&&e)return`${A}/${e}`;if((n||i)&&a&&e)return`${a}/openai/deployments/${e}`;if(n||i){if(!t)throw new Error("azureOpenAIApiInstanceName is required when using azureOpenAIApiKey");if(!e)throw new Error("azureOpenAIApiDeploymentName is a required parameter when using azureOpenAIApiKey");return`https://${t}.openai.azure.com/openai/deployments/${e}`}return s}function nm(r){return r!==void 0&&Array.isArray(r.lc_namespace)}function Am(r){return r!==void 0&&qe.isRunnable(r)&&"lc_name"in r.constructor&&typeof r.constructor.lc_name=="function"&&r.constructor.lc_name()==="RunnableToolLike"}function sm(r){return!!r&&typeof r=="object"&&"name"in r&&"schema"in r&&(Lr(r.schema)||r.schema!=null&&typeof r.schema=="object"&&"type"in r.schema&&typeof r.schema.type=="string"&&["null","boolean","object","array","number","string"].includes(r.schema.type))}function Va(r){return sm(r)||Am(r)||nm(r)}function Iv(r,e){let t=typeof e=="number"?void 0:e;return{name:r.name,description:r.description,parameters:Er(r.schema),...t?.strict!==void 0?{strict:t.strict}:{}}}function im(r,e){let t=typeof e=="number"?void 0:e,n;return Va(r)?n={type:"function",function:Iv(r)}:n=r,t?.strict!==void 0&&(n.function.strict=t.strict),n}var Fv=Symbol("Let zodToJsonSchema decide on which parser to use"),Uv={name:void 0,$refStrategy:"root",effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",nullableStrategy:"from-target",removeAdditionalStrategy:"passthrough",definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref"},Qv=r=>typeof r=="string"?{...Uv,basePath:["#"],definitions:{},name:r}:{...Uv,basePath:["#"],definitions:{},...r};var Bu=r=>"_def"in r?r._def:r;function Tv(r){if(!r)return!0;for(let e in r)return!1;return!0}var Ov=r=>{let e=Qv(r),t=e.name!==void 0?[...e.basePath,e.definitionPath,e.name]:e.basePath;return{...e,currentPath:t,propertyPath:void 0,seenRefs:new Set,seen:new Map(Object.entries(e.definitions).map(([n,A])=>[Bu(A),{def:Bu(A),path:[...e.basePath,e.definitionPath,n],jsonSchema:void 0}]))}};function am(r,e,t,n){n?.errorMessages&&t&&(r.errorMessage={...r.errorMessage,[e]:t})}function Me(r,e,t,n,A){r[e]=t,am(r,e,n,A)}function Sv(){return{}}function Pv(r,e){let t={type:"array"};return r.type?._def?.typeName!==O.ZodAny&&(t.items=be(r.type._def,{...e,currentPath:[...e.currentPath,"items"]})),r.minLength&&Me(t,"minItems",r.minLength.value,r.minLength.message,e),r.maxLength&&Me(t,"maxItems",r.maxLength.value,r.maxLength.message,e),r.exactLength&&(Me(t,"minItems",r.exactLength.value,r.exactLength.message,e),Me(t,"maxItems",r.exactLength.value,r.exactLength.message,e)),t}function Rv(r,e){let t={type:"integer",format:"int64"};if(!r.checks)return t;for(let n of r.checks)switch(n.kind){case"min":e.target==="jsonSchema7"?n.inclusive?Me(t,"minimum",n.value,n.message,e):Me(t,"exclusiveMinimum",n.value,n.message,e):(n.inclusive||(t.exclusiveMinimum=!0),Me(t,"minimum",n.value,n.message,e));break;case"max":e.target==="jsonSchema7"?n.inclusive?Me(t,"maximum",n.value,n.message,e):Me(t,"exclusiveMaximum",n.value,n.message,e):(n.inclusive||(t.exclusiveMaximum=!0),Me(t,"maximum",n.value,n.message,e));break;case"multipleOf":Me(t,"multipleOf",n.value,n.message,e);break}return t}function kv(){return{type:"boolean"}}function Nv(r,e){return be(r.type._def,e)}var Lv=(r,e)=>be(r.innerType._def,e);function om(r,e,t){let n=t??e.dateStrategy;if(Array.isArray(n))return{anyOf:n.map((A,s)=>om(r,e,A))};switch(n){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return q1(r,e)}}var q1=(r,e)=>{let t={type:"integer",format:"unix-time"};if(e.target==="openApi3")return t;for(let n of r.checks)switch(n.kind){case"min":Me(t,"minimum",n.value,n.message,e);break;case"max":Me(t,"maximum",n.value,n.message,e);break}return t};function Hv(r,e){return{...be(r.innerType._def,e),default:r.defaultValue()}}function Dv(r,e,t){return e.effectStrategy==="input"?be(r.schema._def,e,t):{}}function Mv(r){return{type:"string",enum:[...r.values]}}var X1=r=>"type"in r&&r.type==="string"?!1:"allOf"in r;function $v(r,e){let t=[be(r.left._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),be(r.right._def,{...e,currentPath:[...e.currentPath,"allOf","1"]})].filter(s=>!!s),n=e.target==="jsonSchema2019-09"?{unevaluatedProperties:!1}:void 0,A=[];return t.forEach(s=>{if(X1(s))A.push(...s.allOf),s.unevaluatedProperties===void 0&&(n=void 0);else{let i=s;if("additionalProperties"in s&&s.additionalProperties===!1){let{additionalProperties:a,...f}=s;i=f}else n=void 0;A.push(i)}}),A.length?{allOf:A,...n}:void 0}function jv(r,e){let t=typeof r.value;return t!=="bigint"&&t!=="number"&&t!=="boolean"&&t!=="string"?{type:Array.isArray(r.value)?"array":"object"}:e.target==="openApi3"?{type:t==="bigint"?"integer":t,enum:[r.value]}:{type:t==="bigint"?"integer":t,const:r.value}}var um,bi={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(um===void 0&&(um=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),um),uuid:/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/,ipv4:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv6:/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/};function _f(r,e){let t={type:"string"};function n(A){return e.patternStrategy==="escape"?Y1(A):A}if(r.checks)for(let A of r.checks)switch(A.kind){case"min":Me(t,"minLength",typeof t.minLength=="number"?Math.max(t.minLength,A.value):A.value,A.message,e);break;case"max":Me(t,"maxLength",typeof t.maxLength=="number"?Math.min(t.maxLength,A.value):A.value,A.message,e);break;case"email":switch(e.emailStrategy){case"format:email":wn(t,"email",A.message,e);break;case"format:idn-email":wn(t,"idn-email",A.message,e);break;case"pattern:zod":yn(t,bi.email,A.message,e);break}break;case"url":wn(t,"uri",A.message,e);break;case"uuid":wn(t,"uuid",A.message,e);break;case"regex":yn(t,A.regex,A.message,e);break;case"cuid":yn(t,bi.cuid,A.message,e);break;case"cuid2":yn(t,bi.cuid2,A.message,e);break;case"startsWith":yn(t,RegExp(`^${n(A.value)}`),A.message,e);break;case"endsWith":yn(t,RegExp(`${n(A.value)}$`),A.message,e);break;case"datetime":wn(t,"date-time",A.message,e);break;case"date":wn(t,"date",A.message,e);break;case"time":wn(t,"time",A.message,e);break;case"duration":wn(t,"duration",A.message,e);break;case"length":Me(t,"minLength",typeof t.minLength=="number"?Math.max(t.minLength,A.value):A.value,A.message,e),Me(t,"maxLength",typeof t.maxLength=="number"?Math.min(t.maxLength,A.value):A.value,A.message,e);break;case"includes":{yn(t,RegExp(n(A.value)),A.message,e);break}case"ip":{A.version!=="v6"&&wn(t,"ipv4",A.message,e),A.version!=="v4"&&wn(t,"ipv6",A.message,e);break}case"emoji":yn(t,bi.emoji,A.message,e);break;case"ulid":{yn(t,bi.ulid,A.message,e);break}case"base64":{switch(e.base64Strategy){case"format:binary":{wn(t,"binary",A.message,e);break}case"contentEncoding:base64":{Me(t,"contentEncoding","base64",A.message,e);break}case"pattern:zod":{yn(t,bi.base64,A.message,e);break}}break}case"nanoid":yn(t,bi.nanoid,A.message,e);case"toLowerCase":case"toUpperCase":case"trim":break;default:}return t}var Y1=r=>Array.from(r).map(e=>/[a-zA-Z0-9]/.test(e)?e:`\\${e}`).join(""),wn=(r,e,t,n)=>{r.format||r.anyOf?.some(A=>A.format)?(r.anyOf||(r.anyOf=[]),r.format&&(r.anyOf.push({format:r.format,...r.errorMessage&&n.errorMessages&&{errorMessage:{format:r.errorMessage.format}}}),delete r.format,r.errorMessage&&(delete r.errorMessage.format,Object.keys(r.errorMessage).length===0&&delete r.errorMessage)),r.anyOf.push({format:e,...t&&n.errorMessages&&{errorMessage:{format:t}}})):Me(r,"format",e,t,n)},yn=(r,e,t,n)=>{r.pattern||r.allOf?.some(A=>A.pattern)?(r.allOf||(r.allOf=[]),r.pattern&&(r.allOf.push({pattern:r.pattern,...r.errorMessage&&n.errorMessages&&{errorMessage:{pattern:r.errorMessage.pattern}}}),delete r.pattern,r.errorMessage&&(delete r.errorMessage.pattern,Object.keys(r.errorMessage).length===0&&delete r.errorMessage)),r.allOf.push({pattern:Kv(e,n),...t&&n.errorMessages&&{errorMessage:{pattern:t}}})):Me(r,"pattern",Kv(e,n),t,n)},Kv=(r,e)=>{let t=typeof r=="function"?r():r;if(!e.applyRegexFlags||!t.flags)return t.source;let n={i:t.flags.includes("i"),m:t.flags.includes("m"),s:t.flags.includes("s")},A=n.i?t.source.toLowerCase():t.source,s="",i=!1,a=!1,f=!1;for(let d=0;d<A.length;d++){if(i){s+=A[d],i=!1;continue}if(n.i){if(a){if(A[d].match(/[a-z]/)){f?(s+=A[d],s+=`${A[d-2]}-${A[d]}`.toUpperCase(),f=!1):A[d+1]==="-"&&A[d+2]?.match(/[a-z]/)?(s+=A[d],f=!0):s+=`${A[d]}${A[d].toUpperCase()}`;continue}}else if(A[d].match(/[a-z]/)){s+=`[${A[d]}${A[d].toUpperCase()}]`;continue}}if(n.m){if(A[d]==="^"){s+=`(^|(?<=[\r
]))`;continue}else if(A[d]==="$"){s+=`($|(?=[\r
]))`;continue}}if(n.s&&A[d]==="."){s+=a?`${A[d]}\r
`:`[${A[d]}\r
]`;continue}s+=A[d],A[d]==="\\"?i=!0:a&&A[d]==="]"?a=!1:!a&&A[d]==="["&&(a=!0)}try{let d=new RegExp(s)}catch{return console.warn(`Could not convert regex pattern at ${e.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),t.source}return s};function bf(r,e){if(e.target==="openApi3"&&r.keyType?._def.typeName===O.ZodEnum)return{type:"object",required:r.keyType._def.values,properties:r.keyType._def.values.reduce((n,A)=>({...n,[A]:be(r.valueType._def,{...e,currentPath:[...e.currentPath,"properties",A]})??{}}),{}),additionalProperties:!1};let t={type:"object",additionalProperties:be(r.valueType._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??{}};if(e.target==="openApi3")return t;if(r.keyType?._def.typeName===O.ZodString&&r.keyType._def.checks?.length){let n=Object.entries(_f(r.keyType._def,e)).reduce((A,[s,i])=>s==="type"?A:{...A,[s]:i},{});return{...t,propertyNames:n}}else if(r.keyType?._def.typeName===O.ZodEnum)return{...t,propertyNames:{enum:r.keyType._def.values}};return t}function zv(r,e){if(e.mapStrategy==="record")return bf(r,e);let t=be(r.keyType._def,{...e,currentPath:[...e.currentPath,"items","items","0"]})||{},n=be(r.valueType._def,{...e,currentPath:[...e.currentPath,"items","items","1"]})||{};return{type:"array",maxItems:125,items:{type:"array",items:[t,n],minItems:2,maxItems:2}}}function Gv(r){let e=r.values,n=Object.keys(r.values).filter(s=>typeof e[e[s]]!="number").map(s=>e[s]),A=Array.from(new Set(n.map(s=>typeof s)));return{type:A.length===1?A[0]==="string"?"string":"number":["string","number"],enum:n}}function Vv(){return{not:{}}}function Zv(r){return r.target==="openApi3"?{enum:["null"],nullable:!0}:{type:"null"}}var vu={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function Wv(r,e){if(e.target==="openApi3")return Jv(r,e);let t=r.options instanceof Map?Array.from(r.options.values()):r.options;if(t.every(n=>n._def.typeName in vu&&(!n._def.checks||!n._def.checks.length))){let n=t.reduce((A,s)=>{let i=vu[s._def.typeName];return i&&!A.includes(i)?[...A,i]:A},[]);return{type:n.length>1?n:n[0]}}else if(t.every(n=>n._def.typeName==="ZodLiteral"&&!n.description)){let n=t.reduce((A,s)=>{let i=typeof s._def.value;switch(i){case"string":case"number":case"boolean":return[...A,i];case"bigint":return[...A,"integer"];case"object":if(s._def.value===null)return[...A,"null"];case"symbol":case"undefined":case"function":default:return A}},[]);if(n.length===t.length){let A=n.filter((s,i,a)=>a.indexOf(s)===i);return{type:A.length>1?A:A[0],enum:t.reduce((s,i)=>s.includes(i._def.value)?s:[...s,i._def.value],[])}}}else if(t.every(n=>n._def.typeName==="ZodEnum"))return{type:"string",enum:t.reduce((n,A)=>[...n,...A._def.values.filter(s=>!n.includes(s))],[])};return Jv(r,e)}var Jv=(r,e)=>{let t=(r.options instanceof Map?Array.from(r.options.values()):r.options).map((n,A)=>be(n._def,{...e,currentPath:[...e.currentPath,"anyOf",`${A}`]})).filter(n=>!!n&&(!e.strictUnions||typeof n=="object"&&Object.keys(n).length>0));return t.length?{anyOf:t}:void 0};function qv(r,e){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(r.innerType._def.typeName)&&(!r.innerType._def.checks||!r.innerType._def.checks.length))return e.target==="openApi3"||e.nullableStrategy==="property"?{type:vu[r.innerType._def.typeName],nullable:!0}:{type:[vu[r.innerType._def.typeName],"null"]};if(e.target==="openApi3"){let n=be(r.innerType._def,{...e,currentPath:[...e.currentPath]});return n&&"$ref"in n?{allOf:[n],nullable:!0}:n&&{...n,nullable:!0}}let t=be(r.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","0"]});return t&&{anyOf:[t,{type:"null"}]}}function Xv(r,e){let t={type:"number"};if(!r.checks)return t;for(let n of r.checks)switch(n.kind){case"int":t.type="integer",am(t,"type",n.message,e);break;case"min":e.target==="jsonSchema7"?n.inclusive?Me(t,"minimum",n.value,n.message,e):Me(t,"exclusiveMinimum",n.value,n.message,e):(n.inclusive||(t.exclusiveMinimum=!0),Me(t,"minimum",n.value,n.message,e));break;case"max":e.target==="jsonSchema7"?n.inclusive?Me(t,"maximum",n.value,n.message,e):Me(t,"exclusiveMaximum",n.value,n.message,e):(n.inclusive||(t.exclusiveMaximum=!0),Me(t,"maximum",n.value,n.message,e));break;case"multipleOf":Me(t,"multipleOf",n.value,n.message,e);break}return t}function eN(r,e){return e.removeAdditionalStrategy==="strict"?r.catchall._def.typeName==="ZodNever"?r.unknownKeys!=="strict":be(r.catchall._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??!0:r.catchall._def.typeName==="ZodNever"?r.unknownKeys==="passthrough":be(r.catchall._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??!0}function Yv(r,e){let t={type:"object",...Object.entries(r.shape()).reduce((n,[A,s])=>{if(s===void 0||s._def===void 0)return n;let i=[...e.currentPath,"properties",A],a=be(s._def,{...e,currentPath:i,propertyPath:i});if(a===void 0)return n;if(e.openaiStrictMode&&s.isOptional()&&!s.isNullable()&&typeof s._def?.defaultValue>"u")throw new Error(`Zod field at \`${i.join("/")}\` uses \`.optional()\` without \`.nullable()\` which is not supported by the API. See: https://platform.openai.com/docs/guides/structured-outputs?api-mode=responses#all-fields-must-be-required`);return{properties:{...n.properties,[A]:a},required:s.isOptional()&&!e.openaiStrictMode?n.required:[...n.required,A]}},{properties:{},required:[]}),additionalProperties:eN(r,e)};return t.required.length||delete t.required,t}var eC=(r,e)=>{if(e.propertyPath&&e.currentPath.slice(0,e.propertyPath.length).toString()===e.propertyPath.toString())return be(r.innerType._def,{...e,currentPath:e.currentPath});let t=be(r.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","1"]});return t?{anyOf:[{not:{}},t]}:{}};var tC=(r,e)=>{if(e.pipeStrategy==="input")return be(r.in._def,e);if(e.pipeStrategy==="output")return be(r.out._def,e);let t=be(r.in._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),n=be(r.out._def,{...e,currentPath:[...e.currentPath,"allOf",t?"1":"0"]});return{allOf:[t,n].filter(A=>A!==void 0)}};function rC(r,e){return be(r.type._def,e)}function nC(r,e){let n={type:"array",uniqueItems:!0,items:be(r.valueType._def,{...e,currentPath:[...e.currentPath,"items"]})};return r.minSize&&Me(n,"minItems",r.minSize.value,r.minSize.message,e),r.maxSize&&Me(n,"maxItems",r.maxSize.value,r.maxSize.message,e),n}function AC(r,e){return r.rest?{type:"array",minItems:r.items.length,items:r.items.map((t,n)=>be(t._def,{...e,currentPath:[...e.currentPath,"items",`${n}`]})).reduce((t,n)=>n===void 0?t:[...t,n],[]),additionalItems:be(r.rest._def,{...e,currentPath:[...e.currentPath,"additionalItems"]})}:{type:"array",minItems:r.items.length,maxItems:r.items.length,items:r.items.map((t,n)=>be(t._def,{...e,currentPath:[...e.currentPath,"items",`${n}`]})).reduce((t,n)=>n===void 0?t:[...t,n],[])}}function sC(){return{not:{}}}function iC(){return{}}var aC=(r,e)=>be(r.innerType._def,e);function be(r,e,t=!1){let n=e.seen.get(r);if(e.override){let i=e.override?.(r,e,n,t);if(i!==Fv)return i}if(n&&!t){let i=tN(n,e);if(i!==void 0)return"$ref"in i&&e.seenRefs.add(i.$ref),i}let A={def:r,path:e.currentPath,jsonSchema:void 0};e.seen.set(r,A);let s=nN(r,r.typeName,e,t);return s&&AN(r,e,s),A.jsonSchema=s,s}var tN=(r,e)=>{switch(e.$refStrategy){case"root":return{$ref:r.path.join("/")};case"extract-to-root":let t=r.path.slice(e.basePath.length+1).join("_");return t!==e.name&&e.nameStrategy==="duplicate-ref"&&(e.definitions[t]=r.def),{$ref:[...e.basePath,e.definitionPath,t].join("/")};case"relative":return{$ref:rN(e.currentPath,r.path)};case"none":case"seen":return r.path.length<e.currentPath.length&&r.path.every((n,A)=>e.currentPath[A]===n)?(console.warn(`Recursive reference detected at ${e.currentPath.join("/")}! Defaulting to any`),{}):e.$refStrategy==="seen"?{}:void 0}},rN=(r,e)=>{let t=0;for(;t<r.length&&t<e.length&&r[t]===e[t];t++);return[(r.length-t).toString(),...e.slice(t)].join("/")},nN=(r,e,t,n)=>{switch(e){case O.ZodString:return _f(r,t);case O.ZodNumber:return Xv(r,t);case O.ZodObject:return Yv(r,t);case O.ZodBigInt:return Rv(r,t);case O.ZodBoolean:return kv();case O.ZodDate:return om(r,t);case O.ZodUndefined:return sC();case O.ZodNull:return Zv(t);case O.ZodArray:return Pv(r,t);case O.ZodUnion:case O.ZodDiscriminatedUnion:return Wv(r,t);case O.ZodIntersection:return $v(r,t);case O.ZodTuple:return AC(r,t);case O.ZodRecord:return bf(r,t);case O.ZodLiteral:return jv(r,t);case O.ZodEnum:return Mv(r);case O.ZodNativeEnum:return Gv(r);case O.ZodNullable:return qv(r,t);case O.ZodOptional:return eC(r,t);case O.ZodMap:return zv(r,t);case O.ZodSet:return nC(r,t);case O.ZodLazy:return be(r.getter()._def,t);case O.ZodPromise:return rC(r,t);case O.ZodNaN:case O.ZodNever:return Vv();case O.ZodEffects:return Dv(r,t,n);case O.ZodAny:return Sv();case O.ZodUnknown:return iC();case O.ZodDefault:return Hv(r,t);case O.ZodBranded:return Nv(r,t);case O.ZodReadonly:return aC(r,t);case O.ZodCatch:return Lv(r,t);case O.ZodPipeline:return tC(r,t);case O.ZodFunction:case O.ZodVoid:case O.ZodSymbol:return;default:return(A=>{})(e)}},AN=(r,e,t)=>(r.description&&(t.description=r.description,e.markdownDescription&&(t.markdownDescription=r.description)),t);var cm=(r,e)=>{let t=Ov(e),n=typeof e=="string"?e:e?.nameStrategy==="title"?void 0:e?.name,A=be(r._def,n===void 0?t:{...t,currentPath:[...t.basePath,t.definitionPath,n]},!1)??{},s=typeof e=="object"&&e.name!==void 0&&e.nameStrategy==="title"?e.name:void 0;s!==void 0&&(A.title=s);let i=(()=>{if(Tv(t.definitions))return;let f={},d=new Set;for(let h=0;h<500;h++){let m=Object.entries(t.definitions).filter(([y])=>!d.has(y));if(m.length===0)break;for(let[y,w]of m)f[y]=be(Bu(w),{...t,currentPath:[...t.basePath,t.definitionPath,y]},!0)??{},d.add(y)}return f})(),a=n===void 0?i?{...A,[t.definitionPath]:i}:A:t.nameStrategy==="duplicate-ref"?{...A,...i||t.seenRefs.size?{[t.definitionPath]:{...i,...t.seenRefs.size?{[n]:A}:void 0}}:void 0}:{$ref:[...t.$refStrategy==="relative"?[]:t.basePath,t.definitionPath,n].join("/"),[t.definitionPath]:{...i,[n]:A}};return t.target==="jsonSchema7"?a.$schema="http://json-schema.org/draft-07/schema#":t.target==="jsonSchema2019-09"&&(a.$schema="https://json-schema.org/draft/2019-09/schema#"),a};function sN(r,e){return cm(r,{openaiStrictMode:!0,name:e.name,nameStrategy:"duplicate-ref",$refStrategy:"extract-to-root",nullableStrategy:"property"})}function oC(r,e,t){return Hw({type:"json_schema",json_schema:{...t,name:e,strict:!0,schema:sN(r,{name:e})}},n=>r.parse(JSON.parse(n)))}function Cu(r,e){return r.lc_error_code=e,r.message=`${r.message}

Troubleshooting URL: https://js.langchain.com/docs/troubleshooting/errors/${e}/
`,r}function Za(r){let e;return r.constructor.name===xn.name?(e=new Error(r.message),e.name="TimeoutError"):r.constructor.name===ot.name?(e=new Error(r.message),e.name="AbortError"):r.status===400&&r.message.includes("tool_calls")?e=Cu(r,"INVALID_TOOL_RESULTS"):r.status===401?e=Cu(r,"MODEL_AUTHENTICATION"):r.status===429?e=Cu(r,"MODEL_RATE_LIMIT"):r.status===404?e=Cu(r,"MODEL_NOT_FOUND"):e=r,e}function lm(r){if(r)return r==="any"||r==="required"?"required":r==="auto"?"auto":r==="none"?"none":typeof r=="string"?{type:"function",function:{name:r}}:r}function iN(r,e){let t={...r};return Object.defineProperties(t,{$brand:{value:"auto-parseable-response-format",enumerable:!1},$parseRaw:{value:e,enumerable:!1}}),t}function uC(r,e,t){if(tn(r))return oC(r,e,t);if(Nr(r))return iN({type:"json_schema",json_schema:{...t,name:e,strict:!0,schema:fu(r,{cycles:"ref",reused:"ref",override(n){n.jsonSchema.title=e}})}},n=>Wl(r,JSON.parse(n)));throw new Error("Unsupported schema response format")}function aN(r){return r.anyOf!==void 0&&Array.isArray(r.anyOf)}function cC(r){let e=["namespace functions {",""];for(let t of r)t.description&&e.push(`// ${t.description}`),Object.keys(t.parameters.properties??{}).length>0?(e.push(`type ${t.name} = (_: {`),e.push(lC(t.parameters,0)),e.push("}) => any;")):e.push(`type ${t.name} = () => any;`),e.push("");return e.push("} // namespace functions"),e.join(`
`)}function lC(r,e){let t=[];for(let[n,A]of Object.entries(r.properties??{}))A.description&&e<2&&t.push(`// ${A.description}`),r.required?.includes(n)?t.push(`${n}: ${Bf(A,e)},`):t.push(`${n}?: ${Bf(A,e)},`);return t.map(n=>" ".repeat(e)+n).join(`
`)}function Bf(r,e){if(aN(r))return r.anyOf.map(t=>Bf(t,e)).join(" | ");switch(r.type){case"string":return r.enum?r.enum.map(t=>`"${t}"`).join(" | "):"string";case"number":return r.enum?r.enum.map(t=>`${t}`).join(" | "):"number";case"integer":return r.enum?r.enum.map(t=>`${t}`).join(" | "):"number";case"boolean":return"boolean";case"null":return"null";case"object":return["{",lC(r,e+2),"}"].join(`
`);case"array":return r.items?`${Bf(r.items,e)}[]`:"any[]";default:return""}}function fC(r,e){let t;return Va(r)?t=im(r):t=r,t.type==="function"&&e?.strict!==void 0&&(t.function.strict=e.strict),t}function vf(r){return"type"in r&&r.type!=="function"&&r.type!=="custom"}function dC(r){return r!=null&&typeof r=="object"&&"type"in r&&r.type!=="function"}function pC(r){return typeof r=="object"&&r!==null&&"metadata"in r&&typeof r.metadata=="object"&&r.metadata!==null&&"customTool"in r.metadata&&typeof r.metadata.customTool=="object"&&r.metadata.customTool!==null}function fm(r){return"type"in r&&r.type==="custom"&&"custom"in r&&typeof r.custom=="object"&&r.custom!==null}function hC(r){if(r.type==="custom_tool_call")return{...r,type:"tool_call",call_id:r.id,id:r.call_id,name:r.name,isCustomTool:!0,args:{input:r.input}}}function mC(r){return r.type==="tool_call"&&"isCustomTool"in r&&r.isCustomTool===!0}function gC(r){let e=()=>{if(r.custom.format){if(r.custom.format.type==="grammar")return{type:"grammar",definition:r.custom.format.grammar.definition,syntax:r.custom.format.grammar.syntax};if(r.custom.format.type==="text")return{type:"text"}}};return{type:"custom",name:r.custom.name,description:r.custom.description,format:e()}}function wC(r){let e=()=>{if(r.format){if(r.format.type==="grammar")return{type:"grammar",grammar:{definition:r.format.definition,syntax:r.format.syntax}};if(r.format.type==="text")return{type:"text"}}};return{type:"custom",custom:{name:r.name,description:r.description,format:e()}}}var Ja="__openai_function_call_ids__";function xf(r){return r?!!(/^o\d/.test(r??"")||r.startsWith("gpt-5")&&!r.startsWith("gpt-5-chat")):!1}function oN(r){return r!==void 0&&typeof r.schema=="object"}function uN(r){return r.role!=="system"&&r.role!=="developer"&&r.role!=="assistant"&&r.role!=="user"&&r.role!=="function"&&r.role!=="tool"&&console.warn(`Unknown message role: ${r.role}`),r.role}function pm(r){let e=r._getType();switch(e){case"system":return"system";case"ai":return"assistant";case"human":return"user";case"function":return"function";case"tool":return"tool";case"generic":{if(!qA.isInstance(r))throw new Error("Invalid generic chat message");return uN(r)}default:throw new Error(`Unknown message type: ${e}`)}}var yC={providerName:"ChatOpenAI",fromStandardTextBlock(r){return{type:"text",text:r.text}},fromStandardImageBlock(r){if(r.source_type==="url")return{type:"image_url",image_url:{url:r.url,...r.metadata?.detail?{detail:r.metadata.detail}:{}}};if(r.source_type==="base64")return{type:"image_url",image_url:{url:`data:${r.mime_type??""};base64,${r.data}`,...r.metadata?.detail?{detail:r.metadata.detail}:{}}};throw new Error(`Image content blocks with source_type ${r.source_type} are not supported for ChatOpenAI`)},fromStandardAudioBlock(r){if(r.source_type==="url"){let e=ap({dataUrl:r.url});if(!e)throw new Error(`URL audio blocks with source_type ${r.source_type} must be formatted as a data URL for ChatOpenAI`);let t=e.mime_type||r.mime_type||"",n;try{n=ip(t)}catch{throw new Error(`Audio blocks with source_type ${r.source_type} must have mime type of audio/wav or audio/mp3`)}if(n.type!=="audio"||n.subtype!=="wav"&&n.subtype!=="mp3")throw new Error(`Audio blocks with source_type ${r.source_type} must have mime type of audio/wav or audio/mp3`);return{type:"input_audio",input_audio:{format:n.subtype,data:e.data}}}if(r.source_type==="base64"){let e;try{e=ip(r.mime_type??"")}catch{throw new Error(`Audio blocks with source_type ${r.source_type} must have mime type of audio/wav or audio/mp3`)}if(e.type!=="audio"||e.subtype!=="wav"&&e.subtype!=="mp3")throw new Error(`Audio blocks with source_type ${r.source_type} must have mime type of audio/wav or audio/mp3`);return{type:"input_audio",input_audio:{format:e.subtype,data:r.data}}}throw new Error(`Audio content blocks with source_type ${r.source_type} are not supported for ChatOpenAI`)},fromStandardFileBlock(r){if(r.source_type==="url"){if(!ap({dataUrl:r.url}))throw new Error(`URL file blocks with source_type ${r.source_type} must be formatted as a data URL for ChatOpenAI`);return{type:"file",file:{file_data:r.url,...r.metadata?.filename||r.metadata?.name?{filename:r.metadata?.filename||r.metadata?.name}:{}}}}if(r.source_type==="base64")return{type:"file",file:{file_data:`data:${r.mime_type??""};base64,${r.data}`,...r.metadata?.filename||r.metadata?.name||r.metadata?.title?{filename:r.metadata?.filename||r.metadata?.name||r.metadata?.title}:{}}};if(r.source_type==="id")return{type:"file",file:{file_id:r.id}};throw new Error(`File content blocks with source_type ${r.source_type} are not supported for ChatOpenAI`)}};function dm(r,e){return r.flatMap(t=>{let n=pm(t);n==="system"&&xf(e)&&(n="developer");let A=typeof t.content=="string"?t.content:t.content.map(i=>lA(i)?op(i,yC):i),s={role:n,content:A};if(t.name!=null&&(s.name=t.name),t.additional_kwargs.function_call!=null&&(s.function_call=t.additional_kwargs.function_call,s.content=""),WA(t)&&t.tool_calls?.length?(s.tool_calls=t.tool_calls.map(xv),s.content=""):(t.additional_kwargs.tool_calls!=null&&(s.tool_calls=t.additional_kwargs.tool_calls),t.tool_call_id!=null&&(s.tool_call_id=t.tool_call_id)),t.additional_kwargs.audio&&typeof t.additional_kwargs.audio=="object"&&"id"in t.additional_kwargs.audio){let i={role:"assistant",audio:{id:t.additional_kwargs.audio.id}};return[s,i]}return s})}var Eu=class extends gf{_llmType(){return"openai"}static lc_name(){return"ChatOpenAI"}get callKeys(){return[...super.callKeys,"options","function_call","functions","tools","tool_choice","promptIndex","response_format","seed","reasoning","reasoningEffort","service_tier"]}get lc_secrets(){return{apiKey:"OPENAI_API_KEY",organization:"OPENAI_ORGANIZATION"}}get lc_aliases(){return{apiKey:"openai_api_key",modelName:"model",reasoningEffort:"reasoning_effort"}}get lc_serializable_keys(){return["configuration","logprobs","topLogprobs","prefixMessages","supportsStrictToolCalling","modalities","audio","temperature","maxTokens","topP","frequencyPenalty","presencePenalty","n","logitBias","user","streaming","streamUsage","model","modelName","modelKwargs","stop","stopSequences","timeout","apiKey","cache","maxConcurrency","maxRetries","verbose","callbacks","tags","metadata","disableStreaming","zdrEnabled","reasoning","reasoningEffort","promptCacheKey","verbosity"]}getLsParams(e){let t=this.invocationParams(e);return{ls_provider:"openai",ls_model_name:this.model,ls_model_type:"chat",ls_temperature:t.temperature??void 0,ls_max_tokens:t.max_tokens??void 0,ls_stop:e.stop}}_identifyingParams(){return{model_name:this.model,...this.invocationParams(),...this.clientConfig}}identifyingParams(){return this._identifyingParams()}constructor(e){super(e??{}),Object.defineProperty(this,"temperature",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"topP",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"frequencyPenalty",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"presencePenalty",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"n",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"logitBias",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"model",{enumerable:!0,configurable:!0,writable:!0,value:"gpt-3.5-turbo"}),Object.defineProperty(this,"modelKwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stop",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stopSequences",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"user",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"timeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"streaming",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"streamUsage",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"maxTokens",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"logprobs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"topLogprobs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"apiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"organization",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"__includeRawResponse",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"clientConfig",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"supportsStrictToolCalling",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"audio",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"modalities",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"reasoning",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"zdrEnabled",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"service_tier",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"promptCacheKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"verbosity",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"defaultOptions",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),this.apiKey=e?.apiKey??e?.configuration?.apiKey??pt("OPENAI_API_KEY"),this.organization=e?.configuration?.organization??pt("OPENAI_ORGANIZATION"),this.model=e?.model??e?.modelName??this.model,this.modelKwargs=e?.modelKwargs??{},this.timeout=e?.timeout,this.temperature=e?.temperature??this.temperature,this.topP=e?.topP??this.topP,this.frequencyPenalty=e?.frequencyPenalty??this.frequencyPenalty,this.presencePenalty=e?.presencePenalty??this.presencePenalty,this.logprobs=e?.logprobs,this.topLogprobs=e?.topLogprobs,this.n=e?.n??this.n,this.logitBias=e?.logitBias,this.stop=e?.stopSequences??e?.stop,this.stopSequences=this.stop,this.user=e?.user,this.__includeRawResponse=e?.__includeRawResponse,this.audio=e?.audio,this.modalities=e?.modalities,this.reasoning=e?.reasoning??e?.reasoningEffort?{effort:e.reasoningEffort}:void 0,this.maxTokens=e?.maxCompletionTokens??e?.maxTokens,this.disableStreaming=e?.disableStreaming??this.disableStreaming,this.promptCacheKey=e?.promptCacheKey??this.promptCacheKey,this.verbosity=e?.verbosity??this.verbosity,this.streaming=e?.streaming??!1,this.streaming===!1&&(this.disableStreaming=!0),this.disableStreaming&&(this.streaming=!1),this.streamUsage=e?.streamUsage??this.streamUsage,this.disableStreaming&&(this.streamUsage=!1),this.clientConfig={apiKey:this.apiKey,organization:this.organization,dangerouslyAllowBrowser:!0,...e?.configuration},e?.supportsStrictToolCalling!==void 0&&(this.supportsStrictToolCalling=e.supportsStrictToolCalling),e?.service_tier!==void 0&&(this.service_tier=e.service_tier),this.zdrEnabled=e?.zdrEnabled??!1}_getReasoningParams(e){if(!xf(this.model))return;let t;return this.reasoning!==void 0&&(t={...t,...this.reasoning}),e?.reasoning!==void 0&&(t={...t,...e.reasoning}),t}_getResponseFormat(e){return e&&e.type==="json_schema"&&e.json_schema.schema&&Lr(e.json_schema.schema)?uC(e.json_schema.schema,e.json_schema.name,{description:e.json_schema.description}):e}_combineCallOptions(e){return{...this.defaultOptions,...e??{}}}_getClientOptions(e){if(!this.client){let n={baseURL:this.clientConfig.baseURL},A=_i(n),s={...this.clientConfig,baseURL:A,timeout:this.timeout,maxRetries:0};s.baseURL||delete s.baseURL,this.client=new Ce(s)}return{...this.clientConfig,...e}}_convertChatOpenAIToolToCompletionsTool(e,t){return pC(e)?wC(e.metadata.customTool):Yh(e)?t?.strict!==void 0?{...e,function:{...e.function,strict:t.strict}}:e:fC(e,t)}bindTools(e,t){let n;return t?.strict!==void 0?n=t.strict:this.supportsStrictToolCalling!==void 0&&(n=this.supportsStrictToolCalling),this.withConfig({tools:e.map(A=>vf(A)?A:this._convertChatOpenAIToolToCompletionsTool(A,{strict:n})),...t})}async stream(e,t){return super.stream(e,this._combineCallOptions(t))}async invoke(e,t){return super.invoke(e,this._combineCallOptions(t))}_combineLLMOutput(...e){return e.reduce((t,n)=>(n&&n.tokenUsage&&(t.tokenUsage.completionTokens+=n.tokenUsage.completionTokens??0,t.tokenUsage.promptTokens+=n.tokenUsage.promptTokens??0,t.tokenUsage.totalTokens+=n.tokenUsage.totalTokens??0),t),{tokenUsage:{completionTokens:0,promptTokens:0,totalTokens:0}})}async getNumTokensFromMessages(e){let t=0,n=0,A=0;this.model==="gpt-3.5-turbo-0301"?(n=4,A=-1):(n=3,A=1);let s=await Promise.all(e.map(async i=>{let a=await this.getNumTokens(i.content),f=await this.getNumTokens(pm(i)),d=i.name!==void 0?A+await this.getNumTokens(i.name):0,h=a+n+f+d,m=i;if(m._getType()==="function"&&(h-=2),m.additional_kwargs?.function_call&&(h+=3),m?.additional_kwargs.function_call?.name&&(h+=await this.getNumTokens(m.additional_kwargs.function_call?.name)),m.additional_kwargs.function_call?.arguments)try{h+=await this.getNumTokens(JSON.stringify(JSON.parse(m.additional_kwargs.function_call?.arguments)))}catch(y){console.error("Error parsing function arguments",y,JSON.stringify(m.additional_kwargs.function_call)),h+=await this.getNumTokens(m.additional_kwargs.function_call?.arguments)}return t+=h,h}));return t+=3,{totalCount:t,countPerMessage:s}}async _getNumTokensFromGenerations(e){return(await Promise.all(e.map(async n=>n.message.additional_kwargs?.function_call?(await this.getNumTokensFromMessages([n.message])).countPerMessage[0]:await this.getNumTokens(n.message.content)))).reduce((n,A)=>n+A,0)}async _getEstimatedTokenCountFromPrompt(e,t,n){let A=(await this.getNumTokensFromMessages(e)).totalCount;if(t&&n!=="auto"){let s=cC(t);A+=await this.getNumTokens(s),A+=9}return t&&e.find(s=>s._getType()==="system")&&(A-=4),n==="none"?A+=1:typeof n=="object"&&(A+=await this.getNumTokens(n.name)+4),A}_getStructuredOutputMethod(e){let t={...e};if(!this.model.startsWith("gpt-3")&&!this.model.startsWith("gpt-4-")&&this.model!=="gpt-4"){if(t?.method===void 0)return"jsonSchema"}else t.method==="jsonSchema"&&console.warn(`[WARNING]: JSON Schema is not supported for model "${this.model}". Falling back to tool calling.`);return t.method}withStructuredOutput(e,t){let n,A,s,i;oN(e)?(n=e.schema,A=e.name,s=e.method,i=e.includeRaw):(n=e,A=t?.name,s=t?.method,i=t?.includeRaw);let a,f;if(t?.strict!==void 0&&s==="jsonMode")throw new Error("Argument `strict` is only supported for `method` = 'function_calling'");if(s=this._getStructuredOutputMethod({...t,method:s}),s==="jsonMode"){Lr(n)?f=yu.fromZodSchema(n):f=new _u;let y=Er(n);a=this.withConfig({response_format:{type:"json_object"},ls_structured_output_format:{kwargs:{method:"json_mode"},schema:{title:A??"extract",...y}}})}else if(s==="jsonSchema"){let y={name:A??"extract",description:gi(n),schema:n,strict:t?.strict},w=Er(y.schema);if(a=this.withConfig({response_format:{type:"json_schema",json_schema:y},ls_structured_output_format:{kwargs:{method:"json_schema"},schema:{title:y.name,description:y.description,...w}}}),Lr(n)){let b=yu.fromZodSchema(n);f=pn.from(C=>"parsed"in C.additional_kwargs?C.additional_kwargs.parsed:b)}else f=new _u}else{let y=A??"extract";if(Lr(n)){let w=Er(n);a=this.withConfig({tools:[{type:"function",function:{name:y,description:w.description,parameters:w}}],tool_choice:{type:"function",function:{name:y}},ls_structured_output_format:{kwargs:{method:"function_calling"},schema:{title:y,...w}},...t?.strict!==void 0?{strict:t.strict}:{}}),f=new bu({returnSingle:!0,keyName:y,zodSchema:n})}else{let w;typeof n.name=="string"&&typeof n.parameters=="object"&&n.parameters!=null?(w=n,y=n.name):(y=n.title??y,w={name:y,description:n.description??"",parameters:n});let b=Er(n);a=this.withConfig({tools:[{type:"function",function:w}],tool_choice:{type:"function",function:{name:y}},ls_structured_output_format:{kwargs:{method:"function_calling"},schema:{title:y,...b}},...t?.strict!==void 0?{strict:t.strict}:{}}),f=new bu({returnSingle:!0,keyName:y})}}if(!i)return a.pipe(f);let d=Vn.assign({parsed:(y,w)=>f.invoke(y.raw,w)}),h=Vn.assign({parsed:()=>null}),m=d.withFallbacks({fallbacks:[h]});return CA.from([{raw:a},m])}},Cf=class extends Eu{invocationParams(e){let t;e?.strict!==void 0?t=e.strict:this.supportsStrictToolCalling!==void 0&&(t=this.supportsStrictToolCalling);let n={model:this.model,temperature:this.temperature,top_p:this.topP,user:this.user,stream:this.streaming,previous_response_id:e?.previous_response_id,truncation:e?.truncation,include:e?.include,tools:e?.tools?.length?this._reduceChatOpenAITools(e.tools,{stream:this.streaming,strict:t}):void 0,tool_choice:dC(e?.tool_choice)?e?.tool_choice:(()=>{let s=lm(e?.tool_choice);if(typeof s=="object"&&"type"in s){if(s.type==="function")return{type:"function",name:s.function.name};if(s.type==="allowed_tools")return{type:"allowed_tools",mode:s.allowed_tools.mode,tools:s.allowed_tools.tools};if(s.type==="custom")return{type:"custom",name:s.custom.name}}})(),text:(()=>{if(e?.text)return e.text;let s=this._getResponseFormat(e?.response_format);return s?.type==="json_schema"?s.json_schema.schema!=null?{format:{type:"json_schema",schema:s.json_schema.schema,description:s.json_schema.description,name:s.json_schema.name,strict:s.json_schema.strict},verbosity:e?.verbosity}:void 0:{format:s,verbosity:e?.verbosity}})(),parallel_tool_calls:e?.parallel_tool_calls,max_output_tokens:this.maxTokens===-1?void 0:this.maxTokens,prompt_cache_key:e?.promptCacheKey??this.promptCacheKey,...this.zdrEnabled?{store:!1}:{},...this.modelKwargs},A=this._getReasoningParams(e);return A!==void 0&&(n.reasoning=A),n}async _generate(e,t){let n=this.invocationParams(t);if(n.stream){let A=this._streamResponseChunks(e,t),s;for await(let i of A)i.message.response_metadata={...i.generationInfo,...i.message.response_metadata},s=s?.concat(i)??i;return{generations:s?[s]:[],llmOutput:{estimatedTokenUsage:s?.message?.usage_metadata}}}else{let A=this._convertMessagesToResponsesParams(e),s=await this.completionWithRetry({input:A,...n,stream:!1},{signal:t?.signal,...t?.options});return{generations:[{text:s.output_text,message:this._convertResponsesMessageToBaseMessage(s)}],llmOutput:{id:s.id,estimatedTokenUsage:s.usage?{promptTokens:s.usage.input_tokens,completionTokens:s.usage.output_tokens,totalTokens:s.usage.total_tokens}:void 0}}}}async*_streamResponseChunks(e,t,n){let A=await this.completionWithRetry({...this.invocationParams(t),input:this._convertMessagesToResponsesParams(e),stream:!0},t);for await(let s of A){let i=this._convertResponsesDeltaToBaseMessageChunk(s);i!=null&&(yield i,await n?.handleLLMNewToken(i.text||"",{prompt:t.promptIndex??0,completion:0},void 0,void 0,void 0,{chunk:i}))}}async completionWithRetry(e,t){return this.caller.call(async()=>{let n=this._getClientOptions(t);try{return e.text?.format?.type==="json_schema"&&!e.stream?await this.client.responses.parse(e,n):await this.client.responses.create(e,n)}catch(A){throw Za(A)}})}_convertResponsesMessageToBaseMessage(e){if(e.error){let f=new Error(e.error.message);throw f.name=e.error.code,f}let t,n=[],A=[],s=[],i={model:e.model,created_at:e.created_at,id:e.id,incomplete_details:e.incomplete_details,metadata:e.metadata,object:e.object,status:e.status,user:e.user,service_tier:e.service_tier,model_name:e.model},a={};for(let f of e.output)if(f.type==="message")t=f.id,n.push(...f.content.flatMap(d=>d.type==="output_text"?("parsed"in d&&d.parsed!=null&&(a.parsed=d.parsed),{type:"text",text:d.text,annotations:d.annotations}):d.type==="refusal"?(a.refusal=d.refusal,[]):d));else if(f.type==="function_call"){let d={function:{name:f.name,arguments:f.arguments},id:f.call_id};try{A.push(wf(d,{returnId:!0}))}catch(h){let m;typeof h=="object"&&h!=null&&"message"in h&&typeof h.message=="string"&&(m=h.message),s.push(yf(d,m))}a[Ja]??(a[Ja]={}),f.id&&(a[Ja][f.call_id]=f.id)}else if(f.type==="reasoning")a.reasoning=f;else if(f.type==="custom_tool_call"){let d=hC(f);d?A.push(d):s.push(yf(f,"Malformed custom tool call"))}else a.tool_outputs??(a.tool_outputs=[]),a.tool_outputs.push(f);return new sr({id:t,content:n,tool_calls:A,invalid_tool_calls:s,usage_metadata:e.usage,additional_kwargs:a,response_metadata:i})}_convertResponsesDeltaToBaseMessageChunk(e){let t=[],n={},A,s=[],i={},a={},f;if(e.type==="response.output_text.delta")t.push({type:"text",text:e.delta,index:e.content_index});else if(e.type==="response.output_text.annotation.added")t.push({type:"text",text:"",annotations:[e.annotation],index:e.content_index});else if(e.type==="response.output_item.added"&&e.item.type==="message")f=e.item.id;else if(e.type==="response.output_item.added"&&e.item.type==="function_call")s.push({type:"tool_call_chunk",name:e.item.name,args:e.item.arguments,id:e.item.call_id,index:e.output_index}),a[Ja]={[e.item.call_id]:e.item.id};else if(e.type==="response.output_item.done"&&["web_search_call","file_search_call","computer_call","code_interpreter_call","mcp_call","mcp_list_tools","mcp_approval_request","image_generation_call","custom_tool_call"].includes(e.item.type))a.tool_outputs=[e.item];else if(e.type==="response.created")i.id=e.response.id,i.model_name=e.response.model,i.model=e.response.model;else if(e.type==="response.completed"){let d=this._convertResponsesMessageToBaseMessage(e.response);A=e.response.usage,e.response.text?.format?.type==="json_schema"&&(a.parsed??(a.parsed=JSON.parse(d.text)));for(let[h,m]of Object.entries(e.response))h!=="id"&&(i[h]=m)}else if(e.type==="response.function_call_arguments.delta")s.push({type:"tool_call_chunk",args:e.delta,index:e.output_index});else if(e.type==="response.web_search_call.completed"||e.type==="response.file_search_call.completed")n={tool_outputs:{id:e.item_id,type:e.type.replace("response.","").replace(".completed",""),status:"completed"}};else if(e.type==="response.refusal.done")a.refusal=e.refusal;else if(e.type==="response.output_item.added"&&"item"in e&&e.item.type==="reasoning"){let d=e.item.summary?e.item.summary.map((h,m)=>({...h,index:m})):void 0;a.reasoning={id:e.item.id,type:e.item.type,...d?{summary:d}:{}}}else if(e.type==="response.reasoning_summary_part.added")a.reasoning={type:"reasoning",summary:[{...e.part,index:e.summary_index}]};else if(e.type==="response.reasoning_summary_text.delta")a.reasoning={type:"reasoning",summary:[{text:e.delta,type:"summary_text",index:e.summary_index}]};else return e.type==="response.image_generation_call.partial_image",null;return new yA({text:t.map(d=>d.text).join(""),message:new Sr({id:f,content:t,tool_call_chunks:s,usage_metadata:A,additional_kwargs:a,response_metadata:i}),generationInfo:n})}_convertMessagesToResponsesParams(e){return e.flatMap(t=>{let n=t.additional_kwargs,A=pm(t);if(A==="system"&&xf(this.model)&&(A="developer"),A==="function")throw new Error("Function messages are not supported in Responses API");if(A==="tool"){let s=t;return n?.type==="computer_call_output"?{type:"computer_call_output",output:(()=>{if(typeof s.content=="string")return{type:"computer_screenshot",image_url:s.content};if(Array.isArray(s.content)){let a=s.content.find(d=>d.type==="computer_screenshot");if(a)return a;let f=s.content.find(d=>d.type==="image_url");if(f)return{type:"computer_screenshot",image_url:typeof f.image_url=="string"?f.image_url:f.image_url.url}}throw new Error("Invalid computer call output")})(),call_id:s.tool_call_id}:s.metadata?.customTool?{type:"custom_tool_call_output",call_id:s.tool_call_id,output:s.content}:{type:"function_call_output",call_id:s.tool_call_id,id:s.id?.startsWith("fc_")?s.id:void 0,output:typeof s.content!="string"?JSON.stringify(s.content):s.content}}if(A==="assistant"){if(!this.zdrEnabled&&t.response_metadata.output!=null&&Array.isArray(t.response_metadata.output)&&t.response_metadata.output.length>0&&t.response_metadata.output.every(h=>"type"in h))return t.response_metadata.output;let s=[];if(n?.reasoning&&!this.zdrEnabled){let h=this._convertReasoningSummary(n.reasoning);s.push(h)}let{content:i}=t;n?.refusal&&(typeof i=="string"&&(i=[{type:"output_text",text:i,annotations:[]}]),i=[...i,{type:"refusal",refusal:n.refusal}]),(typeof i=="string"||i.length>0)&&s.push({type:"message",role:"assistant",...t.id&&!this.zdrEnabled&&t.id.startsWith("msg_")?{id:t.id}:{},content:typeof i=="string"?i:i.flatMap(h=>h.type==="text"?{type:"output_text",text:h.text,annotations:h.annotations??[]}:h.type==="output_text"||h.type==="refusal"?h:[])});let a=n?.[Ja];WA(t)&&t.tool_calls?.length?s.push(...t.tool_calls.map(h=>mC(h)?{type:"custom_tool_call",id:h.call_id,call_id:h.id??"",input:h.args.input,name:h.name}:{type:"function_call",name:h.name,arguments:JSON.stringify(h.args),call_id:h.id,...this.zdrEnabled?{id:a?.[h.id]}:{}})):n?.tool_calls&&s.push(...n.tool_calls.map(h=>({type:"function_call",name:h.function.name,call_id:h.id,arguments:h.function.arguments,...this.zdrEnabled?{id:a?.[h.id]}:{}})));let f=t.response_metadata.output?.length?t.response_metadata.output:n.tool_outputs,d=["computer_call","mcp_call","code_interpreter_call","image_generation_call"];if(f!=null){let m=f?.filter(y=>d.includes(y.type));m.length>0&&s.push(...m)}return s}if(A==="user"||A==="system"||A==="developer"){if(typeof t.content=="string")return{type:"message",role:A,content:t.content};let s=[],i=t.content.flatMap(a=>(a.type==="mcp_approval_response"&&s.push({type:"mcp_approval_response",approval_request_id:a.approval_request_id,approve:a.approve}),lA(a)?op(a,yC):a.type==="text"?{type:"input_text",text:a.text}:a.type==="image_url"?{type:"input_image",image_url:typeof a.image_url=="string"?a.image_url:a.image_url.url,detail:typeof a.image_url=="string"?"auto":a.image_url.detail}:a.type==="input_text"||a.type==="input_image"||a.type==="input_file"?a:[]));return i.length>0&&s.push({type:"message",role:A,content:i}),s}return console.warn(`Unsupported role found when converting to OpenAI Responses API: ${A}`),[]})}_convertReasoningSummary(e){let t=(e.summary.length>1?e.summary.reduce((n,A)=>{let s=n.at(-1);return s.index===A.index?s.text+=A.text:n.push(A),n},[{...e.summary[0]}]):e.summary).map(n=>Object.fromEntries(Object.entries(n).filter(([A])=>A!=="index")));return{...e,summary:t}}_reduceChatOpenAITools(e,t){let n=[];for(let A of e)vf(A)?(A.type==="image_generation"&&t?.stream&&(A.partial_images=1),n.push(A)):Yh(A)?n.push({type:"function",name:A.function.name,parameters:A.function.parameters,description:A.function.description,strict:t?.strict??null}):fm(A)&&n.push(gC(A));return n}},Ef=class extends Eu{invocationParams(e,t){let n;e?.strict!==void 0?n=e.strict:this.supportsStrictToolCalling!==void 0&&(n=this.supportsStrictToolCalling);let A={};e?.stream_options!==void 0?A={stream_options:e.stream_options}:this.streamUsage&&(this.streaming||t?.streaming)&&(A={stream_options:{include_usage:!0}});let s={model:this.model,temperature:this.temperature,top_p:this.topP,frequency_penalty:this.frequencyPenalty,presence_penalty:this.presencePenalty,logprobs:this.logprobs,top_logprobs:this.topLogprobs,n:this.n,logit_bias:this.logitBias,stop:e?.stop??this.stopSequences,user:this.user,stream:this.streaming,functions:e?.functions,function_call:e?.function_call,tools:e?.tools?.length?e.tools.map(a=>this._convertChatOpenAIToolToCompletionsTool(a,{strict:n})):void 0,tool_choice:lm(e?.tool_choice),response_format:this._getResponseFormat(e?.response_format),seed:e?.seed,...A,parallel_tool_calls:e?.parallel_tool_calls,...this.audio||e?.audio?{audio:this.audio||e?.audio}:{},...this.modalities||e?.modalities?{modalities:this.modalities||e?.modalities}:{},...this.modelKwargs,prompt_cache_key:e?.promptCacheKey??this.promptCacheKey,verbosity:e?.verbosity??this.verbosity};e?.prediction!==void 0&&(s.prediction=e.prediction),this.service_tier!==void 0&&(s.service_tier=this.service_tier),e?.service_tier!==void 0&&(s.service_tier=e.service_tier);let i=this._getReasoningParams(e);return i!==void 0&&i.effort!==void 0&&(s.reasoning_effort=i.effort),xf(s.model)?s.max_completion_tokens=this.maxTokens===-1?void 0:this.maxTokens:s.max_tokens=this.maxTokens===-1?void 0:this.maxTokens,s}async _generate(e,t,n){let A={},s=this.invocationParams(t),i=dm(e,this.model);if(s.stream){let a=this._streamResponseChunks(e,t,n),f={};for await(let b of a){b.message.response_metadata={...b.generationInfo,...b.message.response_metadata};let C=b.generationInfo?.completion??0;f[C]===void 0?f[C]=b:f[C]=f[C].concat(b)}let d=Object.entries(f).sort(([b],[C])=>parseInt(b,10)-parseInt(C,10)).map(([b,C])=>C),{functions:h,function_call:m}=this.invocationParams(t),y=await this._getEstimatedTokenCountFromPrompt(e,h,m),w=await this._getNumTokensFromGenerations(d);return A.input_tokens=y,A.output_tokens=w,A.total_tokens=y+w,{generations:d,llmOutput:{estimatedTokenUsage:{promptTokens:A.input_tokens,completionTokens:A.output_tokens,totalTokens:A.total_tokens}}}}else{let a=await this.completionWithRetry({...s,stream:!1,messages:i},{signal:t?.signal,...t?.options}),{completion_tokens:f,prompt_tokens:d,total_tokens:h,prompt_tokens_details:m,completion_tokens_details:y}=a?.usage??{};f&&(A.output_tokens=(A.output_tokens??0)+f),d&&(A.input_tokens=(A.input_tokens??0)+d),h&&(A.total_tokens=(A.total_tokens??0)+h),(m?.audio_tokens!==null||m?.cached_tokens!==null)&&(A.input_token_details={...m?.audio_tokens!==null&&{audio:m?.audio_tokens},...m?.cached_tokens!==null&&{cache_read:m?.cached_tokens}}),(y?.audio_tokens!==null||y?.reasoning_tokens!==null)&&(A.output_token_details={...y?.audio_tokens!==null&&{audio:y?.audio_tokens},...y?.reasoning_tokens!==null&&{reasoning:y?.reasoning_tokens}});let w=[];for(let b of a?.choices??[]){let I={text:b.message?.content??"",message:this._convertCompletionsMessageToBaseMessage(b.message??{role:"assistant"},a)};I.generationInfo={...b.finish_reason?{finish_reason:b.finish_reason}:{},...b.logprobs?{logprobs:b.logprobs}:{}},WA(I.message)&&(I.message.usage_metadata=A),I.message=new sr(Object.fromEntries(Object.entries(I.message).filter(([T])=>!T.startsWith("lc_")))),w.push(I)}return{generations:w,llmOutput:{tokenUsage:{promptTokens:A.input_tokens,completionTokens:A.output_tokens,totalTokens:A.total_tokens}}}}}async*_streamResponseChunks(e,t,n){let A=dm(e,this.model),s={...this.invocationParams(t,{streaming:!0}),messages:A,stream:!0},i,a=await this.completionWithRetry(s,t),f;for await(let d of a){let h=d?.choices?.[0];if(d.usage&&(f=d.usage),!h)continue;let{delta:m}=h;if(!m)continue;let y=this._convertCompletionsDeltaToBaseMessageChunk(m,d,i);i=m.role??i;let w={prompt:t.promptIndex??0,completion:h.index??0};if(typeof y.content!="string"){console.log("[WARNING]: Received non-string content from OpenAI. This is currently not supported.");continue}let b={...w};h.finish_reason!=null&&(b.finish_reason=h.finish_reason,b.system_fingerprint=d.system_fingerprint,b.model_name=d.model,b.service_tier=d.service_tier),this.logprobs&&(b.logprobs=h.logprobs);let C=new yA({message:y,text:y.content,generationInfo:b});yield C,await n?.handleLLMNewToken(C.text??"",w,void 0,void 0,void 0,{chunk:C})}if(f){let d={...f.prompt_tokens_details?.audio_tokens!==null&&{audio:f.prompt_tokens_details?.audio_tokens},...f.prompt_tokens_details?.cached_tokens!==null&&{cache_read:f.prompt_tokens_details?.cached_tokens}},h={...f.completion_tokens_details?.audio_tokens!==null&&{audio:f.completion_tokens_details?.audio_tokens},...f.completion_tokens_details?.reasoning_tokens!==null&&{reasoning:f.completion_tokens_details?.reasoning_tokens}};yield new yA({message:new Sr({content:"",response_metadata:{usage:{...f}},usage_metadata:{input_tokens:f.prompt_tokens,output_tokens:f.completion_tokens,total_tokens:f.total_tokens,...Object.keys(d).length>0&&{input_token_details:d},...Object.keys(h).length>0&&{output_token_details:h}}}),text:""})}if(t.signal?.aborted)throw new Error("AbortError")}async completionWithRetry(e,t){let n=this._getClientOptions(t),A=e.response_format&&e.response_format.type==="json_schema";return this.caller.call(async()=>{try{return A&&!e.stream?await this.client.chat.completions.parse(e,n):await this.client.chat.completions.create(e,n)}catch(s){throw Za(s)}})}_convertCompletionsMessageToBaseMessage(e,t){let n=e.tool_calls;switch(e.role){case"assistant":{let A=[],s=[];for(let f of n??[])try{A.push(wf(f,{returnId:!0}))}catch(d){s.push(yf(f,d.message))}let i={function_call:e.function_call,tool_calls:n};this.__includeRawResponse!==void 0&&(i.__raw_response=t);let a={model_name:t.model,...t.system_fingerprint?{usage:{...t.usage},system_fingerprint:t.system_fingerprint}:{}};return e.audio&&(i.audio=e.audio),new sr({content:e.content||"",tool_calls:A,invalid_tool_calls:s,additional_kwargs:i,response_metadata:a,id:t.id})}default:return new qA(e.content||"",e.role??"unknown")}}_convertCompletionsDeltaToBaseMessageChunk(e,t,n){let A=e.role??n,s=e.content??"",i;e.function_call?i={function_call:e.function_call}:e.tool_calls?i={tool_calls:e.tool_calls}:i={},this.__includeRawResponse&&(i.__raw_response=t),e.audio&&(i.audio={...e.audio,index:t.choices[0].index});let a={usage:{...t.usage}};if(A==="user")return new zs({content:s,response_metadata:a});if(A==="assistant"){let f=[];if(Array.isArray(e.tool_calls))for(let d of e.tool_calls)f.push({name:d.function?.name,args:d.function?.arguments,id:d.id,index:d.index,type:"tool_call_chunk"});return new Sr({content:s,tool_call_chunks:f,additional_kwargs:i,id:t.id,response_metadata:a})}else return A==="system"?new YA({content:s,response_metadata:a}):A==="developer"?new YA({content:s,response_metadata:a,additional_kwargs:{__openai_role__:"developer"}}):A==="function"?new Ks({content:s,additional_kwargs:i,name:e.name,response_metadata:a}):A==="tool"?new _a({content:s,additional_kwargs:i,tool_call_id:e.tool_call_id,response_metadata:a}):new js({content:s,role:A,response_metadata:a})}},xu=class r extends Eu{get lc_serializable_keys(){return[...super.lc_serializable_keys,"useResponsesApi"]}constructor(e){super(e),Object.defineProperty(this,"fields",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"useResponsesApi",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"responses",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"completions",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.useResponsesApi=e?.useResponsesApi??!1,this.responses=e?.responses??new Cf(e),this.completions=e?.completions??new Ef(e)}_useResponsesApi(e){let t=e?.tools?.some(vf),n=e?.previous_response_id!=null||e?.text!=null||e?.truncation!=null||e?.include!=null||e?.reasoning?.summary!=null||this.reasoning?.summary!=null,A=e?.tools?.some(fm);return this.useResponsesApi||t||n||A}getLsParams(e){let t=this._combineCallOptions(e);return this._useResponsesApi(e)?this.responses.getLsParams(t):this.completions.getLsParams(t)}invocationParams(e){let t=this._combineCallOptions(e);return this._useResponsesApi(e)?this.responses.invocationParams(t):this.completions.invocationParams(t)}async _generate(e,t,n){return this._useResponsesApi(t)?this.responses._generate(e,t):this.completions._generate(e,t,n)}async*_streamResponseChunks(e,t,n){if(this._useResponsesApi(t)){yield*this.responses._streamResponseChunks(e,this._combineCallOptions(t),n);return}yield*this.completions._streamResponseChunks(e,this._combineCallOptions(t),n)}withConfig(e){let t=new r(this.fields);return t.defaultOptions={...this.defaultOptions,...e},t}};var hm=class extends gu{get lc_namespace(){return["langchain","tools"]}constructor(e){super(e??{}),Object.defineProperty(this,"returnDirect",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"verboseParsingErrors",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"responseFormat",{enumerable:!0,configurable:!0,writable:!0,value:"content"}),Object.defineProperty(this,"defaultConfig",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.verboseParsingErrors=e?.verboseParsingErrors??this.verboseParsingErrors,this.responseFormat=e?.responseFormat??this.responseFormat,this.defaultConfig=e?.defaultConfig??this.defaultConfig,this.metadata=e?.metadata??this.metadata}async invoke(e,t){let n,A=He(ka(this.defaultConfig,t));return es(e)?(n=e.args,A={...A,toolCall:e}):n=e,this.call(n,A)}async call(e,t,n){let A=es(e)?e.args:e,s;if(Lr(this.schema))try{s=await ja(this.schema,A)}catch(b){let C="Received tool input did not match expected schema";throw this.verboseParsingErrors&&(C=`${C}
Details: ${b.message}`),new Gs(C,JSON.stringify(e))}else{let b=tt(A,this.schema);if(!b.valid){let C="Received tool input did not match expected schema";throw this.verboseParsingErrors&&(C=`${C}
Details: ${b.errors.map(I=>`${I.keywordLocation}: ${I.error}`).join(`
`)}`),new Gs(C,JSON.stringify(e))}s=A}let i=c0(t),f=await jt.configure(i.callbacks,this.callbacks,i.tags||n,this.tags,i.metadata,this.metadata,{verbose:this.verbose})?.handleToolStart(this.toJSON(),typeof e=="string"?e:JSON.stringify(e),i.runId,void 0,void 0,void 0,i.runName);delete i.runId;let d;try{d=await this._call(s,f,i)}catch(b){throw await f?.handleToolError(b),b}let h,m;if(this.responseFormat==="content_and_artifact")if(Array.isArray(d)&&d.length===2)[h,m]=d;else throw new Error(`Tool response format is "content_and_artifact" but the output was not a two-tuple.
Result: ${JSON.stringify(d)}`);else h=d;let y;es(e)&&(y=e.id),!y&&Sy(i)&&(y=i.toolCall.id);let w=lN({content:h,artifact:m,toolCallId:y,name:this.name,metadata:this.metadata});return await f?.handleToolEnd(w),w}},If=class extends hm{constructor(e){super(e),Object.defineProperty(this,"schema",{enumerable:!0,configurable:!0,writable:!0,value:Pr.object({input:Pr.string().optional()}).transform(t=>t.input)})}call(e,t){let n=typeof e=="string"||e==null?{input:e}:e;return super.call(n,t)}};function lN(r){let{content:e,artifact:t,toolCallId:n,metadata:A}=r;return n&&!Ty(e)?typeof e=="string"||Array.isArray(e)&&e.every(s=>typeof s=="object")?new on({status:"success",content:e,artifact:t,tool_call_id:n,name:r.name,metadata:A}):new on({status:"success",content:fN(e),artifact:t,tool_call_id:n,name:r.name,metadata:A}):e}function fN(r){try{return JSON.stringify(r,null,2)??""}catch{return`${r}`}}var mm=class extends If{static lc_name(){return"DallEAPIWrapper"}constructor(e){e?.responseFormat!==void 0&&["url","b64_json"].includes(e.responseFormat)&&(e.dallEResponseFormat=e.responseFormat,e.responseFormat="content"),super(e),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"dalle_api_wrapper"}),Object.defineProperty(this,"description",{enumerable:!0,configurable:!0,writable:!0,value:"A wrapper around OpenAI DALL-E API. Useful for when you need to generate images from a text description. Input should be an image description."}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"model",{enumerable:!0,configurable:!0,writable:!0,value:"dall-e-3"}),Object.defineProperty(this,"style",{enumerable:!0,configurable:!0,writable:!0,value:"vivid"}),Object.defineProperty(this,"quality",{enumerable:!0,configurable:!0,writable:!0,value:"standard"}),Object.defineProperty(this,"n",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"size",{enumerable:!0,configurable:!0,writable:!0,value:"1024x1024"}),Object.defineProperty(this,"dallEResponseFormat",{enumerable:!0,configurable:!0,writable:!0,value:"url"}),Object.defineProperty(this,"user",{enumerable:!0,configurable:!0,writable:!0,value:void 0});let t=e?.apiKey??e?.openAIApiKey??pt("OPENAI_API_KEY"),n=e?.organization??pt("OPENAI_ORGANIZATION"),A={apiKey:t,organization:n,dangerouslyAllowBrowser:!0,baseURL:e?.baseUrl};this.client=new Ce(A),this.model=e?.model??e?.modelName??this.model,this.style=e?.style??this.style,this.quality=e?.quality??this.quality,this.n=e?.n??this.n,this.size=e?.size??this.size,this.dallEResponseFormat=e?.dallEResponseFormat??this.dallEResponseFormat,this.user=e?.user}processMultipleGeneratedUrls(e){return this.dallEResponseFormat==="url"?e.flatMap(t=>t.data?.flatMap(A=>A.url?{type:"image_url",image_url:A.url}:[]).filter(A=>A!==void 0&&A.type==="image_url"&&typeof A.image_url=="string"&&A.image_url!==void 0)??[]):e.flatMap(t=>t.data?.flatMap(A=>A.b64_json?{type:"image_url",image_url:{url:A.b64_json}}:[]).filter(A=>A!==void 0&&A.type==="image_url"&&typeof A.image_url=="object"&&"url"in A.image_url&&typeof A.image_url.url=="string"&&A.image_url.url!==void 0)??[])}async _call(e){let t={model:this.model,prompt:e,n:1,size:this.size,response_format:this.dallEResponseFormat,style:this.style,quality:this.quality,user:this.user};if(this.n>1){let s=await Promise.all(Array.from({length:this.n}).map(()=>this.client.images.generate(t)));return this.processMultipleGeneratedUrls(s)}let n=await this.client.images.generate(t),A="";return this.dallEResponseFormat==="url"?[A]=n.data?.map(s=>s.url).filter(s=>s!=="undefined")??[]:[A]=n.data?.map(s=>s.b64_json).filter(s=>s!=="undefined")??[],A}};Object.defineProperty(mm,"toolName",{enumerable:!0,configurable:!0,writable:!0,value:"dalle_api_wrapper"});var Wa="ai-hud:default-chatbot:history:";function gm(r){return`${Wa}${r}`}function bC(r){try{typeof window<"u"&&window.localStorage.removeItem(gm(r))}catch{}}function BC(){try{if(typeof window>"u")return;let r=[];for(let e=0;e<window.localStorage.length;e++){let t=window.localStorage.key(e);t&&t.startsWith(Wa)&&r.push(t)}r.forEach(e=>window.localStorage.removeItem(e))}catch{}}var it=require("react/jsx-runtime");async function dN(r){return new Promise((e,t)=>{let n=new FileReader;n.onload=()=>e(n.result),n.onerror=t,n.readAsDataURL(r)})}var vC=({model:r="gpt-4o-mini",placeholderApiKey:e,systemPrompt:t="You are a helpful assistant.",welcome:n="Hi! How can I help you today?",className:A,style:s,conversationId:i,context:a,contextImages:f,inputPlaceholder:d,inputValue:h,tools:m,toolMaxIterations:y=3})=>{let b=(de=>{if(de&&de!=="REPLACE_WITH_YOUR_OPENAI_API_KEY")return de;try{let we=globalThis||{};if(typeof we.AI_HUD_OPENAI_API_KEY=="string"&&we.AI_HUD_OPENAI_API_KEY)return we.AI_HUD_OPENAI_API_KEY;if(typeof we.__AI_HUD_OPENAI_API_KEY__=="string"&&we.__AI_HUD_OPENAI_API_KEY__)return we.__AI_HUD_OPENAI_API_KEY__}catch{}try{let we=globalThis.process;if(we&&we.env&&typeof we.env.AI_HUD_OPENAI_API_KEY=="string")return we.env.AI_HUD_OPENAI_API_KEY}catch{}return null})(e),C=(0,It.useRef)(null);if(!i&&!C.current){let de=(()=>{try{if(typeof crypto<"u"&&crypto.randomUUID)return crypto.randomUUID()}catch{}return`conv_${Date.now().toString(36)}_${Math.random().toString(36).slice(2,8)}`})();C.current=de}let I=i??C.current,T=`${Wa}${I}`,[Q,P]=(0,It.useState)(()=>{try{let de=typeof window<"u"?window.localStorage.getItem(T):null;if(de){let we=JSON.parse(de);if(Array.isArray(we))return we}}catch{}return[{id:"welcome",role:"assistant",text:n}]}),[R,D]=(0,It.useState)(()=>typeof h=="string"?h:""),[ee,Y]=(0,It.useState)([]),[fe,ve]=(0,It.useState)(!1),Ie=(0,It.useRef)(null),Te=(0,It.useCallback)(()=>{Ie.current?.scrollIntoView({behavior:"smooth"})},[]),_t=(0,It.useCallback)(de=>de?de.replace(/\\\(/g,"(").replace(/\\\)/g,")").replace(/\\times/g,"\xD7").replace(/\\n/g,`
`):"",[]),{toolSchemas:$e,toolExecutors:Ye}=(0,It.useMemo)(()=>{if(!Array.isArray(m))return{toolSchemas:[],toolExecutors:{}};let de=m.map(ue=>({type:"function",function:{name:ue.function.name,description:ue.function.description??"",parameters:ue.function.parameters??{type:"object",properties:{}}}})),we={};for(let ue of m)we[ue.function.name]=async ye=>await ue.execute(ye);return{toolSchemas:de,toolExecutors:we}},[m]),At=async de=>{let we=Array.from(de.target.files||[]);if(we.length===0)return;let ue=await Promise.all(we.map(dN));Y(ye=>[...ye,...ue]),de.target.value=""},Ut=de=>{Y(we=>we.filter((ue,ye)=>ye!==de))},Ft=(0,It.useCallback)((de,we)=>{let ue=[];if(t&&ue.push({role:"system",content:t}),typeof a<"u"){let ye="";try{ye=JSON.stringify(a)}catch{ye=String(a)}ue.push({role:"system",content:`Context: ${ye}`})}if(Array.isArray(f)&&f.length>0){let ye=f.filter(Ze=>typeof Ze=="string"&&(Ze.startsWith("data:image/")||Ze.startsWith("http")));if(ye.length>0){let Ze=[{type:"text",text:"Context images"},...ye.map(Ge=>({type:"image_url",image_url:{url:Ge}}))];ue.push({role:"user",content:Ze})}}for(let ye of de)if(ye.role==="assistant")ue.push({role:"assistant",content:ye.text||""});else if((ye.images?.length||0)>0){let Ze=[{type:"text",text:ye.text||""},...ye.images.map(Ge=>({type:"image_url",image_url:{url:Ge}}))];ue.push({role:"user",content:Ze})}else ue.push({role:"user",content:ye.text||""});if(we)if(we.images.length>0){let ye=[{type:"text",text:we.text},...we.images.map(Ze=>({type:"image_url",image_url:{url:Ze}}))];ue.push({role:"user",content:ye})}else ue.push({role:"user",content:we.text});return console.log("result",ue),ue},[t,a]),Qt=(0,It.useCallback)(async()=>{let de=R.trim();if(!de&&ee.length===0)return;let we={id:String(Date.now()),role:"user",text:de||void 0,images:ee.length?ee:void 0};P(ue=>[...ue,we]),D(""),Y([]),ve(!0);try{let ue=[],ye=Ft(Q,{text:we.text||"",images:we.images||[]});for(let at of ye)if(at.role==="system")ue.push(new XA(at.content));else if(at.role==="assistant")ue.push(new sr(at.content));else if(at.role==="user"){let er=at.content;Array.isArray(er)?ue.push(new wr({content:er})):ue.push(new wr(at.content))}let Ze=new xu({modelName:r,temperature:.7,apiKey:b??void 0}),Ge=$e.length>0?Ze.bind({tools:$e}):Ze,Tt=await Ge.invoke(ue),Zn=0;for(;Zn<y&&Array.isArray(Tt.tool_calls)&&Tt.tool_calls.length>0&&$e.length>0;){let at=Tt.tool_calls,er=[];for(let xr of at){let tr=xr.name??xr.function?.name,Hr=xr.args??xr.function?.arguments,fr=Hr;if(typeof Hr=="string")try{fr=JSON.parse(Hr)}catch{fr=Hr}let Kt=tr?Ye[tr]:void 0,rr=`Tool '${tr}' not found`;try{Kt&&(rr=await Kt(fr))}catch(Dr){rr=`Error from tool '${tr}': ${Dr?.message||String(Dr)}`}P(Dr=>[...Dr,{id:`${Date.now()}_${tr}`,role:"tool",text:`Called ${tr} with ${typeof fr=="string"?fr:JSON.stringify(fr)}
\u2192 ${typeof rr=="string"?rr:JSON.stringify(rr)}`}]),er.push(new on({tool_call_id:xr.id,content:typeof rr=="string"?rr:JSON.stringify(rr)}))}ue=[...ue,Tt,...er],Tt=await Ge.invoke(ue),Zn+=1}let Jn=typeof Tt.content=="string"?Tt.content:JSON.stringify(Tt.content),Bi={id:String(Date.now()+1),role:"assistant",text:typeof Jn=="string"?Jn:String(Jn)};P(at=>[...at,Bi]),setTimeout(Te,0)}catch(ue){let ye={id:String(Date.now()+1),role:"assistant",text:`Error: ${ue?.message||"Failed to contact OpenAI"}`};P(Ze=>[...Ze,ye])}finally{ve(!1)}},[Ft,R,Q,ee,e,r,Te]),st=(0,It.useMemo)(()=>(R.trim().length>0||ee.length>0)&&!fe,[R,ee.length,fe]);return(0,It.useEffect)(()=>{try{typeof window<"u"&&window.localStorage.setItem(T,JSON.stringify(Q))}catch{}},[Q,T]),(0,It.useEffect)(()=>()=>{if(!i)try{typeof window<"u"&&window.localStorage.removeItem(T)}catch{}},[i,T]),(0,it.jsxs)("div",{className:A,style:{display:"flex",flexDirection:"column",height:"100%",...s},children:[(0,it.jsxs)("div",{style:{flex:1,overflow:"auto",padding:12,background:"#ffffff"},children:[Q.map(de=>(0,it.jsx)("div",{style:{marginBottom:10,display:"flex",justifyContent:de.role==="user"?"flex-end":"flex-start"},children:(0,it.jsxs)("div",{style:{maxWidth:"80%",padding:"8px 10px",borderRadius:10,border:de.role==="tool"?"1px dashed rgba(0,0,0,0.2)":"1px solid rgba(0,0,0,0.06)",background:de.role==="user"?"#111827":de.role==="tool"?"#fff7ed":"#f3f4f6",color:de.role==="user"?"#ffffff":"#111827",whiteSpace:"pre-wrap",wordBreak:"break-word"},children:[de.role==="assistant"?_t(de.text):de.text,de.images&&de.images.length>0&&(0,it.jsx)("div",{style:{display:"flex",gap:8,marginTop:8,flexWrap:"wrap"},children:de.images.map((we,ue)=>(0,it.jsx)("img",{src:we,alt:"upload",style:{width:96,height:72,objectFit:"cover",borderRadius:8,border:"1px solid rgba(0,0,0,0.06)"}},ue))})]})},de.id)),(0,it.jsx)("div",{ref:Ie})]}),(0,it.jsxs)("div",{style:{padding:12,borderTop:"1px solid rgba(0,0,0,0.06)",background:"#fafafa"},children:[(0,it.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[(0,it.jsx)("input",{type:"file",accept:"image/*",multiple:!0,onChange:At,style:{display:"none"},id:"ai-hud-chatbot-file"}),(0,it.jsx)("label",{htmlFor:"ai-hud-chatbot-file",children:(0,it.jsx)("span",{style:{display:"inline-flex",alignItems:"center",justifyContent:"center",width:36,height:36,border:"1px solid rgba(0,0,0,0.08)",borderRadius:8,background:"white",cursor:"pointer"},children:(0,it.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,it.jsx)("path",{d:"M18.5 12.5l-5 5-3-3-5 5"}),(0,it.jsx)("path",{d:"M20 7a4 4 0 0 0-8 0v10a4 4 0 0 0 8 0Z"})]})})}),(0,it.jsx)("input",{value:R,onChange:de=>D(de.target.value),placeholder:d??"Type a message...",onKeyDown:de=>{de.key==="Enter"&&!de.shiftKey&&(de.preventDefault(),st&&Qt())},style:{flex:1,height:36,border:"1px solid rgba(0,0,0,0.15)",borderRadius:8,padding:"0 10px"}}),(0,it.jsx)("button",{type:"button",disabled:!st,onClick:()=>void Qt(),style:{height:36,padding:"0 12px",borderRadius:8,border:"1px solid rgba(0,0,0,0.08)",background:st?"#111827":"#e5e7eb",color:st?"#ffffff":"#9ca3af",cursor:st?"pointer":"not-allowed"},children:"Send"})]}),ee.length>0&&(0,it.jsx)("div",{style:{display:"flex",gap:8,marginTop:8,flexWrap:"wrap"},children:ee.map((de,we)=>(0,it.jsxs)("div",{style:{position:"relative"},children:[(0,it.jsx)("img",{src:de,alt:"selected",style:{width:64,height:48,objectFit:"cover",borderRadius:6,border:"1px solid rgba(0,0,0,0.06)"}}),(0,it.jsx)("button",{type:"button",onClick:()=>Ut(we),"aria-label":"Remove image",style:{position:"absolute",top:-6,right:-6,width:20,height:20,borderRadius:9999,border:"1px solid rgba(0,0,0,0.08)",background:"white",cursor:"pointer"},children:"\xD7"})]},we))})]})]})};
/*! Bundled license information:

html2canvas/dist/html2canvas.js:
  (*!
   * html2canvas 1.4.1 <https://html2canvas.hertzen.com>
   * Copyright (c) 2022 Niklas von Hertzen <https://hertzen.com>
   * Released under MIT License
   *)
  (*! *****************************************************************************
      Copyright (c) Microsoft Corporation.
  
      Permission to use, copy, modify, and/or distribute this software for any
      purpose with or without fee is hereby granted.
  
      THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
      REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
      AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
      INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
      LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
      OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
      PERFORMANCE OF THIS SOFTWARE.
      ***************************************************************************** *)

@langchain/core/dist/utils/fast-json-patch/src/helpers.js:
  (*!
   * https://github.com/Starcounter-Jack/JSON-Patch
   * (c) 2017-2022 Joachim Wester
   * MIT licensed
   *)

@langchain/core/dist/utils/fast-json-patch/src/duplex.js:
  (*!
   * https://github.com/Starcounter-Jack/JSON-Patch
   * (c) 2013-2021 Joachim Wester
   * MIT license
   *)

@langchain/core/dist/utils/js-sha1/hash.js:
  (*
   * [js-sha1]{@link https://github.com/emn178/js-sha1}
   *
   * @version 0.6.0
   * @author Chen, Yi-Cyuan [emn178@gmail.com]
   * @copyright Chen, Yi-Cyuan 2014-2017
   * @license MIT
   *)

@langchain/core/dist/utils/js-sha256/hash.js:
  (**
   * [js-sha256]{@link https://github.com/emn178/js-sha256}
   *
   * @version 0.11.1
   * @author Chen, Yi-Cyuan [emn178@gmail.com]
   * @copyright Chen, Yi-Cyuan 2014-2025
   * @license MIT
   *)
*/
//# sourceMappingURL=index.cjs.map